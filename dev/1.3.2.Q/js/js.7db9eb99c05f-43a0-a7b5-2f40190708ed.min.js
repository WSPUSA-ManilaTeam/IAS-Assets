/*! 
 PROJECT: AuthorityMatrix 
 GRUNT AUTHOR: Ruther John Guevarra 
 DEVELOPERS: 
 Ruther John Guevarra 
 Eron Manlagnit 
 Jazzvy Andrada 
 Joseph Khalaf 
 Teejay Garcia 
 Mark Joel Casabuena 
 LATEST BUILD DATE AND TIME: September 30, 2021 04:23 PM 
 */

function createApplication(e){return new Msal.UserAgentApplication(msalConfig)}var clientApplication;!function(){var f="__default";angular.module("angularUtils.directives.dirPagination",[]).directive("dirPaginate",["$compile","$parse","paginationService",function(u,c,d){return{terminal:!0,multiElement:!0,priority:100,compile:function(e,t){var a=t.dirPaginate,n=a.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),l=/\|\s*itemsPerPage\s*:\s*(.*\(\s*\w*\)|([^\)]*?(?=\s+as\s+))|[^\)]*)/;if(null===n[2].match(l))throw"pagination directive: the 'itemsPerPage' filter must be set.";var o=n[2].replace(l,""),s=c(o);!function(e){angular.forEach(e,function(e){1===e.nodeType&&angular.element(e).attr("dir-paginate-no-compile",!0)})}(e);var r=t.paginationId||f;return d.registerInstance(r),function(e,t,n){var l=c(n.paginationId)(e)||n.paginationId||f;d.registerInstance(l);var o=function(e,t){var n,l=!!e.match(/(\|\s*itemsPerPage\s*:[^|]*:[^|]*)/);n=t===f||l?e:e.replace(/(\|\s*itemsPerPage\s*:\s*[^|\s]*)/,"$1 : '"+t+"'");return n}(a,l);!function(e,t,n){e[0].hasAttribute("dir-paginate-start")||e[0].hasAttribute("data-dir-paginate-start")?(t.$set("ngRepeatStart",n),e.eq(e.length-1).attr("ng-repeat-end",!0)):t.$set("ngRepeat",n)}(t,n,o),function(e){angular.forEach(e,function(e){1===e.nodeType&&angular.element(e).removeAttr("dir-paginate-no-compile")}),e.eq(0).removeAttr("dir-paginate-start").removeAttr("dir-paginate").removeAttr("data-dir-paginate-start").removeAttr("data-dir-paginate"),e.eq(e.length-1).removeAttr("dir-paginate-end").removeAttr("data-dir-paginate-end")}(t);var r=u(t),i=function(e,t,n){var l;if(t.currentPage)l=c(t.currentPage);else{var o=(n+"__currentPage").replace(/\W/g,"_");e[o]=1,l=c(o)}return l}(e,n,l);d.setCurrentPageParser(l,i,e),void 0!==n.totalItems?(d.setAsyncModeTrue(l),e.$watch(function(){return c(n.totalItems)(e)},function(e){0<=e&&d.setCollectionLength(l,e)})):(d.setAsyncModeFalse(l),e.$watchCollection(function(){return s(e)},function(e){if(e){var t=e instanceof Array?e.length:Object.keys(e).length;d.setCollectionLength(l,t)}})),r(e)}}}}]).directive("dirPaginateNoCompile",function(){return{priority:5e3,terminal:!0}}).directive("dirPaginationControls",["paginationService","paginationTemplate",function(c,n){var d=/^\d+$/,e={restrict:"AE",scope:{maxSize:"=?",onPageChange:"&?",paginationId:"=?",autoHide:"=?"},link:function(l,e,t){var n=t.paginationId||f,o=l.paginationId||t.paginationId||f;if(!c.isRegistered(o)&&!c.isRegistered(n)){window.console}l.maxSize||(l.maxSize=9);l.autoHide=void 0===l.autoHide||l.autoHide,l.directionLinks=!angular.isDefined(t.directionLinks)||l.$parent.$eval(t.directionLinks),l.boundaryLinks=!!angular.isDefined(t.boundaryLinks)&&l.$parent.$eval(t.boundaryLinks);var r=Math.max(l.maxSize,5);function i(e){if(c.isRegistered(o)&&u(e)){var t=l.pagination.current;l.pages=p(e,c.getCollectionLength(o),c.getItemsPerPage(o),r),l.pagination.current=e,s(),l.onPageChange&&l.onPageChange({newPageNumber:e,oldPageNumber:t})}}function a(){if(c.isRegistered(o)){var e=parseInt(c.getCurrentPage(o))||1;l.pages=p(e,c.getCollectionLength(o),c.getItemsPerPage(o),r),l.pagination.current=e,l.pagination.last=l.pages[l.pages.length-1],l.pagination.last<l.pagination.current?l.setCurrent(l.pagination.last):s()}}function s(){if(c.isRegistered(o)){var e=c.getCurrentPage(o),t=c.getItemsPerPage(o),n=c.getCollectionLength(o);l.range.lower=(e-1)*t+1,l.range.upper=Math.min(e*t,n),l.range.total=n}}function u(e){return d.test(e)&&0<e&&e<=l.pagination.last}l.pages=[],l.pagination={last:1,current:1},l.range={lower:1,upper:1,total:1},l.$watch("maxSize",function(e){e&&(r=Math.max(l.maxSize,5),a())}),l.$watch(function(){if(c.isRegistered(o))return(c.getCollectionLength(o)+1)*c.getItemsPerPage(o)},function(e){0<e&&a()}),l.$watch(function(){if(c.isRegistered(o))return c.getItemsPerPage(o)},function(e,t){e!=t&&void 0!==t&&i(l.pagination.current)}),l.$watch(function(){if(c.isRegistered(o))return c.getCurrentPage(o)},function(e,t){e!=t&&i(e)}),l.setCurrent=function(e){c.isRegistered(o)&&u(e)&&(e=parseInt(e,10),c.setCurrentPage(o,e))},l.tracker=function(e,t){return e+"_"+t}}},t=n.getString();void 0!==t?e.template=t:e.templateUrl=function(e,t){return t.templateUrl||n.getPath()};return e;function p(e,t,n,l){var o,r=[],i=Math.ceil(t/n),a=Math.ceil(l/2);o=e<=a?"start":i-a<e?"end":"middle";for(var s=l<i,u=1;u<=i&&u<=l;){var c=m(u,e,l,i);s&&(2===u&&("middle"===o||"end"===o)||u===l-1&&("middle"===o||"start"===o))?r.push("..."):r.push(c),u++}return r}function m(e,t,n,l){var o=Math.ceil(n/2);return e===n?l:1===e?e:n<l?l-o<t?l-n+e:o<t?t-o+e:e:e}}]).filter("itemsPerPage",["paginationService",function(i){return function(t,e,n){if(void 0===n&&(n=f),!i.isRegistered(n))throw"pagination directive: the itemsPerPage id argument (id: "+n+") does not match a registered pagination-id.";var l,o;if(angular.isObject(t)){if(e=parseInt(e)||9999999999,l=(o=i.isAsyncMode(n)?0:(i.getCurrentPage(n)-1)*e)+e,i.setItemsPerPage(n,e),t instanceof Array)return t.slice(o,l);var r={};return angular.forEach(function(e){{if(Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}}(t).slice(o,l),function(e){r[e]=t[e]}),r}return t}}]).service("paginationService",function(){var t,l={};this.registerInstance=function(e){void 0===l[e]&&(l[e]={asyncMode:!1},t=e)},this.deregisterInstance=function(e){delete l[e]},this.isRegistered=function(e){return void 0!==l[e]},this.getLastInstanceId=function(){return t},this.setCurrentPageParser=function(e,t,n){l[e].currentPageParser=t,l[e].context=n},this.setCurrentPage=function(e,t){l[e].currentPageParser.assign(l[e].context,t)},this.getCurrentPage=function(e){var t=l[e].currentPageParser;return t?t(l[e].context):1},this.setItemsPerPage=function(e,t){l[e].itemsPerPage=t},this.getItemsPerPage=function(e){return l[e].itemsPerPage},this.setCollectionLength=function(e,t){l[e].collectionLength=t},this.getCollectionLength=function(e){return l[e].collectionLength},this.setAsyncModeTrue=function(e){l[e].asyncMode=!0},this.setAsyncModeFalse=function(e){l[e].asyncMode=!1},this.isAsyncMode=function(e){return l[e].asyncMode}}).provider("paginationTemplate",function(){var t,n="angularUtils.directives.dirPagination.template";this.setPath=function(e){n=e},this.setString=function(e){t=e},this.$get=function(){return{getPath:function(){return n},getString:function(){return t}}}}).run(["$templateCache",function(e){e.put("angularUtils.directives.dirPagination.template",'<ul class="pagination" ng-if="1 < pages.length || !autoHide"><li ng-if="boundaryLinks" ng-class="{ disabled : pagination.current == 1 }"><a href="" ng-click="setCurrent(1)">&laquo;</a></li><li ng-if="directionLinks" ng-class="{ disabled : pagination.current == 1 }"><a href="" ng-click="setCurrent(pagination.current - 1)">&lsaquo;</a></li><li ng-repeat="pageNumber in pages track by tracker(pageNumber, $index)" ng-class="{ active : pagination.current == pageNumber, disabled : pageNumber == \'...\' || ( ! autoHide && pages.length === 1 ) }"><a href="" ng-click="setCurrent(pageNumber)">{{ pageNumber }}</a></li><li ng-if="directionLinks" ng-class="{ disabled : pagination.current == pagination.last }"><a href="" ng-click="setCurrent(pagination.current + 1)">&rsaquo;</a></li><li ng-if="boundaryLinks"  ng-class="{ disabled : pagination.current == pagination.last }"><a href="" ng-click="setCurrent(pagination.last)">&raquo;</a></li></ul>')}])}(),function(){try{this.supportActiveX="ActiveXObject"in window,window.ActiveXObject||this.supportActiveX?nameCtrl=new ActiveXObject("Name.NameCtrl"):nameCtrl=CreateNPApiOnWindowsPlugin("application/x-sharepoint-uc"),attachLyncPresenceChangeEvent()}catch(e){}}(),function(){"use strict";angular.module("myApp",["ui.router","ngAnimate","ngSanitize","ngMessages","LocalStorageModule","angularUtils.directives.dirPagination","tgComponentsAutocomplete","mmComponentsAutocomplete","astigUtilities","base64","720kb.datepicker","textAngular","RecursionHelper","dndLists","naif.base64","angular-jwt","angular-jwt.jwt"])}(),function(){"use strict";angular.module("myApp").config(["$logProvider","$httpProvider","$compileProvider","localStorageServiceProvider",function(e,t,n,l){e.debugEnabled(!0),angular.lowercase=angular.$$lowercase,t.interceptors.push("isLoadingCheckerInterceptor"),t.interceptors.push("serverErrorInterceptor"),t.interceptors.push("loggedInAndViewAsInterceptor"),t.interceptors.push("RequestInterceptor"),t.interceptors.push("versionrequestInterceptor"),l.setPrefix("WSP.AuthorityMatrix"),l.setStorageType("sessionStorage"),n.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|sip):/),t.defaults.headers.get||(t.defaults.headers.get={}),t.defaults.headers.get["If-Modified-Since"]="Fri, 01 Jan 2010 00:00:00 GMT",t.defaults.headers.get["Cache-Control"]="no-cache",t.defaults.headers.get.Pragma="no-cache",t.defaults.headers.common["Access-Control-Allow-Origin"]="*",t.defaults.headers.common["Access-Control-Allow-Methods"]="GET, POST",t.defaults.headers.common.Authorization="Bearer "+localStorage.token}])}(),function(){"use strict";angular.module("myApp").config(["$stateProvider","$urlRouterProvider","$locationProvider","$urlMatcherFactoryProvider","$injector",function(e,t,n,l,o){l.caseInsensitive(!0),l.strictMode(!1),t.otherwise(function(e,t){if(!(0<window.location.href.indexOf("download")||0<window.location.href.indexOf("OpenFile")))return"/approvalitems/list"}),e.state({name:"am",url:"/",templateUrl:"app/views/main.html",controller:"MainController as vm",abstract:!0,data:{requireLogin:!0}}).state({name:"redirect",url:"/redirect/{base64string}",templateUrl:"app/views/redirect/index.html",controller:"RedirectController as vm",data:{}}).state({name:"unauthorized",url:"/unauthorized",templateUrl:"app/views/authenticate/unauthorized.html",controller:"UnauthorizedController as vm",data:{}}).state({name:"reportredirect",url:"/reportredirect/{requestid}/{requestType}",templateUrl:"app/views/redirect/index.html",controller:"ReportRedirectController as vm",data:{}}).state({name:"delegationredirect",url:"/delegationredirect",templateUrl:"app/views/redirect/index.html",controller:"DelegationsRedirectController as vm",data:{}}).state({name:"am.home",url:"home",controller:"HomeController as vm",templateUrl:"app/views/home/index.html",data:{pageName:"Home",breadcrumbList:[{name:"Home",className:"",route:""}]}}).state({name:"wizard",url:"/wizard/{opportunitynumber}",templateUrl:"app/views/redirect/index.html",controller:"WizardMainController as vm",data:{}}).state({name:"am.wiz",url:"wizard/",templateUrl:"app/views/wizard/index.html",abstract:!0}).state({name:"am.test",url:"test",controller:"TestController as vm",templateUrl:"app/views/test/index.html",data:{pageName:"Test",breadcrumbList:[{name:"Test",className:"",route:""}]}}).state({name:"am.admin",url:"admin/",templateUrl:"app/views/admin/index.html",abstract:!0,data:{routeAccess:["CRUD","FULL_ACCESS"]}}).state({name:"am.approvalitems",url:"approvalitems/",templateUrl:"app/views/approvalitems/index.html",abstract:!0}).state({name:"am.delegations",url:"delegations/",abstract:!0,data:{pageName:"Delegations",breadcrumbList:[{name:"Delegations",className:"",route:""}]}}).state({name:"am.reports",url:"reports/",templateUrl:"app/views/reports/index.html",controller:"ReportsController as vm",data:{pageName:"Reports",breadcrumbList:[{name:"Reports",className:"",route:""}]}}).state({name:"am.howto",url:"howto/",templateUrl:"app/views/howto/index.html",data:{pageName:"How To & Training Videos",breadcrumbList:[{name:"How To Videos",className:"",route:""}]}}).state({name:"downloadfile",url:"/downloadfile/{documentId}",templateUrl:"app/views/authenticate/download.html",controller:"DownloadDocumentController as vm",data:{}}).state({name:"filedownloaded",url:"/filedownloaded",templateUrl:"app/views/authenticate/download.html",data:{}}).state({name:"am.requests",url:"requests/",templateUrl:"app/views/requests/index.html",abstract:!0})}])}(),function(){"use strict";angular.module("myApp").run(["$rootScope",function(e){e.$watch("isLoading",function(){e.isLoading?$("#overlayloader").show():$("#overlayloader").hide()})}])}(),function(){"use strict";angular.module("myApp").run(["$rootScope",function(e){e.angular=angular,e.number=Number}])}(),function(){"use strict";angular.module("myApp").run(["$rootScope","$state","$transitions","localStorageService","$base64","SessionName","astigUtilityService","sweetDialogAlertService","$timeout","AuthenticationService","jwtHelper",function(e,t,n,l,o,r,i,a,s,u,c){n.onStart({},function(e){var t=l.get(r.loggedInViewAs);if(null!==t&&(t=JSON.parse(o.decode(t)),void 0!==e.$to().data.routeAccess&&!i.ifArrayIsInList(e.$to().data.routeAccess,t.AccessList)))return a.alertError("Unauthorized Access","You are not allowed access to this page","none"),!1}),n.onSuccess({},function(e){if(""!==e.$from().name){var t={name:e.$from().name,params:e.$from().params};l.set(r.prevState,JSON.stringify(t))}document.body.scrollTop=document.documentElement.scrollTop=0})}])}(),function(){"use strict";function e(t,n,l,o,r,e,i){return{request:function(e){if(!e.url.endsWith(".html")){var t=l.get(o.token);t?e.headers[r.Authorization]=t.token:n.path("/authenticating")}return e},responseError:function(e){401===e.status&&(l.get(o.token)&&l.remove(o.token),n.path("/authenticating"));return t.reject(e)}}}angular.module("myApp").factory("authorizationInterceptor",e),e.$inject=["$q","$location","localStorageService","SessionName","CustomHeader","$rootScope","$injector"]}(),function(){"use strict";function e(t,e,n,l){var o=0,r=0;function i(){e.isLoading=r<o}function a(e){if(-1<e.indexOf("noloading=true"))return!1;for(var t=0;t<l.length;t++)if(-1<e.toLowerCase().indexOf(l[t].toLowerCase()))return!1;return!0}return{request:function(e){return a(e.url)&&(o++,i()),e},requestError:function(e){return a(e.url)&&(r++,i()),n.error("Request error:",e),t.reject(e)},response:function(e){return a(e.config.url)&&(r++,i()),e},responseError:function(e){return a(e.config.url)&&(r++,i()),n.error("Response error:",e),t.reject(e)}}}angular.module("myApp").factory("isLoadingCheckerInterceptor",e),e.$inject=["$q","$rootScope","$log","IgnoreLoadingUrls"]}(),function(){"use strict";function e(e,n,l,o,r,i){return{request:function(e){if(!e.url.endsWith(".html")){var t=n.get(l.loggedInViewAs);null!==t?(t=JSON.parse(r.decode(t)),e.headers[o.LoggedInUsername]=t.LoggedInUsername,e.headers[o.LoggedInDisplayName]=t.LoggedInDisplayName,e.headers[o.LoggedInEmail]=t.LoggedInEmail,e.headers[o.ViewAsUsername]=t.ViewAsUsername,e.headers[o.ViewAsDisplayName]=t.ViewAsDisplayName,e.headers[o.ViewAsEmail]=t.ViewAsEmail,e.headers[o.AccessList]=t.AccessList,e.headers[o.Token]=t.Token,e.headers[o.DefaultOrg]=t.DefaultOrg):(e.headers[o.Token]="Vb3fl%2fUQ6Yeqfh%2fQi8jNUA%3d%3d",i.path("/home"))}return e}}}angular.module("myApp").factory("loggedInAndViewAsInterceptor",e),e.$inject=["$q","localStorageService","SessionName","CustomHeader","$base64","$location"]}(),function(){"use strict";function e(t,e,n,l){return{response:function(e){if(204===e.status)switch(l.current.name){case"am.approvalitems.details":case"am.approvalitems.resubmit":case"am.approvalitems.viewsaveddetails":case"am.requests.details":l.go("am.approvalitems.list",{},{reload:!0});break;default:window.location.reload(!0)}return e},responseError:function(e){return 405!==e.status&&-1!==e.status||l.reload(),t.reject(e)}}}angular.module("myApp").factory("RequestInterceptor",e),e.$inject=["$q","$log","sweetDialogAlertService","$state"]}(),function(){"use strict";function e(t,n,l){return{responseError:function(e){return 500===e.status&&(n.error("Internal Server Error: Http Status Code 500"),l.alertError("Oops..","Something went wrong, try refreshing the page. If the error persist, please contact support: servicedesk@help.wsp.com","none")),t.reject(e)}}}angular.module("myApp").factory("serverErrorInterceptor",e),e.$inject=["$q","$log","sweetDialogAlertService"]}(),function(){"use strict";function e(t){return{request:function(e){return void 0===t.get(e.url)&&(e.url.includes("graph.microsoft.com")||(e.url.includes("?")?e.url=e.url+"&appVersion="+appVersion:e.url=e.url+"?appVersion="+appVersion)),e}}}angular.module("myApp").factory("versionrequestInterceptor",e),e.$inject=["$templateCache"]}(),function(){"use strict";angular.module("myApp").constant("BghBodDefaultApproverObject",{MainApproverUsername:"boardofdirectors",MainApproverDisplayName:"Board of Directors",MainApproverEmail:"bod@louisberger.com"})}(),function(){"use strict";angular.module("myApp").constant("CostPointRoleIds",{Employee:-10001,Svp:-10037,Vp:-10038,BghBoardOfDirectors:-10011})}(),function(){"use strict";angular.module("myApp").constant("CustomHeader",{Authorization:"Authorization",Org:"OrgID",ActualUsername:"ActualUsername",LoggedInUsername:"LoggedInUsername",LoggedInDisplayName:"LoggedInDisplayName",LoggedInEmail:"LoggedInEmail",ViewAsUsername:"ViewAsUsername",ViewAsDisplayName:"ViewAsDisplayName",ViewAsEmail:"ViewAsEmail",AccessList:"AccessList",Token:"Token",DefaultOrg:"DefaultOrg"})}(),function(){"use strict";angular.module("myApp").constant("DefaultFormControlProperties",{FormCreation:{Value:null,Description:{},ControlID:null,ControlType:null,InputType:null,Label:{},Property:{HasSource:!1,IsRequired:!1,Max:250,Min:0,SourceType:null,CurrentType:null},Attribute:{Directive:null,SourceType:null,SourceUrl:null},Dependency:{ControlID:null,ControlValues:[],Actions:null}}})}(),function(){"use strict";angular.module("myApp").constant("DelegationValidation",{InvalidApprover:"InvalidApprover",InvalidDelegationDate:"InvalidDelegationDate",InvalidRole:"InvalidRole",InvalidFurtherDate:"InvalidFurtherDate",InvalidFilters:"InvalidFilters",InvaliDelegationDateOrFilters:"InvaliDelegationDateOrFilters"})}(),function(){"use strict";angular.module("myApp").constant("DocumentValidation",{MaxSize:25e6,ValidFileExtensions:["doc","docx","xlsx","xlsm","xls","msg","zip","pdf","png","jpeg","jpg","jfif","tiff","tif","gif","bmp","dib","ppt","pptx","csv"]})}(),function(){"use strict";angular.module("myApp").constant("FormControls",{Dropdown:"Dropdown",Textbox:"Textbox",Checkbox:"Checkbox",Radiobutton:"Radiobutton",Textarea:"Textarea",Table:"Table",InactiveProjectTemplate:"InactiveProjectTemplate",BankAccountTemplate:"BankAccountTemplate",OrganizationTemplate:"OrganizationTemplate",OpportunityTemplate:"OpportunityTemplate",CashAccountTemplate:"CashAccountTemplate",ClientTemplate:"ClientTemplate",CompanyTemplate:"CompanyTemplate",AgreementTemplate:"AgreementTemplate",AgreementClosedTemplate:"AgreementClosedTemplate",ProjectAllActiveTemplate:"ProjectAllActiveTemplate",ProjectDirectClosedTemplate:"ProjectDirectClosedTemplate",ClientActiveCRMTemplate:"ClientActiveCRMTemplate",AgreementProjectTemplate:"AgreementProjectTemplate",OverheadProjectTemplate:"OverheadProjectTemplate",AgreementOpportunityProjectTemplate:"AgreementOpportunityProjectTemplate",DivisionTemplate:"DivisionTemplate",PursuitProjectTemplate:"PursuitProjectTemplate",InactiveOrgTemplate:"InactiveOrgTemplate",MasterContractTemplate:"MasterContractTemplate",ProjectOpportunityTemplate:"ProjectOpportunityTemplate",EmployeeTemplate:"EmployeeTemplate",DivisionSpecificEmployeeTemplate:"DivisionSpecificEmployeeTemplate",DirProjectTemplate:"DirProjectTemplate",ParentProjectTemplate:"ParentProjectTemplate",ProjectTemplate:"ProjectTemplate",VendorTemplate:"VendorTemplate",InactiveDirectProjectTemplate:"InactiveDirectProjectTemplate",CostCenterInactiveTemplate:"CostCenterInactiveTemplate",UltimateClientTemplate:"UltimateClientTemplate",ClientCustomerAllActiveTemplate:"ClientCustomerAllActiveTemplate",ClientCustomerERPTemplate:"ClientCustomerERPTemplate",CustomerActiveERPTemplate:"CustomerActiveERPTemplate",OpportunityInactiveTemplate:"OpportunityInactiveTemplate",LocationTemplate:"LocationTemplate",AreasTemplate:"AreasTemplate",EmployeeInactiveTemplate:"EmployeeInactiveTemplate",PursuitProjectClosedTemplate:"PursuitProjectClosedTemplate",ProjectIndirectActiveTemplate:"ProjectIndirectActiveTemplate",ProjectIndirectInactiveTemplate:"ProjectIndirectInactiveTemplate",OpportunityAgreementProjectSpecialTemplate:"OpportunityAgreementProjectSpecialTemplate",OpportunitySpecialTemplate:"OpportunitySpecialTemplate",DistrictsTemplate:"DistrictsTemplate",AgreementProjectClosedTemplate:"AgreementProjectClosedTemplate",GngFormTemplate:"GngFormTemplate",GngPreliminaryFormTemplate:"GngPreliminaryFormTemplate",OpportunityAgreementProjectFormTemplate:"OpportunityAgreementProjectFormTemplate",OpportunityFormTemplate:"OpportunityFormTemplate",GngLeadFormTemplate:"GngLeadFormTemplate",CascadingOracleHierarchyTemplate:"CascadingOracleHierarchyTemplate",WorkAtRiskFormTemplate:"WorkAtRiskFormTemplate",EaNpWithOpportunityFormTemplate:"EaNpWithOpportunityFormTemplate",EaNpWithOpportunityWarFormTemplate:"EaNpWithOpportunityWarFormTemplate",NaNpWithOpportunityFormTemplate:"NaNpWithOpportunityFormTemplate",NaNpWithOpportunityWithFundingFormTemplate:"NaNpWithOpportunityWithFundingFormTemplate",NaNpSansOpportunityFormTemplate:"NaNpSansOpportunityFormTemplate",NaNpWithFundingSansOpportunityFormTemplate:"NaNpWithFundingSansOpportunityFormTemplate",EaNpWithOpportunityWithFundingFormTemplate:"EaNpWithOpportunityWithFundingFormTemplate",EaNpSansOpportunityFormTemplate:"EaNpSansOpportunityFormTemplate",EaNpSansOpportunityWarFormTemplate:"EaNpSansOpportunityWarFormTemplate",EaNpWithFundingSansOpportunityFormTemplate:"EaNpWithFundingSansOpportunityFormTemplate",ProjectUpdateFormTemplate:"ProjectUpdateFormTemplate",WarExtensionFormTemplate:"WarExtensionFormTemplate",AgreementSpecialTemplate:"AgreementSpecialTemplate",NaNpWithOpportunityWarFormTemplate:"NaNpWithOpportunityWarFormTemplate",NaNpSansOpportunityWarFormTemplate:"NaNpSansOpportunityWarFormTemplate"})}(),function(){"use strict";angular.module("myApp").constant("FormTypes",{RequestDetails:"requestdetails",CreateRequest:"createrequest",Preview:"preview",Bergerwin:"bergerwintemplate"})}(),function(){"use strict";angular.module("myApp").constant("AgreementProjectWarFormPropertyNames",{ObjectNumber:"OBJECT_NUMBER",OpportunityNumber:"OPPORTUNITY_NUMBER",ContractClassification:"CONTRACT_CLASSIFICATION",OpportunityName:"OPPORTUNITY_NAME",AgreementNumber:"AGREEMENT_NUMBER",AgreementName:"AGREEMENT_NAME",Level1:"DIVISION_NAME",Level1Id:"DIVISION_ID",Level2:"DISTRICT_NAME",Level2Id:"DISTRICT_ID",Level3:"AREA_NAME",Level3Id:"AREA_ID",Level4:"COST_CENTER_NAME",CostCenterId:"COST_CENTER_ID",UltimateClient:"OWNER_NAME",UltimateClientEdited:"OWNER_NAME_EDITED",ProjectName:"PROJECT_NAME",ProjectNameShort:"PROJECT_NAME_SHORT",ClientEdited:"CLIENT_NAME_EDITED",Client:"CLIENT_NAME",ClientType:"CLIENT_TYPE",ClientTypeExpected:"EXPECTED_CLIENT_TYPE_EDIT",ClientTypeEdited:"CLIENT_TYPE_EDITED",CompanyName:"COMPANY_NAME",UltimateClientType:"OWNER_TYPE",UltimateClientTypeExpected:"EXPECTED_UC_TYPE_EDIT",UltimateClientTypeEdited:"OWNER_TYPE_EDITED",MarketArea:"MARKET_AREA",MarketAreaEdited:"MARKET_AREA_EDITED",PrimaryServiceType:"PRIMARY_SERVICE_TYPE",PrimaryServiceTypeEdited:"PRIMARY_SERVICE_TYPE_EDITED",MarketSector:"MARKET_SECTOR",MarketSectorEdited:"MARKET_SECTOR_EDITED",City:"CITY",ProjectDescription:"OPPORTUNITY_DESCRIPTION",CityEdited:"CITY_EDITED",State:"PROJ_STATE",StateEdited:"PROJ_STATE_EDITED",Country:"COUNTRY",CountryEdited:"COUNTRY_EDITED",ProjectManager:"PROJECT_MANAGER",ProjectManagerId:"PROJECT_MANAGER_ID",ProjectManagerEdited:"PROJECT_MANAGER_EDITED",PA:"PA",PAId:"PA_ID",PAEdited:"PA_EDITED",ProjectDirector:"PROJECT_DIRECTOR",Pic:"PIC",Dbl:"DBL",Dpa:"DPA",Rpa:"RPA",Dfl:"DFL",Rfl:"RFL",Pdm:"PDM",Dol:"DOL",Rol:"ROL",Td:"TECHNICAL_DIRECTOR",Sb:"SENIOR_BILLER",SbRef:"SENIOR_BILLER_REFERENCE",Pb:"PRIMARY_BILLER",Sdl:"SDL",Rpdl:"RPDL",DeliveryMethod:"DELIVERY_METHOD",DeliveryMethodEdited:"DELIVERY_METHOD_EDITED",Segments:"SEGMENTS",SegmentsEdited:"SEGMENTS_EDITED",ServiceType:"SERVICE_TYPE",ServiceTypeEdited:"SERVICE_TYPE_EDITED",PmLevel:"PM_LEVEL",PmLevelEdited:"PM_LEVEL_EDITED",Type:"TYPE",NameRequestingWar:"NAME_REQUESTING_WAR",Authorized:"AUTHORIZED_WAR",WrittenRequest:"WRITTEN_REQUEST",Reimbursed:"REIMBURSED",LimitCost:"LIMIT_COST",CoverPeriodReason:"COVER_PERIOD_REASON",ScopeOfWork:"SCOPE_OF_WORK",ContractExcutionDate:"CONTRACT_EXECUTION_DATE",CoverPeriod:"COVER_PERIOD",ReasonForStartingWork:"REASON_FOR_STARTING_WORK",ContractIssuesUnresolved:"CONTRACT_ISSUES_UNRESOLVED",ContractIssuesUnresolvedComments:"CONTRACT_ISSUES_UNRESOLVED_COMMENTS",ModNotSigned:"MOD_NOT_SIGNED",WorkWithSubPreviously:"WORK_WITH_SUB_PREVIOUSLY",Vendor:"VENDOR",VendorFinancialExposure:"VENDOR_FINANCIAL_EXPOSURE",FinancialExposure:"FINANCIAL_EXPOSURE",BurdenedCost:"BURDENED_COST_BUDGET_REQUEST",CostLimit:"COST_LIMIT",Lbl:"LOCAL_BUSINESS_LINE",WorkflowLbl:"WORKFLOW_LOCAL_BUSINESS_LINE",ClientContractNumber:"CLIENT_CONTRACT_NUMBER",AnticipatedGrossRevenue:"ANTICIPATED_GROSS_REVENUE",AnticipatedGrossRevenueEdit:"ANTICIPATED_GROSS_REVENUE_EDIT",AnticipatedGrossRevenueVariance:"ANTICIPATED_GROSS_REVENUE_VARIANCE",AnticipatedNetRevenue:"ANTICIPATED_NET_REVENUE",AnticipatedNetRevenueEdit:"ANTICIPATED_NET_REVENUE_EDIT",AnticipatedNetRevenueVariance:"ANTICIPATED_NET_REVENUE_VARIANCE",AnticipatedMargin:"ANTICIPATED_MARGIN",AnticipatedMarginEdit:"ANTICIPATED_MARGIN_EDIT",AnticipatedMarginVariance:"ANTICIPATED_MARGIN_VARIANCE",AnticipatedMarginPercentOfGross:"ANTICIPATED_MARGIN_PERCENT_GROSS",AnticipatedMarginPercentOfGrossVariance:"ANTICIPATED_MARGIN_PERCENT_GROSS_VARIANCE",AnticipatedMarginPercentOfNet:"ANTICIPATED_MARGIN_PERCENT_NET",AnticipatedMarginPercentOfNetVariance:"ANTICIPATED_MARGIN_PERCENT_NET_VARIANCE",AgreementFundingInOracle:"AGREEMENT_FUNDING_IN_ORACLE",TotalAgreementFunding:"TOTAL_AGREEMENT_FUNDING",Funding:"FUNDING",Lookup:"LOOKUP",LookupValue:"LOOKUP_VALUE",PreviouslyApprovedWar:"PREVIOUSLY_APPROVED_WAR",Wartype:"WAR_TYPE",AdditionalWarBudget:"ADDITIONAL_WAR_BUDGET",RequestToWarUntil:"REQUEST_TO_WAR_UNTIL",ContractAnticipatedDate:"CONTRACT_ANTICIPATED_DATE",TotalWarBudget:"TOTAL_WAR_BUDGET",Labor:"LABOR_OH",Subcontractor:"SUBCONTRACTOR",DirectExpense:"DIRECT_EXPENSE",TotalFunding:"TOTAL_FUNDING",NetFunding:"NET_FUNDING",ManagementReserve:"MANAGEMENT_RESERVE",TargetMarginDollar:"TARGET_MARGIN_DOLLAR",TargetMarginPercentOfTotal:"TARGET_MARGIN_PERCENT_TOTAL",TargetMarginPercentOfNet:"TARGET_MARGIN_PERCENT_NET",TargetMarginMultiplier:"TARGET_MARGIN_MULTIPLIER",Icr:"INSURANCE_CERTIFICATE_REQUIRED",Ps2Link:"PS2_LINK",IsPs2Link:"IS_PS2_LINK",IsPs2LinkCreated:"IS_PS2_LINK_CREATED",Pndl:"PROJECT_NETWORK_DRIVE_LINK",IsPndl:"IS_PROJECT_NETWORK_DRIVE_LINK",IsPndlCreated:"IS_PROJECT_NETWORK_DRIVE_LINK_CREATED",Pstfl:"PST_FOLDER_LINK",IsPstfl:"IS_PST_FOLDER_LINK",IsPstflCreated:"IS_PST_FOLDER_LINK_CREATED",EngageGBS:"ENGAGE_GBS",GBSPASupport:"GBS_PA_SUPPORT",GBSPARegionalLead:"GBS_PA_REGIONAL_LEAD",GBSPAUSLead:"GBS_PA_US_LEAD",Action:"ACTION",NonReimbursableCost:"NON_REIMBURSABLE_COST",Oh:"OH"})}(),function(){"use strict";angular.module("myApp").constant("FormAutoPopulatedPropertyNames",{OpportunityNumber:"OPPORTUNITY_NUMBER",OpportunityStatus:"OPPORTUNITY_STATUS",OpportunityName:"OPPORTUNITY_NAME",Client:"CLIENT_NAME",UltimateClient:"OWNER_NAME",WspRole:"OUR_ROLE",AnticipatedDecisionDate:"EXPECTED_DECISION_DATE",AnticipatedStartDate:"EST_START_DATE",CostCenterId:"COST_CENTER_ID",RfpIssueDate:"RFQ_RECEIVED_DATE",ClientType:"CLIENT_TYPE",UltimateClientType:"UC_TYPE",ProjectDuration:"DURATION_MONTHS",RfpSubmittalDate:"RFP_SUBMITTAL_LATEST_DISPATCH_DATE",DevBank:"ASSOCIATED_WITH_INTERAMERICAN_BANK",TaskOrderPanel:"TASK_ORDER_PANEL",SoleSource:"SOLE_SOURCE",Type:"TYPE",Level1:"DIVISION_NAME",Level2:"DISTRICT_NAME",Level3:"AREA_NAME",Level4:"COST_CENTER_NAME",Company:"COMPANY_NUMBER_NAME",CompanyNumber:"COMPANY_NUMBER",CompanyName:"COMPANY_NAME",EstGrossEcvRaw:"EST_GROSS_ECV",EstGrossEcv:"EST_GROSS_ECV_FORMAT",EstNetEcvRaw:"EST_NET_ECV",EstNetEcv:"EST_NET_ECV_FORMAT",EstSubEcvRaw:"EST_SUB_ECV",EstSubEcv:"EST_SUB_ECV_FORMAT",EstDirectExpensesRaw:"EST_DIRECT_EXPENSES",EstDirectExpenses:"EST_DIRECT_EXPENSES_FORMAT",JvEcvRaw:"EST_JV_ECV",JvEcv:"EST_JV_ECV_FORMAT",Ppp:"PROJECT_PROCEEDING_PROBABILITY_PERCENT",Wp:"WIN_PROBABILITY_PERCENT",TaskNetEcvRaw:"TASK_NET_ECV",TaskNetEcv:"TASK_NET_ECV_FORMAT",TaskGrossEcv:"TASK_GROSS_ECV_FORMAT",TaskGrossEcvRaw:"TASK_GROSS_ECV",CurrentFy:"CURRENT_FY_PERCENT",SubsequentFy:"SUBSEQUENT_FY_PERCENT",NextFy:"NEXT_FY_PERCENT",DeliveryMethod:"DELIVERY_METHOD",City:"CITY",ProjState:"PROJ_STATE",Country:"COUNTRY",MarketArea:"MARKET_AREA",PrimaryServiceType:"PRIMARY_SERVICE_TYPE",ServiceType:"SERVICE_TYPE",MarketSector:"MARKET_SECTOR",Segment:"SEGMENTS",ProjectDescription:"OPPORTUNITY_DESCRIPTION",Pa:"PA",PaEmail:"PA_EMAIL",PaEdited:"PA_EDITED",ProjectManager:"PROJECT_MANAGER",ProjectManagerEmail:"PROJECT_MANAGER_EMAIL",ProjectManagerEdited:"PROJECT_MANAGER_EDITED",PursuitManager:"PURSUIT_MANAGER",PursuitManagerEmail:"PURSUIT_MANAGER_EMAIL",PursuitManagerEdited:"PURSUIT_MANAGER_EDITED",PmLevel:"PM_LEVEL"})}(),function(){"use strict";angular.module("myApp").constant("FormMessages",{fgngResponse1:"e.g. general project scope, schedule and budget; relationship to any recently completed or anticipated future WSP work.",fgngResponse2:"This section is for documentation of the consultation required in writing by the DOA.",fgngResponse3:"In this section the pursuit team and collaboration partners, i.e. CE lead, NBL/DBL/LBLs, and marketing leader are providing feedback on the following: \n•   current status of client relationship relative to current/past performance on project(s), payment history, legal actions \n•   project’s relationship to/impact on downstream work \n•   anticipated risks related to project delivery and contract/financial terms, e.g. insurance requirements, indemnity provisions, performance bond requirements or terms that impact gross margin or earnings ratio \n•   any surprises in the RFx that we were not anticipating from a contract, scope/budget, or qualifications requirement standpoint?\n•   identification of additional relationships that will add value to the development of the pursuit/proposal\n•   opportunity’s ability to influence WSP’s position for this service in market, existing relationship with client, scope/delivery risks related to staff capability/capacity.",fgngResponse4:"Please indicate if, given timing of RFP and anticipated color review and proposal deadlines, there are any concerns about capacity and resources to deliver the win.",fgngResponse5:"Summarize WSP’s pre-positioning activities with the selection panel, influencers, stakeholders, etc.\nDiscuss specific steps taken to validate our approach, staffing plan, and teaming partners, etc. with the client prior to RFP.\nIdentify the PM and discuss the actions taken to position and pre-qualify our proposed PM with the selection panel.\nDiscuss our strategic teaming partners and small business approach, as applicable.\nDiscuss how the pursuit team leveraged regional and national resources during positioning activities.",fgngResponse6:"How many competitors are we anticipating? How many firms will be selected (if more than one)? Where does WSP rank in the mix?\nList top 3-4 differentiators of the WSP team (NOTE: Differentiators are more than just staff and qualifications. Identify what is unique about our work plan and approach):\n\n1.\tX\n2.\tX\n3.\tX\n4.\tX",fgngResponse7:"1.\tX\n2.\tX\n3.\tX\n4.\tX\n5.\tX",fgngResponsePopOver1:"e.g. general project scope, schedule and budget; relationship to any recently completed or anticipated future WSP work.",fgngResponsePopOver2:"This section is for documentation of the consultation required in writing by the DOA.",fgngResponsePopOver3:"<div><span>In this section the pursuit team and collaboration partners, i.e. CE lead, NBL/DBL/LBLs, and marketing leader are providing feedback on the following:</span></br><ul><li>current status of client relationship relative to current/past performance on project(s), payment history, legal actions</li><li>project’s relationship to/impact on downstream work</li>anticipated risks related to project delivery and contract/financial terms, e.g. insurance requirements, indemnity provisions, performance bond requirements or terms that impact gross margin or earnings ratio</li><li>any surprises in the RFx that we were not anticipating from a contract, scope/budget, or qualifications requirement standpoint?</li><li>identification of additional relationships that will add value to the development of the pursuit/proposal</li><li>opportunity’s ability to influence WSP’s position for this service in market, existing relationship with client, scope/delivery risks related to staff capability/capacity.</li></ul></div>",fgngResponsePopOver4:"Please indicate if, given timing of RFP and anticipated color review and proposal deadlines, there are any concerns about capacity and resources to deliver the win.",fgngResponsePopOver5:"Summarize WSP’s pre-positioning activities with the selection panel, influencers, stakeholders, etc.</br>Discuss specific steps taken to validate our approach, staffing plan, and teaming partners, etc. with the client prior to RFP.</br>Identify the PM and discuss the actions taken to position and pre-qualify our proposed PM with the selection panel.</br>Discuss our strategic teaming partners and small business approach, as applicable.</br>Discuss how the pursuit team leveraged regional and national resources during positioning activities.",fgngResponsePopOver6:"How many competitors are we anticipating? How many firms will be selected (if more than one)? Where does WSP rank in the mix?</br>List top 3-4 differentiators of the WSP team (NOTE: Differentiators are more than just staff and qualifications. Identify what is unique about our work plan and approach):</br></br>1.\tX</br>2.\tX</br>3.\tX</br>4.\tX",fgngResponsePopOver7:"1.\tX</br>2.\tX</br>3.\tX</br>4.\tX</br>5.\tX",fySpreadPopOver:"When will the work be performed?<br/> All three FY% fields must cumulatively total 100%.",pgngResponse3:"In this section the pursuit team and collaboration partners, i.e. CE lead, NBL/DBL/LBLs, and marketing leader are providing feedback on the following:\n•\talignment of this opportunity to national/regional/district strategic plans\n•\tcurrent status of client relationship relative to current/past performance on project(s), payment history, legal actions\n•\tproject’s relationship to/impact on downstream work\n•\tanticipated risks related to project delivery and contract/financial terms, e.g. insurance requirements, indemnity provisions, performance bond requirements or terms that impact gross margin or earnings ratio\n•\tidentification of additional relationships that will add value to the development of the pursuit/proposal\n•\topportunity’s ability to influence WSP’s position for this service in market, existing relationship with client, scope/delivery risks related to staff capability/capacity.",pgngResponsePopOver3:"<div><span>In this section the pursuit team and collaboration partners, i.e. CE lead, NBL/DBL/LBLs, and marketing leader are providing feedback on the following:</span><ul><li>alignment of this opportunity to national/regional/district strategic plans</li><li>current status of client relationship relative to current/past performance on project(s), payment history, legal actions</li><li>project’s relationship to/impact on downstream work</li><li>anticipated risks related to project delivery and contract/financial terms, e.g. insurance requirements, indemnity provisions, performance bond requirements or terms that impact gross margin or earnings ratio</li><li>identification of additional relationships that will add value to the development of the pursuit/proposal</li><li>opportunity’s ability to influence WSP’s position for this service in market, existing relationship with client, scope/delivery risks related to staff capability/capacity.</li></ul></div>",pgngResponse4:"Depending on size and complexity sometimes the pursuit and project manager are one and the same. Please detail the Pursuit Manager’s capacity and key elements of their positioning plan.  Examples include: “Identify a strategic teaming partner to fill XXX critical gap in WSP’s team” or “Identify a national PM with industry leadership in XXX.\n\nIf Project Manager is not yet known, list potential PM candidates that we plan to vet by client decision makers and evaluate against WSP’s competition.\n\nIdentify gaps in team or resources that need to be addressed to pull together a competitive bid.",pgngResponse5:"While a full SWOT analysis is not expected at the PGNG stage, please identify known competitors, their relationships and performance history with the client, and their PM candidates, where known.  At this stage it is very important to identify potential strategic partners that should be secured early.",pgngResponse6:"1.\n2.\n3.\n4.\n5.",pgngResponsePopOver6:"1.<br/>2.<br/>3.<br/>4.<br/>5.",validationMessage:'<div align="left" ><span>In order to submit Go/No-Go form:</span><ul><li>all required fields in the form must be satisfied</li><li>all Requested Edits to CRM Data must = Existing CRM Data</li></ul><br/><span>To move forward, either:</span><ul><li>finish filling out the form</li><li>update the source opportunity record in CRM, and then click Refresh CRM Data.  (Data refreshes in IAS every 3 hours during the day during US working hours.)</li><li>click Save & Finish Later and then click Assign to Others, being sure to assign someone who has CRM access or who needs to finish filling out the form on your behalf</li></ul><br/><span>Guidance for updating data in the source system:<ul><li>If the necessary data is tied to an Opportunity, either update the Opportunity in CRM or contact your Regional CRM Data Coordinator.</li><li>If the necessary data is tied to an Agreement or Project, either update the data in the ERP or contact your Project Accountant.</li><li>For all other data, please contact <a href="mailto: IAS-Admin@wsp.com">IAS-Admin@wsp.com</a>.</ul></div>',jvEcvPopeOver:"<span>If JV, Gross reflects WSP’s share of JV and JV ECV reflects the total anticipated ECV of the JV partnership</span>",statusHoverText:"<span><b>Lead:</b> No firm project data.</span><br/><span><b>Identified:</b> Project is being tracked and has had Pre-GNG approval.</span><br/><span><b>In-prep:</b><span> Proposal underway.</span><br/><span><b>Pending:</b> Awaiting shortlist or final notification.</span><br/><span><b>Shortlisted:</b> Interview prep/Interview.</span><br/><span><b>Task Pipeline:</b> This is a new task under an existing task order panel.</span><br/><span><b>Closed/Won:</b> Client has given us notification of selection.</span>",fundedByHoverText:"<span>Select Yes if the project involves funds from any International Financial Institution (IFI), such as the World Bank or Inter-American Development Bank. A complete list of IFIs is online <i>(Click on field hyperlink)</i></span>",clientHoverText:"<span>The Client is who we will contract with; if we are a Sub this is different than the Owner. If you cannot locate your desired Client in the look up, please select “<b>2021 New Organization</b>” and enter the name of the new Client, Address, and Website in the Comments box below.</span>",ownerHoverText:"<span>If you cannot locate your desired Owner in the look up, please select <b>“2021 New Organization”</b> and enter the name of the new Owner, Address, and Website in the Comments box below.</span>",soleSourceHoverText:"<span>No direct competition, client will just give us the work</span>",confidentialProjectHoverText:"<span>Does this project need to remain confidential?</span>",solicitationNumberHoverText:"<span>If available, otherwise leave blank</span>",contractClassificationHoverText:'<span>Master Contracts are contracts with "umbrella" terms and conditions that govern Task Orders.  Examples include IQCs, IDIQs, MATOCs, MSAs, and "On-Call" contracts.  In our ERP, all top level agreements are either Master Contracts or Stand Alone projects.</span>',masterContractAgreementHoverText:"<span>Lookup associated to existing agreements and opportunities</span>",rcrRequiredHoverText:"<span>Select Yes if any of the high risk criteria are applicable: <i>(Click on field hyperlink)<i></span>",rfpIssueDateHoverText:"<span>When we will receive the RFP/RFQ (project will be advertised), or date of sole source or non-competitive TO request.  This can be your best estimate.</span>",optionalIfKnonHoverText:"<span>Optional - if known</span>",expectedDecisionDateHoverText:"<span>When will the client notify us of selection?</span><br/><span>Depending on client, avg 3-6 months from RFP issue</span>",anticipatedProjectStartDateHoverText:"<span>When we will received authorization to begin work?</span><br/><span>Typically 1-2 months from decision date.</span>",seeGlossaryHoverText:"<span>See Glossary for Instructions</span>",estGrossEcvHoverText:"<span>Est Gross ECV = Est Net ECV + Est Direct Expenses + Est Sub ECV</span>",estNetEcvHoverText:"<span>Total expected contract value (ECV) for WSP only</span>",estDirectExpensesHoverText:"<span>Expenses billable to the project (print, travel)</span>",estSubEcvHoverText:"<span>Value of contract given to subconsultants</span>",estJVEcvHoverText:"<span>Only fill in if JV - total contract value to the JV</span>",winProbHoverText:"<span>Probability of the Win (Get):<br/><b>10%</b> = very low, little known, must be far out;<br/><b>50%</b> = Well positioned;<br/><b>70%</b> = Sole-Source</span>",pppHoverText:"<span>Probability of Proceeding (Go): Anything beyond LEAD is 70-100%</span>",goGetHoverText:"<span>Go/Get % = Win Probability * Project Proceeding Probability</span>",etncvHoverText:"<span>Total and Net Construction Value of the overall project</span>",projDescriptionHoverText:"<span>Provide one or two sentences about the project.<br/>Maximum 255 characters.</span>",projDescription240HoverText:"<span>Provide one or two sentences about the project.<br/>Maximum 240 characters.</span>",contractUpset:"If no upset, then use Gross ECV. This is also known as the Contract Ceiling or Total Contract Capacity.",crmRefresh:'<table class="table table-bordered table-request-pursuit"><thead><tr><th class="text-center" width="25%" style="vertical-align:middle">Refresh Cycle Begins</th><th class="text-center" width="25%" style="vertical-align:middle">Data Available in IAS</th><th class="text-center" width="25%" style="vertical-align:middle">Opportunity and Client Data</th><th class="text-center" width="25%" style="vertical-align:middle">All Data</th></tr></thead><tbody><tr><td class="text-center">10 AM EST</td><td class="text-center">10:55 AM EST</td><td class="text-center" style="background-color:#95C730">Full refresh</td><td class="text-center" style="background-color:#EAEAEA">-</td></tr><tr><td class="text-center">1 PM EST</td><td class="text-center">2:40 PM  EST</td><td class="text-center" colspan="2" style="background-color:#95C730">Full refresh</td></tr><tr><td class="text-center">4 PM EST</td><td class="text-center">4:55 PM EST</td><td class="text-center" style="background-color:#95C730">Full refresh</td><td class="text-center" style="background-color:#EAEAEA">-</td></tr><tr><td class="text-center">7 PM EST</td><td class="text-center">7:55 PM EST</td><td class="text-center" style="background-color:#95C730">Full refresh</td><td class="text-center" style="background-color:#EAEAEA">-</td></tr><tr><td class="text-center">1 AM EST</td><td class="text-center">2:40 AM  EST</td><td class="text-center" colspan="2" style="background-color:#95C730">Full refresh</td></tr></tbody></table>',opportunityNameMessage:"<span>Owner name acronym followed by a succinct description of services. Add enough detail to identify the project easily. If a task-based agreement, add year(s) of the project. <br/><br/>e.g, INDOT I-69 Section 5 Contract 5 Design-Build; USACE 2020-2021 On-Call Structural Engineering Svs; SFMC Cancer Center Commissioning <br/><br/>Maximum 240 characters.</span>",projectNameMessage:"<span>Owner name acronym followed by a succinct description of services. Add enough detail to identify the project easily. If a task-based agreement, add year(s) of the project. <br/><br/>e.g, INDOT I-69 Section 5 Contract 5 Design-Build; USACE 2020-2021 On-Call Structural Engineering Svs; SFMC Cancer Center Commissioning</span>",requestToWarUntil:"Approved WAR Requests Expire After 90 Days.",managementReserveMessage:"If no Management Reserve is necessary, stop completing this form, back out of this approval item, and select an appropriate alternative approval item that does not include Management Reserve.",netFundingFormula:"= (Total Funding) – (Subcontractor Cost) – (Direct Expenses/Other Direct Costs) – (Non-Reimbursable Costs)",targetMarginDollarMRFormula:"= (Total Funding) – (WSP Raw Direct Labor) – (OH) - (Subcontractor Cost) – (Direct Expenses/Other Direct Costs) – (Non-Reimbursable Costs) – (Management Reserve)",targetMarginDollarFormula:"= (Total Funding) – (WSP Raw Direct Labor) – (OH) - (Subcontractor Cost) – (Direct Expenses/Other Direct Costs) – (Non-Reimbursable Costs)",targetMultiplierFormula:" = Net Funding ÷ WSP Raw Direct Labor",targetMarginPercentOfTotalFormula:" = ((Target Margin ($)) ÷ (Total Funding)) X 100",targetMarginPercentOfNetFormula:" = ((Target Margin ($)) ÷ (Net Funding)) X 100",anticipatedMarginPercentOfNetFormula:" = ((Anticipated Margin ($)) ÷ (Anticipated Net Revenue)) X 100",anticipatedMarginPercentOfTotalFormula:" = ((Anticipated Margin ($)) ÷ (Anticipated Gross Funding)) X 100",varianceFormula:" = Funding - Final Pricing",totalFunding:"Total Funding is the amount of the contract that has been funded by the client. Typically, this is the same as the Contract Amount, but sometimes clients don't fund the entire contract immediately.",warquestion6:"Having suppliers work at risk should be avoided. Considerations will be made, on a case by case basis, for projects that require suppliers to work at risk.<ul><li>In such cases, we will issue a Limited Notice to Proceed with Early Work (this is an existing legal template linked under References)</li><li>Any suppliers working in the field are required to provide a safety plan before going in the field</li></ul>",warquestion3:"The PM will ensure that the expected contract will cover the period in which the work at risk is performed, otherwise costs incurred prior to contract or modification execution could be unallowable.",pswarProjectInformation:"Most of the information in this section auto-populates from CRM. But, if no opportunity exists for the project being created, then this data will help the CRM Data Coordinator retroactively create an opportunity after the project is setup in Oracle ERP. The Project Manager and Project Accountant should work with CRM Data Coordinator if there are any questions about what data to enter.",pswarPricingFundingComparison:"Values entered in the first column reflect anticipated revenue and margin based on cost estimates and negotiations during the Pricing phase (pre-award).<br/><br/>By comparison, values entered in the Funding column reflect the contract amount being funded by the client at this time.<br/><br/>The variance column enables us to determine whether the anticipated margin and revenue were realized, or if those amounts differ from what was awarded.",wspLabor:"WSP Raw Direct Labor does not include overhead (OH), fringe, or any labor from subcontractors/subconsultants.",wspOh:"Factor used to burden raw labor, meant to cover our operating costs.  Can be individually established in the contract or included in the Labor Multiplier, Bill Rates, etc.",deOdc:"Include Reimbursable Expenses Only",irc:"Review your contract's insurance requirements to determine if a certificate of insurance (COI) needs to be obtained or renewed.",reviewContractInsurance:"Review your contract's insurance requirements to determine if a certificate of insurance (COI) needs to be obtained or renewed.",burdenedCostCenterMessage:"This is the total amount of risk WSP will be exposed to",requestToHaveCreated:"If this is a GBS project, click Yes here to have GBS personnel facilitate on your behalf.",NonReimbursableCost:"Include all costs which will not be reimbursed by the client, whether labor, direct expenses or subcontractors.",engageGbs:"Work with your Project Accountant and/or PA Management to determine whether or not GBS is to be engaged.<br/><br/>As of mid-August 2021, the default is to engage GBS for all standard projects, with the exception of any work at-risk requests, confidential, or high-profile projects.",projectNameShort:"­Required field in Oracle ERP, with a more restrictive character count.  The name entered here will be what’s visible in Oracle OTL timesheets, in various dashboards, and beyond."})}(),function(){"use strict";angular.module("myApp").constant("FormNewRecordPropertyNames",{TaskOrderPanel:"TASK_ORDER_PANEL_NEW",RCRRequired:"RCR_REQUIRED_NEW",DevBank:"ASSOCIATED_WITH_INTERAMERICAN_BANK_NEW",OpportunityStatus:"OPPORTUNITY_STATUS_NEW",OpportunityName:"OPPORTUNITY_NAME_NEW",Client:"CLIENT_NEW",UltimateClient:"OWNER_NEW",ClientType:"CLIENT_TYPE_NEW",UltimateClientType:"UC_TYPE_NEW",WspRole:"OUR_ROLE_NEW",AnticipatedDecisionDate:"EXPECTED_DECISION_DATE_NEW",AnticipatedStartDate:"EST_START_DATE_NEW",RfpIssueDate:"RFQ_RECEIVED_DATE_NEW",ProjectDuration:"DURATION_MONTHS_NEW",RfpSubmittalDate:"RFP_SUBMITTAL_LATEST_DISPATCH_DATE_NEW",ConfidentialProject:"CONFIDENTIAL_PROJECT_NEW",SolicitationNumber:"SOLICITATION_NUMBER_NEW",ContractClassification:"CONTRACT_CLASSIFICATION_NEW",MasterContractAgreement:"MASTER_CONTRACT_AGREEMENT_NEW",IsFederalClient:"IS_FEDERAL_CLIENT_NEW",PackageType:"PACKAGE_TYPE_NEW",Complexity:"COMPLEXITY_NEW",Priority:"PRIORITY_NEW",SoleSource:"SOLE_SOURCE_NEW",Level1:"DIVISION_NAME_NEW",Level2:"DISTRICT_NAME_NEW",Level3:"AREA_NAME_NEW",Level4:"COST_CENTER_NAME_NEW",Company:"COMPANY_NUMBER_NAME_NEW",EstGrossEcvRaw:"EST_GROSS_ECV_NEW",EstGrossEcv:"EST_GROSS_ECV_FORMAT_NEW",EstNetEcvRaw:"EST_NET_ECV_NEW",EstNetEcv:"EST_NET_ECV_FORMAT_NEW",EstSubEcvRaw:"EST_SUB_ECV_NEW",EstSubEcv:"EST_SUB_ECV_FORMAT_NEW",EstDirectExpensesRaw:"EST_DIRECT_EXPENSES_NEW",EstDirectExpenses:"EST_DIRECT_EXPENSES_FORMAT_NEW",TaskNetEcvRaw:"TASK_NET_ECV_NEW",TaskNetEcv:"TASK_NET_ECV_FORMAT_NEW",TaskGrossEcv:"TASK_GROSS_ECV_FORMAT_NEW",TaskGrossEcvRaw:"TASK_GROSS_ECV_NEW",JvEcvRaw:"EST_JV_ECV_NEW",JvEcv:"EST_JV_ECV_FORMAT_NEW",Ppp:"PROJECT_PROCEEDING_PROBABILITY_PERCENT_NEW",Wp:"WIN_PROBABILITY_PERCENT_NEW",GoGetPercent:"GO_GET_PERCENT_NEW",ETCVRaw:"EST_TOTAL_CONSTRUCTION_VALUE_NEW",ETCV:"EST_TOTAL_CONSTRUCTION_VALUE_FORMAT_NEW",ENCVRaw:"EST_NET_CONSTRUCTION_VALUE_NEW",ENCV:"EST_NET_CONSTRUCTION_VALUE_FORMAT_NEW",ContractUpsetLimit:"CONTRACT_UPSET_LIMIT_NEW",ContractUpsetLimitValuesRaw:"CONTRACT_UPSET_LIMIT_VALUE",ContractUpsetLimitValues:"CONTRACT_UPSET_LIMIT_VALUE_FORMAT",DeliveryMethod:"DELIVERY_METHOD_NEW",City:"CITY_NEW",ProjState:"PROJ_STATE_NEW",Country:"COUNTRY_NEW",MarketArea:"MARKET_AREA_NEW",PrimaryServiceType:"PRIMARY_SERVICE_TYPE_NEW",ServiceType:"SERVICE_TYPE_NEW",MarketSector:"MARKET_SECTOR_NEW",Segment:"SEGMENTS_NEW",ProjectDescription:"OPPORTUNITY_DESCRIPTION_NEW",CurrentFy:"CURRENT_FY_PERCENT_NEW",SubsequentFy:"SUBSEQUENT_FY_PERCENT_NEW",NextFy:"NEXT_FY_PERCENT_NEW",Pa:"PA_NEW",PaAuto:"PA",ProjectManager:"PROJECT_MANAGER_NEW",PmLevel:"PM_LEVEL_NEW",PursuitManager:"PURSUIT_MANAGER_NEW",Pic:"PIC_NEW",ProposalManager:"PROPOSAL_MANAGER_NEW",MarketingCoordinator:"MARKETING_COORDINATOR_NEW",OtherStaff:"OTHER_STAFF_NEW",TeamingPartners:"TEAMING_PARTNERS_NEW",Competitors:"COMPETITORS_NEW",Collaboration:"COLLABORATION_NEW",PreSubmittalLaborHours:"PRESUBMITTAL_LABOR_HOURS",PreSubmittalLaborDollar:"PRESUBMITTAL_LABOR_DOLLAR",PreSubmittalTotalCosts:"PRESUBMITTAL_TOTAL_COST",PreSubmittalTotalPercent:"PRESUBMITTAL_TOTAL_PERCENT",PreSubmittalExpense:"PRESUBMITTAL_EXPENSE",PreSubmittalExpenseFormat:"PRESUBMITTAL_EXPENSE_FORMAT",QualificationsLaborHours:"QUALIFICATIONS_LABORHOURS",QualificationsLaborDollar:"QUALIFICATIONS_LABOR_DOLLAR",QualificationsTotalCosts:"QUALIFICATIONS_TOTAL_COST",QualificationsTotalPercent:"QUALIFICATIONS_TOTAL_PERCENT",QualificationsExpense:"QUALIFICATIONS_EXPENSE",QualificationsExpenseFormat:"QUALIFICATIONS_EXPENSE_FORMAT",TechProposalLaborHours:"TECH_PROPOSAL_LABORHOURS",TechProposalLaborDollar:"TECH_PROPOSAL_LABOR_DOLLAR",TechProposalTotalCosts:"TECH_PROPOSAL_TOTAL_COST",TechProposalTotalPercent:"TECH_PROPOSAL_TOTAL_PERCENT",TechProposalExpense:"TECH_PROPOSAL_EXPENSE",TechProposalExpenseFormat:"TECH_PROPOSAL_EXPENSE_FORMAT",CostProposalLaborHours:"COST_PROPOSAL_LABOR_HOURS",CostProposalLaborDollar:"COST_PROPOSAL_LABOR_DOLLAR",CostProposalTotalCosts:"COST_PROPOSAL_TOTAL_COST",CostProposalTotalPercent:"COST_PROPOSAL_TOTAL_PERCENT",CostProposalExpense:"COST_PROPOSAL_EXPENSE",CostProposalExpenseFormat:"COST_PROPOSAL_EXPENSE_FORMAT",InterviewLaborHours:"INTERVIEW_LABOR_HOURS",InterviewLaborDollar:"INTERVIEW_LABOR_DOLLAR",InterviewTotalCosts:"INTERVIEW_TOTAL_COST",InterviewTotalPercent:"INTERVIEW_TOTAL_PERCENT",InterviewExpense:"INTERVIEW_EXPENSE",InterviewExpenseFormat:"INTERVIEW_EXPENSE_FORMAT",ContractNegotiationsLaborHours:"CONTRACT_NEGOTIATIONS_LABORHOURS",ContractNegotiationsLaborDollar:"CONTRACT_LABOR_DOLLAR",ContractNegotiationsTotalCosts:"CONTRACT_TOTAL_COST",ContractNegotiationsTotalPercent:"CONTRACT_TOTAL_PERCENT",ContractNegotiationsExpense:"CONTRACT_NEGOTIATIONS_EXPENSE",ContractNegotiationsExpenseFormat:"CONTRACT_NEGOTIATIONS_EXPENSE_FORMAT",PusuitBudgetTotalLaborHours:"PURSUIT_BUDGET_TOTAL_LABOR_HOURS",PusuitBudgetTotalLaborDollar:"PURSUIT_BUDGET_TOTAL_LABOR_DOLLAR",PusuitBudgetTotalExpense:"PURSUIT_BUDGET_TOTAL_EXPENSE",PusuitBudgetTotalCost:"PURSUIT_BUDGET_TOTAL_COST",PercentOfGrossEcv:"PERCENT_OF_GROSS_ECV",QuTpCpTotalPercent:"QU_TP_CP_TOTAL_PERCENT",IsBudgetFilledUp:"IS_BUDGET_FILLED_UP",PercentGrossEcv:"PERCENT_GROSS_ECV",Ps:"PRE_SUBMITAL_CHECKBOX",Qu:"QUALIFICATIONS_CHECKBOX",Tp:"TECHNICAL_CHECKBOX",Cp:"COST_CHECKBOX",Intvw:"INTERVIEW_CHECKBOX",Cn:"CONTRACT_CHECKBOX"})}(),function(){"use strict";angular.module("myApp").constant("FormOptions",{Complexity:["1 - Strategic","2 - Complex","3 - Average"],FinancialTerms:["Time & Materials","Commercial Rates","Fixed Price (or Lump Sum)","CPM - Cost Plus Multiplier","CPFF - Cost Plus Fixed Fee","Other"],MarketArea:["ADVISORY SERVICES","PROPERTY & BUILDINGS","CLIMATE, SUSTAINABILITY & RESILIENCY","ENERGY","ENVIRONMENT","PMCM","TRANSPORTATION","WATER","OTHER","AEROSPACE","AUTOMOTIVE","AVIATION","BRIDGES","CHEMICAL","COMMERCIAL BUILDINGS","CONSTRUCTION PRODUCTS","CONSUMER PRODUCTS","CONVERSION","CULTURAL BUILDINGS","ENERGY","FOOD & BEVERAGE","GOVERNMENT BUILDINGS","INDUSTRY","INFRASTRUCTURE","INSTITUTIONAL BUILDINGS","METAL INDUSTRY","MINING","OIL & GAS","PHARMACEUTICAL & BIOTECHNOLOGY","PORTS, MARINE & COASTAL","POWER DISTRIBUTION","POWER GENERATION","POWER TRANSMISSION","PROCESS ENERGY","PROPERTY & BUILDINGS","PULP & PAPER","RAIL & TRANSIT","RESIDENTIAL BUILDINGS","RESOURCES","ROADS & HIGHWAYS","TRANSPORT BUILDINGS","TRANSPORT","TUNNELS","URBAN INFRASTRUCTURE","WASTEWATER DISCHARGES/OUTFALLS","WATER RESOURCES","WATER SUPPLY"],MarketSector:["ACCESS CONTROLLED HIGHWAYS","ACCESS/ROADWAY SYSTEMS","ADVANCED TREATMENT & DESAL","AIRCRAFT COMPONENTS","AIRCRAFT PLANTS & ASSEMBLY","AIRPORT ACCESS CONTROLLED HWYS","AIRPORT PEOPLE MOVERS; RAIL","AIRSIDE FACILITIES","BAKERIES","BIO FUELS","BIOENERGY","BIOGAS/AD","BIOTECHNOLOGY PLANTS","BLEACHING","BULK PHARMACEUTICAL PLANTS","BULK TERMIN (LIQUID DRY BREAK)","BUS RAPID TRANSIT (BRT)","BUS/RAIL FLEET MAINTENANCE FAC","CAPACITY MAINT., OPS & MGMT","CASTING FURNACE & MOLTEN PUMPS","CEMENT PRODUCTION","CEREALS","CHEMICAL RECOVERY","CHEMICALS","CHP","COAL","COASTAL MODELING(HYDRODYNAMIC)","COATINGS","COMBINED SEWER OVERFLOWS (CSO)","COMMS/IT/SECURITY/SPECIAL SYS","COMMUTER RAIL","COMPOSITES PLANTS","COMPRESSION & GAS STORAGE","CONFECTIONERY","CONNECTED AUTONOMOUS VEHICLES","CONTAINER TERMINAL","CONTROL TOWERS","CONVENTIONAL TREATMENT","CONVERSION","CORRECTIONAL/JUSTICE","CUSTOMER SERVICES","DAIRY PRODUCTS","DAMS & RESERVOIRS","DECOMMISSIONING","DEFENSE/MILITARY","DISTRIBUTION/WAREHOUSE","DISTRICT HEATING & COOLING","DRAINAGE","DREDGING/RECLAMATION","EDUCATION (COLLEGE/UNIVERSITY)","EDUCATION (K-12)","EMBASSY","ENERGY EFFICIENCY IMPROVEMENT","ENTERTAINMENT","FIBRES","FILLING & PACKAGING FACILITIES","FLOOD CONTROL/DRAINAGE","FMCP/FAST MOVING CONSUMER PROD","FORMULATION & DOSAGE FAC.","FREEWAY MANAGEMENT SYS (ITS)","FREIGHT RAIL","FUEL HANDLING","GAS PROCESSING & TREATMENT","GAS","GEOTECHNICAL","GEOTHERMAL","GLASS PRODUCTS","GROUNDWATER MODELING","GROUNDWATER MONITORING/MGMT","GSA SCHEDULE","HANGARS & MROS","HEAVY RAIL TRANSIT","HIGH-LEVEL CONTAINMENT LABS","HIGH-RISE","HIGH-RISE","HIGHWAY TUNNELS","HOME CARE PRODUCTS","HOSPITALS/HEALTHCARE","HOTELS/MOTELS/CONVENTION CTRS","HYDRO","HYDROCARBON LIQUID HANDLING","HYDROLOGY & HYDRAULIC ANALYSIS","INDUSTRIAL","INFORMATION SHARING SYS (ITS)","INFRASTRUCTURE FOR BUILDINGS","INTAKES & RAW WATER CONVEYANCE","INTERCHANGES","INTERCITY/HIGH SPEED RAIL","INTERCONNECTOR","INTERMODAL","LAND DEVELOPMENT","LANDSIDE FACILITIES","LEVEE ENGINEERING","LIBRARIES/MUSEUMS","LIGHT RAIL TRANSIT","LIME STONE PRODUCTS","LINEAR INFRASTR REPAIR/RENEWAL","LIQUIDS FRACTIONATION","LONG SPAN BRIDGES","MAGLEV","MAINT, REPAIR &OVERHAUL HANGAR","MANAGED LANES (HOV, HOT, ETC)","MANUFACTURING/ASSEMBLY PLANTS","MARINE FAC (HARBOR/WHARF/PIER)","MASTERPLANNING/URBAN DEVELOP","MEDIUM AND SHORT SPAN BRIDGES","METERING & AUTOMATION","MINERAL HANDLING/TRANS/STORAGE","MISSION CRITICAL/TECH FACILITY","MIXED-USE","MULTIMODAL","MULTI-UNIT","N/A","NUCLEAR PLANTS","OFFICE","OFFICE","OIL & GAS","OIL PROJECTS & SAGD","OIL","OTHER AIRPORT BUILDINGS","OVERHEAD LINE","PAINT HANGARS","PAPER PRODUCTION","PARKING GARAGES","PASSENGER TERM(CRUISE MARINA)","PASSENGER TERMIN/CONTROL TOWER","PASSENGER TERMINALS","PAVEMENT","PEDESTRIAN BRIDGES","PEOPLE MOVERS","PERSONAL CARE PRODUCTS","PIPELINES & GATHERING","POTABLE WATER STOR/CONVEY/DIST","POTABLE WATER TUNNELS","POWER GENERATION","PROCESS VENT & GAS CLEANING","PROCESSED FOODS & MEAT PROCESS","PRODUCTION & PACKAGING FAC.","PRODUCTS & RECYCLING","PUBLIC HOUSING","PULP PRODUCTION","R&D PLANTS & LABORATORIES","RAIL & TRANSIT BRIDGES","RAIL & TRANSIT TUNNELS","RAIL/TRANSPORTATION","RAILROAD BRIDGES","RAILROAD TUNNELS","RAW MAT HANDLING & LOGISTICS","RAW MATERIAL PROCESSES","RECLAIM WATER STOR/CONVEY/DIST","RELIGIOUS","RESEARCH & DEVELOPMENT FAC.","RESEARCH & DEVELOPMENT PLANTS","RETAIL","ROADSIDE AESTHETICS","SANITARY SEWER COLLECTION","SCIENCE & TECHNOLOGY","SHORE/COASTAL PROTECTION","SINGLE FAMILY","SOLAR","SPENT FUEL HANDLING/STORAGE","SPIRITS, MALTS & SOFT DRINKS","SPORTS","STORMWATER MANAGEMENT","STORMWATER TUNNELS","STREETCAR/TROLLEY/TRAMWAY","SUBSEA CABELING AND STRUCTURES","SUBSTATION","SUBSTATION","SUPPLY WELLS, WELLFIELDS & ASR","SURFACE MINING","SURFACE STREETS AND ROADS","SURFACE WATER AUGMENTATION","SUSTAINING PROJECTS","TENANT INTERIORS","TENANT INTERIORS","TESING FACILITIES/TEST CELLS","THERMAL COLD OIL BITUMEN PROC","TIDAL","TOLL COLLECTION SYSTEMS","TOLL FACILITY CUSTOMER SERVICE","TOLL ROADS","TRAFFIC & REVENUE FORECASTING","TRAFFIC ENGINEERING","TRAFFIC SIGNAL SYSTEMS (ITS)","TRANSIT BRIDGES","TRANSIT TUNNELS","TRAVEL DEMAND","TUNNEL SYSTEMS","UNDERGROUND MINING","UNDERGROUND STORAGE","UNDERGROUND","URBAN ARCHITECTURE DESIGN","UTILITIES","V DISPOSAL WELLS","WASTE-TO-ENERGY","WASTEWATER DISCHARGES","WASTEWATER TREAT & RESID MGMT","WASTEWATER TREATMENT","WASTEWATER TUNNELS","WATER TUNNELS","WATERSHED/WATER MANAGEMENT","WELL CONTROL & MEASUREMENT","WELL SITES & TIE-INS","WIND"],MarketSectorLead:["ACCESS CONTROLLED HIGHWAYS","ACCESS/ROADWAY SYSTEMS","ADVANCED TREATMENT & DESAL","AIRCRAFT COMPONENTS","AIRCRAFT PLANTS & ASSEMBLY","AIRPORT ACCESS CONTROLLED HWYS","AIRPORT PEOPLE MOVERS; RAIL","AIRSIDE FACILITIES","BAKERIES","BIO FUELS","BIOENERGY","BIOGAS/AD","BIOTECHNOLOGY PLANTS","BLEACHING","BULK PHARMACEUTICAL PLANTS","BULK TERMIN (LIQUID DRY BREAK)","BUS RAPID TRANSIT (BRT)","BUS/RAIL FLEET MAINTENANCE FAC","CAPACITY MAINT., OPS & MGMT","CASTING FURNACE & MOLTEN PUMPS","CEMENT PRODUCTION","CEREALS","CHEMICAL RECOVERY","CHEMICALS","CHP","COAL","COASTAL MODELING(HYDRODYNAMIC)","COATINGS","COMBINED SEWER OVERFLOWS (CSO)","COMMS/IT/SECURITY/SPECIAL SYS","COMMUTER RAIL","COMPOSITES PLANTS","COMPRESSION & GAS STORAGE","CONFECTIONERY","CONNECTED AUTONOMOUS VEHICLES","CONTAINER TERMINAL","CONTROL TOWERS","CONVENTIONAL TREATMENT","CONVERSION","CORRECTIONAL/JUSTICE","CUSTOMER SERVICES","DAIRY PRODUCTS","DAMS & RESERVOIRS","DECOMMISSIONING","DEFENSE/MILITARY","DISTRIBUTION/WAREHOUSE","DISTRICT HEATING & COOLING","DRAINAGE","DREDGING/RECLAMATION","EDUCATION (COLLEGE/UNIVERSITY)","EDUCATION (K-12)","EMBASSY","ENERGY EFFICIENCY IMPROVEMENT","ENTERTAINMENT","FIBRES","FILLING & PACKAGING FACILITIES","FLOOD CONTROL/DRAINAGE","FMCP/FAST MOVING CONSUMER PROD","FORMULATION & DOSAGE FAC.","FREEWAY MANAGEMENT SYS (ITS)","FREIGHT RAIL","FUEL HANDLING","GAS PROCESSING & TREATMENT","GAS","GEOTECHNICAL","GEOTHERMAL","GLASS PRODUCTS","GROUNDWATER MODELING","GROUNDWATER MONITORING/MGMT","GSA SCHEDULE","HANGARS & MROs","HEAVY RAIL TRANSIT","HIGH-LEVEL CONTAINMENT LABS","HIGH-RISE","HIGH-RISE","HIGHWAY TUNNELS","HOME CARE PRODUCTS","HOSPITALS/HEALTHCARE","HOTELS/MOTELS/CONVENTION CTRS","HYDRO","HYDROCARBON LIQUID HANDLING","HYDROLOGY & HYDRAULIC ANALYSIS","INDUSTRIAL","INFORMATION SHARING SYS (ITS)","INFRASTRUCTURE FOR BUILDINGS","INTAKES & RAW WATER CONVEYANCE","INTERCHANGES","INTERCITY/HIGH SPEED RAIL","INTERCONNECTOR","INTERMODAL","LAND DEVELOPMENT","LANDSIDE FACILITIES","LEVEE ENGINEERING","LIBRARIES/MUSEUMS","LIGHT RAIL TRANSIT","LIME STONE PRODUCTS","LINEAR INFRASTR REPAIR/RENEWAL","LIQUIDS FRACTIONATION","LONG SPAN BRIDGES","MAGLEV","MAINT, REPAIR &OVERHAUL HANGAR","MANAGED LANES (HOV, HOT, etc)","MANUFACTURING/ASSEMBLY PLANTS","MARINE FAC (HARBOR/WHARF/PIER)","MASTERPLANNING/URBAN DEVELOP","MEDIUM AND SHORT SPAN BRIDGES","METERING & AUTOMATION","MINERAL HANDLING/TRANS/STORAGE","MISSION CRITICAL/TECH FACILITY","MIXED-USE","MULTIMODAL","MULTI-UNIT","N/A","NUCLEAR PLANTS","OFFICE","OFFICE","OIL & GAS","OIL PROJECTS & SAGD","OIL","OTHER AIRPORT BUILDINGS","OVERHEAD LINE","PAINT HANGARS","PAPER PRODUCTION","PARKING GARAGES","PASSENGER TERM(CRUISE MARINA)","PASSENGER TERMIN/CONTROL TOWER","PASSENGER TERMINALS","PAVEMENT","PEDESTRIAN BRIDGES","PEOPLE MOVERS","PERSONAL CARE PRODUCTS","PIPELINES & GATHERING","POTABLE WATER STOR/CONVEY/DIST","POTABLE WATER TUNNELS","POWER GENERATION","PROCESS VENT & GAS CLEANING","PROCESSED FOODS & MEAT PROCESS","PRODUCTION & PACKAGING FAC.","PRODUCTS & RECYCLING","PUBLIC HOUSING","PULP PRODUCTION","R&D PLANTS & LABORATORIES","RAIL & TRANSIT BRIDGES","RAIL & TRANSIT TUNNELS","RAIL/TRANSPORTATION","RAILROAD BRIDGES","RAILROAD TUNNELS","RAW MAT HANDLING & LOGISTICS","RAW MATERIAL PROCESSES","RECLAIM WATER STOR/CONVEY/DIST","RELIGIOUS","RESEARCH & DEVELOPMENT FAC.","RESEARCH & DEVELOPMENT PLANTS","RETAIL","ROADSIDE AESTHETICS","SANITARY SEWER COLLECTION","SCIENCE & TECHNOLOGY","SHORE/COASTAL PROTECTION","SINGLE FAMILY","SOLAR","SPENT FUEL HANDLING/STORAGE","SPIRITS, MALTS & SOFT DRINKS","SPORTS","STORMWATER MANAGEMENT","STORMWATER TUNNELS","STREETCAR/TROLLEY/TRAMWAY","SUBSEA CABELING AND STRUCTURES","SUBSTATION","SUBSTATION","SUPPLY WELLS, WELLFIELDS & ASR","SURFACE MINING","SURFACE STREETS AND ROADS","SURFACE WATER AUGMENTATION","SUSTAINING PROJECTS","TENANT INTERIORS","TENANT INTERIORS","TESING FACILITIES/TEST CELLS","THERMAL COLD OIL BITUMEN PROC","TIDAL","TOLL COLLECTION SYSTEMS","TOLL FACILITY CUSTOMER SERVICE","TOLL ROADS","TRAFFIC & REVENUE FORECASTING","TRAFFIC ENGINEERING","TRAFFIC SIGNAL SYSTEMS (ITS)","TRANSIT BRIDGES","TRANSIT TUNNELS","TRAVEL DEMAND","TUNNEL SYSTEMS","UNDERGROUND MINING","UNDERGROUND STORAGE","UNDERGROUND","URBAN ARCHITECTURE DESIGN","UTILITIES","V DISPOSAL WELLS","WASTE-TO-ENERGY","WASTEWATER DISCHARGES","WASTEWATER TREAT & RESID MGMT","WASTEWATER TREATMENT","WASTEWATER TUNNELS","WATER TUNNELS","WATERSHED/WATER MANAGEMENT","WELL CONTROL & MEASUREMENT","WELL SITES & TIE-INS","WIND"],PrimaryServiceType:["ADVISORY","CONSTRUCTION MANAGEMENT","DESIGN","OPERATIONS","PLANNING","PROJECT/PROGRAM MANAGEMENT"],OpportunityStatusNew:[{value:"LEAD",disabled:"N"},{value:"IDENTIFIED",disabled:"N"},{value:"IN PREP",disabled:"N"},{value:"PENDING",disabled:"N"},{value:"SHORT LISTED",disabled:"N"},{value:"TASK PIPELINE",disabled:"N"}],OpportunityStatus:["LEAD","IDENTIFIED","IN PREP","PENDING","SHORT LISTED","TASK PIPELINE"],Priority:["A - National","B - Regional","C - Local"],Rate:[1,2,3,4,5],Segment:["ADVISORY SERVICES","PROPERTY & BUILDINGS","CLIMATE, SUSTAINABILITY & RESILIENCY","ENERGY","ENVIRONMENT","PMCM","TRANSPORTATION","WATER","OTHER"],ServiceType:["ACOUSTICS, NOISE & VIBRATION","AIR QUALITY & CLIMATE CHANGE","COMMISSIONING MANAGEMENT","COMPLIANCE & PERMITTING","CONCEPT & FEASIBILITY STUDIES","CONSTRUCTION MANAGEMENT","CONSTRUCTION SUPERVISION","DECOMMISSIONING & REHAB","DETAILED DESIGN","ECOLOGY SERVICES","ECONOMICAL STUDY","ENGINEERING/DESIGN","ENVIRON IMPACT ASSESSMENT&PLAN","ENVIRONMENTAL AUDIT","ENVIRONMENTAL MANAGEMENT","ENVIRONMENTAL SITE ASSESSMENTS","EPCM","EXPLORATION","EXTRACTION","FAÇADE ENGINEERING","FEASIBILITY STUDY","FEED","FIRE ENGINEERING","GEOMATICS VISUAL SIMULA & MAP","GEOTECH SERVICE&MATERIAL TEST","GEOTECHNICAL ENGINEERING","INDUSTRIA COMPLIANCE/VALIDATE","LAND & SITE REMEDIATION","MATERIAL ENGINEERING","MEP (SYSTEMS) ENGINEERING","N/A","OPTIMIZATION","OTHER - CONSULTATIONS","OWNER'S ENGINEER","PERMITTING PROCESS","PLANNING & DEVELOPMENT","PM","PMC","PRE-FEED","PROCESSING & HANDLING","PROCUREMENT","PROJECT RESOURCE ASSESSMENT","QUALITY SERVICES","RESOURCE OPTIMIZATION","RISK ASSESSMENT","SECURITY CONSULTING","SITE MASTER PLANNING","SOCIAL & HUMAN STUDIES","STRUCTURAL ENGINEERING","SUBSTANCE&HAZARD MATERIAL MGMT","SUSTAINABILITY ADVICE","SUSTAINABILITY ASSESSMENT","TECHNICAL & ECONOMIC ADVICE","TECHNOLOGY CONSULTING","TECHNOLOGY EVALUATION","THIRD-PARTY DUE DILIGENCE","VERTICAL TRANSPORT CONSULTING"],YesNo:["YES","NO"],TaskOrder:[{value:"NON COMPETE",disabled:"N"},{value:"RE-COMPETE",disabled:"N"},{value:"NO",disabled:"N"}],YesNoNotApplicable:["YES","NO","NOT APPLICABLE"],YesNoUnknown:["YES","NO","UNKNOWN"],OurRole:["JV","PRIME","SUB"],ContractClassification:["STAND ALONE","MASTER CONTRACT","TASK ORDER"],Collaboration:[{value:"Advisory & Planning",isChecked:!1,order:1},{value:"Climate, Resilience, Sustainability",isChecked:!1,order:3},{value:"Energy",isChecked:!1,order:5},{value:"Environment",isChecked:!1,order:7},{value:"Federal",isChecked:!1,order:9},{value:"Golder",isChecked:!1,order:2},{value:"PM/CM",isChecked:!1,order:4},{value:"Property & Buildings",isChecked:!1,order:6},{value:"Transportation",isChecked:!1,order:8},{value:"Water",isChecked:!1,order:10},{value:"Future Ready",isChecked:!1,order:11}],ClientOwnerType:["WSP Internal","Joint Venture","Private","Regulated","Public - Federal","Public - Regional/MPO","Public - State/Province","Public - Local/County"],None:[{name:"NONE"}],PackageType:["Proposal","Proposal + Quals","Quals","AWA"],Percent:[5,10,15,20,25,30,35,40,45,50,55,60,65,70,75,80,85,90,95,100],WarExtensionType:["Budget Increase","Time Extension","Both Budget Increase & Time Extension"]})}(),function(){"use strict";angular.module("myApp").constant("FormTwoWayBindPropertyNames",{TaskOrderPanel:"TASK_ORDER_PANEL_EDIT",Doa:"DOA",DevBank:"ASSOCIATED_WITH_INTERAMERICAN_BANK_EDIT",OpportunityStatus:"OPPORTUNITY_STATUS_EDIT",OpportunityName:"OPPORTUNITY_NAME_EDIT",Client:"CLIENT_EDIT",UltimateClient:"OWNER_EDIT",ClientType:"CLIENT_TYPE_EDIT",ClientTypeExpected:"EXPECTED_CLIENT_TYPE_EDIT",UltimateClientType:"UC_TYPE_EDIT",UltimateClientTypeExpected:"EXPECTED_UC_TYPE_EDIT",WspRole:"OUR_ROLE_EDIT",AnticipatedDecisionDate:"EXPECTED_DECISION_DATE_EDIT",AnticipatedStartDate:"EST_START_DATE_EDIT",RfpIssueDate:"RFQ_RECEIVED_DATE_EDIT",ProjectDuration:"DURATION_MONTHS_EDIT",RfpSubmittalDate:"RFP_SUBMITTAL_LATEST_DISPATCH_DATE_EDIT",SoleSource:"SOLE_SOURCE_EDIT",Level1:"DIVISION_NAME_EDIT",Level2:"DISTRICT_NAME_EDIT",Level3:"AREA_NAME_EDIT",Level4:"COST_CENTER_NAME_EDIT",Company:"COMPANY_NUMBER_NAME_EDIT",EstGrossEcvRaw:"EST_GROSS_ECV_EDIT",EstGrossEcv:"EST_GROSS_ECV_FORMAT_EDIT",EstNetEcvRaw:"EST_NET_ECV_EDIT",EstNetEcv:"EST_NET_ECV_FORMAT_EDIT",EstSubEcvRaw:"EST_SUB_ECV_EDIT",EstSubEcv:"EST_SUB_ECV_FORMAT_EDIT",EstDirectExpensesRaw:"EST_DIRECT_EXPENSES_EDIT",EstDirectExpenses:"EST_DIRECT_EXPENSES_FORMAT_EDIT",JvEcvRaw:"EST_JV_ECV_EDIT",JvEcv:"EST_JV_ECV_FORMAT_EDIT",Ppp:"PROJECT_PROCEEDING_PROBABILITY_PERCENT_EDIT",Wp:"WIN_PROBABILITY_PERCENT_EDIT",TaskNetEcvRaw:"TASK_NET_ECV_EDIT",TaskNetEcv:"TASK_NET_ECV_FORMAT_EDIT",TaskGrossEcv:"TASK_GROSS_ECV_FORMAT_EDIT",TaskGrossEcvRaw:"TASK_GROSS_ECV_EDIT",DeliveryMethod:"DELIVERY_METHOD_EDIT",City:"CITY_EDIT",ProjState:"PROJ_STATE_EDIT",Country:"COUNTRY_EDIT",MarketArea:"MARKET_AREA_EDIT",PrimaryServiceType:"PRIMARY_SERVICE_TYPE_EDIT",ServiceType:"SERVICE_TYPE_EDIT",MarketSector:"MARKET_SECTOR_EDIT",Segment:"SEGMENTS_EDIT",NblMarkets:"NBL_MARKETS",ProjectDescription:"OPPORTUNITY_DESCRIPTION_EDIT",CurrentFy:"CURRENT_FY_PERCENT_EDIT",SubsequentFy:"SUBSEQUENT_FY_PERCENT_EDIT",NextFy:"NEXT_FY_PERCENT_EDIT",DescribeOpp:"DESCRIBE_OPP",RequiredDoa:"R_DOA",KnowledgeReq:"KNOWLEDGE_REQ",PursuitProjectMgrWin:"PM_PM_WIN",ExecStrategy:"EXEC_STRATEGY",WSPValue:"WSP_VALUE",TopFive:"TOP_FIVE",StrengthOfClientRelationship:"STRENGHT_OF_CLIENT_RELATIONSHIP",CrmPlan:"CRM_PLAN",Abilities:"ABILITIES",Tracking:"TRACKING",SimilarServices:"SIMILAR_SERVICES",Positioning:"POSITIONING",ClientIssues:"CLIENT_ISSUES",Endorse:"ENDORSE",Differentiated:"DIFFERENTIATED",Precluded:"PRECLUDED",KnownByTheClient:"KNOWN_BY_THE_CLIENT",Perception:"PERCEPTION",Qualifications:"QUALIFICATIONS",Teaming:"TEAMING",StrengthOfQualifications:"STRENGTH_OF_QUALIFICATIONS",SimilarProj:"SIMILAR_PROJ",Adequate:"ADEQUATE",Objectives:"OBJECTIVES",Potential:"POTENTIAL",Extent:"EXTENT",Impact:"IMPACT",Pa:"PA_EDIT",ProjectManager:"PROJECT_MANAGER_EDIT",PmLevel:"PM_LEVEL_EDIT",PursuitManager:"PURSUIT_MANAGER_EDIT",NblMarketLead:"NBL_MARKET_LEAD",AnticipatedGrossRevenue:"ANTICIPATED_GROSS_REVENUE",AnticipatedGrossRevenueVariance:"ANTICIPATED_GROSS_REVENUE_VARIANCE",AnticipatedNetRevenue:"ANTICIPATED_NET_REVENUE",AnticipatedNetRevenueVariance:"ANTICIPATED_NET_REVENUE_VARIANCE",AnticipatedMargin:"ANTICIPATED_MARGIN",AnticipatedMarginVariance:"ANTICIPATED_MARGIN_VARIANCE",AnticipatedMarginPercentOfGross:"ANTICIPATED_MARGIN_PERCENT_GROSS",AnticipatedMarginPercentOfGrossVariance:"ANTICIPATED_MARGIN_PERCENT_GROSS_VARIANCE",AnticipatedMarginPercentOfNet:"ANTICIPATED_MARGIN_PERCENT_NET",AnticipatedMarginPercentOfNetVariance:"ANTICIPATED_MARGIN_PERCENT_NET_VARIANCE",AgreementFundingInOracle:"AGREEMENT_FUNDING_IN_ORACLE",TotalAgreementFunding:"TOTAL_AGREEMENT_FUNDING",Ps2Link:"PS2_LINK",IsPs2Link:"IS_PS2_LINK",IsPs2LinkCreated:"IS_PS2_LINK_CREATED",Pndl:"PROJECT_NETWORK_DRIVE_LINK",IsPndl:"IS_PROJECT_NETWORK_DRIVE_LINK",IsPndlCreated:"IS_PROJECT_NETWORK_DRIVE_LINK_CREATED",Pstfl:"PST_FOLDER_LINK",IsPstfl:"IS_PST_FOLDER_LINK",IsPstflCreated:"IS_PST_FOLDER_LINK_CREATED",IsRCRInWorkflow:"IS_RCR_IN_WORKFLOW"})}(),function(){"use strict";angular.module("myApp").constant("IgnoreLoadingUrls",["api/lookup/searchemployee","api/lookup/getbankaccounts","api/lookup/getcashaccounts","api/lookup/getcashaccounts","api/Generic/Data"])}(),function(){"use strict";angular.module("myApp").constant("LookupRoleIds",{clientRoleId:-99999994,companyRoleId:-99999986,divisionRoleId:-99999987,areasRoleId:-99999989,districtsRoleId:-99999988,ultimateClientRoleId:-99999993,agreementClosedRoleId:-99999971,projectAllActiveRoleId:-99999973,projectDirectClosedRoleId:-99999972,clientCustomerAllActiveRoleId:-99999975,agreementProjectClosedRoleId:-99999978,employeeInactiveRoleId:-99999962,pursuitProjectClosedRoleId:-99999961,projectIndirectActiveRoleId:-99999979,projectIndirectInactiveRoleId:-99999960,costCenterInactiveRoleId:-99999963,opportunityAgreementProjectSpecialRoleId:-99999964,customerActiveErpRoleId:-99999974,clientCustomerERPRoleId:-99999976,opportunityInactiveRoleId:-99999977,clientActiveCrmRoleId:-99999970,opportunityRoleId:-99999995,orgRoleId:-99999996,projectRoleId:-99999998,employeeRoleId:-99999999,agreementRoleId:-99999997,locationRoleId:-99999991,vendorRoleId:-99999992,agreementOpportunityProjectRoleId:-99999982,overheadProjectRoleId:-99999983,agreementProjectRoleId:-99999984,pursuitProjectRoleId:-99999985,gNgFormRoleId:-99999966,delegationsEmployeeLookup:-99999967,vendorClientRoleId:-99999968,opportunityAgreementRoleId:-99999969,opportunitySpecialRoleId:-99999950,projectSetupAgreementRoleId:-99999951,projectSetupEmployeeRoleId:-99999952,projectSetupEmployeeForLblRoleId:-99999953,projectSetupOpportunityRoleId:-99999954,projectSetupUltimateClientRoleId:-99999955,agreementSpecialLookup:-99999956})}(),function(){"use strict";angular.module("myApp").constant("PageSizes",[5,10,15,20,50,100])}(),function(){"use strict";angular.module("myApp").constant("LookupReferenceList",[{label:"Agreement (Active)",value:"AgreementTemplate"},{label:"Agreements (Closed)",value:"AgreementClosedTemplate"},{label:"Agreements/Direct Projects (Active)",value:"AgreementProjectTemplate"},{label:"Agreements/Direct Projects (Closed)",value:"AgreementProjectClosedTemplate"},{label:"Agreements (Active) with details",value:"AgreementSpecialTemplate"},{label:"All Clients/Customers (Active)",value:"ClientCustomerAllActiveTemplate"},{label:"All Clients/Customers",value:"ClientCustomerERPTemplate"},{label:"All Projects (Active)",value:"ProjectAllActiveTemplate"},{label:"Areas",value:"AreasTemplate"},{label:"Cascading Oracle Hierarchy",value:"CascadingOracleHierarchyTemplate"},{label:"Clients (Active per CRM)",value:"ClientActiveCRMTemplate"},{label:"Clients (per CRM)",value:"ClientTemplate"},{label:"Companies",value:"CompanyTemplate"},{label:"Cost Centers (Active)",value:"OrganizationTemplate"},{label:"Cost Centers Inactive",value:"CostCenterInactiveTemplate"},{label:"Customers (Active, per ERP)",value:"CustomerActiveERPTemplate"},{label:"Customers (per ERP)",value:"UltimateClientTemplate"},{label:"Direct Projects (Active)",value:"ParentProjectTemplate"},{label:"Direct Projects  (Closed)",value:"ProjectDirectClosedTemplate"},{label:"Districts",value:"DistrictsTemplate"},{label:"Divisions",value:"DivisionTemplate"},{label:"Employees (Current)",value:"EmployeeTemplate"},{label:"Employees (Inactive)",value:"EmployeeInactiveTemplate"},{label:"Indirect Projects (Active)",value:"ProjectIndirectActiveTemplate"},{label:"Indirect Projects (Inactive)",value:"ProjectIndirectInactiveTemplate"},{label:"Office Location",value:"LocationTemplate"},{label:"Opportunities (Active)",value:"OpportunityTemplate"},{label:"Opportunities (Inactive)",value:"OpportunityInactiveTemplate"},{label:"Opportunities/Agreements/Projects (Active)",value:"AgreementOpportunityProjectTemplate"},{label:"Opportunities/Agreements/Projects (Active) with details",value:"OpportunityAgreementProjectSpecialTemplate"},{label:"Opportunities (Active) with details",value:"OpportunitySpecialTemplate"},{label:"Pursuit Project (Active)",value:"PursuitProjectTemplate"},{label:"Pursuit Project (Closed)",value:"PursuitProjectClosedTemplate"},{label:"Suppliers/Subs/Vendors",value:"VendorTemplate"}])}(),function(){"use strict";angular.module("myApp").constant("Regex",{datePattern:"((19|20)\\d\\d)-(0?[1-9]|1[012])-(0?[1-9]|[12][0-9]|3[01])"})}(),function(){"use strict";angular.module("myApp").constant("SessionName",{currentSelectedOrg:"currentSelectedOrg",token:"secret",loggedInViewAs:"4D3597B5B2B5E0DC374597058E568EE883FA8C122CB05BB6CECFF71BE6B977C6305693F394DF81E9433AA678CFD05C1B2C1910A4C2D93C5020283CDB99DC5146",prevState:"prevstate"})}(),function(){"use strict";angular.module("myApp").constant("sweetDialogConstant",{timer:3e3,successTitle:"Success",warningTitle:"Warning",errorTitle:"Error",dialogTypes:{success:"success",warning:"warning",error:"error",info:"info",question:"question"},allowEscapeKey:!1,allowOutsideClick:!1,allowEnterKey:!1})}(),function(){"use strict";angular.module("myApp").constant("TextAngularToolbarConfig",[["p","pre","quote","bold","italics","underline","strikeThrough","ul","ol","insertLink"]])}(),function(){"use strict";angular.module("myApp").filter("keyAndOrFilter",function(){return function(e,t){if(t){var l={lst:e,pquery:t,out:[]};return angular.forEach(l.lst,function(t){var n=!0;angular.forEach(l.pquery,function(e){angular.isDefined(e.type)?"reverse"===e.type&&e.value.includes(t[e.key])&&n&&(n=!1):!e.value.includes(t[e.key])&&n&&(n=!1)}),n&&l.out.push(t)}),l.out}return e}})}(),function(){"use strict";angular.module("myApp").filter("searchFilter",function(){return function(e,t){if(angular.isDefined(e)&&0<e.length){var l=t.searchkeyword&&t.searchkeyword.trim().split(/\s+/),o=t.fields;return l&&l.length?e.filter(function(n){return l.every(function(t){return o.some(function(e){return-1<String(n[e]).toLowerCase().indexOf(t.toLowerCase())})})}):e}}})}(),function(){"use strict";angular.module("myApp").filter("uniqueFilter",function(){return function(e,n){var l=[],o=[];return angular.forEach(e,function(e){var t=e[n];-1===o.indexOf(t)&&(o.push(t),l.push(e))}),l}})}(),function(){"use strict";angular.module("myApp").filter("utcToLocal",function(n){return function(e,t){if(e)return-1===e.indexOf("Z")&&-1===e.indexOf("+")&&(e+="Z"),n("date")(e,t)}})}(),function(){"use strict";function e(l,o){this.Get=function(e,t){null==t?t={mode:"no-cors"}:t.mode="no-cors";return l.get(e,t).then(function(e){return e.data},function(e){o.error(e)})},this.Post=function(e,t,n){return n=function(e){var t=angular.isUndefined(e)?{cache:!1,mode:"no-cors"}:e;angular.isUndefined(t.cache)&&(t.cache=!1,t.mode="no-cors");return t}(n),l.post(e,t,n).then(function(e){return""===e.data?null:e.data},function(e){o.error(e)})}}angular.module("myApp").service("DataAccess",e),e.$inject=["$http","$log"]}(),function(){"use strict";function e(a){this.alertGeneral=function(e){Swal.fire(e)},this.alertCustomize=function(e,t,n,l,o,r,i,a){Swal.fire({html:e,showCancelButton:a,confirmButtonClass:t,cancelButtonClass:n,confirmButtonText:l,cancelButtonText:o,buttonsStyling:!1}).then(function(e){e.isConfirmed?r():i()})},this.alertSuccess=function(e,t,n){Swal.fire({title:e,html:t,icon:a.dialogTypes.success,timer:void 0===n?a.timer:"none"===n?null:n,allowOutsideClick:a.allowOutsideClick,allowEscapeKey:a.allowEscapeKey,allowEnterKey:a.allowEnterKey})},this.alertError=function(e,t,n){Swal.fire({title:e,html:t,icon:a.dialogTypes.error,timer:void 0===n?a.timer:"none"===n?null:n,allowOutsideClick:a.allowOutsideClick,allowEscapeKey:a.allowEscapeKey,allowEnterKey:a.allowEnterKey})},this.alertWarning=function(e,t,n){Swal.fire({title:e,html:t,icon:a.dialogTypes.warning,timer:void 0===n?a.timer:"none"===n?null:n,allowOutsideClick:a.allowOutsideClick,allowEscapeKey:a.allowEscapeKey,allowEnterKey:a.allowEnterKey})},this.alertSuccessWithConfirm=function(e,t,n,l,o,r,i){Swal.fire({title:e,html:t,icon:a.dialogTypes.success,showCancelButton:!angular.isDefined(i)||i,confirmButtonText:o,cancelButtonText:r,allowOutsideClick:a.allowOutsideClick,allowEscapeKey:a.allowEscapeKey,allowEnterKey:a.allowEnterKey}).then(function(e){e.isConfirmed?n():l()})},this.alertConfirm=function(e,t,n,l,o,r,i){Swal.fire({title:e,html:t,icon:a.dialogTypes.info,showCancelButton:!angular.isDefined(i)||i,confirmButtonText:o,cancelButtonText:r,allowOutsideClick:a.allowOutsideClick,allowEscapeKey:a.allowEscapeKey,allowEnterKey:a.allowEnterKey}).then(function(e){e.isConfirmed?n():l()})},this.alertWarningCustom=function(e,t,n,l){Swal.fire({title:e,html:t,icon:a.dialogTypes.warning,timer:void 0===n?a.timer:"none"===n?null:n,allowOutsideClick:a.allowOutsideClick,allowEscapeKey:a.allowEscapeKey,allowEnterKey:a.allowEnterKey,customContainerClass:l,width:"670px",containerClass:l})},this.alertErrorWithConfirm=function(e,t,n,l,o,r,i){Swal.fire({title:e,html:t,icon:a.dialogTypes.error,showCancelButton:!angular.isDefined(i)||i,confirmButtonText:o,cancelButtonText:r,allowOutsideClick:a.allowOutsideClick,allowEscapeKey:a.allowEscapeKey,allowEnterKey:a.allowEnterKey}).then(function(e){e.isConfirmed?n():l()})}}angular.module("myApp").service("sweetDialogAlertService",e),e.$inject=["sweetDialogConstant"]}(),function(){"use strict";angular.module("myApp").service("UtilService",function(){this.isInArray=function(t,e){if(0<e.length){var n=JSON.parse(e),l=!1;return n.forEach(function(e){e!=t||(l=!0)}),l}return!1},this.isInJsonArray=function(t,e){if(0<e.length){var n=!1;return e.forEach(function(e){e.toUpperCase()!=t.toUpperCase()||(n=!0)}),n}return!1},this.isInJsonArrayLike=function(t,e){if(0<e.length){var n=!1;return e.forEach(function(e){t.toUpperCase().includes(e.toUpperCase())&&(n=!0)}),n}return!1}})}(),function(){"use strict";angular.module("myApp").config(["$stateProvider","$urlRouterProvider",function(e,t){e.state({name:"am.admin.home",url:"home",controller:"AdminHomeController as vm",templateUrl:"app/views/admin/home/index.html",data:{pageName:"Admin Home",breadcrumbList:[{name:"Admin",className:"",route:""},{name:"Home",className:"",route:""}]}}).state({name:"am.admin.group",url:"group",controller:"AdminGroupController as vm",templateUrl:"app/views/admin/group/index.html",data:{pageName:"User Groups",breadcrumbList:[{name:"Admin",className:"",route:""},{name:"User Groups",className:"",route:""}]}}).state({name:"am.admin.waiverteam",url:"waiverteam",controller:"AdminWaiverTeamController as vm",templateUrl:"app/views/admin/waiverteam/index.html",data:{pageName:"Waiver Team",breadcrumbList:[{name:"Admin",className:"",route:""},{name:"Waiver Team",className:"",route:""}]}}).state({name:"am.admin.approvalitems",url:"approvalitems",controller:"AdminApprovalItemsController as vm",templateUrl:"app/views/admin/approvalitems/index.html",data:{pageName:"Approval Items",breadcrumbList:[{name:"Admin",className:"",route:""},{name:"Approval Items",className:"",route:""}]}}).state({name:"am.admin.approvalitemsmanage",url:"approvalitems/manage/:division/:type?id",controller:"AdminApprovalItemManageController as vm",templateUrl:"app/views/admin/approvalitems/manage.html",data:{pageName:"Approval Items",breadcrumbList:[{name:"Admin",className:"",route:""},{name:"Approval Items",className:"",route:""},{name:"",className:"",route:""}]}}).state({name:"am.admin.organization",url:"region",controller:"AdminOrganizationController as vm",templateUrl:"app/views/admin/organization/index.html",data:{routeAccess:["FULL_ACCESS"],pageName:"Region",breadcrumbList:[{name:"Admin",className:"",route:""},{name:"Region",className:"",route:""}]}}).state({name:"am.admin.roles",url:"roles",controller:"AdminRoleController as vm",templateUrl:"app/views/admin/role/index.html",data:{routeAccess:["FULL_ACCESS"],pageName:"Roles",breadcrumbList:[{name:"Admin",className:"",route:""},{name:"Roles",className:"",route:""}]}}).state({name:"am.admin.reportaccess",url:"reportaccess",controller:"AdminReportAccessController as vm",templateUrl:"app/views/admin/reportaccess/index.html",data:{routeAccess:["FULL_ACCESS"],pageName:"Report Access",breadcrumbList:[{name:"Admin",className:"",route:""},{name:"Report Access",className:"",route:""}]}})}])}(),function(){"use strict";function e(){return{}}angular.module("myApp").factory("AdminStore",e),e.$inject=[]}(),function(){"use strict";function e(n,l,e){this.SetItem=function(e){n.form.id=angular.copy(e.ApprovalItemId),n.form.name=angular.copy(e.ApprovalItemName.EN),n.form.reflist=angular.copy(e.RefNo.split(".")),n.form.refno=angular.copy(e.RefNo.split(".")[e.RefNo.split(".").length-1]),n.form.notes=angular.copy(e.ApprovalItemDescription.EN),n.form.level=angular.copy(e.RefNo.split(".").length),n.originalForm=angular.copy(n.form)},this.SubmitApprovalItem=function(){var e=angular.copy(n.form.reflist);e.pop(),e.push(n.form.refno);var t={ApprovalItemId:n.form.id,ApprovalItems:[{Level:n.form.level,ApprovalItemId:n.form.id,ApprovalItemName:{EN:n.form.name,ES:n.form.name},ApprovalItemDescription:{EN:n.form.notes,ES:n.form.notes},RefNo:e.join(".")}]};return l.SubmitApprovalItem(t).then(function(e){return e})},this.GetGroups=function(){if(n.groupList.length<=0)return e.GetGroups().then(function(e){n.groupList=e})},this.DeleteApprovalItem=function(e){return l.ApprovalItemDelete(e).then(function(e){return e})},Object.preventExtensions(n)}angular.module("myApp").service("AdminApprovalItemsBusiness",e),e.$inject=["AdminApprovalItemsStore","AdminApprovalItemsService","AdminGroupService"]}(),function(){"use strict";function e(l,o,r,i,e,a,t,s,u){this.model=o,this.approvalItemTreeviewComponentStore=l,this.events={onClick_Manage:function(e,t,n){"add"===e?r.go("am.admin.approvalitemsmanage",{division:n,type:"add",id:t.ApprovalItemId}):"update"===e?t.children.length<=0?r.go("am.admin.approvalitemsmanage",{division:l.selectedOrg.OrganizationCode,type:"update",id:t.ApprovalItemId}):(i.SetItem(t),angular.element("#manageApprovalItemsModal").modal("show")):"auditor"===e?(o.selectedApprovalItemId=t.ApprovalItemId,u.ClearStore(),angular.element("#auditorApprovalItemModal").modal("show"),i.GetGroups(),s.GetSettings(t.ApprovalItemId,"AUDITOR")):"delete"===e&&a.alertConfirm("Confirm Deletion","Are you sure you want to delete "+t.ApprovalItemName.EN+"?",function(){return i.DeleteApprovalItem(t.ApprovalItemId).then(function(e){null===e&&(a.alertSuccess("Success","Deleted "+t.ApprovalItemName.EN+" successfully!",3e3),r.go("am.admin.approvalitems",{},{reload:!0}))})},angular.noop,"Yes","No",!0)},onClick_AddBusinessActivity:function(){r.go("am.admin.approvalitemsmanage",{division:l.selectedOrg.OrganizationCode,type:"add"})},onClick_ApprovalItem:function(){i.SubmitApprovalItem().then(function(){angular.element("#manageApprovalItemsModal").modal("hide"),e.GetApprovalItemsByOrg(!0),a.alertSuccess("Success","Successfully saved",3e3)})},getToolbarConfig:function(){return t}}}angular.module("myApp").controller("AdminApprovalItemsController",e),e.$inject=["ApprovalItemTreeviewComponentStore","AdminApprovalItemsStore","$state","AdminApprovalItemsBusiness","ApprovalItemTreeviewComponentBusiness","sweetDialogAlertService","TextAngularToolbarConfig","ApprovalItemSettingsComponentBusiness","ApprovalItemSettingsComponentStore"]}(),function(){"use strict";function e(t){this.SubmitApprovalItem=function(e){return t.Post(n+"ApprovalItemLevelUpdate",e).then(function(e){return e})},this.ApprovalItemDelete=function(e){return t.Post(n+"ApprovalItemDelete",{ApprovalItemId:e}).then(function(e){return e})};var n=ApiRootDirectory.absoluteRootUrl+"api/ApprovalItem/Admin/"}angular.module("myApp").service("AdminApprovalItemsService",e),e.$inject=["DataAccess"]}(),function(){"use strict";function e(){function e(){this.manageType=null,this.form={id:0,name:null,refno:null,notes:null,reflist:[]},this.originalForm={},this.groupList=[],this.selectedApprovalItemId=0}return e.prototype.ClearStore=function(){this.manageType=null,this.form={id:0,name:null,refno:null,notes:null,reflist:[]},this.originalForm={},this.groupList=[],this.selectedApprovalItemId=0},new e}angular.module("myApp").factory("AdminApprovalItemsStore",e),e.$inject=[]}(),function(){"use strict";function e(i,n,a,e,t,l,o,s,r,u,c){function d(e){r.GetClassifications(e).then(function(e){i.classificationList=e,null!==i.form.classificationId&&(i.form.selectedclassification=i.classificationList.find(function(e){return e.ClassificationId===i.form.classificationId}))})}function p(e){return!!(a.isInObjectArray("CONDITIONAL LOOKUP","RoleType",e)||a.isInObjectArray("LOOKUP","RoleType",e)||a.isInObjectArray("EMPLOYEE SEARCH","RoleType",e))}function m(){var e=angular.copy(0<i.form.mainItems.length?i.form.mainItems[i.form.mainItems.length-1].reflist:[]);e.push(""),i.form.mainItems.push({id:0,name:"",refno:"",notes:"",reflist:angular.copy(e),isDisabled:!1})}function f(){if(0<i.form.steps.length)for(var e=0;e<i.form.steps.length;e++)i.form.steps[e].Order=e+1}this.ClearForm=function(){i.form={mainItems:[],approvalItemLabel:"",classificationId:null,requiresClassification:"N",isApprovalItem:!1,requiresImplementation:!1,requiresUpload:!1,selectedLookup:null,lookups:[],steps:[],implementationType:"USER",selectedImplementation:null,selectedclassification:null}},this.AddStep=function(){var e={id:a.guid(),Order:i.form.steps.length+1,StepType:null,StepLevel:i.stepLevels.find(function(e){return"REGIONAL"===e.StepLevelCode}),StepDistinction:null,Sla:4,selectedRole:null,Roles:[],Lookup:null};i.form.steps.push(e)},this.GetApprovalItemDetails=function(e){return o.GetApprovalItemDetails(e,0).then(function(e){!function(e){var t=e.filter(function(e){return"LOOKUP"===e.SettingType}),n=e.find(function(e){return"IMPLEMENTATION"===e.SettingType}),l=e.find(function(e){return"UPLOAD"===e.SettingType}),o=e.find(function(e){return"AUTO APPROVE"===e.SettingType}),r=e.find(function(e){return"COC SLA"===e.SettingType});void 0!==n&&(i.form.requiresImplementation=!0,i.form.implementationType=n.SettingValue,"USER"===i.form.implementationType||i.form.implementationType);void 0!==l&&(i.form.requiresUpload=!0);i.form.autoApprove=void 0===o||"Y"===o.SettingValue,i.form.cocSla=void 0!==r?r.SettingValue:4,0<t.length&&t.forEach(function(t){var e=s.find(function(e){return e.value.toUpperCase()===t.SettingValue});void 0!==e&&i.form.lookups.push(e)})}(e.ApprovalItemSettings),function(e){var l=angular.copy(e),t=a.object_array_unique(l,"ExecutionOrder","ExecutionOrder"),o=[];t.forEach(function(t){var n=angular.copy(l.find(function(e){return e.ExecutionOrder===t})),e={id:a.guid(),Order:n.ExecutionOrder,StepType:i.stepTypes.find(function(e){return e.StepTypeCode===n.StepType}),StepLevel:i.stepLevels.find(function(e){return e.StepLevelCode===n.StepLevel}),StepDistinction:i.stepDistinctions.find(function(e){return e.StepDistinctionCode===n.StepDistinction}),Sla:n.Sla,selectedRole:null,Roles:[],Lookup:s.find(function(e){return e.value.toUpperCase()===n.LookupValue})};o.push(e)}),o.forEach(function(t){l.forEach(function(e){t.Order===e.ExecutionOrder&&t.Roles.push({RoleId:e.CostPointRoleId,RoleName:e.CostPointRoleName,RoleType:e.RoleType})})}),i.form.steps=angular.copy(o)}(e.ApprovalItemSteps),function(e){var t=angular.copy(e);if(i.form.requiresImplementation&&0<t.length){if("USER"===i.form.implementationType)i.form.selectedImplementation={FULL_NAME:t[0].OBJECTDISPLAYNAME,EMAIL_ADDRESS:t[0].OBJECTEMAIL};else if("GROUP"===i.form.implementationType)i.form.selectedImplementation=i.groupList.find(function(e){return e.GroupId===parseInt(t[0].OBJECTID)});else if("ROLE"===i.form.implementationType){i.form.selectedImplementation=i.roleList.find(function(e){return e.RoleId===parseInt(t[0].OBJECTID)}),null!=t[0].LOOKUP&&(i.form.implementationlookup=i.form.lookups.find(function(e){return e.value.toUpperCase()===t[0].LOOKUP.toUpperCase()}));var n={selected:null,lookup:null},l=JSON.parse(t[0].REQUIRES);l.hasOwnProperty("LOOKUP")&&(n.selected="LOOKUP",n.lookup=i.lookupList.find(function(e){return e.value.toUpperCase()===l.LOOKUP.toUpperCase()})),l.hasOwnProperty("COMMENTS")&&(n.selected="COMMENTS"),i.form.implementationrequires=n}i.form.implementationSla=t[0].IMPLEMENTATIONSLA}}(e.ApprovalItemSettingsImplementation),function(e){i.form.rfiSla=null===e?4:0===e.RFISLA?4:e.RFISLA}(e.ApprovalItemSettingsRFI),i.formObj=JSON.parse(e.ApprovalItemForm.Form),i.form.approvalItemLabel=e.ApprovalItemDetail[0].ApprovalItemLabel,i.form.classificationId=e.ApprovalItemDetail[0].ClassificationId,i.form.requiresClassification=e.ApprovalItemDetail[0].RequiresClassification,i.blockObj=JSON.parse(e.ApprovalItemBlock.Form)})},this.RemoveStep=function(t){i.form.steps=i.form.steps.filter(function(e){return angular.toJson(e)!==angular.toJson(t)}),f()},this.GetRoleList=function(){return u.GetRoles().then(function(e){i.roleList=e})},this.GetStepReference=function(){return n.GetStepReference().then(function(e){i.stepTypes=e.StepTypeList,i.stepLevels=e.StepLevelList,i.stepDistinctions=e.StepDistinctionList,i.roleLookupReferences=e.RoleLookupReferenceList})},this.AddRole=function(e){e.Roles.push(e.selectedRole),e.selectedRole=null},this.RemoveRole=function(t,e){var n=i.form.steps.map(function(e){return e.id}).indexOf(e);i.form.steps[n].Roles=i.form.steps[n].Roles.filter(function(e){return angular.toJson(e)!==angular.toJson(t)})},this.AddLookup=function(){i.form.lookups.push(i.form.selectedLookup),i.form.selectedLookup=null},this.RemoveLookup=function(t){i.form.lookups=i.form.lookups.filter(function(e){return angular.toJson(e)!==angular.toJson(t)}),i.form.lookups.length<=0&&0<i.form.steps.length&&i.form.steps.forEach(function(e){e.Lookup=null})},this.GetApprovalItemTree=function(e){return t.GetApprovalItemTree(e).then(function(e){!function(e){var t=0;e.forEach(function(e){i.form.mainItems.push({id:e.ApprovalItemId,name:e.ApprovalItemName.EN,notes:e.ApprovalItemDescription.EN,refno:e.RefNo.split(".")[t],reflist:e.RefNo.split("."),isDisabled:!1}),t+=1}),"add"===i.manageType&&m()}(e)})},this.GetApprovalItemsByOrg=function(e){return t.GetApprovalItemsByOrg(e,!1).then(function(e){!function(e){i.referenceList=[],e.forEach(function(e){i.referenceList.push(e.RefNo.toLowerCase())})}(e)})},this.UpdateRefList=function(t,n){i.form.mainItems.forEach(function(e){void 0!==e.reflist[t]&&(e.reflist[t]=n)})},this.AddLevel=function(){m()},this.InitializeMainItem=function(e,t,n){e.isDisabled=""!==e.refno&&!t,e.level=n+1},this.SetSelectedMainItemIndex=function(e){i.selectedMainItemIndex=null,i.selectedMainItemIndex=e},this.SaveChanges=function(e){var t={ApprovalItemId:i.approvalItemId,ApprovalItems:function(e){var t=angular.copy(e),n=[];return t.forEach(function(e){n.push({Level:e.level,ApprovalItemId:e.id,ApprovalItemName:{EN:e.name},ApprovalItemDescription:{EN:e.notes},RefNo:e.reflist.join(".")})}),n}(i.form.mainItems),ApprovalItemSetting:function(e){var t=angular.copy(e),n=[];n.push({SettingType:"AUTO APPROVE",SettingValue:e.autoApprove?"Y":"N"}),n.push({SettingType:"COC SLA",SettingValue:e.cocSla}),t.requiresUpload&&n.push({SettingType:"UPLOAD",SettingValue:"REQUIRED"});0<t.lookups.length&&t.lookups.forEach(function(e){n.push({SettingType:"LOOKUP",SettingValue:e.value.toUpperCase()})});return n}(i.form),ApprovalItemStepDetail:function(e){var t=angular.copy(e),n=[];return t.steps.forEach(function(t){t.Roles.forEach(function(e){n.push({ExecutionOrder:t.Order,StepType:t.StepType.StepTypeCode,StepDistinction:t.StepDistinction.StepDistinctionCode,StepLevel:t.StepLevel.StepLevelCode,Sla:t.Sla,Lookup:null!==t.Lookup&&void 0!==t.Lookup?t.Lookup.value.toUpperCase():null,CostPointRoleId:e.RoleId,CostPointRoleName:e.RoleName,RoleType:e.RoleType})})}),n}(i.form),ApprovalItemSettingDetail:function(e){var t=angular.copy(e),n=[];if(i.form.requiresImplementation){var l={SettingType:t.implementationType,OBJECTID:null,OBJECTDISPLAYNAME:null,OBJECTEMAIL:null,REQUIRES:null,LOOKUP:null,IMPLEMENTATIONSLA:t.implementationSla};if("USER"===t.implementationType)l.OBJECTID=t.selectedImplementation.EMAIL_ADDRESS,l.OBJECTDISPLAYNAME=t.selectedImplementation.FULL_NAME,l.OBJECTEMAIL=t.selectedImplementation.EMAIL_ADDRESS,l.IMPLEMENTATIONSLA=t.implementationSla;else if("GROUP"===t.implementationType)l.OBJECTID=t.selectedImplementation.GroupId,l.OBJECTDISPLAYNAME=t.selectedImplementation.GroupName,l.IMPLEMENTATIONSLA=t.implementationSla;else if("ROLE"===t.implementationType){if(l.OBJECTID=t.selectedImplementation.RoleId,l.OBJECTDISPLAYNAME=t.selectedImplementation.RoleName,l.IMPLEMENTATIONSLA=t.implementationSla,"LOOKUP"===t.implementationrequires.selected){var o={LOOKUP:t.implementationrequires.lookup.value.toUpperCase()};l.REQUIRES=JSON.stringify(o)}if("COMMENTS"===t.implementationrequires.selected){l.REQUIRES=JSON.stringify({COMMENTS:"COMMENTS"})}null!=t.implementationlookup&&(l.LOOKUP=t.implementationlookup.value.toUpperCase())}n.push(l)}var r={SettingType:"NONE",OBJECTID:null,OBJECTDISPLAYNAME:null,OBJECTEMAIL:null,RFISLA:t.rfiSla};return n.push(r),n}(i.form),OrganizationCode:e,TransactionType:i.manageType,SectionUpdates:"add"===i.manageType?[]:function(e,t){var n=[],l=0;a.objectIsNullorUndefined(e.selectedclassification)||(l=e.selectedclassification.ClassificationId);angular.equals(e.mainItems,t.mainItems)&&angular.equals(e.approvalItemLabel,t.approvalItemLabel)&&angular.equals(l,t.classificationId)||n.push("ApprovalItems");e.requiresUpload!==t.requiresUpload&&n.push("ApprovalItemSettings");angular.equals(e.lookups,t.lookups)||n.push("ApprovalItemSettings");e.autoApprove!==t.autoApprove&&n.push("ApprovalItemSettings");e.cocSla!==t.cocSla&&n.push("ApprovalItemSettings");e.requiresImplementation!==t.requiresImplementation&&n.push("ApprovalImplementation");!0===e.requiresImplementation&&(e.implementationType!==t.implementationType&&n.push("ApprovalImplementation"),angular.equals(e.selectedImplementation,t.selectedImplementation)||n.push("ApprovalImplementation"),angular.equals(e.implementationSla,t.implementationSla)||n.push("ApprovalImplementation"),angular.equals(e.implementationrequires,t.implementationrequires)||n.push("ApprovalImplementation"),angular.equals(e.implementationlookup,t.implementationlookup)||n.push("ApprovalImplementation"));angular.equals(e.rfiSla,t.rfiSla)||n.push("RfiSla");angular.equals(e.steps,t.steps)||n.push("ApprovalSteps");return a.array_unique(n)}(i.form,i.originalForm),ApprovalItemLabel:i.form.approvalItemLabel,ClassificationId:function(e,t){return"Y"===e?t.ClassificationId:null}(i.form.requiresClassification,i.form.selectedclassification)};return n.SubmitApprovalItem(t).then(function(e){return e})},this.GetGroups=function(){if(i.groupList.length<=0)return l.GetGroups().then(function(e){i.groupList=e})},this.ValidateSubmit=function(){var e=[!angular.equals(i.form.mainItems,i.originalForm.mainItems)&&function(e){var t=angular.copy(e),l=angular.copy(i.originalForm),o=!1,r=['<h3 style="text-align: left;">Main</h3><ul style="text-align: left; font-size: 13px;">'];if(t.forEach(function(t){var e="<li><b>Level "+t.level+":</b>";if(""!==t.name&&null!==t.name||(o=!0,r.push(e+"Name cannot be empty/blank</li>")),""===t.refno||null===t.refno)o=!0,r.push(e+"Reference Number cannot be empty/blank</li>");else{var n=angular.copy(t.reflist.join("."));if("update"===i.manageType&&parseInt(i.approvalItemId)===parseInt(t.id))l.mainItems.find(function(e){return e.level===t.level}).reflist.join(".")!==n&&a.isInArray(n.toLowerCase(),i.referenceList)&&(o=!0,r.push(e+"Reference Number already exists</li>"));else"add"===i.manageType&&0===parseInt(t.id)&&a.isInArray(n.toLowerCase(),i.referenceList)&&(o=!0,r.push(e+"Reference Number already exists</li>"))}}),o)return r.push("</ul>"),r.join("");return!1}(i.form.mainItems),function(e){var t=angular.copy(e),n=!1,l=['<h3 style="text-align: left;">Approval Item Label</h3><ul style="text-align: left; font-size: 13px;">'];a.stringIsNullUndefinedOrEmpty(t)&&(n=!0,l.push("<li>Approval Item Label is required</li>"));if(n)return l.push("</ul>"),l.join("");return!1}(i.form.approvalItemLabel),function(e,t){var n=angular.copy(t),l=!1;if("Y"===e){var o=['<h3 style="text-align: left;">Classification</h3><ul style="text-align: left; font-size: 13px;">'];if(a.intIsNullorUndefinedorZero(n.ClassificationId)&&(l=!0,o.push("<li>Classification is required</li>")),l)return o.push("</ul>"),o.join("")}return!1}(i.form.requiresClassification,i.form.selectedclassification),function(e){var t=angular.copy(e),l=!1,o=['<h3 style="text-align: left;">Steps</h3><ul style="text-align: left; font-size: 13px;">'];t.length<=0?(l=!0,o.push("<li>No steps added</li>")):t.forEach(function(t){var n="<li><b>Step "+t.Order+":</b>";null===t.StepType&&(l=!0,o.push(n+"No step type selected</li>")),null===t.StepLevel&&(l=!0,o.push(n+"No step level selected</li>")),null===t.StepDistinction&&(l=!0,o.push(n+"No step distinction selected</li>")),t.Roles.length<=0&&(l=!0,o.push(n+"No approver/s selected</li>")),0<t.Roles.length&&t.Roles.forEach(function(e){!a.isInObjectArray(e.RoleId,"RoleId",i.roleLookupReferences)||null!==t.Lookup&&void 0!==t.Lookup||(l=!0,o.push(n+"No lookup selected</li>"))}),(t.Sla<0||null===t.Sla||""===t.Sla)&&(l=!0,o.push(n+"SLA Cannot be less than 0</li>"))});if(l)return o.push("</ul>"),o.join("");return!1}(i.form.steps)].filter(function(e){return!1!==e});if(0<e.length)return e.join("");return!0},this.CopyOriginalForm=function(){i.originalForm=angular.copy(i.form)},this.OnDragStep=function(e){i.form.steps.splice(e,1),f()},this.GetClassifications=d,this.GetOrganizationClassification=function(n){e.GetOrganizationLookup().then(function(e){var t=e.find(function(e){return e.OrganizationCode===n});i.form.requiresClassification=t.CLASSIFICATION,"Y"===i.form.requiresClassification&&d(n)})},this.ValidateRoleType=function(){for(var e=0;e<i.form.steps.length;e++)if(!a.objectIsNullorUndefined(i.form.steps[e].Roles)&&p(i.form.steps[e].Roles))return!0;return!1},this.ValidateLookup=p,Object.preventExtensions(i)}angular.module("myApp").service("AdminApprovalItemManageBusiness",e),e.$inject=["AdminApprovalItemManageStore","AdminApprovalItemManageService","astigUtilityService","LookupService","ApprovalItemTreeviewComponentService","AdminGroupService","ApprovalItemsDetailsService","LookupReferenceList","AdminClassificationService","AdminRoleService","UtilService"]}(),function(){"use strict";function e(t,l,e,n,o,r,i,a,s,u,c,d,p,m,f){function g(){l.ClearForm(),l.GetApprovalItemTree(n.params.id).then(function(){l.GetApprovalItemDetails(n.params.id).then(function(){l.CopyOriginalForm(),"Y"===t.form.requiresClassification&&l.GetClassifications(n.params.division)})})}this.model=t,this.events={onClick_AddStep:function(){l.AddStep()},onClick_RemoveStep:function(e){l.RemoveStep(e)},onClick_AddRole:function(e){null!==e.selectedRole&&(i.isInObjectArray(e.selectedRole.RoleId,"RoleId",e.Roles)?e.selectedRole=null:l.AddRole(e))},onClick_RemoveRole:function(e,t){l.RemoveRole(e,t)},onClick_AddLookup:function(){null!==t.form.selectedLookup&&(i.isInObjectArray(t.form.selectedLookup.value,"value",t.form.lookups)?t.form.selectedLookup=null:l.AddLookup())},onClick_RemoveLookup:function(e){l.RemoveLookup(e)},onChange_UpdateRefList:function(e,t){l.UpdateRefList(e,t)},onClick_AddLevel:function(){l.AddLevel()},onInitialize_MainItem:function(e,t,n){l.InitializeMainItem(e,t,n)},onClick_SaveChanges:function(){var e=l.ValidateSubmit();!0!==e?a.alertWarning("Error",e,"none"):l.SaveChanges(n.params.division).then(function(e){null!==e&&(a.alertSuccess("Success","Successfully saved",3e3),"add"===t.manageType?(t.ClearStore(),n.go("am.admin.approvalitemsmanage",{division:n.params.division,type:"update",id:e})):"update"===t.manageType&&g())})},onChange_RequiresImplementation:function(){t.form.requiresImplementation||(t.form.implementationType="USER",t.form.selectedImplementation=null)},onChange_ImplementationType:function(){t.form.selectedImplementation=null,"GROUP"===t.form.implementationType&&l.GetGroups()},onChange_OpenNote:function(e){l.SetSelectedMainItemIndex(e),angular.element("#noteApprovalItemModal").modal("show")},onClick_Block:function(){angular.element("#blockApprovalItemModal").modal("show"),c.SetBlock()},onClick_Form:function(){angular.element("#formApprovalItemModal").modal("show"),d.SetForm()},getToolbarConfig:function(){return s},onDrag_Step:function(e){l.OnDragStep(e)},onClick_Notification:function(){angular.element("#notificationApprovalItemModal").modal("show"),p.GetSettings(t.approvalItemId,"NOTIFICATION")},onClick_CopyForm:function(){angular.element("#copyFormApprovalItemModal").modal("show"),d.SetForm(),d.GetOrganizationLookup()},onValidate_RoleType:function(){return l.ValidateRoleType()},onValidate_Lookup:function(e){return l.ValidateLookup(e)},onClick_AssignConcurrectSteps:function(){angular.element("#concurrentApprovalItemstepModal").modal("show"),m.GetApprovalItemConcurrentSteps(t.approvalItemId)},onClick_AssignDocuments:function(){angular.element("#approvalitemdocumentsModal").modal("show"),f.GetApprovalDocuments(t.approvalItemId)},isRoleRequiresLookup:function(){if(null!==t.form.selectedImplementation&&"ROLE"===t.form.implementationType)return"LOOKUP"===t.form.selectedImplementation.RoleType||"CONDITIONAL LOOKUP"===t.form.selectedImplementation.RoleType;return!1}},function(){if(t.lookupList=r,t.manageType=n.params.type,t.approvalItemId=void 0===n.params.id?0:n.params.id,t.organization=void 0===n.params.division?null:n.params.division,l.GetRoleList(),l.GetStepReference(),l.GetGroups(),void 0===n.params.id){for(var e=0;e<=1;e++)l.AddLevel();l.GetOrganizationClassification(n.params.division)}else"update"===t.manageType?g():(l.GetApprovalItemTree(n.params.id),l.GetOrganizationClassification(n.params.division))}(),o.$on("$destroy",function(){t.ClearStore()})}angular.module("myApp").controller("AdminApprovalItemManageController",e),e.$inject=["AdminApprovalItemManageStore","AdminApprovalItemManageBusiness","$base64","$state","$scope","LookupReferenceList","astigUtilityService","sweetDialogAlertService","TextAngularToolbarConfig","AdminApprovalItemManageService","AdminApprovalItemManageBlockComponentBusiness","AdminApprovalItemManageFormComponentBusiness","ApprovalItemSettingsComponentBusiness","AdminApprovalItemConcurrentStepComponentBusiness","AdminApprovalItemDocumentComponentBusiness"]}(),function(){"use strict";function e(t){this.GetStepReference=function(){return t.Get(n+"GetStepReferences",{cache:!0}).then(function(e){return e})},this.SubmitApprovalItem=function(e){return t.Post(n+"ApprovalItemInsertUpdate",e).then(function(e){return e})},this.DeleteFormBlock=function(e){return t.Post(n+"ApprovalItemFormBlockDelete",e).then(function(e){return e})};var n=ApiRootDirectory.absoluteRootUrl+"api/ApprovalItem/Admin/"}angular.module("myApp").service("AdminApprovalItemManageService",e),e.$inject=["DataAccess"]}(),function(){"use strict";function e(){function e(){this.approvalItemId=0,this.manageType=null,this.organization=null,this.referenceList=[],this.classificationList=[],this.formObj={},this.blockObj={},this.stepTypes=[],this.stepLevels=[],this.stepDistinctions=[],this.roleLookupReferences=[],this.roleList=[],this.lookupList=[],this.groupList=[],this.selectedMainItemIndex=null,this.form={mainItems:[],approvalItemLabel:"",classificationId:null,selectedclassification:null,requiresClassification:"N",isApprovalItem:!1,requiresImplementation:!1,requiresUpload:!1,selectedLookup:null,lookups:[],steps:[],implementationType:"USER",selectedImplementation:null,selectedStep:null,implementationSla:4,rfiSla:4,autoApprove:!0,cocSla:4,implementationlookup:null,implementationrequires:{selected:null,lookup:null}},this.originalForm={}}return e.prototype.ClearStore=function(){this.approvalItemId=0,this.manageType=null,this.organization=null,this.referenceList=[],this.classificationList=[],this.formObj={},this.blockObj={},this.stepTypes=[],this.stepLevels=[],this.stepDistinctions=[],this.roleLookupReferences=[],this.roleList=[],this.lookupList=[],this.groupList=[],this.selectedMainItemIndex=null,this.form={mainItems:[],approvalItemLabel:"",classificationId:null,selectedclassification:null,requiresClassification:"N",isApprovalItem:!1,requiresImplementation:!1,requiresUpload:!1,selectedLookup:null,lookups:[],steps:[],implementationType:"USER",selectedImplementation:null,selectedStep:null,implementationSla:4,rfiSla:4,autoApprove:!0,cocSla:4,implementationlookup:null,implementationrequires:{selected:null,lookup:null}},this.originalForm={}},new e}angular.module("myApp").factory("AdminApprovalItemManageStore",e),e.$inject=[]}(),function(){"use strict";function e(e,l,t,n){this.SetBlock=function(){e.form=t.blockObj,e.originalForm=angular.copy(e.form)},this.SubmitBlock=function(e,t){var n={ApprovalItemId:e,FormType:"BLOCK",ApprovalItemForm:{Name:t.Name,Value:t.Value}};return l.SubmitBlockForm(n).then(function(e){return e})},this.DeleteBlock=function(e){var t={ApprovalItemId:e,FormType:"BLOCK"};return n.DeleteFormBlock(t).then(function(e){return e})},Object.preventExtensions(e)}angular.module("myApp").service("AdminApprovalItemManageBlockComponentBusiness",e),e.$inject=["AdminApprovalItemManageBlockComponentStore","AdminApprovalItemManageBlockComponentService","AdminApprovalItemManageStore","AdminApprovalItemManageService"]}(),function(){"use strict";function e(e,t,n,l,o,r){var i=this;i.model=t,i.events={getToolbarConfig:function(){return n},onClick_SubmitBlock:function(){e.SubmitBlock(i.approvalItemId,i.model.form).then(function(e){null===e&&(r.blockObj=t.form,t.originalForm=angular.copy(t.form),angular.element("#blockApprovalItemModal").modal("hide"),l.alertSuccess("Success","Successfully saved block",3e3))})},ValidateBlockForm:function(e){return null!==e?(void 0===e.Name&&(e.Name="",e.Value=""),null===e.Name||null===e.Value||""===e.Name||""===e.Value):(e={Name:null,Value:null},!0)},onClick_DeleteBlock:function(){e.DeleteBlock(i.approvalItemId).then(function(e){null===e&&(t.form={},r.blockObj=null,t.originalForm=angular.copy(t.form),angular.element("#blockApprovalItemModal").modal("hide"),l.alertSuccess("Success","Successfully deleted block",3e3))})}},o.$on("$destroy",function(){t.ClearStore()})}angular.module("myApp").component("blockAdminModalComponent",{templateUrl:"app/views/admin/approvalitems/component/block.html",controller:e,controllerAs:"vm",bindings:{approvalItemId:"="}}),e.$inject=["AdminApprovalItemManageBlockComponentBusiness","AdminApprovalItemManageBlockComponentStore","TextAngularToolbarConfig","sweetDialogAlertService","$scope","AdminApprovalItemManageStore"]}(),function(){"use strict";function e(t){this.SubmitBlockForm=function(e){return t.Post(n+"ApprovalItemBlockInsertUpdate",e).then(function(e){return e})};var n=ApiRootDirectory.absoluteRootUrl+"api/approvalitem/admin/"}angular.module("myApp").service("AdminApprovalItemManageBlockComponentService",e),e.$inject=["DataAccess"]}(),function(){"use strict";function e(){function e(){this.form={},this.originalForm={}}return e.prototype.ClearStore=function(){this.form={},this.originalForm={}},new e}angular.module("myApp").factory("AdminApprovalItemManageBlockComponentStore",e),e.$inject=[]}(),function(){"use strict";function e(l,o,r){this.GetApprovalItemConcurrentSteps=function(e){var t={RoleId:-99999965,Parameters:{Id:e,Data:"CONCURRENTSTEPS"}};o.GetApprovalItemConcurrentSteps(t).then(function(e){!function(e){l.approvalItemConcurrentStepsRef=[],e.forEach(function(e){var t={};e.Value.forEach(function(e){t[e.Key]=e.Value}),l.approvalItemConcurrentStepsRef.push(t)}),l.approvalItemConcurrentSteps=angular.copy(l.approvalItemConcurrentStepsRef)}(e)})},this.AssignConcurrentSteps=function(e){var t=l.approvalItemConcurrentSteps.filter(function(e){return!r.stringIsNullUndefinedOrEmpty(e.ApprovalItemConcurrentStepGroupName)}),n={ApprovalItemId:e,ConcurrentSteps:t};return o.AssignConcurrentSteps(n).then(function(e){return e})},Object.preventExtensions(l)}angular.module("myApp").service("AdminApprovalItemConcurrentStepComponentBusiness",e),e.$inject=["AdminApprovalItemConcurrentStepComponentStore","AdminApprovalItemConcurrentStepComponentService","astigUtilityService"]}(),function(){"use strict";function e(e,t,i,n,l,o){var a=this;a.model=t,a.events={onClick_Save:function(){!function(){var o={},r=!0;return a.model.approvalItemConcurrentSteps.forEach(function(e){1<=e.ApprovalItemConcurrentStepGroupName.length&&(o.hasOwnProperty(e.ApprovalItemConcurrentStepGroupName)||(o[e.ApprovalItemConcurrentStepGroupName]=[]),o[e.ApprovalItemConcurrentStepGroupName].push(e))}),Object.keys(o).forEach(function(e){var t=o[e].length,n=[];if(t<=1)return i.alertWarning("Warning","Group "+e+" should have at least 2 steps.","none"),void(r=!1);var l=o[e][0];return 0<o[e].filter(function(e){return e.StepType!==l.StepType||e.StepLevel!==l.StepLevel}).length?(i.alertWarning("Warning","Concurrent steps of Group "+e+" should have the same step level and step type","none"),void(r=!1)):(o[e].forEach(function(e){n.push(e.ExecutionOrder)}),function(e){for(var t=1;t<e.length;t++)if(parseInt(e[t])!==parseInt(e[t-1])+1)return!1;return!0}(n)?void 0:(i.alertWarning("Warning","Concurrent steps of Group "+e+" should be sequential","none"),void(r=!1)))}),r}()||e.AssignConcurrentSteps(a.approvalItemId).then(function(e){i.alertSuccess("Success","Successfully saved!",3e3),angular.element("#concurrentApprovalItemstepModal").modal("hide")})}},a.validations={HasConcurrentStepChanges:function(){return angular.equals(a.model.approvalItemConcurrentSteps,a.model.approvalItemConcurrentStepsRef)}},n.$on("$destroy",function(){t.ClearStore()})}angular.module("myApp").component("concurrentStepComponent",{templateUrl:"app/views/admin/approvalitems/component/concurrentsteps.html",controller:e,controllerAs:"vm",bindings:{approvalItemId:"="}}),e.$inject=["AdminApprovalItemConcurrentStepComponentBusiness","AdminApprovalItemConcurrentStepComponentStore","sweetDialogAlertService","$scope","$state","astigUtilityService"]}(),function(){"use strict";function e(t){this.GetApprovalItemConcurrentSteps=function(e){return t.Post(n,e).then(function(e){return e})},this.AssignConcurrentSteps=function(e){return t.Post(l+"AssignConcurrentSteps",e).then(function(e){return e})};var n=ApiRootDirectory.absoluteRootUrl+"api/Generic/Data",l=ApiRootDirectory.absoluteRootUrl+"api/ApprovalItem/Admin/"}angular.module("myApp").service("AdminApprovalItemConcurrentStepComponentService",e),e.$inject=["DataAccess"]}(),function(){"use strict";function e(){function e(){this.approvalItemConcurrentStepsRef=[],this.approvalItemConcurrentSteps=[]}return e.prototype.ClearStore=function(){this.approvalItemConcurrentStepsRef=[],this.approvalItemConcurrentSteps=[]},new e}angular.module("myApp").factory("AdminApprovalItemConcurrentStepComponentStore",e),e.$inject=[]}(),function(){"use strict";function e(n,l,e){this.ClearForm=function(){n.Form={documenttype:null,notes:null,required:"N",multiple:"N"}},this.GetApprovalDocuments=function(e){var t={RoleId:-88888888,Parameters:{DATA:"APPROVALITEMDOCUMENTS",ApprovalItemId:e}};n.ApprovalItemId=e,l.GetData(t).then(function(e){n.Documents=e,n.RefDocuments=angular.copy(n.Documents)})},this.SubmitTransaction=function(){var e={RoleId:-88888887,Parameters:{DATA:"SAVEAPPROVALITEMDOCUMENTS",ApprovalItemId:n.ApprovalItemId,Document_LIST:angular.toJson(n.Documents)}};return l.SubmitTransaction(e).then(function(e){return e})},Object.preventExtensions(n)}angular.module("myApp").service("AdminApprovalItemDocumentComponentBusiness",e),e.$inject=["AdminApprovalItemDocumentComponentStore","GenericDataService","astigUtilityService"]}(),function(){"use strict";function e(n,e,l,t,o,r){var i=this;i.model=e,i.events={Add:function(){var e=i.model.Documents.find(function(e){return e.SettingValue===i.model.Form.documenttype.SettingValue});if(r.objectIsNullorUndefined(e)){var t={SettingType:"DOCUMENT",SettingValue:angular.copy(i.model.Form.documenttype.SettingValue),Title:angular.copy(i.model.Form.documenttype.Title),Required:i.model.Form.required,Multiple:i.model.Form.multiple,Notes:i.model.Form.notes};i.model.Documents.unshift(t)}else l.alertWarning("Duplicate Entry","This document type already exists","none");n.ClearForm()},Clear:function(){n.ClearForm()},Delete:function(t){i.model.Documents=i.model.Documents.filter(function(e){return angular.toJson(e)!==angular.toJson(t)})},Save:function(){l.alertConfirm("Saving Changes","Are you sure you want to save the changes?",function(){return n.SubmitTransaction().then(function(e){"SUCCESS"===e[0].StatusCode&&(l.alertSuccess("Success","Changes were saved successfully!",3e3),n.ClearForm(),angular.element("#approvalitemdocumentsModal").modal("hide"))})},function(){},"Yes","No",!0)}},i.validations={onAddDocument:function(){return r.objectIsNullorUndefined(i.model.Form.documenttype)},onSaveChanges:function(){return angular.equals(angular.toJson(i.model.Documents),angular.toJson(i.model.RefDocuments))}},t.$on("$destroy",function(){e.ClearStore()})}angular.module("myApp").component("documentComponent",{templateUrl:"app/views/admin/approvalitems/component/documents.html",controller:e,controllerAs:"vm",bindings:{approvalItemId:"="}}),e.$inject=["AdminApprovalItemDocumentComponentBusiness","AdminApprovalItemDocumentComponentStore","sweetDialogAlertService","$scope","$state","astigUtilityService"]}(),function(){"use strict";function e(){function e(){this.ApprovalItemId=0,this.Documents=[],this.RefDocuments=[],this.Form={documenttype:null,notes:null,required:"N",multiple:"N"},this.ReferenceList={documenttypes:[{SettingValue:"AA_CONTRACTCHANGE",Title:"Signed Contract / Change Order"},{SettingValue:"AB_SIGNEDCONTRACT",Title:"Signed Contract"},{SettingValue:"AC_CHANGEORDER",Title:"Signed Change Order"},{SettingValue:"DA_PRICING",Title:"Pricing Tool"},{SettingValue:"CA_WRITTENPERMISSION",Title:"Written Permission"},{SettingValue:"EA_AGGREMENTSETUPFORM",Title:"Agreement Setup Form "},{SettingValue:"FA_MARGINANALYSIS",Title:"Margin Analysis"},{SettingValue:"BA_RISKEVALUATION",Title:"Risk Evaluation"},{SettingValue:"GA_RCR",Title:"RCR Form"},{SettingValue:"ZA_SUPPORTING",Title:"Support Document"}]}}return e.prototype.ClearStore=function(){this.ApprovalItemId=0,this.Documents=[],this.RefDocuments=[],this.Form={documenttype:null,notes:null,required:"N",multiple:"N"}},new e}angular.module("myApp").factory("AdminApprovalItemDocumentComponentStore",e),e.$inject=[]}(),function(){"use strict";function e(n,l,r,e,i,t,o,a,s){function u(e,t,n,l){var o=angular.copy(e);return o.ControlType=n,o.ControlID=l+t,o.Property.IsRequired=!0,o.Columns=[],o}this.SetForm=function(){angular.equals(n.originalForm,{})?(n.form=e.formObj,n.originalForm=angular.copy(n.form)):n.form=angular.copy(n.originalForm)},this.GetOrganizationLookup=function(){return n.orgList=[],n.selectedOrg=null,n.selectedApprovalItem=null,n.approvalItemList=[],t.GetOrganizationLookup().then(function(e){n.orgList=e})},this.GetApprovalItem=function(e){return n.approvalItemList=[],o.GetApprovalItemsByOrg(e,!0).then(function(e){!function t(e){e.forEach(function(e){e.children.length<=0?(e.label=e.RefNo+" - "+e.ApprovalItemName.EN,n.approvalItemList.push(e)):t(e.children)})}(r.listToTree(e,"ApprovalItemId","ApprovalItemParentId","children"))})},this.AddItemValues=function(e,t){var n=r.guid().split("-");n=n.join("");var l={Dependency:{ControlID:null,ControlValues:[],Actions:null},KeyID:function(e){{if(e===i.Checkbox)return"cb_i_";if(e===i.Dropdown)return"dd_i_";if(e===i.Radiobutton)return"rdb_i_"}}(t)+n,Label:{EN:e.addValue,ES:e.addValue}};t===i.Checkbox&&(l.isChecked=!1);e.ItemValues.push(l)},this.RemoveItemValue=function(t,e){e.ItemValues=e.ItemValues.filter(function(e){return angular.toJson(e)!==angular.toJson(t)})},this.RemoveRow=function(t){n.form.Rows=n.form.Rows.filter(function(e){return angular.toJson(e)!==angular.toJson(t)})},this.AddRow=function(e){var t={Controls:[],ddControl:i.Textbox,id:r.guid()};angular.isDefined(n.form.Rows)?n.form.Rows.splice(e,0,t):(n.form.Rows=[],n.form.Rows.push(t))},this.AddControl=function(e,t){var n=r.guid().split("-");n=n.join("");var l=angular.copy(s.FormCreation);e===i.Textbox?t.Controls.push(function(e,t){var n=angular.copy(e);return n.Property.Max=250,n.Property.IsRequired=!0,n.InputType="text",n.ControlType=i.Textbox,n.ControlID="tb_"+t,n}(l,n)):e===i.Checkbox?t.Controls.push(function(e,t){var n=angular.copy(e);return n.Property.IsRequired=!0,n.InputType=null,n.ControlType=i.Checkbox,n.ControlID="cb_"+t,n.ItemValues=[],n}(l,n)):e===i.Dropdown?t.Controls.push(function(e,t){var n=angular.copy(e);return n.ItemValues=[],n.ControlType=i.Dropdown,n.ControlID="dd_"+t,n.Property.IsRequired=!0,n}(l,n)):e===i.Radiobutton?t.Controls.push(function(e,t){var n=angular.copy(e);return n.ItemValues=[],n.ControlType=i.Radiobutton,n.ControlID="rb_"+t,n.Property.IsRequired=!0,n}(l,n)):e===i.Textarea?t.Controls.push(function(e,t){var n=angular.copy(e);return n.Property.Max=500,n.ControlType=i.Textarea,n.ControlID="ta_"+t,n}(l,n)):e===i.Table?t.Controls.push(function(e,t){var n=angular.copy(e);return n.Columns=[],n.Rows=[],n.ControlType=i.Table,n.ControlID="tbl_"+t,n}(l,n)):e===i.InactiveProjectTemplate?t.Controls.push(u(l,n,i.InactiveProjectTemplate,"inctvprjtmplte_")):e===i.BankAccountTemplate?t.Controls.push(u(l,n,i.BankAccountTemplate,"bnkccnttmplte_")):e===i.OrganizationTemplate?t.Controls.push(u(l,n,i.OrganizationTemplate,"orgtmplte_")):e===i.OpportunityTemplate?t.Controls.push(u(l,n,i.OpportunityTemplate,"opptmplte_")):e===i.CashAccountTemplate?t.Controls.push(u(l,n,i.CashAccountTemplate,"cshacctmplte_")):e===i.ClientTemplate?t.Controls.push(u(l,n,i.ClientTemplate,"clnttmplte_")):e===i.CompanyTemplate?t.Controls.push(u(l,n,i.CompanyTemplate,"cmpnytmplte_")):e===i.AgreementTemplate?t.Controls.push(u(l,n,i.AgreementTemplate,"agnttmplte_")):e===i.ClientActiveCRMTemplate?t.Controls.push(u(l,n,i.ClientActiveCRMTemplate,"clntactvcrmtmplte_")):e===i.AgreementProjectTemplate?t.Controls.push(u(l,n,i.AgreementProjectTemplate,"agntprojtmplte_")):e===i.OverheadProjectTemplate?t.Controls.push(u(l,n,i.OverheadProjectTemplate,"ohprjttmplte_")):e===i.AgreementOpportunityProjectTemplate?t.Controls.push(u(l,n,i.AgreementOpportunityProjectTemplate,"agntoppprjtmplte_")):e===i.DivisionTemplate?t.Controls.push(u(l,n,i.DivisionTemplate,"dvsntmplte_")):e===i.PursuitProjectTemplate?t.Controls.push(u(l,n,i.PursuitProjectTemplate,"prstprjtmplte_")):e===i.InactiveOrgTemplate?t.Controls.push(u(l,n,i.InactiveOrgTemplate,"inctvorgtmplte_")):e===i.MasterContractTemplate?t.Controls.push(u(l,n,i.MasterContractTemplate,"mstcntrcttmplte_")):e===i.ProjectOpportunityTemplate?t.Controls.push(u(l,n,i.ProjectOpportunityTemplate,"prjopptmplte_")):e===i.EmployeeTemplate?t.Controls.push(u(l,n,i.EmployeeTemplate,"emptmplte_")):e===i.DivisionSpecificEmployeeTemplate?t.Controls.push(u(l,n,i.DivisionSpecificEmployeeTemplate,"divspecemptmplte_")):e===i.DirProjectTemplate?t.Controls.push(u(l,n,i.DirProjectTemplate,"dirprjtmplte_")):e===i.CostCenterInactiveTemplate?t.Controls.push(u(l,n,i.CostCenterInactiveTemplate,"ccincttmplte_")):e===i.ParentProjectTemplate?t.Controls.push(u(l,n,i.ParentProjectTemplate,"prntprjtmplte_")):e===i.UltimateClientTemplate?t.Controls.push(u(l,n,i.UltimateClientTemplate,"ultclntmplte_")):e===i.AgreementProjectClosedTemplate?t.Controls.push(u(l,n,i.AgreementProjectClosedTemplate,"agrmntprojclsedtmplte")):e===i.ClientCustomerAllActiveTemplate?t.Controls.push(u(l,n,i.ClientCustomerAllActiveTemplate,"clnctmrallacttmplte_")):e===i.ClientCustomerERPTemplate?t.Controls.push(u(l,n,i.ClientCustomerERPTemplate,"clnctmrerptmplte_")):e===i.CustomerActiveERPTemplate?t.Controls.push(u(l,n,i.CustomerActiveERPTemplate,"ctmracterptmplte_")):e===i.OpportunityInactiveTemplate?t.Controls.push(u(l,n,i.OpportunityInactiveTemplate,"oppinacttmplte_")):e===i.VendorTemplate?t.Controls.push(u(l,n,i.VendorTemplate,"ventmplte_")):e===i.LocationTemplate?t.Controls.push(u(l,n,i.LocationTemplate,"loctmplte_")):e===i.AreasTemplate?t.Controls.push(u(l,n,i.AreasTemplate,"arstmplte_")):e===i.DistrictsTemplate?t.Controls.push(u(l,n,i.DistrictsTemplate,"dstrstmplte_")):e===i.AgreementClosedTemplate?t.Controls.push(u(l,n,i.AgreementClosedTemplate,"agrmntclsdtmplte_")):e===i.ProjectAllActiveTemplate?t.Controls.push(u(l,n,i.ProjectAllActiveTemplate,"prjallacttmplte_")):e===i.ProjectDirectClosedTemplate?t.Controls.push(u(l,n,i.ProjectDirectClosedTemplate,"prjdirclstmplte_")):e===i.EmployeeInactiveTemplate?t.Controls.push(u(l,n,i.EmployeeInactiveTemplate,"emplinacttmplte_")):e===i.PursuitProjectClosedTemplate?t.Controls.push(u(l,n,i.PursuitProjectClosedTemplate,"purstprjctclsdtmplte_")):e===i.ProjectIndirectActiveTemplate?t.Controls.push(u(l,n,i.ProjectIndirectActiveTemplate,"prjindiracttmplte_")):e===i.ProjectIndirectInactiveTemplate?t.Controls.push(u(l,n,i.ProjectIndirectInactiveTemplate,"prjindirinacttmplte_")):e===i.OpportunityAgreementProjectSpecialTemplate?t.Controls.push(u(l,n,i.OpportunityAgreementProjectSpecialTemplate,"oppagrprjspcltmplte_")):e===i.OpportunitySpecialTemplate?t.Controls.push(u(l,n,i.OpportunitySpecialTemplate,"oppspcltmplte_")):e===i.GngFormTemplate?t.Controls.push(u(l,n,i.GngFormTemplate,"gngformtmplte_")):e===i.GngPreliminaryFormTemplate?t.Controls.push(u(l,n,i.GngPreliminaryFormTemplate,"gngprelimformtmplte_")):e===i.OpportunityAgreementProjectFormTemplate?t.Controls.push(u(l,n,i.OpportunityAgreementProjectFormTemplate,"oppagrprojformtmplte_")):e===i.OpportunityFormTemplate?t.Controls.push(u(l,n,i.OpportunityFormTemplate,"oppformtmplte_")):e===i.GngLeadFormTemplate?t.Controls.push(u(l,n,i.GngLeadFormTemplate,"gngleadformtmplte_")):e===i.CascadingOracleHierarchyTemplate?t.Controls.push(u(l,n,i.CascadingOracleHierarchyTemplate,"cscdngorclhrchytmplte_")):e===i.WorkAtRiskFormTemplate?t.Controls.push(u(l,n,i.WorkAtRiskFormTemplate,"warformtmplte_")):e===i.EaNpWithOpportunityFormTemplate?t.Controls.push(u(l,n,i.EaNpWithOpportunityFormTemplate,"eanpwithformtmplte_")):e===i.EaNpWithOpportunityWarFormTemplate?t.Controls.push(u(l,n,i.EaNpWithOpportunityWarFormTemplate,"eanpwarwithformtmplte_")):e===i.NaNpWithOpportunityFormTemplate?t.Controls.push(u(l,n,i.NaNpWithOpportunityFormTemplate,"nanpwithformtmplte_")):e===i.NaNpSansOpportunityFormTemplate?t.Controls.push(u(l,n,i.NaNpSansOpportunityFormTemplate,"nanpsansformtmplte_")):e===i.NaNpSansOpportunityWarFormTemplate?t.Controls.push(u(l,n,i.NaNpSansOpportunityWarFormTemplate,"nanpsanswarformtmplte_")):e===i.EaNpWithOpportunityWithFundingFormTemplate?t.Controls.push(u(l,n,i.EaNpWithOpportunityWithFundingFormTemplate,"eanpwithoppwithfundformtmplte_")):e===i.NaNpWithOpportunityWithFundingFormTemplate?t.Controls.push(u(l,n,i.NaNpWithOpportunityWithFundingFormTemplate,"nanpwithoppwithfundformtmplte_")):e===i.NaNpWithFundingSansOpportunityFormTemplate?t.Controls.push(u(l,n,i.NaNpWithFundingSansOpportunityFormTemplate,"nanpwithfundsansformtmplte_")):e===i.EaNpSansOpportunityFormTemplate?t.Controls.push(u(l,n,i.EaNpSansOpportunityFormTemplate,"eanpsansformtmplte_")):e===i.EaNpSansOpportunityWarFormTemplate?t.Controls.push(u(l,n,i.EaNpSansOpportunityWarFormTemplate,"eanpsanswarformtmplte_")):e===i.EaNpWithFundingSansOpportunityFormTemplate?t.Controls.push(u(l,n,i.EaNpWithFundingSansOpportunityFormTemplate,"eanpwithfundsansformtmplte_")):e===i.ProjectUpdateFormTemplate?t.Controls.push(u(l,n,i.ProjectUpdateFormTemplate,"prjctupdateformtmplte_")):e===i.WarExtensionFormTemplate?t.Controls.push(u(l,n,i.WarExtensionFormTemplate,"warextnsnformtmplte_")):e===i.AgreementSpecialTemplate?t.Controls.push(u(l,n,i.AgreementSpecialTemplate,"agrspclmplte_")):e===i.NaNpWithOpportunityWarFormTemplate&&t.Controls.push(u(l,n,i.NaNpWithOpportunityWarFormTemplate,"nanpwarwithformtmplte_"))},this.IsInControl=function(e){if(3<=e.length)return!1;if(0<e.length){for(var t=0;t<e.length;t++){if(-1<e[t].ControlType.indexOf("Template"))return!1;if(e[t].ControlType===i.Table)return!1}return!0}return!0},this.RemoveControl=function(t,e){e.Controls=e.Controls.filter(function(e){return angular.toJson(e)!==angular.toJson(t)})},this.AddTableColumn=function(e){e.Columns.push({ColumnHeader:e.addValueColumn})},this.RemoveTableColumn=function(t,e){e.Columns=e.Columns.filter(function(e){return angular.toJson(e)!==angular.toJson(t)})},this.AddTableRowColumn=function(e){var l=angular.copy(s.FormCreation);l.ControlType=i.Textbox;var o=[];e.Columns.forEach(function(e){var t=r.guid().split("-");t=t.join("");var n=angular.copy(l);n.ControlId=null,n.ControlId="tbc_"+t,o.push(n)}),e.Rows.push({id:r.guid(),Controls:o})},this.RemoveTableRowColumn=function(t,e){e.Rows=e.Rows.filter(function(e){return angular.toJson(e)!==angular.toJson(t)})},this.SubmitForm=function(e){var t={FormType:"FORM",ApprovalItemId:e,ApprovalItemForm:n.form};return l.SubmitForm(t).then(function(e){return e})},this.DeleteForm=function(e){var t={ApprovalItemId:e,FormType:"FORM"};return a.DeleteFormBlock(t).then(function(e){return e})},Object.preventExtensions(n)}angular.module("myApp").service("AdminApprovalItemManageFormComponentBusiness",e),e.$inject=["AdminApprovalItemManageFormComponentStore","AdminApprovalItemManageFormComponentService","astigUtilityService","AdminApprovalItemManageStore","FormControls","LookupService","ApprovalItemTreeviewComponentService","AdminApprovalItemManageService","DefaultFormControlProperties"]}(),function(){"use strict";function e(n,t,l,e,o,r,i,a){var s=this;s.model=t,s.events={getToolbarConfig:function(){return e},onClick_AddItemValues:function(t,e){if(void 0!==t.addValue){if(null!==t.addValue||""!==t.addValue)void 0===t.ItemValues.find(function(e){return e.Label.EN===t.addValue})&&n.AddItemValues(t,e)}t.addValue=null},onClick_RemoveItemValue:function(e,t){n.RemoveItemValue(e,t)},onClick_RemoveRow:function(e){n.RemoveRow(e)},onClick_AddRow:function(e){n.AddRow(e)},onClick_AddControl:function(e,t){t.Controls.length<=3&&n.AddControl(e,t);t.ddControl=r.Textbox},onInit_Row:function(e){e.ddControl=r.Textbox},isInControl:function(e){return n.IsInControl(e)},onClick_RemoveControl:function(e,t){n.RemoveControl(e,t)},ifNoForm:function(){angular.isUndefined(t.form.Rows)&&(t.form.Rows=[])},onClick_AddTableColumn:function(e){n.AddTableColumn(e),e.addValueColumn=null},onClick_RemoveTableColumn:function(e,t){n.RemoveTableColumn(e,t)},onClick_AddTableRowColumn:function(e){n.AddTableRowColumn(e)},onClick_RemoveTableRowColumn:function(e,t){n.RemoveTableRowColumn(e,t)},onClick_SubmitForm:function(){n.SubmitForm(s.approvalItemId).then(function(e){null===e&&(a.formObj=t.form,t.originalForm=angular.copy(t.form),angular.element("#formApprovalItemModal").modal("hide"),l.alertSuccess("Success","Successfully saved form",3e3))})},onSelect_Organization:function(){n.GetApprovalItem(t.selectedOrg.OrganizationCode)},onClick_CopyForm:function(){l.alertConfirm("Confirm Copy Form","Are you sure you want to copy form to  "+t.selectedApprovalItem.ApprovalItemName.EN+"?",function(){n.SubmitForm(t.selectedApprovalItem.ApprovalItemId).then(function(e){null===e&&l.alertConfirm("Successfully copied form to "+t.selectedApprovalItem.ApprovalItemName.EN,"Do you want to be redirected to the approval item?",function(){i.go("am.admin.approvalitemsmanage",{division:t.selectedOrg.OrganizationCode,type:"update",id:t.selectedApprovalItem.ApprovalItemId},{reload:!0}),angular.element("#copyFormApprovalItemModal").modal("hide")},function(){t.originalForm=angular.copy(t.form),angular.element("#copyFormApprovalItemModal").modal("hide")},"Yes, redirect me to the approval item","No, I'll stay here",!0)})},angular.noop,"Yes","No",!0)},onClick_DeleteForm:function(){n.DeleteForm(s.approvalItemId).then(function(e){null===e&&(t.form={},a.formObj=null,t.originalForm=angular.copy(t.form),angular.element("#formApprovalItemModal").modal("hide"),l.alertSuccess("Success","Successfully deleted form",3e3))})}},o.$on("$destroy",function(){t.ClearStore()})}angular.module("myApp").component("formAdminModalComponent",{templateUrl:"app/views/admin/approvalitems/component/form.html",controller:e,controllerAs:"vm",bindings:{approvalItemId:"=",organization:"="}}),e.$inject=["AdminApprovalItemManageFormComponentBusiness","AdminApprovalItemManageFormComponentStore","sweetDialogAlertService","TextAngularToolbarConfig","$scope","FormControls","$state","AdminApprovalItemManageStore"]}(),function(){"use strict";function e(t){this.SubmitForm=function(e){return t.Post(n+"ApprovalItemFormInsertUpdate",e).then(function(e){return e})};var n=ApiRootDirectory.absoluteRootUrl+"api/approvalitem/admin/"}angular.module("myApp").service("AdminApprovalItemManageFormComponentService",e),e.$inject=["DataAccess"]}(),function(){"use strict";function e(){function e(){this.form={},this.originalForm={},this.selectedRow=null,this.orgList=[],this.approvalItemList=[],this.selectedOrg=null,this.selectedApprovalItem=null}return e.prototype.ClearStore=function(){this.form={},this.originalForm={},this.selectedRow=null,this.orgList=[],this.approvalItemList=[],this.selectedOrg=null,this.selectedApprovalItem=null},new e}angular.module("myApp").factory("AdminApprovalItemManageFormComponentStore",e),e.$inject=[]}(),function(){"use strict";function e(t,n,e){this.GetClassifications=function(e){return n.GetClassifications(e).then(function(e){t.classificationList=e})},this.DeleteClassification=function(e){return n.DeleteClassification(e).then(function(e){return e})},this.ClearForm=function(){t.form={ClassificationId:null,ClassificationName:null,OrganizationCode:"ALL"===t.selectedOrg?null:t.selectedOrg}},this.InsertUpdate=function(){var e=angular.copy(t.form);return n.InsertUpdate(e).then(function(e){return e})},this.GetOrganizations=function(){return e.GetOrganizations().then(function(e){t.organizationList=angular.copy(e),t.orgList=angular.copy(e),t.orgList.unshift({OrganizationId:0,OrganizationCode:"ALL",OrganizationName:"ALL",CanDelete:"N",CLASSIFICATION:"",SUPERVISOR:""})})},this.ChangePageSize=function(e){t.currentPageSize=e},Object.preventExtensions(t)}angular.module("myApp").service("AdminClassificationBusiness",e),e.$inject=["AdminClassificationStore","AdminClassificationService","AdminOrganizationService"]}(),function(){"use strict";function e(n,e,t,l,o,r){var i=this;i.model=e,i.events={onClick_DeleteClassification:function(t){l.alertConfirm("Confirm Deletion","Are you sure you want to delete "+t.ClassificationName+"?",function(){return n.DeleteClassification(t).then(function(e){null===e&&(l.alertSuccess("Success","Deleted "+t.ClassificationName+" successfully!",3e3),n.GetClassifications(i.model.selectedOrg))})},angular.noop,"Yes","No",!0)},onClick_OpenManageModal:function(e,t){i.model.manageType=e,n.ClearForm(),"edit"===i.model.manageType&&(i.model.form=angular.copy(t));angular.element("#manageClassificationModal").modal("show")},onClick_SaveChanges:function(){l.alertConfirm("Saving Changes","Are you sure you want to save "+i.model.form.ClassificationName+"?",function(){return n.InsertUpdate().then(function(e){if(null===e){"add"===i.model.manageType&&"Added ",angular.element("#manageClassificationModal").modal("hide"),l.alertSuccess("Success","add"===i.model.manageType?"Added ":"Updated "+i.model.form.ClassificationName+" successfully!",3e3),i.model.selectedOrg=angular.copy(i.model.form.OrganizationCode),n.ClearForm(),n.GetClassifications(i.model.form.OrganizationCode)}})},function(){},"Yes","No",!0)},onSelect_OrganizationCode:function(){n.GetClassifications(i.model.selectedOrg)},onChange_PageSize:function(e){n.ChangePageSize(e)}},i.validations={OnValidate_Submit:function(t){if(i.model.errors.active=null,o.intIsNullorUndefinedorZero(t.ClassificationId)){if(o.stringIsNullUndefinedOrEmpty(t.ClassificationName)||o.stringIsNullUndefinedOrEmpty(t.OrganizationCode))return i.model.errors.active="REQUIRED",!0;if(0<i.model.classificationList.filter(function(e){return e.ClassificationId!==t.ClassificationId&&e.ClassificationName.toUpperCase()===t.ClassificationName.toUpperCase()}).length)return i.model.errors.active="EXISTS",!0}else if(0<i.model.classificationList.filter(function(e){return e.ClassificationId!==t.ClassificationId&&e.ClassificationName.toUpperCase()===t.ClassificationName.toUpperCase()}).length)return i.model.errors.active="EXISTS",!0;return!1}},i.model.selectedOrg="ALL",n.GetClassifications(i.model.selectedOrg),n.GetOrganizations(),t.$on("$destroy",function(){e.ClearStore()})}angular.module("myApp").controller("AdminClassificationController",e),e.$inject=["AdminClassificationBusiness","AdminClassificationStore","$scope","sweetDialogAlertService","astigUtilityService","$state"]}(),function(){"use strict";function e(t){this.GetClassifications=function(e){return t.Get(n+"GetClassifications?orgCode="+e,{cache:!1}).then(function(e){return e})},this.DeleteClassification=function(e){return t.Post(n+"DeleteClassification",e).then(function(e){return e})},this.InsertUpdate=function(e){return t.Post(n+"InsertUpdateClassification",e).then(function(e){return e})},this.GetClassificationAssignments=function(e){return t.Get(n+"GetClassificationAssignments?classificationId="+e,{cache:!1}).then(function(e){return e})};var n=ApiRootDirectory.absoluteRootUrl+"api/classification/"}angular.module("myApp").service("AdminClassificationService",e),e.$inject=["DataAccess"]}(),function(){"use strict";function e(e){function t(){this.search="",this.classificationList=[],this.manageType=null,this.organizationList=[],this.orgList=[],this.selectedOrg=null,this.pageSizes=e,this.currentPageSize=5,this.form={ClassificationId:null,ClassificationName:null,OrganizationCode:null},this.errors={active:null,errormessages:{EXISTS:"Classification already exists."}}}return t.prototype.ClearStore=function(){this.classificationList=[],this.manageType=null,this.form={ClassificationId:null,ClassificationName:null},this.pageSizes=e,this.currentPageSize=5},new t}angular.module("myApp").factory("AdminClassificationStore",e),e.$inject=["PageSizes"]}(),function(){"use strict";function e(n,l,e){this.GetGroups=function(){return l.GetGroups().then(function(e){n.groupList=e})},this.DeleteGroup=function(e){var t={Id:e};return l.DeleteGroup(t).then(function(e){return e})},this.GetGroupAccessReference=function(){return l.GetGroupAccessReference().then(function(e){n.groupAccessReferenceList=e})},this.SetSelectedMember=function(e){n.form.MemberSelected={MemberUsername:e.EMAIL_ADDRESS,MemberDisplayName:e.FULL_NAME,MemberEmail:e.EMAIL_ADDRESS,GroupId:n.form.GroupId}},this.ClearSelectedMember=function(){n.form.MemberSelected=null,n.form.MemberSearch=null},this.AddSelectedMember=function(){n.form.GroupMembers.unshift(n.form.MemberSelected)},this.RemoveMember=function(t){n.form.GroupMembers=n.form.GroupMembers.filter(function(e){return angular.toJson(e)!==angular.toJson(t)})},this.GetGroupDetails=function(e){return l.GetGroupDetails(e).then(function(e){n.form.GroupAccess=e.GroupAccess.map(function(e){return e.isActive=e.isActive="Y"===e.Active,e}),n.form.GroupMembers=e.GroupMembers.map(function(e){return e.GroupId=n.form.GroupId,e}),n.form.GroupAccessCopy=angular.copy(n.form.GroupAccess),n.form.GroupMembersCopy=angular.copy(n.form.GroupMembers)})},this.ClearForm=function(){n.form={GroupId:null,GroupName:null,GroupAccess:[],GroupMembers:[],MemberSearch:null,MemberSelected:null,GroupNameCopy:null,GroupAccessCopy:[],GroupMembersCopy:[]}},this.InsertUpdate=function(){var t=angular.copy(n.form);return t.GroupAccess=[],n.form.GroupAccess.forEach(function(e){e.isActive&&t.GroupAccess.push(e)}),l.InsertUpdate(t).then(function(e){return e})},this.ValidateAccess=function(t){return null!==t.GroupDependency&&0===n.form.GroupAccess.filter(function(e){if(t.GroupDependency===e.GroupAccessCode&&e.isActive)return e}).length},this.GroupAccessOnChange=function(t){t.Active=t.isActive?"Y":"N",t.isActive?n.form.GroupAccess.forEach(function(e){e.GroupDependency===t.GroupAccessCode&&(e.isActive=!0,e.Active="Y")}):n.form.GroupAccess.forEach(function(e){e.GroupDependency===t.GroupAccessCode&&(e.isActive=!1,e.Active="N")})},this.CheckDuplicateGroupMember=function(){return n.form.GroupMembers.find(function(e){return e.MemberEmail===n.form.MemberSelected.MemberEmail})},this.ChangePageSize=function(e){n.currentPageSize=e},this.GetUserGroupAssignment=function(e){return l.GetUserGroupAssignment(e).then(function(e){n.groupAssignmentList=e})},this.ChangeAssignmentPageSize=function(e){n.currentAssignmentPageSize=e},Object.preventExtensions(n)}angular.module("myApp").service("AdminGroupBusiness",e),e.$inject=["AdminGroupStore","AdminGroupService","astigUtilityService"]}(),function(){"use strict";function e(n,e,l,o,t,r,i,a,s){var u=this;u.model=e,u.events={onClick_DeleteGroup:function(t){l.alertConfirm("Confirm Deletion","Are you sure you want to delete "+t.GroupName+"?",function(){return n.DeleteGroup(t.GroupId).then(function(e){null===e&&(l.alertSuccess("Success","Deleted "+t.GroupName+" successfully!",3e3),n.GetGroups())})},angular.noop,"Yes","No",!0)},onClick_OpenManageModal:function(e,t){u.model.manageType=e,n.ClearForm(),"add"===u.model.manageType?n.GetGroupDetails(0).then(function(){angular.element("#manageGroupModal").modal("show")}):(u.model.form=angular.copy(t),u.model.form.GroupNameCopy=angular.copy(t.GroupName),n.GetGroupDetails(u.model.form.GroupId).then(function(){angular.element("#manageGroupModal").modal("show")}))},onClick_OpenGroupAssignment:function(e){u.model.searchAssginment="",u.model.sortAssignmentPendingAction=!1,u.model.sortAssignmentPendingActionProperty="",n.GetUserGroupAssignment(e.GroupId).then(function(){angular.element("#userGroupAssginmentModal").modal("show")})},onSelect_SearchEmployee:function(e){n.SetSelectedMember(e.value),angular.element("#addEmployeeSearch").focus()},onClick_AddSelectedMember:function(){angular.isUndefined(n.CheckDuplicateGroupMember())?n.AddSelectedMember():l.alertWarning("Duplicate Employee",u.model.form.MemberSelected.MemberDisplayName+" is already a member.");n.ClearSelectedMember(),angular.element("#searchEmployee").focus()},onClick_RemoveMember:function(e){n.RemoveMember(e)},onClick_SaveChanges:function(){l.alertConfirm("Saving Changes","Are you sure you want to save "+u.model.form.GroupName+"?",function(){return n.InsertUpdate().then(function(e){if(null===e){"add"===u.model.manageType&&"Added ",angular.element("#manageGroupModal").modal("hide"),l.alertSuccess("Success","add"===u.model.manageType?"Added ":"Updated "+u.model.form.GroupName+" successfully!",3e3),n.ClearForm(),n.GetGroups()}})},function(){},"Yes","No",!0)},onClick_GroupAccessOnChange:function(e){n.GroupAccessOnChange(e)},searchEmployee:function(e,t){o.SearchEmployee(e.term,10).then(function(e){e&&t(e.map(function(e){return{label:e.FULL_NAME,value:e}}))})},validateAccess:function(e){return n.ValidateAccess(e)},validateSubmit:function(e){if(angular.isDefined(e.GroupMembers)&&(e.GroupMembers.length<=0||""===e.GroupName||null===e.GroupName||angular.equals(e.GroupAccess,u.model.form.GroupAccessCopy)&&angular.equals(e.GroupMembers,u.model.form.GroupMembersCopy)&&e.GroupName===e.GroupNameCopy))return!0;return!1},onSort_Field:function(e){u.model.sortPendingAction=!u.model.sortPendingAction,u.model.sortPendingActionProperty=e,u.model.groupList=a(u.model.groupList,e,u.model.sortPendingAction)},onSort_AssignmentField:function(e){u.model.sortAssignmentPendingAction=!u.model.sortAssignmentPendingAction,u.model.sortAssignmentPendingActionProperty=e,u.model.groupAssignmentList=a(u.model.groupAssignmentList,e,u.model.sortAssignmentPendingAction)},onChange_AssignmentPageSize:function(e){n.ChangeAssignmentPageSize(e)},onChange_PageSize:function(e){n.ChangePageSize(e)},onHover:function(e){return 0<e.length?s.GetToolTip(e[0]):"No items to search"}},n.GetGroups(),t.$on("$destroy",function(){u.model.ClearStore()})}angular.module("myApp").controller("AdminGroupController",e),e.$inject=["AdminGroupBusiness","AdminGroupStore","sweetDialogAlertService","LookupService","$scope","astigUtilityService","MainStore","orderByFilter","MainBusiness"]}(),function(){"use strict";function e(t){this.GetGroups=function(){return t.Get(n+"GetGroups").then(function(e){return e})},this.DeleteGroup=function(e){return t.Post(n+"DeleteGroup",e).then(function(e){return e})},this.GetGroupAccessReference=function(){return t.Get(n+"GetGroupAccessReference").then(function(e){return e})},this.GetGroupDetails=function(e){return t.Get(n+"getgroupdetails/"+e).then(function(e){return e})},this.InsertUpdate=function(e){return t.Post(n+"InsertUpdateGroup",e).then(function(e){return e})},this.GetUserGroupAssignment=function(e){return t.Get(n+"getusergroupassignment/"+e).then(function(e){return e})};var n=ApiRootDirectory.absoluteRootUrl+"api/Group/"}angular.module("myApp").service("AdminGroupService",e),e.$inject=["DataAccess"]}(),function(){"use strict";function e(e){function t(){this.groupList=[],this.groupAccessReferenceList=[],this.manageType=null,this.search="",this.groupAssignmentList=[],this.form={GroupId:null,GroupName:null,GroupAccess:[],GroupMembers:[],MemberSearch:null,MemberSelected:null,GroupNameCopy:null,GroupAccessCopy:[],GroupMembersCopy:[]},this.sortPendingAction=!1,this.sortPendingActionProperty="",this.pageSizes=e,this.currentPageSize=5,this.searchAssginment="",this.sortAssignmentPendingAction=!1,this.sortAssignmentPendingActionProperty="",this.assignmentPageSizes=e,this.currentAssignmentPageSize=5}return t.prototype.ClearStore=function(){this.groupList=[],this.groupAccessReferenceList=[],this.manageType=null,this.search="",this.groupAssignmentList=[],this.form={GroupId:null,GroupName:null,GroupAccess:[],GroupMembers:[],MemberSearch:null,MemberSelected:null,GroupNameCopy:null,GroupAccessCopy:[],GroupMembersCopy:[]},this.sortPendingAction=!1,this.sortPendingActionProperty="",this.searchAssginment="",this.sortAssignmentPendingAction=!1,this.sortAssignmentPendingActionProperty=""},new t}angular.module("myApp").factory("AdminGroupStore",e),e.$inject=["PageSizes"]}(),function(){"use strict";function e(e,t){this.model={},this.methods={},this.model.mainStore=e,this.methods.utilityService=t}angular.module("myApp").controller("AdminHomeController",e),e.$inject=["MainStore","astigUtilityService"]}(),function(){"use strict";function e(n,l,t){this.GetOrganizations=function(){return l.GetOrganizations().then(function(e){n.organizationList=e})},this.DeleteOrganization=function(e){var t={Id:e};return l.DeleteOrganization(t).then(function(e){return e})},this.ClearForm=function(){n.form={OrganizationId:null,OrganizationCode:null,OrganizationName:null,CLASSIFICATION:"Y",SUPERVISOR:"HIDDEN",OriginalClassificationList:[],ClassificationList:[],ClassificationName:null},n.originalForm={OrganizationId:null,OrganizationCode:null,OrganizationName:null,CLASSIFICATION:"Y",SUPERVISOR:"HIDDEN",OriginalClassificationList:[],ClassificationList:[],ClassificationName:null}},this.InsertUpdate=function(){var e=angular.copy(n.form);return l.InsertUpdate(e).then(function(e){return e})},this.GetOrganizationClassifications=function(e){t.GetClassifications(e).then(function(e){n.form.ClassificationList=e,n.form.OriginalClassificationList=angular.copy(n.form.ClassificationList);var t=n.form.ClassificationList.filter(function(e){return"N"===e.CanDelete});n.classificationdisabledoff=0!==t.length})},this.ChangePageSize=function(e,t){"org"===t?n.currentPageSize=e:n.currentClassificationPageSize=e},this.ChangeAssignmentPageSize=function(e){n.currentAssignmentPageSize=e},this.GetClassificationAssignments=function(e){return t.GetClassificationAssignments(e).then(function(e){n.classificationAssignmentList=e})},Object.preventExtensions(n)}angular.module("myApp").service("AdminOrganizationBusiness",e),e.$inject=["AdminOrganizationStore","AdminOrganizationService","AdminClassificationService"]}(),function(){"use strict";function e(n,e,t,l,o,r,i){var a=this;a.model=e,a.events={onClick_DeleteOrganization:function(t){l.alertConfirm("Confirm Deletion","Are you sure you want to delete "+t.OrganizationName+"?",function(){return n.DeleteOrganization(t.OrganizationId).then(function(e){null===e&&(l.alertSuccess("Success","Deleted "+t.OrganizationName+" successfully!",3e3),n.GetOrganizations())})},angular.noop,"Yes","No",!0)},onClick_OpenManageModal:function(e,t){a.model.manageType=e,n.ClearForm(),"add"===a.model.manageType?n.GetOrganizations():(a.model.form=angular.copy(t),"Y"===a.model.form.CLASSIFICATION?a.model.form.ClassificationList=n.GetOrganizationClassifications(t.OrganizationCode):(a.model.form.ClassificationList=[],a.model.form.OriginalClassificationList=[],a.model.classificationdisabledoff=!1),a.model.originalForm=angular.copy(a.model.form)),angular.element("#manageOrganizationModal").modal("show")},onClick_SaveChanges:function(){l.alertConfirm("Saving Changes","Are you sure you want to save "+a.model.form.OrganizationName+"?",function(){return"N"===a.model.form.CLASSIFICATION&&(a.model.form.ClassificationList=[]),n.InsertUpdate().then(function(e){if(null===e){"add"===a.model.manageType&&"Added ",angular.element("#manageOrganizationModal").modal("hide"),l.alertSuccess("Success","add"===a.model.manageType?"Added ":"Updated "+a.model.form.OrganizationName+" successfully!",3e3),n.ClearForm(),n.GetOrganizations()}})},function(){},"Yes","No",!0)},onClick_AddClassification:function(){var e=a.model.form.ClassificationList.filter(function(e){return e.ClassificationName===a.model.form.ClassificationName}),t=a.model.form.OriginalClassificationList.filter(function(e){return e.ClassificationName===a.model.form.ClassificationName});if(0===e.length)if(0===t.length){var n={ClassificationId:0,ClassificationName:a.model.form.ClassificationName,OrganizationCode:a.model.form.OrganizationCode};a.model.form.ClassificationList.push(n)}else a.model.form.ClassificationList.push(t[0]);else l.alertWarning("Duplicate Classification","Classification already exists!");a.model.form.ClassificationName=null},onChange_PageSize:function(e,t){n.ChangePageSize(e,t)},onClick_DeleteClassification:function(e){var t=a.model.form.ClassificationList.indexOf(e);a.model.form.ClassificationList.splice(t,1)},onClick_ClassificationOff:function(){a.model.classificationdisabledoff&&l.alertConfirm("Switch Off Classification","Turning this Off will remove all classifications tied to approval items. Do you want to proceed?",function(){a.model.form.CLASSIFICATION="N",t.$apply()},function(){a.model.form.CLASSIFICATION="Y",t.$apply()},"Proceed","Cancel",!0)},onChange_AssignmentPageSize:function(){n.ChangeAssignmentPageSize(_pageSize)},onSort_AssignmentField:function(e){a.model.sortAssignmentPendingAction=!a.model.sortAssignmentPendingAction,a.model.sortAssignmentPendingActionProperty=e,a.model.classificationAssignmentList=r(a.model.classificationAssignmentList,e,a.model.sortAssignmentPendingAction)},onClick_OpenClassificationAssignment:function(e){n.GetClassificationAssignments(e.ClassificationId).then(function(){angular.element("#classificationAssginmentModal").modal("show"),angular.element("#manageOrganizationModal").css("display","none")})},onClose_AssignmentModal:function(){angular.element("#manageOrganizationModal").css("display","block")},onHover:function(e){return 0<e.length?i.GetToolTip(e[0]):"No items to search"}},a.validations={OnValidate_Submit:function(t){if(a.model.errors.active=null,o.intIsNullorUndefinedorZero(t.OrganizationId)){if(o.stringIsNullUndefinedOrEmpty(t.OrganizationCode)||o.stringIsNullUndefinedOrEmpty(t.OrganizationName))return a.model.errors.active="REQUIRED",!0;if(0<a.model.organizationList.filter(function(e){return e.OrganizationId!==t.OrganizationId&&e.OrganizationCode.toUpperCase()===t.OrganizationCode.toUpperCase()}).length)return a.model.errors.active="EXISTS",!0}else if(0<a.model.organizationList.filter(function(e){return e.OrganizationId!==t.OrganizationId&&e.OrganizationCode.toUpperCase()===t.OrganizationCode.toUpperCase()}).length)return a.model.errors.active="EXISTS",!0;if("Y"===a.model.form.CLASSIFICATION){if(o.objectIsNullorUndefined(a.model.form.ClassificationList))return a.model.errors.active="REQUIRED CLASSIFICATIONS",!0;if(0===a.model.form.ClassificationList.length)return a.model.errors.active="REQUIRED CLASSIFICATIONS",!0}return!1},OnValidate_FormChanges:function(){return JSON.stringify(a.model.form)===JSON.stringify(a.model.originalForm)},OnValidate_ClassificatioName:function(e){return o.stringIsNullUndefinedOrEmpty(e)}},n.GetOrganizations(),t.$on("$destroy",function(){e.ClearStore()})}angular.module("myApp").controller("AdminOrganizationController",e),e.$inject=["AdminOrganizationBusiness","AdminOrganizationStore","$scope","sweetDialogAlertService","astigUtilityService","orderByFilter","MainBusiness"]}(),function(){"use strict";function e(t){this.GetOrganizations=function(){return t.Get(n+"GetOrganizations",{cache:!1}).then(function(e){return e})},this.DeleteOrganization=function(e){return t.Post(n+"DeleteOrganization",e).then(function(e){return e})},this.InsertUpdate=function(e){return t.Post(n+"InsertUpdateOrganization",e).then(function(e){return e})};var n=ApiRootDirectory.absoluteRootUrl+"api/organization/"}angular.module("myApp").service("AdminOrganizationService",e),e.$inject=["DataAccess"]}(),function(){"use strict";function e(e){function t(){this.search="",this.organizationList=[],this.organizationLookup=[],this.manageType=null,this.classificationdisabledoff=!0,this.pageSizes=e,this.currentPageSize=5,this.currentClassificationPageSize=5,this.originalForm={OrganizationId:null,OrganizationCode:null,OrganizationName:null,CLASSIFICATION:"Y",SUPERVISOR:"HIDDEN",OriginalClassificationList:[],ClassificationList:[],ClassificationName:null},this.form={OrganizationId:null,OrganizationCode:null,OrganizationName:null,CLASSIFICATION:"Y",SUPERVISOR:"HIDDEN",OriginalClassificationList:[],ClassificationList:[],ClassificationName:null},this.errors={active:null,errormessages:{EXISTS:"Organization already exists.",REQUIRED:"Organization Code and Organization Name are required."}},this.supervisor=["VIEW ONLY","ALLOWED","HIDDEN"],this.assignmentPageSizes=e,this.currentAssignmentPageSize=10,this.searchAssginment="",this.classificationAssignmentList=[],this.sortAssignmentPendingAction=!1,this.sortAssignmentPendingActionProperty=""}return t.prototype.ClearStore=function(){this.organizationList=[],this.organizationLookup=[],this.manageType=null,this.classificationdisabledoff=!0,this.pageSizes=e,this.currentPageSize=5,this.currentClassificationPageSize=5,this.originalForm={OrganizationId:null,OrganizationCode:null,OrganizationName:null,CLASSIFICATION:"Y",SUPERVISOR:"HIDDEN",OriginalClassificationList:[],ClassificationList:[],ClassificationName:null},this.form={OrganizationId:null,OrganizationCode:null,OrganizationName:null,CLASSIFICATION:"Y",SUPERVISOR:"HIDDEN",OriginalClassificationList:[],ClassificationList:[],ClassificationName:null},this.searchAssginment="",this.classificationAssignmentList=[],this.sortAssignmentPendingAction=!1,this.sortAssignmentPendingActionProperty=""},new t}angular.module("myApp").factory("AdminOrganizationStore",e),e.$inject=["PageSizes"]}(),function(){"use strict";function e(n,t,e,l,o,r){this.GetGroupsAndOrganizationAndReportsList=function(){o.all([e.GetGroups(),l.GetOrganizationLookup(),t.GetReportsList()]).then(function(e){n.groupList=e[0],n.organizationList=e[1],n.reportsList=e[2]})},this.GetReportsList=function(){return t.GetReportsList().then(function(e){n.reportsList=e})},this.GetReportSettingsAccessDetails=function(e){return n.reportSettingsList=[],n.reportSettingsListCopy=[],t.GetReportSettingsAccessDetails(e).then(function(e){0<e.length&&(e=function(e){return e.forEach(function(t){t.Group=n.groupList.find(function(e){return e.GroupId===parseInt(t.ObjectId)}),t.Org=n.organizationList.find(function(e){return e.OrganizationCode===t.OrganizationCode}),delete t.OrganizationCode,delete t.ObjectId,delete t.ObjectDisplayName}),e}(e),n.reportSettingsList=angular.copy(e),n.reportSettingsListCopy=angular.copy(e))})},this.RemoveAccess=function(t){n.reportSettingsList=n.reportSettingsList.filter(function(e){return angular.toJson(e)!==angular.toJson(t)})},this.AddAccess=function(){n.reportSettingsList.unshift({Group:null,Org:null})},this.SaveChanges=function(){var e={ReportId:n.form.ReportId,ReportName:n.form.ReportName,ReportAccessSettings:function(e){var t=[];return e.forEach(function(e){t.push({OrganizationCode:e.Org.OrganizationCode,ObjectId:e.Group.GroupId,ObjectDisplayName:e.Group.GroupName})}),t}(n.reportSettingsList)};return t.InsertUpdateReportAndReportSettingsAccessDetails(e).then(function(e){return e})},this.HasDuplicates=function(){for(var t=0;t<n.reportSettingsList.length;t++){if(2<=n.reportSettingsList.filter(function(e){return angular.toJson(e)===angular.toJson(n.reportSettingsList[t])}).length)return!0}return!1},Object.preventExtensions(n)}angular.module("myApp").service("AdminReportAccessBusiness",e),e.$inject=["AdminReportAccessStore","AdminReportAccessService","AdminGroupService","LookupService","$q","astigUtilityService"]}(),function(){"use strict";function e(t,n,e,l){this.model=n,this.events={onClick_ManageSettings:function(e){n.form=angular.copy(e),t.GetReportSettingsAccessDetails(n.form.ReportId),angular.element("#manageReportAccessSettings").modal("show")},onClick_RemoveAccess:function(e){t.RemoveAccess(e)},onClick_AddAccess:function(){t.AddAccess()},onClick_SaveChanges:function(){l.alertConfirm("Saving Changes","Are you sure you want to save changes?",function(){return t.SaveChanges().then(function(e){null===e&&(angular.element("#manageReportAccessSettings").modal("hide"),l.alertSuccess("Success","Changes saved successfully!",3e3),t.GetReportsList())})},function(){},"Yes","No",!0)},onValidate_HasDuplicate:function(){return t.HasDuplicates()}},t.GetGroupsAndOrganizationAndReportsList(),e.$on("$destroy",function(){n.ClearStore()})}angular.module("myApp").controller("AdminReportAccessController",e),e.$inject=["AdminReportAccessBusiness","AdminReportAccessStore","$scope","sweetDialogAlertService"]}(),function(){"use strict";function e(t){this.GetReportsList=function(){return t.Get(n+"GetReportsList",{cache:!1}).then(function(e){return e})},this.GetReportSettingsAccessDetails=function(e){return t.Get(n+"GetReportSettingsAccessDetails/"+e,{cache:!1}).then(function(e){return e})},this.InsertUpdateReportAndReportSettingsAccessDetails=function(e){return t.Post(n+"InsertUpdateReportAndReportSettingsAccessDetails",e).then(function(e){return e})};var n=ApiRootDirectory.absoluteRootUrl+"api/Reports/Admin/"}angular.module("myApp").service("AdminReportAccessService",e),e.$inject=["DataAccess"]}(),function(){"use strict";function e(){function e(){this.reportsList=[],this.form={},this.reportSettingsList=[],this.reportSettingsListCopy=[],this.groupList=[],this.organizationList=[]}return e.prototype.ClearStore=function(){this.reportsList=[],this.form={},this.reportSettingsList=[],this.reportSettingsListCopy=[],this.groupList=[],this.organizationList=[]},new e}angular.module("myApp").factory("AdminReportAccessStore",e),e.$inject=[]}(),function(){"use strict";function e(l,o){function t(){l.form={RoleId:null,RoleName:"",RoleNameReference:"",EmployeeSearched:null,EmployeeSelected:null,EmployeeListReference:[],EmployeeList:[]},l.formtablebased={RoleId:null,RoleName:"",RoleNameReference:"",TableName:"",TableNameReference:"",TableData:[],TableDataReference:[],form:{TableDataRoleId:null,TableDataName:"",TableDataNameReference:"",EmployeeSearched:null,EmployeeSelected:null,EmployeeListReference:[],EmployeeList:[]}},l.formassociation={RoleList:[],ChildRoleList:[],selectedParentRole:null,selectedChildRole:null,itemSelected:null,parentRole:null,parentRoleReference:null,parentParentRole:null,childRole:null,childRoleTableData:null,childRoleTableDataReference:null},l.formconditional={RoleList:[],type:"",RoleId:null,RoleName:"",RoleNameReference:"",ConditionalRoles:[],ConditionalRolesDeleted:[],ConditionalRolesReference:[],SelectedOracleHierarchy:{},SelectedImportedHierarchy:{},SelectedDerivedRole:{},UpdateConditionalRow:{},UpdateConditionalRowReference:{}},l.formlookup={RoleId:null,RoleName:"",RoleNameReference:""},l.associationtype=""}this.ClearForm=t,this.ClearTableBasedForm=function(){l.formtablebased.form={TableDataRoleId:null,TableDataName:"",TableDataNameReference:"",EmployeeSearched:null,EmployeeSelected:null,EmployeeListReference:[],EmployeeList:[]}},this.ChangePageSize=function(e){l.currentPageSize=e},this.GetSelectedMemberDetails=function(e){return{MemberUsername:e.EMAIL_ADDRESS,MemberDisplayName:e.FULL_NAME,MemberEmail:e.EMAIL_ADDRESS}},this.GetRoles=function(){return o.GetRoles().then(function(e){l.roleList=e})},this.GetRoleAssignments=function(e){return o.GetRoleAssignments(e).then(function(e){l.roleAssignmentList=e})},this.ChangeAssignmentPageSize=function(e){l.currentAssignmentPageSize=e},this.GetUniversalRoleMembers=function(e){return o.GetUniversalRoleMembers(e).then(function(e){l.form.EmployeeList=e,l.form.EmployeeListReference=angular.copy(e)})},this.GetTableBasedRoleInformation=function(e){return o.GetTableBasedRoleInformation(e).then(function(e){return e})},this.GetAssociatedRoleInformation=function(e){return o.GetAssociatedRoleInformation(e).then(function(e){return e})},this.GetConditionalRoleInformation=function(e){return o.GetConditionalRoleInformation(e).then(function(e){return e})},this.GetImportedHierarchy=function(){return o.GetImportedHierarchy(l.formconditional.SelectedOracleHierarchy.OracleHierarchyCode).then(function(e){return e})},this.GetRoleLookupInformation=function(e){var t={RoleId:-99999965,Parameters:{Id:e,Data:"ROLELOOKUPINFORMATION"}};return o.GetRoleLookupInformation(t).then(function(e){!function(e){l.roleLookupInformationList=[],e.forEach(function(e){var t={};e.Value.forEach(function(e){t[e.Key]=e.Value}),l.roleLookupInformationList.push(t)})}(e)})},this.InsertUpdateRole=function(e){switch(e){case"universal":return function(){var e={RoleId:l.form.RoleId,RoleName:l.form.RoleName,EmployeeList:l.form.EmployeeList};return o.InsertUpdateUniversalRole(e).then(function(e){return e})}();case"tablebased":return function(){var e={RoleId:l.formtablebased.RoleId,RoleName:l.formtablebased.RoleName,TableName:l.formtablebased.TableName,TableData:l.formtablebased.TableData};return o.InsertUpdateTableBasedRole(e).then(function(e){return e})}();case"association":return function(){var n={ParentRoleId:l.formassociation.parentRole.RoleId,ChildRoleId:l.formassociation.childRole.RoleId,TableDataAssociation:[]};return angular.forEach(l.formassociation.parentRole.TableData,function(e){var t={ParentTableDataRoleId:e.TableDataRoleId,ChildTableData:[]};angular.forEach(e.AssociatedTableData,function(e){t.ChildTableData.unshift(e.TableDataRoleId)}),n.TableDataAssociation.unshift(t)}),o.InsertUpdateAssociationRole(n).then(function(e){return e})}();case"conditional":return function(){var t=l.formconditional.ConditionalRoles.filter(function(e){return"I"===e.Action||"U"===e.Action});l.formconditional.ConditionalRolesDeleted.forEach(function(e){t.push(e)});var e={RoleId:l.formconditional.RoleId,RoleName:l.formconditional.RoleName,ConditionalRoles:function(e){var t=[];return e.forEach(function(e){t.push({ConditionalRoleId:e.ConditionalRoleId,DerivedRoleId:e.DerivedRoleId,Action:e.Action,ImportedHierarchyCode:e.ImportedHierarchyCode,OracleHierarchyCode:e.OracleHierarchyCode})}),t}(t)};return o.InsertUpdateConditionalRole(e).then(function(e){return e})}();case"lookup":return function(){var e={RoleId:l.formlookup.RoleId,RoleName:l.formlookup.RoleName};return o.InsertUpdateLookupRole(e).then(function(e){return e})}()}t()},this.DeleteRole=function(e){return o.DeleteRole(e).then(function(e){return e})},this.GetRoleMembers=function(e,t){var n={RoleId:-99999965,Parameters:{Id:e,Data:"ROLEMEMBERS",REFERENCEDATA:t}};return o.GetRoleLookupInformation(n).then(function(e){return function(e){var n=[];null!==e&&e.forEach(function(e){var t={};e.Value.forEach(function(e){t[e.Key]=e.Value}),n.push(t)});return n}(e)})},Object.preventExtensions(l)}angular.module("myApp").service("AdminRoleBusiness",e),e.$inject=["AdminRoleStore","AdminRoleService"]}(),function(){"use strict";function e(l,n,e,o,r,t,i,a,s){var u=this;function c(e){"update"===u.model.manageType&&(u.model.form={RoleId:e.RoleId,RoleName:e.RoleName,RoleNameReference:angular.copy(e.RoleName),EmployeeSearched:null,EmployeeSelected:null,EmployeeListReference:[],EmployeeList:[]},l.GetUniversalRoleMembers(e.RoleId)),angular.element("#manageRoleModal").modal("show")}function d(e){"update"===u.model.manageType&&l.GetTableBasedRoleInformation(e.RoleId).then(function(e){u.model.formtablebased={RoleId:e.RoleId,RoleName:e.RoleName,RoleNameReference:angular.copy(e.RoleName),TableName:e.TableName,TableNameReference:angular.copy(e.TableName),TableData:e.TableData,TableDataReference:angular.copy(e.TableData),form:{TableName:"",EmployeeSearched:null,EmployeeSelected:null,EmployeeListReference:[],EmployeeList:[]}}}),angular.element("#manageTableBasedRoleModal").modal("show")}function p(e){u.model.formassociation.RoleList=u.model.roleList.filter(function(e){return"TABLE-BASED"===e.RoleType}),"update"===u.model.manageType?l.GetAssociatedRoleInformation(e.RoleId).then(function(e){u.model.formassociation.parentParentRole={RoleId:e.ParentRoleId,RoleName:e.ParentRoleName,RoleType:e.ParentRoleType,RoleBehavior:e.ParentRoleBehavior,TableName:e.ParentTableName},u.model.formassociation.parentRole={RoleId:e.RoleId,RoleName:e.RoleName,RoleType:e.RoleType,RoleBehavior:e.RoleBehavior,TableName:e.TableName,TableData:e.TableData},u.model.formassociation.parentRoleReference=angular.copy(u.model.formassociation.parentRole),u.model.formassociation.childRole={RoleId:e.ChildRoleId,RoleName:e.ChildRoleName,RoleBehavior:e.ChildRoleBehavior,RoleType:e.ChildRoleType,TableName:e.ChildTableName,TableData:e.ChildTableData},u.model.formassociation.childRoleTableData=angular.copy(e.ChildTableData)}):r.objectIsNullorUndefined(e)||(u.model.associationtype="association-add",l.GetAssociatedRoleInformation(e.RoleId).then(function(t){u.model.formassociation.parentRole={RoleId:t.RoleId,RoleName:t.RoleName,RoleType:t.RoleType,RoleBehavior:t.RoleBehavior,TableName:t.TableName,TableData:t.TableData},u.model.formassociation.parentRoleReference=angular.copy(u.model.formassociation.parentRole),u.model.formassociation.ChildRoleList=u.model.formassociation.RoleList.filter(function(e){return e.RoleId!==t.RoleId&&("TABLE-BASED"===e.RoleBehavior||"PARENT-CHILD"===e.RoleBehavior)}),u.model.formassociation.childRole=null,u.model.formassociation.selectedChildRole=null})),angular.element("#manageAssociationRoleModal").modal("show")}function m(t){"update"===u.model.manageType?(u.model.formconditional.RoleList=u.model.roleList.filter(function(e){return e.RoleId!==t.RoleId}),l.GetConditionalRoleInformation(t.RoleId).then(function(e){u.model.formconditional={type:"",RoleId:e.RoleId,RoleName:e.RoleName,RoleNameReference:angular.copy(e.RoleName),ConditionalRoles:e.ConditionalRoles,ConditionalRolesDeleted:[],ConditionalRolesReference:angular.copy(e.ConditionalRoles),SelectedOracleHierarchy:{},SelectedImportedHierarchy:{},SelectedDerivedRole:{}}})):u.model.formconditional.RoleList=angular.copy(u.model.roleList),angular.element("#manageConditionalRoleModal").modal("show")}function f(e){"update"==u.model.manageType&&(u.model.formlookup.RoleId=e.RoleId,u.model.formlookup.RoleName=e.RoleName,u.model.formlookup.RoleNameReference=angular.copy(e.RoleName)),angular.element("#manageLookupRoleModal").modal("show")}u.model=n,u.events={onChange_PageSize:function(e){l.ChangePageSize(e)},onSort_RoleField:function(e){u.model.sortAction=!u.model.sortAction,u.model.sortProperty=e,u.model.roleList=t(u.model.roleList,e,u.model.sortAction)},onHover:function(e){return 0<e.length?a.GetToolTip(e[0]):"No items to search"},onClick_OpenAddManageRole:function(e,t){switch(u.model.manageType="add",l.ClearForm(),e){case"universal":c(null);break;case"tablebased":d(null);break;case"association":p(null);break;case"association-add":p(t);break;case"conditional":m(null);break;case"lookup":f(null)}},onClick_OpenManageRole:function(e){switch(u.model.manageType="update",l.ClearForm(),e.RoleType){case"UNIVERSAL":c(e);break;case"TABLE-BASED":d(e);break;case"CONDITIONAL LOOKUP":m(e);break;case"LOOKUP":f(e)}},onClick_DeleteRole:function(t){o.alertConfirm("Delete Role","Are you sure you want to delete "+t.RoleName+"?",function(){return l.DeleteRole(t).then(function(e){o.alertSuccess("Success","Deleted "+t.RoleName+" successfully!",3e3),l.GetRoles()})},function(){},"Yes","No",!0)},onClick_ExportToExcel:function(e,t){var n="";switch(e){case"ROLELIST":alasql('SELECT RoleId, RoleName, RoleType INTO XLSX("RoleList.xlsx",{headers:true}) FROM ?',[u.model.roleList]);break;case"ROLELOOKUP":n=u.model.roleLookupTitle+"_LookupReference.xlsx",alasql('SELECT Lookups,\tTablesAffected,\tFields,\tConditions INTO XLSX("'+n+'",{headers:true}) FROM ?',[u.model.roleLookupInformationList]);break;case"ROLEASSIGNMENT":n=u.model.roleLookupTitle+"_Assignemnt.xlsx",alasql('SELECT OrganizationCode, RefNo,\tApprovalItemLabel INTO XLSX("'+n+'",{headers:true}) FROM ?',[u.model.roleAssignmentList]);break;case"ROLEMEMBERS":n=t.RoleName.trim()+"_RoleMembers.xlsx",-1030===t.RoleId?s.all([l.GetRoleMembers(-1011,"OPPORTUNITY"),l.GetRoleMembers(-1011,"PROJECT"),l.GetRoleMembers(-1009,"OPPORTUNITY"),l.GetRoleMembers(-1009,"PROJECT")]).then(function(e){alasql('SELECT * INTO XLSX("'+n+'", ? ) FROM ?',[[{sheetid:"Pursuit_Opp_Members",header:!0},{sheetid:"Pursuit_Proj_Members",header:!0},{sheetid:"PM_Opp_Members",header:!0},{sheetid:"PM_Proj_Members",header:!0}],e])}):"LOOKUP"===t.RoleType||-1031==t.RoleId?s.all([l.GetRoleMembers(t.RoleId,"OPPORTUNITY"),l.GetRoleMembers(t.RoleId,"PROJECT")]).then(function(e){alasql('SELECT * INTO XLSX("'+n+'", ? ) FROM ?',[[{sheetid:"Role_Opp_Members",header:!0},{sheetid:"Role_Proj_Members",header:!0}],e])}):l.GetRoleMembers(t.RoleId,"").then(function(e){alasql('SELECT * INTO XLSX("'+n+'",{headers:true}) FROM ?',[e])})}},onClick_OpenRoleAssignment:function(e){u.model.searchAssginment="",u.model.sortAssignmentPendingAction=!1,u.model.sortAssignmentPendingActionProperty="",u.model.roleLookupTitle=null,l.GetRoleAssignments(e.RoleId).then(function(){u.model.roleLookupTitle=angular.copy(e.RoleName),angular.element("#roleAssginmentModal").modal("show")})},onChange_AssignmentPageSize:function(e){l.ChangeAssignmentPageSize(e)},onSort_AssignmentField:function(e){u.model.sortAssignmentPendingAction=!u.model.sortAssignmentPendingAction,u.model.sortAssignmentPendingActionProperty=e,u.model.roleAssignmentList=t(u.model.roleAssignmentList,e,u.model.sortAssignmentPendingAction)},onSearch_Employee:function(e,t){i.SearchEmployee(e.term,10).then(function(e){e&&t(e.map(function(e){return{label:e.FULL_NAME,value:e}}))})},onSelect_SearchEmployee:function(e){n.form.EmployeeSelected=l.GetSelectedMemberDetails(e.value)},onClick_RemoveMember:function(t,e){switch(e){case"UNIVERSAL":u.model.form.EmployeeList=u.model.form.EmployeeList.filter(function(e){return angular.toJson(e)!==angular.toJson(t)});break;case"TABLE-BASED":u.model.formtablebased.form.EmployeeList=u.model.formtablebased.form.EmployeeList.filter(function(e){return angular.toJson(e)!==angular.toJson(t)})}},onClick_OpenAddTableDataRow:function(e,t){l.ClearTableBasedForm(),"updatetabledatarow"===(u.model.manageType=e)&&(u.model.formtablebased.form={TableDataRoleId:t.TableDataRoleId,TableDataName:t.TableDataName,TableDataNameReference:angular.copy(t.TableDataName),EmployeeSearched:null,EmployeeSelected:null,EmployeeListReference:angular.copy(t.Members),EmployeeList:t.Members});angular.element("#managetabledatarowModal").modal("show")},onSelect_TableDataSearchEmployee:function(e){n.formtablebased.form.EmployeeSelected=l.GetSelectedMemberDetails(e.value)},onClick_AddNewTableDataRow:function(){if(1<=u.model.formtablebased.TableData.filter(function(e){return e.TableDataName.toLowerCase()===u.model.formtablebased.form.TableDataName.toLowerCase()}).length)o.alertWarning("Duplicate Table Data","This Table Data already exists.");else{var e={TableDataRoleId:r.guid(),TableDataName:angular.copy(u.model.formtablebased.form.TableDataName),Members:angular.copy(u.model.formtablebased.form.EmployeeList)};u.model.formtablebased.TableData.unshift(angular.copy(e)),angular.element("#managetabledatarowModal").modal("hide")}},onClick_UpdateTableDataRow:function(){var e=u.model.formtablebased.TableData.find(function(e){return e.TableDataRoleId===u.model.formtablebased.form.TableDataRoleId});e.TableDataName=angular.copy(u.model.formtablebased.form.TableDataName),2<=u.model.formtablebased.TableData.filter(function(e){return e.TableDataName.toLowerCase()===u.model.formtablebased.form.TableDataName.toLowerCase()}).length?(o.alertWarning("Duplicate Table Data","This Table Data already exists."),e.TableDataName=angular.copy(u.model.formtablebased.form.TableDataNameReference),e.Members=angular.copy(u.model.formtablebased.form.EmployeeListReference)):(e.Members=angular.copy(u.model.formtablebased.form.EmployeeList),angular.element("#managetabledatarowModal").modal("hide"))},onClick_DeleteTableRoleRow:function(t){u.model.formtablebased.TableData=u.model.formtablebased.TableData.filter(function(e){return angular.toJson(e)!==angular.toJson(t)})},OnChange_SelectHierarchy:function(e){if(r.objectIsNullorUndefined(u.model.formassociation.selectedParentRole)&&r.objectIsNullorUndefined(u.model.formassociation.selectedChildRole))return;var t="PARENT"===e?u.model.formassociation.selectedParentRole.RoleId:u.model.formassociation.selectedChildRole.RoleId;l.GetTableBasedRoleInformation(t).then(function(t){"PARENT"===e?(u.model.formassociation.parentRole={RoleId:t.RoleId,RoleName:t.RoleName,TableName:t.TableName,TableData:t.TableData},u.model.formassociation.parentRoleReference=angular.copy(u.model.formassociation.parentRole),u.model.formassociation.ChildRoleList=u.model.formassociation.RoleList.filter(function(e){return e.RoleId!==t.RoleId&&("TABLE-BASED"===e.RoleBehavior||"PARENT-CHILD"===e.RoleBehavior)}),u.model.formassociation.childRole=null,u.model.formassociation.selectedChildRole=null):(u.model.formassociation.childRole={RoleId:t.RoleId,RoleName:t.RoleName,TableName:t.TableName,TableData:t.TableData},u.model.formassociation.childRoleTableData=angular.copy(t.TableData),u.model.formassociation.parentRole=angular.copy(u.model.formassociation.parentRoleReference),"update"===u.model.manageType&&angular.forEach(u.model.formassociation.parentRole.TableData,function(e){e.AssociatedTableData=null}))})},onClick_OpenTableAssociationSelection:function(e){u.model.formassociation.itemSelected=e,u.model.formassociation.childRoleTableDataReference=angular.copy(u.model.formassociation.childRoleTableData),angular.element("#manageassociationselectionModal").modal("show")},onClick_AssignAssociation:function(){var t=u.model.formassociation.parentRole.TableData.find(function(e){return e.TableDataRoleId===u.model.formassociation.itemSelected.TableDataRoleId}),e=u.model.formassociation.childRoleTableDataReference.filter(function(e){return e.isSelected});r.objectIsNullorUndefined(t.AssociatedTableData)&&0<e.length&&(t.AssociatedTableData=[]);0<e.length&&angular.forEach(e,function(e){t.AssociatedTableData.unshift(e)});u.model.formassociation.childRoleTableDataReference=u.model.formassociation.childRoleTableDataReference.filter(function(e){return!e.isSelected}),u.model.formassociation.childRoleTableData=angular.copy(u.model.formassociation.childRoleTableDataReference),angular.element("#manageassociationselectionModal").modal("hide")},onClick_SelectAssociation:function(e){e.isSelected=!e.isSelected},onClick_OpenManageRoleAssociation:function(t){u.model.manageType="update",p(t),u.model.formassociation.ChildRoleList=u.model.formassociation.RoleList.filter(function(e){return e.RoleId!==t.RoleId&&("TABLE-BASED"===e.RoleBehavior||"PARENT-CHILD"===e.RoleBehavior)})},onClick_DeleteAssociation:function(e,t){e.AssociatedTableData=e.AssociatedTableData.filter(function(e){return angular.toJson(e)!==angular.toJson(t)}),t.isSelected=!1,u.model.formassociation.childRoleTableData.unshift(t)},onClick_AddNewCondition:function(){u.model.formconditional.RoleList=u.model.roleList.filter(function(e){return e.RoleId!==u.model.formconditional.RoleId}),u.model.formconditional.type="add-condition",u.model.formconditional.SelectedOracleHierarchy=null,u.model.formconditional.SelectedImportedHierarchy=null,u.model.formconditional.SelectedDerivedRole=null,angular.element("#manageNewConditionModal").modal("show")},onClick_AddNewConditionalRow:function(){if(1<=u.model.formconditional.ConditionalRoles.filter(function(e){return e.OracleHierarchyCode===u.model.formconditional.SelectedOracleHierarchy.OracleHierarchyCode&&e.ImportedHierarchyCode===u.model.formconditional.SelectedImportedHierarchy.ImportedHierarchyCode&&e.DerivedRoleId===u.model.formconditional.SelectedDerivedRole.RoleId}).length)o.alertWarning("Duplicate Condition","This condition already exists.");else{var e={ConditionalRoleId:0,RoleId:u.model.formconditional.RoleId,OracleHierarchyCode:u.model.formconditional.SelectedOracleHierarchy.OracleHierarchyCode,OracleHierarchyDisplay:u.model.formconditional.SelectedOracleHierarchy.OracleHierarchyDisplay,ImportedHierarchyCode:u.model.formconditional.SelectedImportedHierarchy.ImportedHierarchyCode,ImportedHierarchyDisplay:u.model.formconditional.SelectedImportedHierarchy.ImportedHierarchyDisplay,DerivedRoleId:u.model.formconditional.SelectedDerivedRole.RoleId,DerivedRoleName:u.model.formconditional.SelectedDerivedRole.RoleName,Action:"I"};u.model.formconditional.ConditionalRoles.unshift(e),angular.element("#manageNewConditionModal").modal("hide")}},onClick_RemoveCondition:function(t){if(u.model.formconditional.ConditionalRoles=u.model.formconditional.ConditionalRoles.filter(function(e){return angular.toJson(e)!==angular.toJson(t)}),0!==t.ConditionalRoleId){u.model.formconditional.ConditionalRolesDeleted.find(function(e){return e.ConditionalRoleId===t.ConditionalRoleId})||(t.Action="D",u.model.formconditional.ConditionalRolesDeleted.push(t))}},onClick_UpdateCondition:function(t){u.model.formconditional.type="update-condition",u.model.formconditional.UpdateConditionalRow=t,u.model.formconditional.UpdateConditionalRowReference=angular.copy(t),u.model.formconditional.RoleList=u.model.roleList.filter(function(e){return e.RoleId!==u.model.formconditional.RoleId}),u.model.formconditional.SelectedOracleHierarchy=u.model.OracleHierarchyList.find(function(e){return e.OracleHierarchyCode===t.OracleHierarchyCode}),n.ImportedHierarchyList=[],l.GetImportedHierarchy().then(function(e){n.ImportedHierarchyList=e,u.model.formconditional.SelectedImportedHierarchy=u.model.ImportedHierarchyList.find(function(e){return e.ImportedHierarchyCode===t.ImportedHierarchyCode}),u.model.formconditional.SelectedDerivedRole=u.model.formconditional.RoleList.find(function(e){return e.RoleId===t.DerivedRoleId}),angular.element("#manageNewConditionModal").modal("show")})},onClick_UpdateConditionalRow:function(){u.model.formconditional.UpdateConditionalRow.OracleHierarchyCode=u.model.formconditional.SelectedOracleHierarchy.OracleHierarchyCode,u.model.formconditional.UpdateConditionalRow.OracleHierarchyDisplay=u.model.formconditional.SelectedOracleHierarchy.OracleHierarchyDisplay,u.model.formconditional.UpdateConditionalRow.ImportedHierarchyCode=u.model.formconditional.SelectedImportedHierarchy.ImportedHierarchyCode,u.model.formconditional.UpdateConditionalRow.ImportedHierarchyDisplay=u.model.formconditional.SelectedImportedHierarchy.ImportedHierarchyDisplay,u.model.formconditional.UpdateConditionalRow.DerivedRoleId=u.model.formconditional.SelectedDerivedRole.RoleId,u.model.formconditional.UpdateConditionalRow.DerivedRoleName=u.model.formconditional.SelectedDerivedRole.RoleName;var e=u.model.formconditional.ConditionalRoles.filter(function(e){return e.OracleHierarchyCode===u.model.formconditional.SelectedOracleHierarchy.OracleHierarchyCode&&e.ImportedHierarchyCode===u.model.formconditional.SelectedImportedHierarchy.ImportedHierarchyCode&&e.DerivedRoleId===u.model.formconditional.SelectedDerivedRole.RoleId});r.objectIsNullorUndefined(e)?angular.element("#manageNewConditionModal").modal("hide"):2<=e.length?(u.model.formconditional.UpdateConditionalRow.OracleHierarchyCode=u.model.formconditional.UpdateConditionalRowReference.OracleHierarchyCode,u.model.formconditional.UpdateConditionalRow.OracleHierarchyDisplay=u.model.formconditional.UpdateConditionalRowReference.OracleHierarchyDisplay,u.model.formconditional.UpdateConditionalRow.ImportedHierarchyCode=u.model.formconditional.UpdateConditionalRowReference.ImportedHierarchyCode,u.model.formconditional.UpdateConditionalRow.ImportedHierarchyDisplay=u.model.formconditional.UpdateConditionalRowReference.ImportedHierarchyDisplay,u.model.formconditional.UpdateConditionalRow.DerivedRoleId=u.model.formconditional.UpdateConditionalRowReference.DerivedRoleId,u.model.formconditional.UpdateConditionalRow.DerivedRoleName=u.model.formconditional.UpdateConditionalRowReference.DerivedRoleName,o.alertWarning("Duplicate Condition","This condition already exists.")):(0!==u.model.formconditional.UpdateConditionalRow.ConditionalRoleId&&(u.model.formconditional.UpdateConditionalRow.Action="U"),angular.element("#manageNewConditionModal").modal("hide"))},OnChange_OracleHierarchy:function(){n.ImportedHierarchyList=[],l.GetImportedHierarchy().then(function(e){n.ImportedHierarchyList=e})},onClick_OpenRoleLookupInformation:function(t){u.model.roleLookupTitle=null,l.GetRoleLookupInformation(t.RoleId).then(function(e){u.model.roleLookupTitle=angular.copy(t.RoleName),angular.element("#lookupInformation").modal("show")})},onClick_AddSelectedMember:function(e){switch(e){case"UNIVERSAL":!function(){angular.isUndefined(u.validations.checkDuplicatesFromList(u.model.form.EmployeeList,u.model.form.EmployeeSelected,"MemberUsername"))?u.model.form.EmployeeList.unshift(u.model.form.EmployeeSelected):o.alertWarning("Duplicate Employee",u.model.form.EmployeeSelected.MemberDisplayName+" is already a member.");u.model.form.EmployeeSelected=null,u.model.form.EmployeeSearched=null,angular.element("#searchEmployee").focus()}();break;case"TABLE-BASED":!function(){angular.isUndefined(u.validations.checkDuplicatesFromList(u.model.formtablebased.form.EmployeeList,u.model.formtablebased.form.EmployeeSelected,"MemberUsername"))?u.model.formtablebased.form.EmployeeList.unshift(u.model.formtablebased.form.EmployeeSelected):o.alertWarning("Duplicate Employee",u.model.formtablebased.form.EmployeeSelected.MemberDisplayName+" is already a member.");u.model.formtablebased.form.EmployeeSelected=null,u.model.formtablebased.form.EmployeeSearched=null,angular.element("#searchEmployee").focus()}()}},onClick_SaveChanges:function(t){!function(e){var t={RoleId:null,RoleName:""};switch(e){case"universal":t={RoleId:u.model.form.RoleId,RoleName:u.model.form.RoleName};break;case"tablebased":t={RoleId:u.model.formtablebased.RoleId,RoleName:u.model.formtablebased.RoleName};break;case"conditional":t={RoleId:u.model.formconditional.RoleId,RoleName:u.model.formconditional.RoleName};break;case"lookup":t={RoleId:u.model.formlookup.RoleId,RoleName:u.model.formlookup.RoleName}}return 0!==u.model.roleList.filter(function(e){return e.RoleName.toLowerCase()===t.RoleName.toLowerCase()&&e.RoleId!==t.RoleId}).length}(t)?o.alertConfirm("Saving Changes","Are you sure you want to save "+u.model.form.RoleName+"?",function(){return l.InsertUpdateRole(t).then(function(e){if(null===e){switch(t){case"universal":angular.element("#manageRoleModal").modal("hide");break;case"tablebased":angular.element("#manageTableBasedRoleModal").modal("hide");break;case"association":angular.element("#manageAssociationRoleModal").modal("hide");break;case"conditional":angular.element("#manageConditionalRoleModal").modal("hide");break;case"lookup":angular.element("#manageLookupRoleModal").modal("hide")}o.alertSuccess("Success",("add"===u.model.manageType?"Added ":"Updated ")+u.model.form.RoleName+" successfully!",3e3),l.ClearForm(),l.GetRoles()}})},function(){},"Yes","No",!0):o.alertWarning("Duplicate Role","This role already exists.")}},u.validations={universalrolevalidation:function(e){if(angular.isDefined(e.EmployeeList)&&(e.EmployeeList.length<=0||r.stringIsNullUndefinedOrEmpty(e.RoleName)||angular.equals(e.EmployeeList,u.model.form.EmployeeListReference)&&angular.equals(e.RoleName,u.model.form.RoleNameReference)))return!0;return!1},tabledatarolevalidation:function(e){if(angular.isDefined(e.EmployeeList)&&(e.EmployeeList.length<=0||r.stringIsNullUndefinedOrEmpty(e.TableDataName)||angular.equals(e.EmployeeList,u.model.formtablebased.form.EmployeeListReference)&&angular.equals(e.TableDataName,u.model.formtablebased.form.TableDataNameReference)))return!0;return!1},tablebasedrolevalidation:function(e){if(angular.isDefined(e.TableData)&&(r.stringIsNullUndefinedOrEmpty(e.RoleName)||r.stringIsNullUndefinedOrEmpty(e.TableName)||0===e.TableData.length||angular.equals(e.RoleName,e.RoleNameReference)&&angular.equals(e.TableName,e.TableNameReference)&&angular.equals(e.TableData,e.TableDataReference)))return!0;return!1},associationrolevalidation:function(e){{if(r.objectIsNullorUndefined(e.parentRole)||r.objectIsNullorUndefined(e.childRole))return!0;var t=e.parentRole.TableData.find(function(e){return!r.objectIsNullorUndefined(e.AssociatedTableData)&&0<e.AssociatedTableData.length});if(r.objectIsNullorUndefined(t))return!0;if(0===t.AssociatedTableData.length)return!0;if(angular.equals(e.parentRole,e.parentRoleReference))return!0}return!1},newcoditionalrolevalidation:function(e){if(r.objectIsNullorUndefined(e.SelectedOracleHierarchy)||r.objectIsNullorUndefined(e.SelectedImportedHierarchy)||r.objectIsNullorUndefined(e.SelectedDerivedRole))return!0;return!1},conditionalrolevalidation:function(e){if(0===e.ConditionalRoles.length||r.stringIsNullUndefinedOrEmpty(e.RoleName)||angular.equals(e.RoleName,e.RoleNameReference)&&angular.equals(e.ConditionalRoles,e.ConditionalRolesReference))return!0;return!1},lookuprolevalidation:function(e){if(r.stringIsNullUndefinedOrEmpty(e.RoleName)||angular.equals(e.RoleName,e.RoleNameReference))return!0;return!1},checkDuplicatesFromList:function(e,t,n){return e.find(function(e){return e[n]==t[n]})}},l.GetRoles(),e.$on("$destroy",function(){n.ClearStore()})}angular.module("myApp").controller("AdminRoleController",e),e.$inject=["AdminRoleBusiness","AdminRoleStore","$scope","sweetDialogAlertService","astigUtilityService","orderByFilter","LookupService","MainBusiness","$q"]}(),function(){"use strict";function e(t){this.GetRoles=function(){return t.Get(l+"GetRoles",{cache:!1}).then(function(e){return e})},this.GetUniversalRoleMembers=function(e){return t.Get(l+"GetUniversalRoleMembers?roleId="+e,{cache:!1}).then(function(e){return e})},this.InsertUpdateUniversalRole=function(e){return t.Post(l+"InsertUpdateUniversalRole",e).then(function(e){return e})},this.InsertUpdateTableBasedRole=function(e){return t.Post(l+"InsertUpdateTableBasedRole",e).then(function(e){return e})},this.GetTableBasedRoleInformation=function(e){return t.Get(l+"GetTableBasedRoleInformation?roleId="+e,{cache:!1}).then(function(e){return e})},this.InsertUpdateAssociationRole=function(e){return t.Post(l+"InsertUpdateAssociationRole",e).then(function(e){return e})},this.GetAssociatedRoleInformation=function(e){return t.Get(l+"GetAssociatedRoleInformation?roleId="+e,{cache:!1}).then(function(e){return e})},this.InsertUpdateConditionalRole=function(e){return t.Post(l+"InsertUpdateConditionalRole",e).then(function(e){return e})},this.GetConditionalRoleInformation=function(e){return t.Get(l+"GetConditionalRoleInformation?roleId="+e,{cache:!1}).then(function(e){return e})},this.InsertUpdateLookupRole=function(e){return t.Post(l+"InsertUpdateLookupRole",e).then(function(e){return e})},this.DeleteRole=function(e){return t.Post(l+"DeleteRole",e).then(function(e){return e})},this.GetImportedHierarchy=function(e){return t.Get(l+"GetImportedHierarchy/"+e,{cache:!1}).then(function(e){return e})},this.GetRoleLookupInformation=function(e){return t.Post(n,e).then(function(e){return e})},this.GetRoleAssignments=function(e){return t.Get(l+"RoleAssignments/"+e,{cache:!1}).then(function(e){return e})};var n=ApiRootDirectory.absoluteRootUrl+"api/Generic/Data",l=ApiRootDirectory.absoluteRootUrl+"api/role/"}angular.module("myApp").service("AdminRoleService",e),e.$inject=["DataAccess"]}(),function(){"use strict";function e(e){function t(){this.search="",this.roleList=[],this.pageSizes=e,this.currentPageSize=10,this.sortAction=!1,this.sortProperty="",this.manageType="",this.associationtype="",this.form={RoleId:null,RoleName:"",RoleNameReference:"",EmployeeSearched:null,EmployeeSelected:null,EmployeeListReference:[],EmployeeList:[]},this.formtablebased={RoleId:null,RoleName:"",RoleNameReference:"",TableName:"",TableNameReference:"",TableData:[],TableDataReference:[],form:{TableDataRoleId:null,TableDataName:"",TableDataNameReference:"",EmployeeSearched:null,EmployeeSelected:null,EmployeeListReference:[],EmployeeList:[]}},this.formassociation={RoleList:[],ChildRoleList:[],selectedParentRole:null,selectedChildRole:null,itemSelected:null,parentRole:null,parentRoleReference:null,parentParentRole:null,childRole:null,childRoleTableData:null,childRoleTableDataReference:null},this.formconditional={RoleList:[],type:"",RoleId:null,RoleName:"",RoleNameReference:"",ConditionalRoles:[],ConditionalRolesDeleted:[],ConditionalRolesReference:[],SelectedOracleHierarchy:{},SelectedImportedHierarchy:{},SelectedDerivedRole:{},UpdateConditionalRow:{},UpdateConditionalRowReference:{}},this.formlookup={RoleId:null,RoleName:"",RoleNameReference:""},this.roleAssignmentList=[],this.roleLookupInformationList=[],this.roleLookupTitle=null,this.assignmentPageSizes=e,this.currentAssignmentPageSize=10,this.searchAssginment="",this.sortAssignmentPendingActionProperty="",this.sortAssignmentPendingAction=!1,this.OracleHierarchyList=[{OracleHierarchyCode:"DIVISION",OracleHierarchyDisplay:"WSP USA Oracle Division"},{OracleHierarchyCode:"DISTRICT",OracleHierarchyDisplay:"WSP USA Oracle District"},{OracleHierarchyCode:"AREA",OracleHierarchyDisplay:"WSP USA Oracle Area"},{OracleHierarchyCode:"COSTCENTER",OracleHierarchyDisplay:"WSP USA Oracle Cost Center"}],this.ImportedHierarchyList=[]}return t.prototype.ClearStore=function(){this.search="",this.roleList=[],this.pageSizes=e,this.currentPageSize=10,this.sortAction=!1,this.sortProperty="",this.manageType="",this.form={RoleId:null,RoleName:"",RoleNameReference:"",EmployeeSearched:null,EmployeeSelected:null,EmployeeListReference:[],EmployeeList:[]},this.formtablebased={RoleId:null,RoleName:"",RoleNameReference:"",TableName:"",TableNameReference:"",TableData:[],TableDataReference:[],form:{TableDataRoleId:null,TableDataName:"",TableDataNameReference:"",EmployeeSearched:null,EmployeeSelected:null,EmployeeListReference:[],EmployeeList:[]}},this.formassociation={RoleList:[],ChildRoleList:[],selectedParentRole:null,selectedChildRole:null,itemSelected:null,parentRole:null,parentRoleReference:null,parentParentRole:null,childRole:null,childRoleTableData:null,childRoleTableDataReference:null},this.formconditional={RoleList:[],type:"",RoleId:null,RoleName:"",RoleNameReference:"",ConditionalRoles:[],ConditionalRolesDeleted:[],ConditionalRolesReference:[],SelectedOracleHierarchy:{},SelectedImportedHierarchy:{},SelectedDerivedRole:{},UpdateConditionalRow:{},UpdateConditionalRowReference:{}},this.formlookup={RoleId:null,RoleName:"",RoleNameReference:""},this.roleAssignmentList=[],this.roleLookupInformationList=[],this.roleLookupTitle=null,this.assignmentPageSizes=e,this.currentAssignmentPageSize=10,this.searchAssginment="",this.sortAssignmentPendingActionProperty="",this.sortAssignmentPendingAction=!1,this.OracleHierarchyList=[{OracleHierarchyCode:"DIVISION",OracleHierarchyDisplay:"WSP USA Oracle Division"},{OracleHierarchyCode:"DISTRICT",OracleHierarchyDisplay:"WSP USA Oracle District"},{OracleHierarchyCode:"AREA",OracleHierarchyDisplay:"WSP USA Oracle Area"},{OracleHierarchyCode:"COSTCENTER",OracleHierarchyDisplay:"WSP USA Oracle Cost Center"}],this.ImportedHierarchyList=[{ImportedHierarchyCode:"TRSC",ImportedHierarchyDisplay:"TRSC US ADVISORY SERVICES"},{ImportedHierarchyCode:"BLDV",ImportedHierarchyDisplay:"BLDV BUILDINGS DIVISION"},{ImportedHierarchyCode:"POWER",ImportedHierarchyDisplay:"US POWER DIVISION"},{ImportedHierarchyCode:"FEDV",ImportedHierarchyDisplay:"FEDV FEDERAL DIVISION"},{ImportedHierarchyCode:"TRNV",ImportedHierarchyDisplay:"TRNV TRANSPORTATION DIVISION"},{ImportedHierarchyCode:"VENV",ImportedHierarchyDisplay:"VENV WATER AND ENV DIV"}]},new t}angular.module("myApp").factory("AdminRoleStore",e),e.$inject=["PageSizes"]}(),function(){"use strict";function e(n,t,e){this.GetWaivers=function(){return t.GetWaivers().then(function(e){n.waiverTeamList=e,n.waiverTeamListCopy=angular.copy(e)})},this.SetSelectedEmployee=function(e,t){n.selectedEmployeeSearch={WaiverUsername:e.EMAIL_ADDRESS,WaiverDisplayName:e.FULL_NAME,WaiverEmail:e.EMAIL_ADDRESS,OrganizationCode:t}},this.AddSelectedEmployee=function(){n.waiverTeamList.unshift(n.selectedEmployeeSearch)},this.ClearSelectedEmployee=function(){n.employeeSearch=null,n.selectedEmployeeSearch=null},this.RemoveEmployee=function(t){n.waiverTeamList=n.waiverTeamList.filter(function(e){return angular.toJson(t)!==angular.toJson(e)})},this.InsertDeleteWaivers=function(){var e={Waivers:angular.copy(n.waiverTeamList.filter(function(e){return e.OrganizationCode===n.selectedOrg.OrganizationCode})),OrganizationCode:n.selectedOrg.OrganizationCode};return t.InsertDeleteWaivers(e).then(function(e){return e})},this.CheckDuplicateWaiverTeam=function(){return n.waiverTeamList.find(function(e){return e.WaiverUsername===n.selectedEmployeeSearch.WaiverUsername&&e.WaiverDisplayName===n.selectedEmployeeSearch.WaiverDisplayName&&e.WaiverEmail===n.selectedEmployeeSearch.WaiverEmail&&e.OrganizationCode===n.selectedEmployeeSearch.OrganizationCode})},this.CancelChanges=function(){n.waiverTeamList=[],n.waiverTeamList=angular.copy(n.waiverTeamListCopy)},this.GetOrganizationLookup=function(){return e.GetOrganizationLookup().then(function(e){n.orgList=e})},this.ChangePageSize=function(e){n.currentPageSize=e},Object.preventExtensions(n)}angular.module("myApp").service("AdminWaiverTeamBusiness",e),e.$inject=["AdminWaiverTeamStore","AdminWaiverTeamService","LookupService"]}(),function(){"use strict";function e(t,e,n,l,o,r){var i=this;function a(){return!angular.equals(i.model.waiverTeamList,i.model.waiverTeamListCopy)}i.model=e,i.events={onSelect_SearchEmployee:function(e){t.SetSelectedEmployee(e.value,i.model.selectedOrg.OrganizationCode),angular.element("#addEmployeeSearch").focus()},searchEmployee:function(e,t){l.SearchEmployee(e.term,10).then(function(e){e&&t(e.map(function(e){return{label:e.FULL_NAME,value:e}}))})},onClick_AddSelectedEmployee:function(){angular.isUndefined(t.CheckDuplicateWaiverTeam())?t.AddSelectedEmployee():n.alertWarning("Duplicate Employee","<strong>"+i.model.selectedEmployeeSearch.WaiverDisplayName+"</strong> is already a member.");t.ClearSelectedEmployee(),angular.element("#searchEmployee").focus()},onClick_RemoveEmployee:function(e){t.RemoveEmployee(e)},onClick_Cancel:function(){a()&&n.alertConfirm("Cancel Changes","Are you sure you want to cancel your changes?",function(){i.model.waiverTeamList=[],i.model.waiverTeamList=angular.copy(i.model.waiverTeamListCopy),o.$apply()},angular.noop,"Yes","No",!0)},onClick_SaveChanges:function(){a()&&n.alertConfirm("Saving Changes","Are you sure you want to save your changes?",function(){return t.InsertDeleteWaivers().then(function(e){null===e&&(n.alertSuccess("Success","Successfully saved waiver team!",3e3),t.GetWaivers())})},function(){},"Yes","No",!0)},hasChanges:a,onSort_Field:function(e){i.model.sortPendingAction=!i.model.sortPendingAction,i.model.sortPendingActionProperty=e,i.model.waiverTeamList=r(i.model.waiverTeamList,e,i.model.sortPendingAction),i.model.waiverTeamListCopy=r(i.model.waiverTeamList,e,i.model.sortPendingAction)},onChange_PageSize:function(e){t.ChangePageSize(e)}},t.GetOrganizationLookup(),t.GetWaivers(),o.$on("$destroy",function(){i.model.ClearStore()})}angular.module("myApp").controller("AdminWaiverTeamController",e),e.$inject=["AdminWaiverTeamBusiness","AdminWaiverTeamStore","sweetDialogAlertService","LookupService","$scope","orderByFilter"]}(),function(){"use strict";function e(t){this.GetWaivers=function(){return t.Get(n+"GetWaivers").then(function(e){return e})},this.InsertDeleteWaivers=function(e){return t.Post(n+"InsertDeleteWaivers",e).then(function(e){return e})};var n=ApiRootDirectory.absoluteRootUrl+"api/Waiver/"}angular.module("myApp").service("AdminWaiverTeamService",e),e.$inject=["DataAccess"]}(),function(){"use strict";function e(e){function t(){this.waiverTeamList=[],this.waiverTeamListCopy=[],this.employeeSearch=null,this.selectedEmployeeSearch=null,this.orgList=[],this.selectedOrg=null,this.sortPendingAction=!1,this.sortPendingActionProperty="",this.pageSizes=e,this.currentPageSize=5}return t.prototype.ClearStore=function(){this.waiverTeamList=[],this.waiverTeamListCopy=[],this.employeeSearch=null,this.selectedEmployeeSearch=null,this.orgList=[],this.selectedOrg=null,this.sortPendingAction=!1,this.sortPendingActionProperty="",this.pageSizes=e,this.currentPageSize=5},new t}angular.module("myApp").factory("AdminWaiverTeamStore",e),e.$inject=["PageSizes"]}(),function(){"use strict";angular.module("myApp").config(["$stateProvider","$urlRouterProvider",function(e,t){e.state({name:"am.approvalitems.list",url:"list",controller:"ApprovalItemsListController as vm",templateUrl:"app/views/approvalitems/list/index.html",data:{pageName:"Approval Items",breadcrumbList:[{name:"Approval Items",className:"",route:""}]}}).state({name:"am.approvalitems.details",url:"details/{org}/{approvalitemid}",params:{lookups:null},controller:"ApprovalItemsDetailsController as vm",templateUrl:"app/views/approvalitems/details/index.html",data:{pageName:"Approval Item Details",breadcrumbList:[{name:"Approval Items",className:"",route:""},{name:"Item Details",className:"",route:""}]}}).state({name:"am.approvalitems.resubmit",url:"resubmit/{org}/{requestid}",params:{resubmitComment:null,requestComment:null,defaultControlValues:null,requestDocuments:null,requestDetails:null},controller:"ApprovalItemsDetailsController as vm",templateUrl:"app/views/approvalitems/details/index.html",data:{pageName:"Resubmit Request",breadcrumbList:[{name:"Approval Items",className:"",route:""},{name:"Resubmit Request",className:"",route:""}]}}).state({name:"am.approvalitems.viewsaveddetails",url:"viewsaveddetails/{saveRequestId}",params:{saveRequestId:null,org:null},controller:"ApprovalItemsDetailsController as vm",templateUrl:"app/views/approvalitems/details/index.html",data:{pageName:"Approval Item Details",breadcrumbList:[{name:"Approval Items",className:"",route:""},{name:"Saved Request",className:"",route:""}]}}).state({name:"am.approvalitems.decision",url:"decision",params:{approvalitem:null},controller:"ApprovalItemsCascadingController as vm",templateUrl:"app/views/approvalitems/cascading/index.html",data:{pageName:"Approval Item (Decision Wizard)",breadcrumbList:[{name:"Approval Item",className:"",route:""},{name:"Decision Wizard",className:"",route:""}]}})}])}(),function(){"use strict";function e(n,e,t,l,o,r,i){this.GetLookupValueDetails=function(e){var t={RoleId:o.gNgFormRoleId,Parameters:{LOOKUP_VALUE:e}};return r.Search(t).then(function(e){void 0!==e[0]&&(n.objectDetails=e[0])})},this.InitializeLookups=function(e){n.lookups[e]=null},this.GetApprovalItemByRefNo=function(e){var t={RoleId:-99999965,Parameters:{Id:null,Data:"APPROVALITEMBYREFNO",RefNo:e}};return r.GetGenericData(t).then(function(e){return e})},Object.preventExtensions(n)}angular.module("myApp").service("ApprovalItemsCascadingBusiness",e),e.$inject=["ApprovalItemsCascadingStore","ApprovalItemsCascadingService","$filter","astigUtilityService","LookupRoleIds","LookupService","sweetDialogAlertService"]}(),function(){"use strict";function e(n,l,e,i,t,o,r,a){var s=this;function u(e){e<=1&&2<s.model.decisionPoints.length&&c(),function(e){for(var t=0;t<n.decisionPoints.length;t++)e<t&&(s.model.decisionPoints.splice(t,1),t--)}(e),d(e+1),p(e+1)}function c(){s.model.approvaldecisions=[],Object.keys(s.model.reference).forEach(function(e,t){if(s.model.reference[e].availableto.includes(s.model.approvalitem.RefNo)){var n=angular.copy(s.model.reference[e]);n.key=e,s.model.approvaldecisions.push(n),0}})}function d(e){if(0===e)s.model.decisionPoints=[];else{var t=e-1,n=s.model.decisionPoints[t];if("ecv"===n.key)return void(s.model.isDisabledNext=!1)}var l=angular.copy(s.model.approvaldecisions[e]);if(null!=l.condition)switch(l.condition){case"CLIENTOWNER":"01"!==s.model.decisionPoints[0].selected.RefNo&&"01"!==s.model.decisionPoints[1].selected.RefNo&&(s.model.approvaldecisions.splice(s.model.approvaldecisions[e],1),l=angular.copy(s.model.approvaldecisions[e]));break;case"ECV":Object.keys(s.model.decisionPoints).forEach(function(e){if("Delivery Method"===s.model.decisionPoints[e].title)if("02"===s.model.decisionPoints[e].selected.RefNo){var t="03"===s.model.decisionPoints[0].selected.RefNo||"03"===s.model.decisionPoints[1].selected.RefNo?"notbuild-private":"notbuild";l.list=l.list.filter(function(e){return e.condition===t})}else l.list=l.list.filter(function(e){return"build"===e.condition})})}if(0!==e&&n.selected.hasOwnProperty("Next")){var o=function(t){return angular.copy(s.model.approvaldecisions).find(function(e){return e.key===t})}(s.model.decisionPoints[t].selected.Next);if(null!=o.condition)switch(o.condition){case"ECV":Object.keys(s.model.decisionPoints).forEach(function(e){if("Delivery Method"===s.model.decisionPoints[e].title)if("02"===s.model.decisionPoints[e].selected.RefNo){var t="03"===s.model.decisionPoints[0].selected.RefNo||"03"===s.model.decisionPoints[1].selected.RefNo?"notbuild-private":"notbuild";o.list=o.list.filter(function(e){return e.condition===t})}else o.list=o.list.filter(function(e){return"build"===e.condition})})}l=angular.copy(o)}s.model.decisionPoints.push(l),s.model.isDisabledNext=!0}function p(e){if(!i.objectIsNullorUndefined(s.model.decisionPoints[e])&&null!==s.model.decisionPoints[e].objectKey){var n="";if(s.model.objectDetails.hasOwnProperty(s.model.decisionPoints[e].objectKey[s.model.lookup])&&(n=s.model.objectDetails[s.model.decisionPoints[e].objectKey[s.model.lookup]]),!i.stringIsNullUndefinedOrEmpty(n)||"ECV"===s.model.decisionPoints[e].defaultcondition){var l=null;if(s.model.decisionPoints[e].hasOwnProperty("defaultcondition")){if("CLIENTJVORINTERNAL"===s.model.decisionPoints[e].defaultcondition){if("JOINT VENTURE"===n.toUpperCase())if(s.model.objectDetails.TYPE.toUpperCase().includes("INTERNAL")){var t=s.model.objectDetails[s.model.approvaldecisions[e+1].objectKey[s.model.lookup]];(o=s.model.decisionPoints[e].list.find(function(e){return a.isInJsonArray(t.toUpperCase(),e.Values.IN)})).Values.IN.push(s.model.objectDetails.CLIENT_TYPE)}else{(o=s.model.decisionPoints[e].list.find(function(e){return"03"===e.RefNo})).Values.IN.push(s.model.objectDetails.CLIENT_TYPE)}if("WSP INTERNAL"===n.toUpperCase()){t=s.model.objectDetails[s.model.approvaldecisions[e+1].objectKey[s.model.lookup]];var o=s.model.decisionPoints[e].list.find(function(e){return a.isInJsonArray(t.toUpperCase(),e.Values.IN)});i.objectIsNullorUndefined(o)||o.Values.IN.push(s.model.objectDetails.CLIENT_TYPE)}}if("OWNERINTERNAL"===s.model.decisionPoints[e].defaultcondition&&"WSP INTERNAL"===n.toUpperCase()){t=s.model.objectDetails[s.model.decisionPoints[e-1].objectKey[s.model.lookup]],o=s.model.decisionPoints[e].list.find(function(e){return a.isInJsonArray(t.toUpperCase(),e.Values.IN)});i.objectIsNullorUndefined(o)||o.Values.IN.push(s.model.objectDetails.CLIENT_TYPE)}if("ECV"===s.model.decisionPoints[e].defaultcondition&&"01.06.02"!==s.model.approvalitem.RefNo.substring(0,8)){var r="TASK PIPELINE"===n.toUpperCase()?s.model.objectDetails.TASK_GROSS:s.model.objectDetails.EST_GROSS_ECV;s.model.decisionPoints[e].list.forEach(function(e){e.min<=r&&e.max>=r&&(l=e)})}}s.model.decisionPoints[e].list.forEach(function(t){t.hasOwnProperty("Values")&&null!==t.Values&&Object.keys(t.Values).forEach(function(e){switch(e){case"IN":a.isInJsonArray(n.toUpperCase(),t.Values[e])&&(l=t);break;case"LIKE":a.isInJsonArrayLike(n.toUpperCase(),t.Values[e])&&(l=t);break;case"NOTLIKE":a.isInJsonArrayLike(n.toUpperCase(),t.Values[e])||(l=t)}})}),i.objectIsNullorUndefined(l)||(s.model.decisionPoints[e].selected=l,u(e))}}}s.model=n,s.utility=i,s.events={onInitialize_Lookup:function(e){l.InitializeLookups(e)},onChange_DecisionDropdown:u,OnClick_Next:function(){var e=angular.copy(s.model.approvalitem.RefNo);e=function(e){var t=e;return Object.keys(s.model.decisionPoints).forEach(function(e){t=t.concat(".").concat(s.model.decisionPoints[e].selected.RefNo)}),t}(e),l.GetApprovalItemByRefNo(e).then(function(e){0<e.length&&o.go("am.approvalitems.details",{org:"WSPUSA",approvalitemid:e[0].ApprovalItemId,lookups:s.model.lookups})})},getFormType:function(){switch(s.model.approvalitem.RefNo){case"01.02":return"PRELIMINARY";case"01.03":return"FORMAL";default:return"NORMAL"}}},s.model.approvalitem=e.approvalitem,null==e.approvalitem&&o.go("am.approvalitems.list"),r.$watch("vm.model.lookups",function(e,t){!function(t,n){angular.equals(s.model.lookups,{})||Object.keys(t).forEach(function(e){null===t[e]||angular.equals(n[e],t[e])?(s.model.objectDetails=null,s.model.decisionPoints=[],s.model.approvaldecisions=[],s.model.isDisabledNext=!0):"OPPORTUNITYTEMPLATE"===(s.model.lookup=e)?l.GetLookupValueDetails(t[e].OBJECT_ID).then(function(e){c(),d(0),p(0)}):(s.model.objectDetails=angular.copy(t[e]),c(),d(0),p(0))})}(e,t)},!0),r.$on("$destroy",function(){s.model.ClearStore()})}angular.module("myApp").controller("ApprovalItemsCascadingController",e),e.$inject=["ApprovalItemsCascadingStore","ApprovalItemsCascadingBusiness","$stateParams","astigUtilityService","sweetDialogAlertService","$state","$scope","UtilService"]}(),function(){"use strict";function e(t){this.GetAllWizardDecisionPoints=function(e){return t.Get(n+"GetAllWizardDecisionPoints",{cache:!1}).then(function(e){return e})};var n=ApiRootDirectory.absoluteRootUrl+"api/Wizard/"}angular.module("myApp").service("ApprovalItemsCascadingService",e),e.$inject=["DataAccess"]}(),function(){"use strict";function e(){function e(){this.approvalitem=null,this.objectDetails=null,this.lookups={},this.decisionPoints=[],this.approvaldecisions=[],this.isDisabledNext=!0,this.lookup="",this.reference={client:{availableto:["01.02","01.03","01.06.01.01","01.06.01.02","01.06.02.01.01","01.06.02.01.02","01.06.02.02.01","01.06.02.02.02"],title:"Client",controltype:"radio",defaultcondition:"CLIENTJVORINTERNAL",selected:null,condition:null,objectKey:{OPPORTUNITYTEMPLATE:"CLIENT_TYPE",OPPORTUNITYAGREEMENTPROJECTSPECIALTEMPLATE:"CLIENT_TYPE"},list:[{RefNo:"01",Display:"Federal",Values:{IN:["Public - Federal"]}},{RefNo:"02",Display:"Public (Non-Federal)",Values:{IN:["Public - Regional/MPO","Public - State/Province","Public - Local/County"]}},{RefNo:"03",Display:"Private",Values:{IN:["Private","Regulated"]}}]},owner:{availableto:["01.02","01.03","01.06.01.01","01.06.01.02","01.06.02.01.01","01.06.02.01.02","01.06.02.02.01","01.06.02.02.02"],title:"Owner",controltype:"radio",defaultcondition:"OWNERJVORINTERNAL",selected:null,condition:null,objectKey:{OPPORTUNITYTEMPLATE:"UC_TYPE",OPPORTUNITYAGREEMENTPROJECTSPECIALTEMPLATE:"OWNER_TYPE"},list:[{RefNo:"01",Display:"Federal",Values:{IN:["Public - Federal"]}},{RefNo:"02",Display:"Public (Non-Federal)",Values:{IN:["Public - Regional/MPO","Public - State/Province","Public - Local/County"]}},{RefNo:"03",Display:"Private",Values:{IN:["Private","Regulated"]}}]},region:{availableto:["01.02","01.03","01.06.01.01","01.06.01.02","01.06.02.02.01","01.06.02.02.02"],selected:null,controltype:"checkbox",condition:"CLIENTOWNER",objectKey:{OPPORTUNITYTEMPLATE:"DIVISION_NAME",OPPORTUNITYAGREEMENTPROJECTSPECIALTEMPLATE:"DIVISION_NAME"},title:"Project's P&L",list:[{RefNo:"01",Display:"In Federal Region",Values:{IN:["FEDV FEDERAL DIVISION"]}},{RefNo:"02",Display:"Outside Federal Region",Values:{IN:["AMGV","Central","Northeast","Southeast","West","Earth Environment"]}}]},deliverymethod:{availableto:["01.02","01.03","01.06.01.01","01.06.01.02","01.06.02.01.01","01.06.02.01.02","01.06.02.02.01","01.06.02.02.02"],selected:null,condition:null,controltype:"checkbox",objectKey:{OPPORTUNITYTEMPLATE:"DELIVERY_METHOD",OPPORTUNITYAGREEMENTPROJECTSPECIALTEMPLATE:"DELIVERY_METHOD"},title:"Delivery Method",list:[{RefNo:"01",Display:"Design Build",Values:{IN:["DESIGN/BUILD","DESIGN/BUILD/OPERATE/MAINTAIN","DESIGN/BUILD/FINANCE"," DESIGN/BUILD/OPERATE/TRANSFER"]}},{RefNo:"02",Display:"NOT Design Build / Others",Values:{IN:["DESIGN/BID/BUILD","PLANNING/STUDY","PFI","ENGINEER PROCURE CONSTRUCT","OPERATIONS AND MAINTENANCE","ENGINEER PROCURE CM","CM/GC","ALLIANCE","CONSTRUCTION MANAGEMENT","CONSTRUCTION ENG & INSPECTION","CM/GC CONTRACTOR","PPP - NO INVESTMENT","PPP - WITH INVESTMENT","CM AT-RISK","CM/CC OWNER"]}}]},risks:{availableto:["01.02","01.03","01.06.01.01","01.06.01.02","01.06.02.02.01","01.06.02.02.02"],selected:null,condition:null,controltype:"dropdown",title:"Country",objectKey:null,list:[{RefNo:"01",Display:"USA: Project, Client & Owner are all in USA"},{RefNo:"02",Display:"Outside US (Not High Risk): Project is Outside US, but not associated with a High Risk Country"},{RefNo:"03",Display:"High Risk or New Country: Either Project or Client or Owner is associated w/ Either a High Risk or New Country"}]},perDOA:{availableto:["01.02","01.03","01.06.01.01","01.06.01.02","01.06.02.02.01","01.06.02.02.02"],selected:null,condition:null,controltype:"checkbox",objectKey:null,title:"Risk Profile",list:[{RefNo:"01",Display:"Standard Risk Profile: No&nbsp;<b><a href='https://intranet.wspgroup.com/Documents/WSP-PB-USA/About%20Us/Delegations%20of%20Authority/2.0_US%20Pursuits%20and%20Projects%20Approval%20Authority%20Policy.pdf' target='_blank'>DoA</a></b>&nbsp;Risks Identified"},{RefNo:"02",Display:"High Risk Profile:&nbsp;<b><a href='https://intranet.wspgroup.com/Documents/WSP-PB-USA/About%20Us/Delegations%20of%20Authority/2.0_US%20Pursuits%20and%20Projects%20Approval%20Authority%20Policy.pdf' target='_blank'>DoA</a></b>&nbsp;Risks Identified"}]},pursuit:{availableto:["01.02","01.03","01.06.01.01","01.06.01.02","01.06.02.02.01","01.06.02.02.02"],selected:null,condition:null,controltype:"dropdown",objectKey:{OPPORTUNITYTEMPLATE:"AREA_NAME",OPPORTUNITYAGREEMENTPROJECTSPECIALTEMPLATE:"AREA_NAME"},title:"Business Line",hover:"New Line of Business is a line of business not conducted by any WSP USA entity in the past 3 years.",list:[{RefNo:"01",Display:"New Line of Business",Next:"ecv",Values:null},{RefNo:"02",Display:"Standard Business Line",Next:"ecv",Values:{NOTLIKE:["ADVISORY","CRS"," EE"]}},{RefNo:"03",Display:"Advisory Services",Next:"advisory",Values:{LIKE:["Advisory"]}},{RefNo:"04",Display:"Climate Resilience & Sustainability (CRS)",Next:"climate",Values:{LIKE:["CRS"]}},{RefNo:"05",Display:"Earth & Environment",Next:"ecv",Values:{LIKE:[" EE"]}}]},advisory:{availableto:["01.02","01.03","01.06.01.01","01.06.01.02","01.06.02.02.01","01.06.02.02.02"],selected:null,condition:null,controltype:"dropdown",title:"Advisory",objectKey:null,list:[{RefNo:"01",Display:"Planning",Next:"ecv"},{RefNo:"02",Display:"Communications & Public Involvement (CPI)",Next:"ecv"},{RefNo:"03",Display:"Management Consulting Advisory Services (MCAS)",Next:"ecv"}]},climate:{availableto:["01.02","01.03","01.06.01.01","01.06.01.02","01.06.02.02.01","01.06.02.02.02"],selected:null,condition:null,controltype:"dropdown",objectKey:null,title:"Climate Resilience & Sustainability",list:[{RefNo:"01",Display:"Sustainability, Energy & Climate Change (SECC)",Next:"ecv"},{RefNo:"02",Display:"Resilience",Next:"ecv"},{RefNo:"03",Display:"Emergency Management (EM)",Next:"ecv"}]},ecv:{availableto:["01.02","01.03","01.06.01.01","01.06.01.02","01.06.02.01.01","01.06.02.01.02","01.06.02.02.01","01.06.02.02.02"],selected:null,condition:"ECV",defaultcondition:"ECV",controltype:"dropdown",objectKey:{OPPORTUNITYTEMPLATE:"CRM_STATUS",OPPORTUNITYAGREEMENTPROJECTSPECIALTEMPLATE:"CRM_STATUS"},title:"ECV",list:[{RefNo:"01",Display:"ECV < $5M",condition:"build",min:0,max:4999999},{RefNo:"02",Display:"ECV ≥ $5M but < $15M",condition:"build",min:5e6,max:14999999},{RefNo:"03",Display:"ECV ≥ $15M but < $25M",condition:"build",min:15e6,max:24999999},{RefNo:"04",Display:"ECV ≥ $25M but < $30M",condition:"build",min:25e6,max:29999999},{RefNo:"05",Display:"ECV ≥ $30M",condition:"build",min:3e7,max:1e11},{RefNo:"01",Display:"ECV < $500K",condition:"notbuild",min:0,max:499999},{RefNo:"02",Display:"ECV ≥ $500K but <$1M",condition:"notbuild",min:5e5,max:999999},{RefNo:"03",Display:"ECV ≥ $1M but <$5M",condition:"notbuild",min:1e6,max:4999999},{RefNo:"04",Display:"ECV ≥ $5M but <$9M",condition:"notbuild",min:5e6,max:8999999},{RefNo:"05",Display:"ECV ≥ $9M but <$14M",condition:"notbuild",min:9e6,max:13999999},{RefNo:"06",Display:"ECV ≥ $14M but <$22M",condition:"notbuild",min:14e6,max:21999999},{RefNo:"07",Display:"ECV ≥ $22M but <$30M",condition:"notbuild",min:22e6,max:29999999},{RefNo:"08",Display:"ECV ≥ $30M",condition:"notbuild",min:3e7,max:1e11},{RefNo:"01",Display:"ECV < $100K",condition:"notbuild-private",min:0,max:99999},{RefNo:"02",Display:"ECV ≥ $100K but <$200K",condition:"notbuild-private",min:1e5,max:199999},{RefNo:"03",Display:"ECV ≥ $200K but <$750K",condition:"notbuild-private",min:2e5,max:749999},{RefNo:"04",Display:"ECV ≥ $750K but <$2.5M",condition:"notbuild-private",min:75e4,max:2499999},{RefNo:"05",Display:"ECV ≥ $2.5M but <$5M",condition:"notbuild-private",min:25e5,max:4999999},{RefNo:"06",Display:"ECV ≥ $5M but <$10M",condition:"notbuild-private",min:5e6,max:9999999},{RefNo:"07",Display:"ECV ≥ $10M but <$30M",condition:"notbuild-private",min:1e7,max:29999999},{RefNo:"08",Display:"ECV ≥ $30M",condition:"notbuild-private",min:3e7,max:1e11}]}},this.refdetails={"01.02":null,"01.03":null,"01.06.01.01":{list:[{RefNo:"01.06.01",Display:"Initial Contract (incl. Master Contracts, Task Orders & Stand Alone Agreements)"},{RefNo:"01.06.01.01",Display:"Bid includes Pricing / Cost Estimate"}]},"01.06.01.02":{list:[{RefNo:"01.06.01",Display:"Initial Contract (incl. Master Contracts, Task Orders & Stand Alone Agreements)"},{RefNo:"01.06.01.02",Display:"Bid is Quals-Based Only (sans Pricing)"}]},"01.06.02.01.01":{list:[{RefNo:"01.06.02",Display:"Change Request (CR) to Existing Contract"},{RefNo:"01.06.02.01",Display:"Same Essential Risk Profile (as already established contract)"},{RefNo:"01.06.02.01.01",Display:"CR <30% of Original Contract Value"}]},"01.06.02.01.02":{list:[{RefNo:"01.06.02",Display:"Change Request (CR) to Existing Contract"},{RefNo:"01.06.02.01",Display:"Same Essential Risk Profile (as already established contract)"},{RefNo:"01.06.02.01.02",Display:"CR ≥30% of Original Contract Value"}]},"01.06.02.02.01":{list:[{RefNo:"01.06.02",Display:"Change Request (CR) to Existing Contract"},{RefNo:"01.06.02.02",Display:"Materially Different Terms / Risk (compared against existing contract)"},{RefNo:"01.06.02.02.01",Display:"CR includes Pricing / Cost Estimate"}]},"01.06.02.02.02":{list:[{RefNo:"01.06.02",Display:"Change Request (CR) to Existing Contract"},{RefNo:"01.06.02.02",Display:"Materially Different Terms / Risk (compared against existing contract)"},{RefNo:"01.06.02.02.02",Display:"CR does not include Pricing / Costs"}]}}}return e.prototype.ClearStore=function(){this.approvalitem=null,this.objectDetails=null,this.lookups={},this.decisionPoints=[],this.approvaldecisions=[],this.isDisabledNext=!0,this.lookup=""},new e}angular.module("myApp").factory("ApprovalItemsCascadingStore",e),e.$inject=[]}(),function(){"use strict";function e(u,n,c,a,d,l,p,o,r,m,i,s,e,f,g,v){function I(l){var t=[],n=!1,o={},r=[],i=!1;if("CASCADINGORACLEHIERARCHYTEMPLATE"===l&&!p.objectIsNullorUndefined(u.lookups.CASCADINGORACLEHIERARCHYTEMPLATE)){if(!u.lookups.CASCADINGORACLEHIERARCHYTEMPLATE.hasOwnProperty("LOCAL_BUSINESS_LINE"))return;if(p.objectIsNullorUndefined(u.lookups.CASCADINGORACLEHIERARCHYTEMPLATE.LOCAL_BUSINESS_LINE))return}return u.approvalItem.detail.ApprovalItemSteps.forEach(function(e){if(e.LookupValue===l)switch(e.RoleType){case"LOOKUP":e.MainApprovers=[],e.NoApprovers=!1,e.HasChanged=!0,p.objectIsNullorUndefined(u.lookups[e.LookupValue])?n=!0:(e.NoApprovers=!0,r.push(e),t.push(function(n){var e={RoleId:n.CostPointRoleId,Parameters:{OBJECT_ID:u.lookups[n.LookupValue].OBJECT_ID,COST_CENTER_ID:u.lookups[n.LookupValue].COST_CENTER_ID,LOOKUP:u.lookups[n.LookupValue].LOOKUP}};return a.SearchApprover(e).then(function(e){return n.MainApprovers=[],e.forEach(function(e){var t={MainApproverUsername:e.EMAIL,MainApproverDisplayName:e.LAST_FIRST_NAME,MainApproverEmail:e.EMAIL,IsActive:e.ISACTIVE};n.MainApprovers.push(t),0!==n.MainApprovers.length&&(n.NoApprovers=!1)}),n})}(e)));break;case"CONDITIONAL LOOKUP":e.DerivedRoleType=null,e.DerivedRoleBehavior=null,e.MainApprovers=[],e.NoApprovers=!1,e.HasChanged=!0,delete e.TableData,p.objectIsNullorUndefined(u.lookups[e.LookupValue])?n=!0:(e.NoApprovers=!0,r.push(e),t.push(function(n){var e={RoleId:n.CostPointRoleId,Parameters:{OBJECT_ID:u.lookups[n.LookupValue].OBJECT_ID,COST_CENTER_ID:u.lookups[n.LookupValue].COST_CENTER_ID,LOOKUP:u.lookups[n.LookupValue].LOOKUP}};return a.SearchApprover(e).then(function(e){if(!p.objectIsNullorUndefined(e[0])){if("UNIVERSAL"===e[0].DerivedRoleType&&(e.forEach(function(e){var t={MainApproverUsername:e.EMAIL,MainApproverDisplayName:e.LAST_FIRST_NAME,MainApproverEmail:e.EMAIL,IsActive:e.ISACTIVE};n.MainApprovers.push(t)}),n.DerivedRoleType=e[0].DerivedRoleType,n.DerivedRoleId=e[0].DerivedRoleId,n.DerivedRoleBehavior=e[0].DerivedRoleBehavior,0!==n.MainApprovers.length&&(n.NoApprovers=!1)),"TABLE-BASED"===e[0].DerivedRoleType){n.DerivedRoleType=e[0].DerivedRoleType,n.DerivedRoleId=e[0].DerivedRoleId,n.DerivedRoleBehavior=e[0].DerivedRoleBehavior,n.DerivedChildRoleIds=e[0].DerivedChildRoleIds;var o=[];e.forEach(function(t){var e=o.find(function(e){return e.TableDataRoleId===t.TableDataRoleId});if(p.objectIsNullorUndefined(e)){var n={TableDataRoleId:t.TableDataRoleId,TableDataName:t.TableDataName,ParentTableDataRoleId:t.ParentTableDataRoleId,TableDataMembers:[],DerivedParentTableDataRoleIds:t.DerivedParentTableDataRoleIds},l={MainApproverUsername:t.EMAIL,MainApproverDisplayName:t.LAST_FIRST_NAME,MainApproverEmail:t.EMAIL,IsActive:t.ISACTIVE};n.TableDataMembers.push(l),o.push(n)}else{l={MainApproverUsername:t.EMAIL,MainApproverDisplayName:t.LAST_FIRST_NAME,MainApproverEmail:t.EMAIL,IsActive:t.ISACTIVE};e.TableDataMembers.push(l)}}),n.TableData=o,0!==n.TableData.length&&(n.NoApprovers=!1)}"LOOKUP"===e[0].DerivedRoleType&&(n.DerivedRoleType=e[0].DerivedRoleType,n.DerivedRoleId=e[0].DerivedRoleId,n.DerivedRoleBehavior=e[0].DerivedRoleBehavior,e.forEach(function(e){var t={MainApproverUsername:e.EMAIL,MainApproverDisplayName:e.LAST_FIRST_NAME,MainApproverEmail:e.EMAIL,IsActive:e.ISACTIVE};n.MainApprovers.push(t)}),0!==n.MainApprovers.length&&(n.NoApprovers=!1))}return n})}(e)));break;case"EMPLOYEE SEARCH":u.IsSavedViewDetailInit||(p.objectIsNullorUndefined(u.lookups[e.LookupValue])?i=!0:"CASCADINGORACLEHIERARCHYTEMPLATE"!==l&&(r.push(e),t.push(function(e){var t=0===e.DerivedRoleId?e.CostPointRoleId:e.DerivedRoleId,n={RoleId:-1009,Parameters:{OBJECT_ID:u.lookups[e.LookupValue].OBJECT_ID,COST_CENTER_ID:u.lookups[e.LookupValue].COST_CENTER_ID,LOOKUP:u.lookups[e.LookupValue].LOOKUP}};switch(t){case-1031:n.RoleId=-1009;break;case-1032:n.RoleId=-1007;break;case-1033:n.RoleId=-1011}return a.SearchApprover(n).then(function(e){if(0<e.length)return a.SearchEmployee(e[0].EMAIL,10).then(function(e){return e})})}(e))))}}),0<t.length?g.all(t).then(function(t){if(!u.IsSavedViewDetailInit&&"CASCADINGORACLEHIERARCHYTEMPLATE"!==l){var n=0;r.forEach(function(e){"EMPLOYEE SEARCH"===e.RoleType&&(p.objectIsNullorUndefined(t[n])||0<t[n].length&&(o[e.CostPointRoleId]=t[n][0])),n++}),y("EMPLOYEESEARCH",JSON.stringify(o))}return m.ProcessApprovalItemStepLookups(u.approvalItem.detail.ApprovalItemSteps,u.lookups)}):(i&&y("EMPLOYEESEARCH",JSON.stringify(o)),n?m.ProcessApprovalItemStepLookups(u.approvalItem.detail.ApprovalItemSteps,u.lookups):void 0)}function E(e,t){angular.copy(t);var n=angular.copy(e),l=t.filter(function(e){return"LOOKUP"===e.SettingType});return 0<l.length&&(null===n?(n={Title:"LOOKUP VALUES",Desc:"",SubDesc:"",Rows:[]},l.forEach(function(e){n.Rows.push({Controls:[S(u.lookups[e.SettingValue],e.SettingValue)]})})):l.forEach(function(e){n.Rows.unshift({Controls:[S(u.lookups[e.SettingValue],e.SettingValue)]})})),n}function S(e){var t=p.guid().split("-");t=t.join("");var n=angular.copy(o.FormCreation);return n.InputType="text",n.ControlType=r.Textbox,n.ControlID="tb_"+t,n.Value=e._value,n.Label={EN:e._label},n}function N(n){var l="",e=Object.keys(n);return"LEAD"===A()?l="Opportunity Name: "+u.oppName:e.forEach(function(e){var t=p.stringIsNullUndefinedOrEmpty(n[e]._value)?"":n[e]._value.replace("<br/>","\n");l+=(0!==l.length?" || ":"")+n[e]._label+" :|| "+t}),l}function A(){if(null===u.approvalItem.detail.ApprovalItemForm.Form)return"NORMAL";if(u.approvalItem.detail.ApprovalItemForm.Form.hasOwnProperty("Rows"))for(var e=0;e<u.approvalItem.detail.ApprovalItemForm.Form.Rows.length;e++)if(u.approvalItem.detail.ApprovalItemForm.Form.Rows[e].hasOwnProperty("Controls"))for(var t=0;t<u.approvalItem.detail.ApprovalItemForm.Form.Rows[e].Controls.length;t++){JSON.parse(u.approvalItem.detail.ApprovalItemForm.Form.Rows[e].Controls[t].Value);switch(u.approvalItem.detail.ApprovalItemForm.Form.Rows[e].Controls[t].ControlType){case"GngFormTemplate":return"FORMAL";case"GngPreliminaryFormTemplate":return"PRELIMINARY";case"GngLeadFormTemplate":return"LEAD";case"OpportunityAgreementProjectSpecialTemplate":case"OpportunityAgreementProjectFormTemplate":return"NORMAL-MODS";case"WorkAtRiskFormTemplate":case"WarExtensionFormTemplate":return"WAR";case"EaNpWithOpportunityFormTemplate":case"EaNpWithOpportunityWarFormTemplate":case"NaNpWithOpportunityFormTemplate":case"NaNpWithOpportunityWithFundingFormTemplate":case"NaNpSansOpportunityFormTemplate":case"NaNpSansOpportunityWarFormTemplate":case"NaNpWithFundingSansOpportunityFormTemplate":case"EaNpWithOpportunityWithFundingFormTemplate":case"EaNpSansOpportunityFormTemplate":case"EaNpSansOpportunityWarFormTemplate":case"EaNpWithFundingSansOpportunityFormTemplate":case"NaNpWithOpportunityWarFormTemplate":return"PS"}}return"NORMAL"}function y(e,t){m.SetSelectedValues(e,t)}this.GetApprovalItemDetails=function(e,t){return n.GetApprovalItemDetails(e,t).then(function(e){if(0<e.ApprovalItemDetail.length){var t=e.ApprovalItemDetail.find(function(e){return"Y"===e.IsApprovalItem});u.approvalItem.detailinformation=t,u.approvalItem.detail=e,u.approvalItem.detail.ApprovalItemForm.Form=null!==u.approvalItem.detail.ApprovalItemForm.Form?JSON.parse(u.approvalItem.detail.ApprovalItemForm.Form):null,u.approvalItem.detail.ApprovalItemBlock.Form=null!==u.approvalItem.detail.ApprovalItemBlock.Form?JSON.parse(u.approvalItem.detail.ApprovalItemBlock.Form):null,function(e){e.forEach(function(e){e.CostPointRoleId===i.BghBoardOfDirectors&&e.MainApprovers.length<=0&&e.MainApprovers.push(s)})}(u.approvalItem.detail.ApprovalItemSteps),u.requestType=A();var n=[];return u.approvalItem.detail.ApprovalItemSteps.forEach(function(e){switch(e.RoleType){case"TABLE-BASED":n.push(function(t){var e={RoleId:t.CostPointRoleId,Parameters:{}};return a.SearchApprover(e).then(function(e){var o=[];return e.forEach(function(t){var e=o.find(function(e){return e.TableDataRoleId===t.TableDataRoleId});if(p.objectIsNullorUndefined(e)){var n={TableDataRoleId:t.TableDataRoleId,TableDataName:t.TableDataName,ParentTableDataRoleId:t.ParentTableDataRoleId,TableDataMembers:[],DerivedParentTableDataRoleIds:t.DerivedParentTableDataRoleIds},l={MainApproverUsername:t.EMAIL,MainApproverDisplayName:t.LAST_FIRST_NAME,MainApproverEmail:t.EMAIL,IsActive:t.ISACTIVE};n.TableDataMembers.push(l),o.push(n)}else{l={MainApproverUsername:t.EMAIL,MainApproverDisplayName:t.LAST_FIRST_NAME,MainApproverEmail:t.EMAIL,IsActive:t.ISACTIVE};e.TableDataMembers.push(l)}}),t.DerivedChildRoleIds=e[0].DerivedChildRoleIds,t.TableData=o,t})}(e));break;case"LOOKUP":"DROPDOWN"===e.RoleBehavior&&n.push(function(n){var e={RoleId:n.CostPointRoleId,Parameters:{OBJECT_ID:"",COST_CENTER_ID:0,LOOKUP:""}};return a.SearchApprover(e).then(function(e){return n.MainApprovers=[],e.forEach(function(e){var t={MainApproverUsername:e.EMAIL,MainApproverDisplayName:e.LAST_FIRST_NAME,MainApproverEmail:e.EMAIL,IsActive:e.ISACTIVE};n.MainApprovers.push(t),0===n.MainApprovers.length&&(n.NoApprovers=!0)}),n})}(e))}}),0<n.length?g.all(n).then(function(e){m.ProcessApprovalItemStepInit(u.approvalItem.detail.ApprovalItemSteps),u.referenceDetails=angular.copy(u.approvalItem)}):(m.ProcessApprovalItemStepInit(u.approvalItem.detail.ApprovalItemSteps),u.referenceDetails=angular.copy(u.approvalItem)),!0}return!1})},this.SubmitRequest=function(){var e=angular.copy(u.approvalItem.detail.ApprovalItemForm.Form);{if(function(e){{if(null===e)return!0;if(e.hasOwnProperty("Rows")){for(var t=0;t<e.Rows.length;t++)if(e.Rows[t].hasOwnProperty("Controls"))for(var n=0;n<e.Rows[t].Controls.length;n++)switch(e.Rows[t].Controls[n].ControlType){case"GngLeadFormTemplate":var l=p.stringIsNullUndefinedOrEmpty(JSON.parse(e.Rows[t].Controls[n].Value).OPPORTUNITY_NAME_NEW),o=p.stringIsNullUndefinedOrEmpty(JSON.parse(e.Rows[t].Controls[n].Value).CURRENT_FY_PERCENT_NEW)?0:JSON.parse(e.Rows[t].Controls[n].Value).CURRENT_FY_PERCENT_NEW,r=p.stringIsNullUndefinedOrEmpty(JSON.parse(e.Rows[t].Controls[n].Value).NEXT_FY_PERCENT_NEW)?0:JSON.parse(e.Rows[t].Controls[n].Value).NEXT_FY_PERCENT_NEW,i=p.stringIsNullUndefinedOrEmpty(JSON.parse(e.Rows[t].Controls[n].Value).SUBSEQUENT_FY_PERCENT_NEW)?0:JSON.parse(e.Rows[t].Controls[n].Value).SUBSEQUENT_FY_PERCENT_NEW,a=parseFloat(o)+parseFloat(r)+parseFloat(i);return!l&&parseFloat(a)===parseFloat(100);case"GngFormTemplate":case"GngPreliminaryFormTemplate":o=p.stringIsNullUndefinedOrEmpty(JSON.parse(e.Rows[t].Controls[n].Value).CURRENT_FY_PERCENT_EDIT)?p.stringIsNullUndefinedOrEmpty(JSON.parse(e.Rows[t].Controls[n].Value).CURRENT_FY_PERCENT)?0:JSON.parse(e.Rows[t].Controls[n].Value).CURRENT_FY_PERCENT:JSON.parse(e.Rows[t].Controls[n].Value).CURRENT_FY_PERCENT_EDIT,r=p.stringIsNullUndefinedOrEmpty(JSON.parse(e.Rows[t].Controls[n].Value).NEXT_FY_PERCENT_EDIT)?p.stringIsNullUndefinedOrEmpty(JSON.parse(e.Rows[t].Controls[n].Value).NEXT_FY_PERCENT)?0:JSON.parse(e.Rows[t].Controls[n].Value).NEXT_FY_PERCENT:JSON.parse(e.Rows[t].Controls[n].Value).NEXT_FY_PERCENT_EDIT,i=p.stringIsNullUndefinedOrEmpty(JSON.parse(e.Rows[t].Controls[n].Value).SUBSEQUENT_FY_PERCENT_EDIT)?p.stringIsNullUndefinedOrEmpty(JSON.parse(e.Rows[t].Controls[n].Value).SUBSEQUENT_FY_PERCENT)?0:JSON.parse(e.Rows[t].Controls[n].Value).SUBSEQUENT_FY_PERCENT:JSON.parse(e.Rows[t].Controls[n].Value).SUBSEQUENT_FY_PERCENT_EDIT,a=parseFloat(o)+parseFloat(r)+parseFloat(i);return parseFloat(a)===parseFloat(100);default:return!0}return!0}return!0}}(e)){for(var t,n,l,o=[],r=0;r<=u.approvalItem.detail.ApprovalItemSteps.length-1;r++)if(""!==u.approvalItem.detail.ApprovalItemSteps[r].LookupValue){n=u.approvalItem.detail.ApprovalItemRoleLookupParameters.filter(function(e){return e.RoleId===u.approvalItem.detail.ApprovalItemSteps[r].CostPointRoleId}),l=t="";for(var i=0;i<=n.length-1;i++)if(t=n[i].Key,void 0!==(l=u.lookups[u.approvalItem.detail.ApprovalItemSteps[r].LookupValue][t])){var a={ExecutionOrder:u.approvalItem.detail.ApprovalItemSteps[r].ExecutionOrder,LookupName:u.approvalItem.detail.ApprovalItemSteps[r].LookupValue,LookupField:t,LookupValue:l};o.push(a);break}}u.approvalItem.detail.ApprovalItemDocument=[],Object.keys(u.approvalItem.documents).forEach(function(n){0<u.approvalItem.documents[n].length&&u.approvalItem.documents[n].forEach(function(e){if("Successful"===e.Status){var t={};t.SettingValue=n,t.Title=e.Title,t.Notes=e.Notes,t.Required=e.Required,t.Multiple=e.Multiple,t.ActualFileName=e.ActualFilename,t.GeneratedFileName=e.NewFilename,u.approvalItem.detail.ApprovalItemDocument.push(t)}})}),null!==u.approvalItem.detail.ApprovalItemForm.Form&&0<u.approvalItem.detail.ApprovalItemForm.Form.Rows.length&&u.approvalItem.detail.ApprovalItemForm.Form.Rows.forEach(function(e){0<e.Controls.length&&e.Controls.forEach(function(e){if(-1<e.ControlType.indexOf("Template")&&null!==e.Value){var t=JSON.parse(e.Value);e.Label={EN:t._label},e.Description={EN:"VALUE||"+t._value}}})});var s={OrganizationCode:u.division,Application:"AUTHORITYMATRIX",RequestorComment:u.approvalItem.comments,RequestStepsDetails:u.approvalItem.detail.ApprovalItemSteps,ApprovalItemId:u.approvalItem.detailinformation.ApprovalItemId,RequestStepLookup:o,RequestForm:E(e,u.approvalItem.detail.ApprovalItemSettings),RequestDocument:u.approvalItem.detail.ApprovalItemDocument,RequestId:u.approvalItem.requestId,ResubmitComments:u.approvalItem.resubmitComments,RequestFyi:function(){for(var t,n=[],l=0;l<=u.approvalItem.detail.ApprovalItemSettingDetails.length-1;l++)u.lookups.hasOwnProperty(u.approvalItem.detail.ApprovalItemSettingDetails[l].LOOKUP)&&(t=u.approvalItem.detail.ApprovalItemSettingDetails[l].LOOKUP,d("filter")(u.approvalItem.detail.RoleLookupFyi,{RoleId:u.approvalItem.detail.ApprovalItemSettingDetails[l].OBJECTID}).forEach(function(e){u.lookups[t].hasOwnProperty(e.Key)&&n.push({ApprovalItemSettingId:u.approvalItem.detail.ApprovalItemSettingDetails[l].ApprovalItemSettingId,LookupPropertyKey:e.Key,LookupPropertyValue:u.lookups[t][e.Key]})}));return n}(),LookupValues:JSON.stringify(u.lookups),ApprovalItemForm:JSON.stringify(e),LookupLabelValue:N(u.lookups),SaveRequestId:u.approvalItem.saveRequestId,RequestType:A(),MissingClientOwnerType:function(){var e=A();{if("PS"===e||"WAR"===e)return"NO";if(null===u.approvalItem.detail.ApprovalItemForm.Form)return"NO";if(u.approvalItem.detail.ApprovalItemForm.Form.hasOwnProperty("Rows"))for(var t=0;t<u.approvalItem.detail.ApprovalItemForm.Form.Rows.length;t++)if(u.approvalItem.detail.ApprovalItemForm.Form.Rows[t].hasOwnProperty("Controls"))for(var n=0;n<u.approvalItem.detail.ApprovalItemForm.Form.Rows[t].Controls.length;n++){var l=JSON.parse(u.approvalItem.detail.ApprovalItemForm.Form.Rows[t].Controls[n].Value);if(!p.stringIsNullUndefinedOrEmpty(l.OWNER_NAME)&&p.stringIsNullUndefinedOrEmpty(l.UC_TYPE)&&!p.stringIsNullUndefinedOrEmpty(l.CLIENT_NAME)&&p.stringIsNullUndefinedOrEmpty(l.CLIENT_TYPE))return"BOTH";if(!p.stringIsNullUndefinedOrEmpty(l.OWNER_NAME)&&p.stringIsNullUndefinedOrEmpty(l.UC_TYPE))return"OWNER";if(!p.stringIsNullUndefinedOrEmpty(l.CLIENT_NAME)&&p.stringIsNullUndefinedOrEmpty(l.CLIENT_TYPE))return"CLIENT"}return"NO"}}(),IsNoOpportunityExists:function(){{if(null===u.approvalItem.detail.ApprovalItemForm.Form)return"NO";if(u.approvalItem.detail.ApprovalItemForm.Form.hasOwnProperty("Rows"))for(var e=0;e<u.approvalItem.detail.ApprovalItemForm.Form.Rows.length;e++)if(u.approvalItem.detail.ApprovalItemForm.Form.Rows[e].hasOwnProperty("Controls"))for(var t=0;t<u.approvalItem.detail.ApprovalItemForm.Form.Rows[e].Controls.length;t++){JSON.parse(u.approvalItem.detail.ApprovalItemForm.Form.Rows[e].Controls[t].Value);switch(u.approvalItem.detail.ApprovalItemForm.Form.Rows[e].Controls[t].ControlType){case"NaNpSansOpportunityFormTemplate":case"NaNpSansOpportunityWarFormTemplate":case"NaNpWithFundingSansOpportunityFormTemplate":return"YES"}}return"NO"}}(),SelectedEmployee:m.GetSelectedValues("EMPLOYEESEARCH"),MargninAnalyisEstablished:u.margninanalyisestablished};return c.SubmitRequest(s)}f.alertWarning("Request - Failed","Please complete form","none")}},this.InitializeLookups=function(e){u.lookups[e]=null},this.SetDivision=function(e){u.division=e},this.UploadFileTemp=function(e){var t=l.ValidateFile(e);u.approvalItem.documents.hasOwnProperty(u.selectedDocument.SettingValue)||(u.approvalItem.documents[u.selectedDocument.SettingValue]=[]);if(null!==t)return void f.alertWarning("Upload File - Failed","Unsuccessful - "+t,"none");l.UploadFileTemp(e).then(function(e){e.payload.success?("N"===u.selectedDocument.Multiple&&(u.approvalItem.documents[u.selectedDocument.SettingValue]=[]),u.approvalItem.documents[u.selectedDocument.SettingValue].push({Title:u.selectedDocument.Title,Notes:u.selectedDocument.Notes,Required:u.selectedDocument.Required,Multiple:u.selectedDocument.Required,ActualFilename:e.payload.actual_filename,NewFilename:e.payload.new_filename,Status:"Successful"})):f.alertWarning("Upload File - Failed","Failed to upload your file","none")})},this.CheckCompleteApprovers=function(){if(null!==u.approvalItem.detail){for(var e=!0,t=Object.values(u.lookups),n=0;n<=t.length-1;n++)if(p.stringIsNullUndefinedOrEmpty(t[n])){e=!1;break}if(!0===e){var o=[];if(u.approvalItem.detail.ApprovalItemSteps.forEach(function(t){if(e&&("TABLE-BASED"!==t.RoleType&&"TABLE-BASED"!==t.DerivedRoleType&&"DROPDOWN"!==t.RoleBehavior&&"DROPDOWN"!==t.DerivedRoleBehavior||(e=0<t.MainApprovers.filter(function(e){return"Y"===e.IsActive}).length)),e){var n=o.find(function(e){return e.ExecutionOrder===t.ExecutionOrder});if(p.objectIsNullorUndefined(n)){var l={ExecutionOrder:t.ExecutionOrder,MainApprovers:[]};t.MainApprovers.forEach(function(e){"Y"===e.IsActive&&l.MainApprovers.push(e)}),o.push(l)}else t.MainApprovers.forEach(function(e){"Y"===e.IsActive&&n.MainApprovers.push(e)})}}),e){var l=o.filter(function(e){return 0===e.MainApprovers.length});e=0===l.length}}u.completeApprovers=e}},this.SetResubmitValues=function(e,t,n,l,o,r){u.approvalItem.requestId=angular.copy(e),u.approvalItem.resubmitComments=angular.copy(t),u.approvalItem.comments=angular.copy(n),null!==l&&m.SetDefaultControls(l);null!==o&&o.forEach(function(e){u.approvalItem.documents.hasOwnProperty(e.SettingValue)||(u.approvalItem.documents[e.SettingValue]=[]),e.RequestDocumentType.includes("_OLD")&&!e.RequestDocumentType.includes("RFI")||u.approvalItem.documents[e.SettingValue].push({ActualFilename:e.ActualFileName,NewFilename:e.GeneratedFileName,Title:e.Title,Notes:e.Notes,Required:e.Required,Multiple:e.Multiple,Status:"Active"})});u.approvalItem.resubmitDetails=angular.copy(r),m.ProcessApprovalItemStepInit(u.approvalItem.detail.ApprovalItemSteps)},this.IfRequiresUploadBghBod=function(){if(0<u.approvalItem.detail.ApprovalItemSteps.filter(function(e){return e.CostPointRoleId===i.BghBoardOfDirectors&&1===e.ExecutionOrder}).length&&u.approvalItem.documents.length<=0)return!0;return!1},this.GetRequestLookupFormInformation=function(e){c.GetRequestLookupFormInformation(e).then(function(e){if(null!==e.SubmittedRequestLookupFormValue.LookupValues&&(u.lookups=JSON.parse(e.SubmittedRequestLookupFormValue.LookupValues)),!p.stringIsNullUndefinedOrEmpty(e.SubmittedRequestLookupFormValue.ApprovalItemForm)){var t={Form:JSON.parse(e.SubmittedRequestLookupFormValue.ApprovalItemForm)};u.approvalItem.detail.ApprovalItemForm=t}})},this.VerifyLookupApprovers=function(){var t=!0;Object.keys(u.lookups).forEach(function(e){p.objectIsNullorUndefined(u.lookups[e])&&(t=!1)});var e=u.approvalItem.detail.ApprovalItemSteps.filter(function(e){return e.NoApprovers});t&&0<e.length&&f.alertWarning("Warning","<i>IAS relies on accurate data in other source systems in order for certain roles to auto-populate. </ br> <p> To submit this request, the missing personnel assignments must be updated in the applicable source system. <ul><li>If the necessary role is tied to an Opportunity, either update the Opportunity in CRM or contact your Pursuit or Proposal Manager.</li><li>If the necessary role is tied to an Agreement or Project, either update the data in the ERP or contact your Project Accountant.</li><li>For all other roles, please contact IAS-Admin@wsp.com.</li></ul></p>","none")},this.GetLookupApprovers=I,this.SaveFinishLater=function(){var e=angular.copy(u.approvalItem.detail.ApprovalItemForm.Form);var t={SaveRequestId:u.approvalItem.saveRequestId,ApprovalItemId:u.approvalItem.detailinformation.ApprovalItemId,Steps:JSON.stringify(u.approvalItem.detail.ApprovalItemSteps),Lookups:JSON.stringify(u.lookups),ApprovalItemForm:JSON.stringify(e),Documents:JSON.stringify(u.approvalItem.documents),Comments:angular.copy(u.approvalItem.comments),PertainsTo:N(u.lookups),SelectedTableData:m.GetSelectedValues("TABLEDATA"),SelectedApprover:m.GetSelectedValues("APPROVER"),RequestForm:E(e,u.approvalItem.detail.ApprovalItemSettings),LookupValues:JSON.stringify(u.lookups),RequestType:A(),SelectedEmployee:m.GetSelectedValues("EMPLOYEESEARCH"),MargninAnalyisEstablished:u.margninanalyisestablished};return c.SaveFinishLater(t).then(function(e){u.approvalItem.saveRequestId=e})},this.GetSaveRequest=function(e){return c.GetSaveRequest(e).then(function(e){return e})},this.ProcessApprovalStepsDropdown=function(){var t=[];Object.keys(u.lookups).forEach(function(e){t.push(I(e))}),g.all(t).then(function(e){var t=JSON.parse(u.selectedTableData),n=JSON.parse(u.selectedApprover);u.IsSavedViewDetailInit=!1,m.ProcessApprovalItemSaveRequest(t,n,u.approvalItem.detail.ApprovalItemSteps,u.lookups)})},this.CancelSavedRequest=function(){var e={SaveRequestId:u.approvalItem.saveRequestId,ApprovalItemId:u.approvalItem.detailinformation.ApprovalItemId,Steps:"",Lookups:"",ApprovalItemForm:"",Documents:"",Comments:"",PertainsTo:"",SelectedTableData:"",SelectedApprover:""};return c.CancelSavedRequest(e).then(function(e){return u.approvalItem.saveRequestId=0,e})},this.GetRequestAssignedTo=function(){var e={RoleId:-99999965,Parameters:{Id:u.approvalItem.saveRequestId,Data:"ASSIGNEDTOSAVEREQUEST"}};return c.GetRequestAssignedTo(e).then(function(e){!function(e){u.assignTo.requestAssignedToList=[],e.forEach(function(e){var t={};e.Value.forEach(function(e){t[e.Key]=e.Value}),u.assignTo.requestAssignedToList.push(t)}),u.assignTo.requestAssignedToRefList=angular.copy(u.assignTo.requestAssignedToList)}(e)})},this.SaveAssignToOthers=function(){var e={SaveRequestId:u.approvalItem.saveRequestId,AssignedMembers:u.assignTo.requestAssignedToList};return c.AssignRequestToOthers(e).then(function(e){})},this.ParseForm=function(t,n){null!==u.approvalItem.detail.ApprovalItemForm.Form&&u.approvalItem.detail.ApprovalItemForm.Form.hasOwnProperty("Rows")&&u.approvalItem.detail.ApprovalItemForm.Form.Rows.forEach(function(e){e.hasOwnProperty("Controls")&&e.Controls.forEach(function(e){p.isInArray(e.ControlType,u.templates.customform)?null!==e.Value?e.Value=null!==JSON.parse(e.Value).OPPORTUNITY_NUMBER&&void 0!==JSON.parse(e.Value).OPPORTUNITY_NUMBER&&void 0===n?e.Value:angular.copy(t):e.Value=angular.copy(t):p.isInArray(e.ControlType,u.templates.specialform)?null!==e.Value?e.Value=null!==JSON.parse(e.Value).OBJECT_NUMBER&&void 0!==JSON.parse(e.Value).OBJECT_NUMBER&&void 0===n?e.Value:angular.copy(t):e.Value=angular.copy(t):p.isInArray(e.ControlType,u.templates.cascading)&&(null!==e.Value?e.Value=(null!==JSON.parse(e.Value).PA&&void 0!==JSON.parse(e.Value).PA||null!==e.value)&&void 0===n?e.Value:angular.copy(t):e.Value=angular.copy(t))})})},this.GetRequestType=A,this.GetFormName=function(){{if(null===u.approvalItem.detail.ApprovalItemForm.Form)return"NO FORM";if(u.approvalItem.detail.ApprovalItemForm.Form.hasOwnProperty("Rows"))for(var e=0;e<u.approvalItem.detail.ApprovalItemForm.Form.Rows.length;e++)if(u.approvalItem.detail.ApprovalItemForm.Form.Rows[e].hasOwnProperty("Controls"))for(var t=0;t<u.approvalItem.detail.ApprovalItemForm.Form.Rows[e].Controls.length;t++)return u.approvalItem.detail.ApprovalItemForm.Form.Rows[e].Controls[t].ControlType;return"NO FORM"}},this.ProcessSelectedEmployee=y,this.GetApprovalDocuments=function(e){var t={RoleId:-88888888,Parameters:{DATA:"APPROVALITEMDOCUMENTS",ApprovalItemId:e}};return v.GetData(t).then(function(e){return e})},this.SetLookup=function(){m.SetLookup(u.lookups)},Object.preventExtensions(u)}angular.module("myApp").service("ApprovalItemsDetailsBusiness",e),e.$inject=["ApprovalItemsDetailsStore","ApprovalItemsDetailsService","RequestsDetailsService","LookupService","$filter","DocumentService","astigUtilityService","DefaultFormControlProperties","FormControls","WorkflowStepsComponentBusiness","CostPointRoleIds","BghBodDefaultApproverObject","uniqueFilter","sweetDialogAlertService","$q","GenericDataService"]}(),function(){"use strict";function e(l,i,t,e,n,o,r,a,s,u,c,d,p,m){var f=this;function g(){return i.GetRequestType()}function v(){var t=!1,n=!1;return l.approvalItem.approvaldocuments.forEach(function(e){switch(e.SettingValue){case"DA_PRICING":t=!0;break;case"FA_MARGINANALYSIS":n=!0}}),t&&n}f.model=l,f.events={onClick_Submit:function(e){{if(!i.IfRequiresUploadBghBod())return i.SubmitRequest().then(function(e){o.stringIsNullUndefinedOrEmpty(e)?r.alertError("Error","Error submitting the request","none"):(a.GetRequestTotalCount(),"am.approvalitems.details"===n.current.name?"LEAD"===l.requestType.toUpperCase()?r.alertSuccessWithConfirm("Submission Success",'<span style="font-size: 13px; text-align:left; display: inline-block;">Thank you for submitting your opportunity. <br/><br/>It has been sent to the CRM Data Team for entry into CRM. <br/><br/>You will receive a notification when that opportunity is entered. <br/><br/>Once entered in CRM, the opportunity must go through a system integration process before it is available for Go/No-Go and Pricing. <br/><br/>The entry and integration process may take 1-2 business days to complete.</span>',function(){n.go("am.requests.list",{},{reload:!0})},angular.noop,"OK","",!1):r.alertSuccessWithConfirm("Submission Success","Your request has been submitted successfully",function(){n.go("am.requests.list",{},{reload:!0})},angular.noop,"OK","",!1):"am.approvalitems.resubmit"===n.current.name?(r.alertSuccess("Resubmitted","Workflow has been restarted.",3e3),n.go("am.requests.list",{},{reload:!0})):"am.approvalitems.viewsaveddetails"===n.current.name&&("LEAD"===l.requestType.toUpperCase()?r.alertSuccessWithConfirm("Submission Success",'<span style="font-size: 13px; text-align:left; display: inline-block;">Thank you for submitting your opportunity. <br/><br/>It has been sent to the CRM Data Team for entry into CRM. <br/><br/>You will receive a notification when that opportunity is entered. <br/><br/>Once entered in CRM, the opportunity must go through a system integration process before it is available for Go/No-Go and Pricing. <br/><br/>The entry and integration process may take 1-2 business days to complete.</span>',function(){n.go("am.requests.list",{},{reload:!0})},angular.noop,"OK","",!1):r.alertSuccessWithConfirm("Submission Success","Saved request has been submitted.",function(){n.go("am.requests.list",{},{reload:!0})},angular.noop,"OK","",!1)))});r.alertError("Upload Required","Please upload a file.","none")}},onInitialize_Lookup:function(e){null!==t.resubmitComment&&null!==t.requestid||i.InitializeLookups(e)},isInObjectArray:o.isInObjectArray,isInArray:o.isInArray,onAfterValidate_UploadFileTemp:function(e,t,n){angular.forEach(t,function(e){i.UploadFileTemp(e)})},onClick_DeleteDocument:function(t,n){m.DeletePhysicalFile(t).then(function(e){l.approvalItem.documents[n]=l.approvalItem.documents[n].filter(function(e){return angular.toJson(e)!==angular.toJson(t)})})},onClick_CancelResubmission:function(){r.alertConfirm("CONFIRM CANCEL RESUBMISSION","Cancelling resubmission will return the request to where it was previously in the workflow. Any changes made to this request will be lost. Are you sure you wish to proceed?",function(){n.go("am.requests.details",{requestid:t.requestid},{reload:!0})},angular.noop,"Yes, I want to cancel resubmission and restore this request to its previous status.","NO TAKE ME BACK",!0)},onClick_TemporarySaveRequest:function(){i.SaveFinishLater().then(function(e){0===f.model.Requestor.Username.length&&(f.model.Requestor.Username=angular.copy(p.securityDetails.ViewAsUsername)),r.alertSuccess("Save and Finish Later","Successfully Saved.",3e3),a.GetRequestTotalCount()})},onClick_CancelSavedRequest:function(){r.alertConfirm("CONFIRM CANCEL SAVED REQUEST","Cancelling saved request will be deleted from your request queue. Any changes made to this request will be lost. Are you sure you wish to proceed?",function(){"am.approvalitems.details"===n.current.name?n.go("am.approvalitems.list"):n.go("am.requests.list",{},{reload:!0}),i.CancelSavedRequest(),a.GetRequestTotalCount()},angular.noop,"Yes, I want to cancel this request.","NO TAKE ME BACK",!0)},onClick_AsignToOthers:function(){i.GetRequestAssignedTo().then(function(e){angular.element("#assignToOtherModal").modal("show")})},onSelect_SearchEmployee:function(e){l.assignTo.EmployeeSelected={AssignedToUsername:e.value.EMAIL_ADDRESS,AssignedToDisplayName:e.value.FULL_NAME,AssignedToEmail:e.value.EMAIL_ADDRESS,HasActionTaken:"N"}},onSearch_Employee:function(e,t){s.SearchEmployee(e.term,50).then(function(e){e&&t(e.map(function(e){return{label:e.FULL_NAME,value:e}}))})},onClick_AddSelectedMember:function(){angular.isUndefined(function(e,t,n){return e.find(function(e){return e[n]==t[n]})}(f.model.assignTo.requestAssignedToList,f.model.assignTo.EmployeeSelected,"AssignedToUsername"))?f.model.assignTo.EmployeeSelected.AssignedToEmail===f.model.Requestor.Username?r.alertWarning("Cannot Assign Requestor",f.model.assignTo.EmployeeSelected.AssignedToDisplayName+" is the main requestor of this request.",5e3):f.model.assignTo.requestAssignedToList.unshift(f.model.assignTo.EmployeeSelected):r.alertWarning("Duplicate Employee",f.model.assignTo.EmployeeSelected.AssignedToDisplayName+" is already assigned.");f.model.assignTo.EmployeeSelected=null,f.model.assignTo.EmployeeSearched=null,angular.element("#searchEmployee").focus()},onClick_RemoveMember:function(t){f.model.assignTo.requestAssignedToList=f.model.assignTo.requestAssignedToList.filter(function(e){return angular.toJson(e)!==angular.toJson(t)})},onClick_AssignToOthers_Save:function(){i.SaveAssignToOthers().then(function(e){r.alertSuccess("Assign to Others","Successfully Assigned to Others",3e3),angular.element("#assignToOtherModal").modal("hide")})},getFormType:g,onSelect_Document:function(e){l.selectedDocument=e},onLoad_PopOver:function(e){angular.element(e).popover("show")},onChange_MargninAnalyisEstablished:function(t){f.model.margninanalyisestablished=t,l.approvalItem.approvaldocuments.forEach(function(e){"FA_MARGINANALYSIS"===e.SettingValue&&(e.Required=t)})},onClick_OpenDocument:m.DownloadTempDocument},f.validations={showSaveButtonChanges:function(){if("am.approvalitems.viewsaveddetails"===n.current.name&&0!=l.approvalItem.saveRequestId||"am.approvalitems.details"===n.current.name)return!angular.equals(l.approvalItem,l.referenceDetails);return!1},validateDocuments:function(){var t=!0,n=v();return l.approvalItem.approvaldocuments.forEach(function(e){"Y"===e.Required&&t&&(t=l.approvalItem.documents.hasOwnProperty(e.SettingValue)?1<=l.approvalItem.documents[e.SettingValue].length:"FA_MARGINANALYSIS"===e.SettingValue&&(n&&"N"===l.margninanalyisestablished))}),t},showMarginEstablished:v},f.formValidation={},function(){f.model.currentName=angular.copy(n.current.name),"am.approvalitems.details"===n.current.name?(l.referenceDetails={},i.GetApprovalItemDetails(t.approvalitemid,0).then(function(e){l.lookups=o.stringIsNullUndefinedOrEmpty(t.lookups)?{}:t.lookups}),i.GetApprovalDocuments(t.approvalitemid).then(function(e){l.approvalItem.approvaldocuments=e})):"am.approvalitems.resubmit"===n.current.name?null!==t.resubmitComment&&null!==t.requestid?i.GetApprovalItemDetails(0,t.requestid).then(function(e){e?i.GetApprovalDocuments(l.approvalItem.detailinformation.ApprovalItemId).then(function(e){l.approvalItem.approvaldocuments=e,i.SetResubmitValues(t.requestid,t.resubmitComment,t.requestComment,t.defaultControlValues,t.requestDocuments,t.requestDetails),i.GetRequestLookupFormInformation(t.requestid)}):(r.alertWarning("Warning","This approval item does not exist.","none"),n.go("am.requests.details",{requestid:t.requestid},{reload:!0}))}):n.go("am.approvalitems.list",{},{reload:!0}):"am.approvalitems.viewsaveddetails"===n.current.name&&(null!==t.saveRequestId?i.GetSaveRequest(t.saveRequestId).then(function(t){i.GetApprovalDocuments(t.ApprovalItemId).then(function(e){l.approvalItem.approvaldocuments=e}),i.GetApprovalItemDetails(t.ApprovalItemId,0).then(function(e){e?(l.IsSavedViewDetailInit=!0,l.approvalItem.saveRequestId=t.SaveRequestId,l.approvalItem.comments=t.Comments,l.approvalItem.documents=JSON.parse(t.Documents),l.approvalItem.detailinformation.ApprovalItemId=t.ApprovalItemId,l.lookups=JSON.parse(t.Lookups),l.approvalItem.detail.ApprovalItemSteps=JSON.parse(t.Steps),l.approvalItem.detail.ApprovalItemForm.Form=JSON.parse(t.ApprovalItemForm),l.selectedTableData=t.SelectedTableData,l.selectedApprover=t.SelectedApprover,l.Requestor.Username=t.RequestorUsername,l.margninanalyisestablished=t.MargninAnalyisEstablished,i.ProcessApprovalStepsDropdown(),o.objectIsNullorUndefined(t.SelectedEmployee)||2<t.SelectedEmployee.length&&i.ProcessSelectedEmployee("EMPLOYEESEARCH",t.SelectedEmployee)):(r.alertWarning("Warning","You do not have permission to view this request.","none"),n.go("am.requests.list",{},{reload:!0}))})}):n.go("am.requests.list",{},{reload:!0}));i.SetDivision(o.stringIsNullUndefinedOrEmpty(t.org)?"WSPUSA":t.org)}(),e.$watch("vm.model.lookups",function(t,n){angular.equals(f.model.lookups,{})||null===l.approvalItem.detail||(i.SetLookup(),i.CheckCompleteApprovers(),Object.keys(t).forEach(function(e){angular.equals(n[e],t[e])||(l.IsSavedViewDetailInit||i.GetLookupApprovers(e),function(e,t,n){var l=g(),o=i.GetFormName();if("WAR"===l)switch(e){case"OPPORTUNITYAGREEMENTPROJECTSPECIALTEMPLATE":case"OPPORTUNITYSPECIALTEMPLATE":case"AGREEMENTSPECIALTEMPLATE":null!==t?i.ParseForm(JSON.stringify(t),n):i.ParseForm(null,n)}else if("PS"!==l)switch(e){case"OPPORTUNITYTEMPLATE":if(null!==t){var r={OPPORTUNITY_NUMBER:angular.copy(t.OPPORTUNITY_NUMBER)};i.ParseForm(JSON.stringify(r),n)}else i.ParseForm(null,n);break;case"OPPORTUNITYAGREEMENTPROJECTSPECIALTEMPLATE":case"OPPORTUNITYSPECIALTEMPLATE":null!==t?i.ParseForm(JSON.stringify(t),n):i.ParseForm(null,n);break;case"AGREEMENTTEMPLATE":if(null!==t){r={OBJECT_NUMBER:angular.copy(t.OBJECT_NUMBER)};i.ParseForm(JSON.stringify(r),n)}else i.ParseForm(null,n);break;case"CASCADINGORACLEHIERARCHYTEMPLATE":if(null!==t){r={PA:angular.copy(t.PA),COST_CENTER_ID:angular.copy(t.COST_CENTER_ID)};i.ParseForm(JSON.stringify(r),n)}else i.ParseForm(null,n)}else switch(e){case"OPPORTUNITYTEMPLATE":case"AGREEMENTTEMPLATE":if(null!==t){r={OBJECT_NUMBER:angular.copy(t.OBJECT_NUMBER)};"AGREEMENTTEMPLATE"!=e||"EaNpWithOpportunityWarFormTemplate"!==o&&"EaNpWithOpportunityFormTemplate"!==o&&"EaNpWithOpportunityWithFundingFormTemplate"!==o||(f.model.formLookupValues={OBJECT_NUMBER:angular.copy(t.OBJECT_NUMBER),LOOKUP:"AGREEMENT",COST_CENTER_ID:angular.copy(t.COST_CENTER_ID)}),i.ParseForm(JSON.stringify(r),n)}else"EaNpWithOpportunityWarFormTemplate"!==o&&"EaNpWithOpportunityFormTemplate"!==o&&"EaNpWithOpportunityWithFundingFormTemplate"!==o||"AGREEMENTTEMPLATE"!==e?i.ParseForm(null,n):f.model.formLookupValues=null;break;case"CASCADINGORACLEHIERARCHYTEMPLATE":null!==t?i.ParseForm(JSON.stringify(t),n):i.ParseForm(null,n)}}(e,t[e],n[e]))}))},!0),e.$watch("vm.model.approvalItem.detail.ApprovalItemSteps",function(){i.CheckCompleteApprovers()},!0),e.$on("$destroy",function(){l.ClearStore()})}angular.module("myApp").controller("ApprovalItemsDetailsController",e),e.$inject=["ApprovalItemsDetailsStore","ApprovalItemsDetailsBusiness","$stateParams","$scope","$state","astigUtilityService","sweetDialogAlertService","MainBusiness","LookupService","UtilService","$timeout","SessionName","MainStore","DocumentService"]}(),function(){"use strict";function e(n){this.GetApprovalItemDetails=function(e,t){return n.Get(l+"GetApprovalItemDetail/"+e+"/"+t,{cache:!1}).then(function(e){return e})};var l=ApiRootDirectory.absoluteRootUrl+"api/approvalitem/"}angular.module("myApp").service("ApprovalItemsDetailsService",e),e.$inject=["DataAccess"]}(),function(){"use strict";function e(){function e(){this.approvalItem={detail:null,comments:null,documents:{},steps:[],requestId:0,resubmitComments:null,resubmitDetails:[],detailinformation:null,saveRequestId:0,approvaldocuments:[]},this.margninanalyisestablished=null,this.oppName=null,this.formLookupValues=null,this.isFormValid=!0,this.lookups={},this.division=null,this.completeApprovers=!1,this.currentName=null,this.documents=null,this.referenceDetails={},this.selectedTableData="",this.selectedApprover="",this.Requestor={Username:""},this.assignTo={requestAssignedToList:[],requestAssignedToRefList:[],EmployeeSearched:null,EmployeeSelected:null},this.requestType="NORMAL",this.IsSavedViewDetailInit=!1,this.templates={customform:["GngFormTemplate","GngPreliminaryFormTemplate","OpportunityFormTemplate","EaNpWithOpportunityWarFormTemplate","EaNpWithOpportunityFormTemplate","NaNpWithOpportunityFormTemplate","NaNpWithOpportunityWarFormTemplate","EaNpWithOpportunityWithFundingFormTemplate","NaNpWithOpportunityWithFundingFormTemplate","EaNpSansOpportunityFormTemplate","EaNpSansOpportunityWarFormTemplate","EaNpWithFundingSansOpportunityFormTemplate"],specialform:["OpportunityAgreementProjectFormTemplate","WorkAtRiskFormTemplate","WarExtensionFormTemplate","ProjectUpdateFormTemplate"],cascading:["GngLeadFormTemplate","NaNpWithFundingSansOpportunityFormTemplate","NaNpSansOpportunityFormTemplate","NaNpSansOpportunityWarFormTemplate"],gngAndPricingForms:["GngFormTemplate","GngPreliminaryFormTemplate","OpportunityAgreementProjectFormTemplate","GngLeadFormTemplate"]},this.selectedDocument={}}return e.prototype.ClearStore=function(){this.approvalItem={detail:null,comments:null,documents:{},steps:[],requestId:0,resubmitComments:null,resubmitDetails:[],detailinformation:null,saveRequestId:0,approvaldocuments:[]},this.margninanalyisestablished=null,this.oppName=null,this.isFormValid=!0,this.lookups={},this.division=null,this.completeApprovers=!1,this.currentName=null,this.documents=null,this.referenceDetails={},this.selectedTableData="",this.selectedApprover="",this.Requestor={Username:""},this.assignTo={requestAssignedToList:[],requestAssignedToRefList:[],EmployeeSearched:null,EmployeeSelected:null},this.requestType="NORMAL",this.IsSavedViewDetailInit=!1,this.selectedDocument={}},new e}angular.module("myApp").factory("ApprovalItemsDetailsStore",e),e.$inject=[]}(),function(){"use strict";function e(e,t,n,l){Object.preventExtensions(e)}angular.module("myApp").service("ApprovalItemsListBusiness",e),e.$inject=["ApprovalItemsListStore","ApprovalItemsListService","AdminOrganizationService","$filter"]}(),function(){"use strict";function e(t,l,n,e,o){this.events={onClick_Export:function(){if(null!==n.selectedOrg.OrganizationCode){var e={ReportPath:"Approval_Items_Report",Region:n.selectedOrg,ReportFilters:[{Key:"OrganizationCode",Value:n.selectedOrg.OrganizationCode}]};t.GenerateExportURL(e).then(function(e){window.location=e})}},onClick_ManageFunction:function(e,t,n){o.stringIsNullUndefinedOrEmpty(t.ApprovalItemLabel)?l.go("am.approvalitems.decision",{approvalitem:t}):l.go("am.approvalitems.details",{org:n,approvalitemid:t.ApprovalItemId})},onClick_Refresh:function(){e.RefreshApprovalItemList()}}}angular.module("myApp").controller("ApprovalItemsListController",e),e.$inject=["ReportService","$state","ApprovalItemTreeviewComponentStore","ApprovalItemTreeviewComponentBusiness","astigUtilityService"]}(),function(){"use strict";function e(e){}angular.module("myApp").service("ApprovalItemsListService",e),e.$inject=["DataAccess"]}(),function(){"use strict";function e(){function e(){}return e.prototype.ClearStore=function(){},new e}angular.module("myApp").factory("ApprovalItemsListStore",e),e.$inject=[]}(),function(){"use strict";function e(r,n,e,t){this.GetAssignedDelegations=function(){return r.assigned.delegationList=[],n.GetAssignedDelegations().then(function(e){for(var t=0;t<e.length;t++)e[t].DelegationDateLocal=moment(e[t].DelegationDateLocal).format(),e[t].DelegationFromLocal=moment(e[t].DelegationFromLocal).format(),e[t].DelegationToLocal=moment(e[t].DelegationToLocal).format(),e[t].DelegationFilterStatus=null==e[t].DelegationFilterStatus?e[t].DelegationRoleStatus:e[t].DelegationFilterStatus;r.assigned.delegationList=e})},this.DelegationsFurther=function(e){var t=angular.copy(e);return function(e){var t=angular.copy(function(e){for(var t=0;t<e.length;t++)if(e[t].isSelected)return e[t]}(r.assigned.delegationList));e.DelegationId=t.DelegationId;var n=[{OrganizationCode:t.OrganizationCode,ApprovalItemId:t.ApprovalItemId,CostPointRoleId:t.CostPointRoleId}];e.Roles.push({CostPointRoleId:t.CostPointRoleId,RoleDisplayName:t.RoleDisplayName,CanFurtherDelegate:t.CanFurtherDelegate,Filters:n});var l=moment(e.DelegationFrom,"YYYY-MMM-DD"),o=moment(e.DelegationTo,"YYYY-MMM-DD");e.DelegationFrom=l,e.DelegationTo=o.add(1,"days").subtract(1,"seconds"),e.DelegateeDisplayName=angular.copy(e.delegatee.FULL_NAME),e.DelegateeEmail=angular.copy(e.delegatee.EMAIL_ADDRESS),e.DelegateeUserName=angular.copy(e.delegatee.EMAIL_ADDRESS)}(t),n.DelegationsFurther(t).then(function(e){return e})},this.GetDates=function(e,t){var n=[],l=moment(e);t=moment(t);for(;l<=t;)n.push(moment(l).format("YYYY-MMM-DD")),l=moment(l).add(1,"days");return n},this.ChangePageSize=function(e){r.currentPageSize=e}}angular.module("myApp").service("DelegationsAssignedBusiness",e),e.$inject=["DelegationsAssignedStore","DelegationsAssignedService","LookupService","astigUtilityService"]}(),function(){"use strict";function e(t,e,n,l,o,r,i,a,s,u,c){var d=this;function p(e,t,n){n&&(n.isSelected=!0,d.model.ClearAssignedModal(),angular.element(document.querySelector("#genericAutocomplete")).val(null),d.model.assign.filterList=[{userName:angular.copy(l.securityDetails.ViewAsUsername)},{userName:n.DelegatorUsername}],d.model.assign.selected.push(n)),angular.element(t).modal(e)}d.model=e,d.mainModel=l,d.delegateModel=o,d.sharedModel=c,d.methods={utility:a},d.events={onClicked_OpenExitModal:p,onClicked_SelectCheckbox:function(e){e.isSelected=!e.isSelected},onClicked_Delegate:function(){t.DelegationsFurther(d.model.assign).then(function(e){switch(e.ValidationMessage){case r.InvalidApprover:i.alertWarning("Warning","Delegatee cannot be the same as the parent delegation delegator or yourself","none");break;case r.InvalidDelegationDate:i.alertWarning("Warning","Delegation dates should be within parent delegation dates","none");break;case r.InvalidRole:i.alertWarning("Warning","You are trying to assign a different role","none");break;case r.InvalidFurtherDate:i.alertWarning("Warning","There's already existing further delegation with your choosen date","none");break;default:t.GetAssignedDelegations().then(function(e){s.GetPendingDelegationCount().then(function(){p("hide","#furtherDelegations")})})}p("hide","#furtherDelegations")})},onValidate_FurtherDelegation:function(){if(d.methods.utility.stringIsNullUndefinedOrEmpty(d.model.assign.delegatee))return!0;if(d.methods.utility.stringIsNullUndefinedOrEmpty(d.model.assign.DelegationFrom))return!0;if(d.methods.utility.stringIsNullUndefinedOrEmpty(d.model.assign.DelegationTo))return!0;return!1},onSort_Field:function(e){d.model.sortPendingAction=!d.model.sortPendingAction,d.model.sortPendingActionProperty=e,d.model.assigned.delegationList=u(d.model.assigned.delegationList,e,d.model.sortPendingAction)},onChange_PageSize:function(e){t.ChangePageSize(e)},onHover:function(e){return angular.isDefined(e)&&0<e.length?s.GetToolTip(_listt[0]):"No items to search"}},n.GetDelegations(),t.GetAssignedDelegations()}angular.module("myApp").controller("DelegationsAssignedController",e),e.$inject=["DelegationsAssignedBusiness","DelegationsAssignedStore","DelegationsDelegateBusiness","MainStore","DelegationsDelegateStore","DelegationValidation","sweetDialogAlertService","astigUtilityService","MainBusiness","orderByFilter","DelegationStore"]}(),function(){"use strict";function e(t){this.GetAssignedDelegations=function(){return t.Get(n+"Assigned",{cache:!1}).then(function(e){return e})},this.DelegationsFurther=function(e){return t.Post(n+"DelegationsFurther",e).then(function(e){return e})};var n=ApiRootDirectory.absoluteRootUrl+"api/Delegations/"}angular.module("myApp").service("DelegationsAssignedService",e),e.$inject=["DataAccess"]}(),function(){"use strict";function e(e){function t(){this.assigned={delegationList:[]},this.search="",this.assigned={organizationList:[],orgSelected:"ALL"},this.assign={delegatee:null,delegationId:0,DelegateeUserName:null,DelegateeDisplayName:null,DelegateeEmail:null,DelegationFrom:null,DelegationTo:null,Comments:null,Roles:[],selected:[],filterList:[],invalidDates:[]},this.sortPendingAction=!1,this.sortPendingActionProperty="",this.pageSizes=e,this.currentPageSize=5}return t.prototype.ClearStore=function(){this.search="",this.assigned={delegationList:[]},this.assigned={organizationList:[],orgSelected:"ALL"},this.assigned={delegatee:null,delegationId:0,DelegateeUserName:null,DelegateeDisplayName:null,DelegateeEmail:null,DelegationFrom:null,DelegationTo:null,Comments:null,Roles:[],selected:[],filterList:[],invalidDates:[]},this.sortPendingAction=!1,this.sortPendingActionProperty="",this.pageSizes=e,this.currentPageSize=5},t.prototype.ClearAssignedModal=function(){this.assign={delegatee:null,delegationId:0,DelegateeUserName:null,DelegateeDisplayName:null,DelegateeEmail:null,DelegationFrom:null,DelegationTo:null,Comments:null,Roles:[],selected:[],filterList:[],invalidDates:[]}},new t}angular.module("myApp").factory("DelegationsAssignedStore",e),e.$inject=["PageSizes"]}(),function(){"use strict";function e(n,l,o,r,e){this.CancelDelegation=function(e){return e.DelegationsList=function(){return n.delegations.list.filter(function(e){return!0===e.isSelected&&("ACCEPTED"===e.DelegationFilterStatus||"ACCEPTED"===e.DelegationRoleStatus||"AUTO-ACCEPTED"===e.DelegationFilterStatus||"AUTO-ACCEPTED"===e.DelegationRoleStatus)})}(),l.CancelDelegation(e).then(function(e){})},this.GetUserRoleList=function(){return o.GetUserRoleList().then(function(e){for(var t=0;t<e.length;t++)n.roles.list.push({delegationGuid:r.guid(),isSelected:!1,RoleDisplayName:e[t].ROLE_NAME,CostPointRoleId:e[t].ROLE_ID,CanFurtherDelegate:!1,approvalItems:{list:[],search:null,selected:{},checkAll:!1},Filters:[],expandSwitch:!1})})},this.Delegate=function(e){var t=angular.copy(e);return function(e){e.Roles=e.Roles.filter(function(e){return!0===e.isSelected}),e.Roles.forEach(function(t){t.Filters.forEach(function(e){e.CostPointRoleId=angular.copy(t.CostPointRoleId),e.CanFurtherDelegate=angular.copy(t.CanFurtherDelegate),e.RoleDisplayName=angular.copy(t.RoleDisplayName)})})}(t),l.InsertUpdateDelegation(t).then(function(e){return e})},this.LoadApprovalItems=function(n){(function(e,t,n){return o.GetApprovalItemsPerRoleDivision(e,t,n).then(function(e){return e})})("ALL",n.CostPointRoleId,"x").then(function(e){n.approvalItems.list=angular.copy(e);for(var t=0;t<n.approvalItems.list.length;t++)n.approvalItems.list[t].isSelected=angular.copy(n.isSelected);n.approvalItems.checkAll=angular.copy(n.isSelected)})},this.GetDelegations=function(){return n.delegations.list=[],l.GetDelegations().then(function(e){for(var t=0;t<e.length;t++)e[t].DelegationDateLocal=moment(e[t].DelegationDateLocal).format(),e[t].DelegationFromLocal=moment(e[t].DelegationFromLocal).format(),e[t].DelegationToLocal=moment(e[t].DelegationToLocal).format(),e[t].DelegationToLocal=moment(e[t].DelegationToLocal).format(),e[t].DelegationFilterStatus=null==e[t].DelegationFilterStatus?e[t].DelegationRoleStatus:e[t].DelegationFilterStatus;n.delegations.list=e})},this.MapDelegatee=function(e){var t=moment(e.DelegationFrom,"YYYY-MMM-DD"),n=moment(e.DelegationTo,"YYYY-MMM-DD");e.DelegationFrom=t,e.DelegationTo=n.add(1,"days").subtract(1,"seconds"),e.DelegateeDisplayName=angular.copy(e.delegatee.FULL_NAME),e.DelegateeEmail=angular.copy(e.delegatee.EMAIL_ADDRESS),e.DelegateeUserName=angular.copy(e.delegatee.EMAIL_ADDRESS)},this.ChangePageSize=function(e){n.currentPageSize=e},this.AddFilters=function(e){if(e.Filters=[],!e.approvalItems.checkAll)for(var t=0;t<e.approvalItems.list.length;t++)e.approvalItems.list[t].isSelected&&e.Filters.push(e.approvalItems.list[t])},Object.preventExtensions(n)}angular.module("myApp").service("DelegationsDelegateBusiness",e),e.$inject=["DelegationsDelegateStore","DelegationsDelegateService","LookupService","astigUtilityService"]}(),function(){"use strict";function e(e,t,n,l,r,o,i,a,s,u,c){var d=this;function p(e,t){switch(t){case"#cancelDelegations":d.model.ClearCancelModal();break;case"#addDelegations":d.model.ClearDelegateModal(),d.model.delegate.Roles=angular.copy(d.model.roles.list)}angular.element(document.querySelector("#genericAutocomplete")).val(null),angular.element(t).modal(e)}function m(e){r.SelectDeselectAll(e.approvalItems,"list"),n.AddFilters(e)}d.model=e,d.sharedModel=t,d.mainModel=i,d.methods={utility:o},d.events={onClicked_SelectApprovalItem:function(e,t){t.isSelected=!t.isSelected,e.approvalItems.checkAll=r.IsAllSelectedDeselected(e.approvalItems.list,t.isSelected),n.AddFilters(e),e.isSelected=!r.IsAllDeselected(e.approvalItems.list),d.model.delegate.checkAll=r.IsAllSelectedDeselected(d.model.delegate.Roles,e.isSelected)},onClicked_OpenExitModal:p,onClicked_CancelDelegations:function(){n.CancelDelegation(d.model.cancel).then(function(e){n.GetDelegations().then(function(e){u.GetPendingDelegationCount().then(function(){d.model.delegations.checkAll=!1,p("hide","#cancelDelegations")})})})},onClicked_ExpandFilters:function(e){e.approvalItems.list.length<1&&n.LoadApprovalItems(e)},onClicked_SelectCheckbox:function(e,t,n){angular.isDefined(e.approvalItems)&&(e.approvalItems.checkAll=angular.copy(e.isSelected));e.isSelected=!e.isSelected,t.checkAll=r.IsAllSelectedDeselected(t[n],e.isSelected),angular.isDefined(e.approvalItems)&&m(e)},onClicked_SelectDelegation:function(e){r.PushSpliceDelegationId(d.model.cancel.Delegation,e)},onClicked_Delegate:function(){n.MapDelegatee(d.model.delegate),n.Delegate(d.model.delegate).then(function(e){switch(e.ValidationMessage){case a.InvalidApprover:s.alertWarning("Warning","Delegatee should not be the same with existing delegations","none");break;case a.InvaliDelegationDateOrFilters:s.alertWarning("Warning","Found existing delegation (Roles/Dates/Organization/Item)","none");break;default:n.GetDelegations().then(function(e){u.GetPendingDelegationCount().then(function(){u.GetRequestTotalCount().then(function(){p("hide","#addDelegations")})})})}p("hide","#addDelegations")})},onClicked_SelectAll:function(e,t,n,l){r.SelectDeselectAll(e,t,n,l);for(var o=0;o<e[t].length;o++)m(e[t][o]),e[t][o].approvalItems.checkAll=angular.copy(e.checkAll)},onChanged_SetDateFrom:function(e){var t=moment(e.DelegationFrom,"YYYY-MMM-DD");e.MaxDateFrom=new Date(t).toDateString()},onSort_Field:function(e){d.model.sortPendingAction=!d.model.sortPendingAction,d.model.sortPendingActionProperty=e,d.model.delegations.list=c(d.model.delegations.list,e,d.model.sortPendingAction)},onChange_PageSize:function(e){n.ChangePageSize(e)},onClicked_SelectAllApprovalItems:m,onHover:function(e){return 0<e.length?u.GetToolTip(e[0]):"No items to search"},onLoad_PopOver:function(){angular.element("#delegatee").popover("show")}},d.validations={onValidated_IsCheckBoxSelected:function(e){return r.ValidateCheckBox(e)},onValidated_IsAllSelected:function(e){return n.ValidateFilterApprovalItems(e)},onValidated_DelegateValidation:function(){if(d.methods.utility.stringIsNullUndefinedOrEmpty(d.model.delegate.delegatee))return!0;if(d.methods.utility.stringIsNullUndefinedOrEmpty(d.model.delegate.DelegationFrom))return!0;if(d.methods.utility.stringIsNullUndefinedOrEmpty(d.model.delegate.DelegationTo))return!0;return!1},onValidated_CancelValidation:function(){if(d.methods.utility.stringIsNullUndefinedOrEmpty(d.model.cancel.Comments))return!0;return!1}},n.GetDelegations(),n.GetUserRoleList(),l.$on("$destroy",function(){d.model.ClearStore()})}angular.module("myApp").controller("DelegationsDelegateController",e),e.$inject=["DelegationsDelegateStore","DelegationStore","DelegationsDelegateBusiness","$scope","DelegationsBusiness","astigUtilityService","MainStore","DelegationValidation","sweetDialogAlertService","MainBusiness","orderByFilter"]}(),function(){"use strict";function e(t){this.CancelDelegation=function(e){return t.Post(n+"Cancel",e).then(function(e){return e})},this.InsertUpdateDelegation=function(e){return t.Post(n+"CreateUpdate",e).then(function(e){return e})},this.GetDelegations=function(){return t.Get(n,{cache:!1}).then(function(e){return e})};var n=ApiRootDirectory.absoluteRootUrl+"api/Delegations/"}angular.module("myApp").service("DelegationsDelegateService",e),e.$inject=["DataAccess"]}(),function(){"use strict";function e(e){function t(){this.search="",this.delegations={list:[],selected:null,checkAll:!1},this.organization={list:[],selected:"ALL"},this.roles={list:[]},this.approvalItems={list:[],selected:null},this.cancel={Comments:null,Delegation:[],DelegationsList:[]},this.delegate={delegatee:null,mindate:(new Date).toDateString(),delegationId:0,DelegateeUserName:null,DelegateeDisplayName:null,DelegateeEmail:null,DelegationFrom:null,MaxDateFrom:null,DelegationTo:null,Comments:null,Roles:[],checkAll:!1},this.filterList=[],this.sortPendingAction=!1,this.sortPendingActionProperty="",this.pageSizes=e,this.currentPageSize=5}return t.prototype.ClearStore=function(){this.search="",this.delegations={list:[],selected:null,checkAll:!1},this.roles={list:[]},this.organization={list:[],selected:"ALL"},this.cancel={Comments:null,Delegation:[],DelegationsList:[]},this.delegate={delegatee:null,mindate:(new Date).toDateString(),delegationId:0,DelegateeUserName:null,DelegateeDisplayName:null,DelegateeEmail:null,DelegationFrom:null,MaxDateFrom:null,DelegationTo:null,Comments:null,Roles:[],checkAll:!1},this.sortPendingAction=!1,this.sortPendingActionProperty="",this.pageSizes=e,this.currentPageSize=5},t.prototype.ClearDelegateModal=function(){this.delegate={delegatee:null,mindate:(new Date).toDateString(),delegationId:0,DelegateeUserName:null,DelegateeDisplayName:null,DelegateeEmail:null,DelegationFrom:null,DelegationTo:null,MaxDateFrom:null,Comments:null,Roles:[],checkAll:!1}},t.prototype.ClearCancelModal=function(){this.cancel.Comments=null},new t}angular.module("myApp").factory("DelegationsDelegateStore",e),e.$inject=["PageSizes"]}(),function(){"use strict";function e(n,e,t,l){function o(e,t){t.isSelected?e.push({DelegationId:t.DelegationId,DelegationRoleId:t.DelegationRoleId,DelegationFilterId:t.DelegationFilterId,guid:t.DelegationGuid}):e.splice(e.map(function(e){return e.guid}).indexOf(t.guid),1)}this.PushSpliceDelegationId=o,this.ValidateCheckBox=function(e){return function(e){return null!=e.find(function(e){return!0===e.isSelected})}(e)},this.SelectDeselectAll=function(t,e,n,l){void 0!==n?(n[l]=[],t[e].forEach(function(e){e.isSelected=!t.checkAll,o(n[l],e)})):t[e].forEach(function(e){e.isSelected=!t.checkAll});t.checkAll=!t.checkAll},this.IsAllSelectedDeselected=function(e,t){var n=e.filter(function(e){return e.isSelected==t});return!(e.length!==n.length||!t)},this.GetWaiverDelegationsCount=function(){return t.GetWaiverDelegations().then(function(e){n.waiver.delegationList=e})},this.ValidateWaiverAccess=function(t){return t.ViewAsUsername===t.LoggedInUsername?0<n.waiver.waiverTeam.filter(function(e){return e.WaiverUsername===t.ViewAsUsername}).length:0<n.waiver.waiverTeam.filter(function(e){return e.WaiverUsername===t.ViewAsUsername}).length&&l.ifArrayIsInList(["MASK_WAIVE"],t.AccessList)},this.GetWaiverTeam=function(){return e.GetWaiverTeam().then(function(e){n.waiver.waiverTeam=e})},this.IsAllDeselected=function(e){var t=e.filter(function(e){return 0==e.isSelected});return e.length===t.length}}angular.module("myApp").service("DelegationsBusiness",e),e.$inject=["DelegationStore","DelegationsService","DelegationsWaiverService","astigUtilityService"]}(),function(){"use strict";function e(t,n,e,l,o){var r=this;r.model=e,r.model.mainModel=l,r.validation={onValidated_CheckWaiverAccess:function(e){return t.ValidateWaiverAccess(e)}},function(){r.model.state=n.current.name;var e=o.guid().split("-");r.model.guid=e.join(""),t.GetWaiverTeam(),t.GetWaiverDelegationsCount()}()}angular.module("myApp").controller("DelegationsController",e),e.$inject=["DelegationsBusiness","$state","DelegationStore","MainStore","astigUtilityService"]}(),function(){"use strict";angular.module("myApp").config(["$stateProvider","$urlRouterProvider",function(e,t){e.state({name:"am.delegations.index",url:"index/",controller:"DelegationsController as vm",templateUrl:"app/views/delegations/index.html"})}])}(),function(){"use strict";function e(e){this.GetWaiverTeam=function(){return e.Get(t+"WaiverTeam").then(function(e){return e})};var t=ApiRootDirectory.absoluteRootUrl+"api/Delegations/"}angular.module("myApp").service("DelegationsService",e),e.$inject=["DataAccess"]}(),function(){"use strict";function e(){return new function(){this.state=null,this.guid=null,this.waiver={delegationList:[],waiverTeam:[]},this.mainModel=null}}angular.module("myApp").factory("DelegationStore",e),e.$inject=[]}(),function(){"use strict";angular.module("myApp").config(["$stateProvider","$urlRouterProvider",function(e,t){e.state({name:"am.delegations.index.waiver",url:"waiver",controller:"DelegationsWaiverController as vm",templateUrl:"app/views/delegations/waiver/index.html",data:{breadcrumbList:[{name:"Delegations",className:"",route:""},{name:"Pending Delegations",className:"",route:""}]}}).state({name:"am.delegations.index.delegate",url:"delegate",controller:"DelegationsDelegateController as vm",templateUrl:"app/views/delegations/delegate/index.html",data:{breadcrumbList:[{name:"Delegations",className:"",route:""},{name:"Submitted Delegations",className:"",route:""}]}}).state({name:"am.delegations.index.assigned",url:"assigned",controller:"DelegationsAssignedController as vm",templateUrl:"app/views/delegations/assigned/index.html",data:{breadcrumbList:[{name:"Delegations",className:"",route:""},{name:"Delegations Assigned to Me",className:"",route:""}]}})}])}(),function(){"use strict";function e(n,t){function l(){return n.waiver.delegationList.filter(function(e){return!0===e.isSelected})}this.GetWaiverDelegations=function(){return n.waiver.delegationList=[],t.GetWaiverDelegations().then(function(e){for(var t=0;t<e.length;t++)e[t].DelegationDateLocal=moment(e[t].DelegationDateLocal).format(),e[t].DelegationFromLocal=moment(e[t].DelegationFromLocal).format(),e[t].DelegationToLocal=moment(e[t].DelegationToLocal).format(),e[t].DelegationFilterStatus=null==e[t].DelegationFilterStatus?e[t].DelegationRoleStatus:e[t].DelegationFilterStatus;n.waiver.delegationList=e})},this.ApproveDelegation=function(e){return e.DelegationsList=l(),t.ApproveDelegation(e).then(function(e){})},this.DeclineDelegation=function(e){return e.DelegationsList=l(),t.DeclineDelegation(e).then(function(e){})},this.ChangePageSize=function(e){n.currentPageSize=e},Object.preventExtensions(n)}angular.module("myApp").service("DelegationsWaiverBusiness",e),e.$inject=["DelegationsWaiverStore","DelegationsWaiverService"]}(),function(){"use strict";function e(t,e,n,o,l,r,i,a){var s=this;function u(e,t){angular.element(t).modal(e)}s.model=e,s.mainModel=r,s.sharedModel=a,s.events={onClicked_OpenExitModal:u,onClicked_ApproveDelegations:function(){t.ApproveDelegation(s.model.approve).then(function(e){t.GetWaiverDelegations().then(function(e){l.GetPendingDelegationCount().then(function(){s.model.waiver.checkAll=!1,s.model.ClearModalStore(),u("hide","#approveDelegations")})})})},onClicked_DeclineDelegations:function(){t.DeclineDelegation(s.model.approve).then(function(e){t.GetWaiverDelegations().then(function(e){l.GetPendingDelegationCount().then(function(){s.model.waiver.checkAll=!1,s.model.ClearModalStore(),u("hide","#declineDelegations")})})})},onClicked_SelectCheckbox:function(e){e.isSelected=!e.isSelected,s.model.waiver.checkAll=o.IsAllSelectedDeselected(s.model.waiver.delegationList,e.isSelected)},onClicked_SelectDelegation:function(e){o.PushSpliceDelegationId(s.model.approve.Delegation,e)},onClicked_SelectAll:function(e,t,n,l){o.SelectDeselectAll(e,t,n,l)},onSort_Field:function(e){s.model.sortPendingAction=!s.model.sortPendingAction,s.model.sortPendingActionProperty=e,s.model.waiver.delegationList=i(s.model.waiver.delegationList,e,s.model.sortPendingAction)},onChange_PageSize:function(e){t.ChangePageSize(e)},onHover:function(e){return angular.isDefined(e)&&0<e.length?l.GetToolTip(e[0]):"No items to search"}},s.validation={onValidated_IsCheckBoxSelected:function(e){return o.ValidateCheckBox(e)}},t.GetWaiverDelegations(),n.$on("$destroy",function(){s.model.ClearStore()})}angular.module("myApp").controller("DelegationsWaiverController",e),e.$inject=["DelegationsWaiverBusiness","DelegationsWaiverStore","$scope","DelegationsBusiness","MainBusiness","MainStore","orderByFilter","DelegationStore"]}(),function(){"use strict";function e(t){this.GetWaiverDelegations=function(){return t.Get(n+"Waiver").then(function(e){return e})},this.ApproveDelegation=function(e){return t.Post(n+"Approve",e).then(function(e){return e})},this.DeclineDelegation=function(e){return t.Post(n+"Decline",e).then(function(e){return e})};var n=ApiRootDirectory.absoluteRootUrl+"api/Delegations/"}angular.module("myApp").service("DelegationsWaiverService",e),e.$inject=["DataAccess"]}(),function(){"use strict";function e(e){function t(){this.search="",this.waiver={delegationList:[],selected:null,checkAll:!1},this.approve={Comments:null,Delegation:[],DelegationsList:[]},this.sortPendingAction=!1,this.sortPendingActionProperty="",this.pageSizes=e,this.currentPageSize=5}return t.prototype.ClearStore=function(){this.search="",this.waiver={delegationList:[],selected:null,checkAll:!1},this.sortPendingAction=!1,this.sortPendingActionProperty="",this.pageSizes=e,this.currentPageSize=5},t.prototype.ClearModalStore=function(){this.approve={Comments:null,Delegation:[],DelegationsList:[]}},new t}angular.module("myApp").factory("DelegationsWaiverStore",e),e.$inject=["PageSizes"]}(),function(){"use strict";function e(t,e,n,l,o){n.isTokenExpired()?n.authenticate().then(function(e){e?localStorage.existingUser?t.go("am.approvalitems.list"):(localStorage.setItem("existingUser","Y"),t.go("am.approvalitems.list",{},{reload:!0})):n.login().then(function(e){e?n.me(localStorage.token).then(function(e){e.hasOwnProperty("error")?window.alert("You are not authorized to access this site. (#HomeInitLoginErr)"):(localStorage.setItem("user",angular.toJson(e)),t.go("am.approvalitems.list"))}):t.go("am.approvalitems.list",{},{reload:!0})})}):localStorage.existingUser?t.go("am.approvalitems.list"):(localStorage.setItem("existingUser","Y"),t.go("am.approvalitems.list",{},{reload:!0}))}angular.module("myApp").controller("HomeController",e),e.$inject=["$state","astigUtilityService","MainBusiness","localStorageService","$rootScope"]}(),function(){"use strict";function e(n,e,t,l,o,r,i,a,s,u,c,d){function p(e,t,n){return"WSPUSA"}this.GetDetails=function(){return e.GetDetails().then(function(e){var t=l.get(o.loggedInViewAs);s.objectIsNullorUndefined(t)?(n.securityDetails.ViewAsUsername=e.LoggedInUsername,n.securityDetails.ViewAsDisplayName=e.LoggedInDisplayName,n.securityDetails.ViewAsEmail=e.LoggedInEmail,n.securityDetails.SubordinateList=[]):n.securityDetails=JSON.parse(r.decode(t)),n.securityDetails.LoggedInUsername=e.LoggedInUsername,n.securityDetails.LoggedInDisplayName=e.LoggedInDisplayName,n.securityDetails.LoggedInEmail=e.LoggedInEmail,n.securityDetails.OrgId=e.OrgId,n.securityDetails.Region=e.Region,n.securityDetails.SubRegion=e.SubRegion,n.securityDetails.CountryName=e.CountryName,n.securityDetails.AccessList=e.GroupAccess,n.securityDetails.Token=e.Token,null===n.securityDetails.OrigOrg&&(n.securityDetails.DefaultOrg=(e.OrgId,e.Region,e.SubRegion,"WSPUSA"),n.securityDetails.OrigOrg=angular.copy(n.securityDetails.DefaultOrg)),n.securityDetails.SupervisorAccess=e.SupervisorAccess,n.securityDetails.LoggedInUsername===n.securityDetails.ViewAsUsername&&(n.securityDetails.HasSubordinate=e.HasSubordinate,n.securityDetails.IsGBSPersonnel=e.IsGBSPersonnel,n.securityDetails.GroupIds=0<e.GroupIds.length?JSON.parse(e.GroupIds):[]),l.set(o.loggedInViewAs,r.encode(JSON.stringify(n.securityDetails)))})},this.GetRequestTotalCount=function(){return t.GetRequestTotalCount().then(function(e){n.RequestTotalCount=e})},this.GetPendingDelegationCount=function(){return i.GetWaiverDelegations().then(function(e){n.PendingDelegationCount=e.length})},this.IdentifyOrgCode=p,this.GetToolTip=function(e){var t=Object.keys(e),n="";t=t.filter(function(e){return"$$hashkey"!==e.toLowerCase()&&"isopen"!==e.toLowerCase()&&"isprojectspecific"!==e.toLowerCase()&&"children"!==e.toLowerCase()&&"candelete"!==e.toLowerCase()&&"isapproverflag"!==e.toLowerCase()&&"anticipatedapproverjson"!==e.toLowerCase()&&"application"!==e.toLowerCase()});for(var l=0;l<t.length;l++)n+=l===t.length-1?" and "+t[l].toLowerCase():t[l].toLowerCase()+", ";return"Fields searched include: "+n},this.Test=function(){return d.test()},this.me=function(e){return u.me(e)},this.login=function(){return u.login()},this.logout=function(){return u.logout()},this.authenticate=function(){return u.authenticate()},this.isAuthenticated=function(){return!(null===localStorage.getItem("user")||void 0===localStorage.getItem("user")||"undefined"===localStorage.getItem("user"))},this.isTokenExpired=function(){try{return c.isTokenExpired(localStorage.token)}catch(e){return!0}},Object.preventExtensions(n)}angular.module("myApp").service("MainBusiness",e),e.$inject=["MainStore","SecurityService","RequestsListService","localStorageService","SessionName","$base64","DelegationsWaiverService","LookupService","astigUtilityService","AuthenticationService","jwtHelper","MainService"]}(),function(){"use strict";function e(n,e,t,l,o,r,i,a,s){function u(){n.login().then(function(e){e?n.me(localStorage.token).then(function(e){e.hasOwnProperty("error")?window.alert("You are not authorized to access this site. (#MainInitLoginErr)"):localStorage.setItem("user",angular.toJson(e))}):window.alert("You are not authorized to access this site. (#HomeInitLogin)")})}function c(){n.me(localStorage.token).then(function(e){if(e.hasOwnProperty.error)u();else{var t=e;localStorage.setItem("user",angular.toJson(t)),n.GetDetails().then(function(){n.GetRequestTotalCount(),n.GetPendingDelegationCount(),function(){var e=document.querySelector("ias-config"),t=a.get(i.loggedInViewAs);t=JSON.parse(s.decode(t)),e.token=localStorage.token,e.viewAsUsername=t.ViewAsUsername,e.loggedInUsername=t.LoggedInUsername,e.appVersion=appVersion,document.querySelector("ias-idle-detector").addEventListener("on-component-dispatch",function(e){"RELOAD"===e.detail.action&&window.location.reload()})}(),"am.admin.approvalitems"!==r.current.name&&"am.approvalitems.list"!==r.current.name||o.$broadcast("LOAD_DEFAULT_ORG_AND_APPROVAL_ITEM",{init:!0})})}})}this.model=e,this.events={login:u,isAuthenticated:function(){return n.isAuthenticated()},Test:function(){n.Test()}},localStorage.token&&(n.isTokenExpired()?n.authenticate().then(function(e){e?c():n.login().then(function(e){e&&r.reload()})}):c()),r.defaultErrorHandler(function(e){})}angular.module("myApp").controller("MainController",e),e.$inject=["MainBusiness","MainStore","SecurityService","$scope","$rootScope","$state","SessionName","localStorageService","$base64"]}(),function(){"use strict";function e(e,t){var n=ApiRootDirectory.absoluteRootUrl+"api/Data";this.test=function(){return e.Post(n,{RoleId:-88888885,parameters:{data:"POSTREQUESTAPPROVAL",action:"CONFIRMED",POSTREQUESTID:0,POSTREQUESTSTEPID:0}}).then(function(e){return e})}}angular.module("myApp").service("MainService",e),e.$inject=["DataAccess","$http"]}(),function(){"use strict";function e(){function e(){this.securityDetails={LoggedInUsername:null,LoggedInDisplayName:null,LoggedInEmail:null,ViewAsUsername:null,ViewAsDisplayName:null,ViewAsEmail:null,OrgId:null,Region:null,SubRegion:null,CountryName:null,DefaultOrg:null,OrigOrg:null,SupervisorAccess:null,AccessList:[],SubordinateList:[],HasSubordinate:"",IsGBSPersonnel:"",Token:""},this.showMenu=!0,this.removeMenu=!1,this.RequestTotalCount=0,this.PendingDelegationCount=0}return e.prototype.ClearStore=function(){this.securityDetails={LoggedInUsername:null,LoggedInDisplayName:null,LoggedInEmail:null,ViewAsUsername:null,ViewAsDisplayName:null,ViewAsEmail:null,OrgId:null,Region:null,SubRegion:null,CountryName:null,DefaultOrg:null,OrigOrg:null,SupervisorAccess:null,AccessList:[],SubordinateList:[],HasSubordinate:"",Token:""},this.showMenu=!0,this.removeMenu=!1,this.RequestTotalCount=0,this.PendingDelegationCount=0},new e}angular.module("myApp").factory("MainStore",e),e.$inject=[]}(),function(){"use strict";function e(e,t){t.GetDetails().then(function(){e.go("am.delegations.index.waiver")})}angular.module("myApp").controller("DelegationsRedirectController",e),e.$inject=["$state","MainBusiness"]}(),function(){"use strict";function e(t,e,n,l,o){l.isAuthenticated()?n.DownloadDocument(e.documentId,"email").then(function(e){e&&0!=JSON.parse(o.decode(decodeURIComponent(e))).parameters.documentId?t.go("filedownloaded"):t.go("unauthorized")}):t.go("unauthorized")}angular.module("myApp").controller("DownloadDocumentController",e),e.$inject=["$state","$stateParams","DocumentService","MainBusiness","$base64"]}(),function(){"use strict";function e(t,n,e,l){e.GetDetails().then(function(){var e=JSON.parse(n.decode(decodeURIComponent(l.base64string)));t.go(e.routeName,e.parameters)})}angular.module("myApp").controller("RedirectController",e),e.$inject=["$state","$base64","MainBusiness","$stateParams"]}(),function(){"use strict";function e(e,t,n){t.GetDetails().then(function(){n.requestType&&"save"===n.requestType?e.go("am.approvalitems.viewsaveddetails",{saveRequestId:n.requestid,org:"WSPUSA"}):e.go("am.requests.details",{requestid:n.requestid})})}angular.module("myApp").controller("ReportRedirectController",e),e.$inject=["$state","MainBusiness","$stateParams"]}(),function(){"use strict";function e(e,t,n,l,o){o.alertError("Unauthorized Access","You are not allowed access to this file",5e3),e.go("am.approvalitems.list")}angular.module("myApp").controller("UnauthorizedController",e),e.$inject=["$state","$base64","MainBusiness","$stateParams","sweetDialogAlertService"]}(),function(){"use strict";function e(l,n,e){function t(e){void 0!==e&&(e.ReportFilters.forEach(function(e){e.Value=null}),e.filters={requestStatus:"ALL",keyword:null,businessActivity:null,requestor:null,approver:null,dateFrom:null,dateTo:null,viewAsAdmin:"NOT ADMIN",roleSelected:null,delegationRoleStatus:null,delgatedBy:null,delegatedTo:null,opportunityStatus:null,projectType:null,projectStatus:null,agreementStatus:null})}this.GetReports=function(t){return n.GetReports(t.Region.OrganizationCode).then(function(e){l.reports.list=angular.copy(e),t.reportSelected=angular.isUndefined(e[0])?null:angular.copy(e[0]),t.ReportPath=angular.isUndefined(e[0].ReportPath)?null:angular.copy(e[0].ReportPath),t.ReportFilters=angular.isUndefined(e[0].ReportFilters)?null:angular.copy(e[0].ReportFilters)})},this.GetBusinessActivitiesRegion=function(e){return t(e),n.GetBusinessActivitiesRegion(e.Region.OrganizationCode).then(function(e){l.businessActivities.list=angular.copy(e)})},this.GetBusinessActivitiesAuditor=function(e){return t(e),n.GetBusinessActivitiesAuditor(e.filters.approver,e.Region.OrganizationCode).then(function(e){l.businessActivities.list=angular.copy(e)})},this.SetDefaultOrg=function(t,e){var n=l.regions.list.find(function(e){return e.OrganizationCode===t});e.Region=void 0!==n?n:null},this.GetOrganizationLookup=function(){return e.GetOrganizationLookup().then(function(e){l.regions.list=angular.copy(e),l.regions.list.unshift({OrganizationId:0,OrganizationCode:"ALL",OrganizationName:"ALL",CanDelete:"N",CLASSIFICATION:"",SUPERVISOR:""})})},this.GetCostPointRoleList=function(){return n.GetCostPointRoleList().then(function(e){l.roles.list=angular.copy(e)})},this.GetOpportunityStatus=function(){return n.GetOpportunityStatus().then(function(e){l.parameters.opportunityStatus.list=angular.copy(e)})},this.GetAgreementStatus=function(){return n.GetAgreementStatus().then(function(e){l.parameters.agreementStatus.list=angular.copy(e)})},this.GetProjectType=function(){return n.GetProjectType().then(function(e){l.parameters.projectType.list=angular.copy(e)})},this.GetProjectStatus=function(){return n.GetProjectStatus().then(function(e){l.parameters.projectStatus.list=angular.copy(e)})},this.GetStatusDescen=function(){return n.GetStatusDescen().then(function(e){l.parameters.statusDescen.list=angular.copy(e)})},this.GetClientType=function(){return n.GetClientType().then(function(e){l.parameters.clientType.list=angular.copy(e)})},Object.preventExtensions(l)}angular.module("myApp").service("ReportParametersComponentBusiness",e),e.$inject=["ReportParametersComponentStore","ReportsParameterComponentService","LookupService"]}(),function(){"use strict";function e(e,n,t,l,o,r,i,a,s){var u,c=this;c.model=e,c.mainModel=a,c.sharedModel=t,c.utility=s,c.events={onChanged_ReportType:function(e){switch(c.reportParameter.reportPanelSwitch=!1,c.reportParameter.ReportPath=angular.copy(c.reportParameter.reportSelected.ReportPath),c.model.businessActivities.list=[],c.reportParameter.ReportFilters=angular.copy(c.reportParameter.reportSelected.ReportFilters),c.reportParameter.reportSelected.ReportName){case"Delegations Report":var t=o.get(l.loggedInViewAs);null!==t&&(t=JSON.parse(r.decode(t)),c.sharedModel.reportParameter.filters.userName=e?null:angular.copy(t.LoggedInEmail));break;case"Auditor Report":n.GetBusinessActivitiesAuditor(c.reportParameter);break;case"Checks and Balances Report":n.GetBusinessActivitiesRegion(c.reportParameter);break;case"WSP USA Agreement Report":n.GetAgreementStatus();break;case"WSP USA Client Report":n.GetStatusDescen(),n.GetClientType();break;case"WSP USA Project Report":n.GetProjectType(),n.GetProjectStatus()}!function(){var e={OrganizationId:0,OrganizationCode:"ALL",OrganizationName:"ALL",CanDelete:"N",CLASSIFICATION:"",SUPERVISOR:""},t=o.get(l.loggedInViewAs);null!==t?(t=JSON.parse(r.decode(t)),4===c.reportParameter.reportSelected.ReportId||5===c.reportParameter.reportSelected.ReportId||6===c.reportParameter.reportSelected.ReportId||7===c.reportParameter.reportSelected.ReportId?c.reportParameter.Region=angular.copy(e):n.SetDefaultOrg(t.DefaultOrg,c.reportParameter)):c.reportParameter.Region=4===c.reportParameter.reportSelected.ReportId||5===c.reportParameter.reportSelected.ReportId||6===c.reportParameter.reportSelected.ReportId||7===c.reportParameter.reportSelected.ReportId?e:c.reportParameter.Region}()},onChanged_Region:function(){c.reportParameter.reportPanelSwitch=!1,n.GetReports(c.reportParameter).then(function(){switch(c.reportParameter.reportSelected.ReportName){case"Auditor Report":n.GetBusinessActivitiesAuditor(c.reportParameter);break;case"Checks and Balances Report":n.GetBusinessActivitiesRegion(c.reportParameter)}})},onLoad_PopOver:function(e){angular.element(e).popover("show")}},null!==(u=o.get(l.loggedInViewAs))?(u=JSON.parse(r.decode(u)),n.GetOrganizationLookup().then(function(){n.SetDefaultOrg(u.DefaultOrg,c.reportParameter),n.GetReports(c.reportParameter).then(function(){switch(c.reportParameter.reportSelected.ReportName){case"Auditor Report":n.GetBusinessActivitiesAuditor(c.reportParameter);break;case"Checks and Balances Report":n.GetBusinessActivitiesRegion(c.reportParameter)}})})):n.GetOrganizationLookup(),i.$on("$destroy",function(){c.model.ClearStore()})}angular.module("myApp").component("reportParameterComponents",{templateUrl:"app/views/reports/component/report-parameters.html",controller:e,controllerAs:"vm",bindings:{reportParameter:"=bind"}}),e.$inject=["ReportParametersComponentStore","ReportParametersComponentBusiness","ReportsStore","SessionName","localStorageService","$base64","$scope","MainStore","astigUtilityService"]}(),function(){"use strict";function e(){function e(){this.reports={list:[]},this.regions={list:[],selected:null},this.businessActivities={list:[]},this.parameters={opportunityStatus:{list:[{Value:"LEAD"},{Value:"IDENTIFIED"},{Value:"IN PREP"},{Value:"PENDING"},{Value:"SHORT LISTED"},{Value:"TASK PIPELINE"},{Value:"CLOSED/WON"},{Value:"TASK WON"},{Value:"WON PANEL-PIPELINE"},{Value:"WON PANEL-COMPLETE"},{Value:"ABANDONED"},{Value:"CANCELLED"},{Value:"CLOSED/LOST"},{Value:"DEFERRED"},{Value:"OPP STOPPED"},{Value:"TASK LOST"}]},agreementStatus:{list:[]},projectType:{list:[]},projectStatus:{list:[]},vendorType:{list:[]},statusDescen:{list:[]},clientType:{list:[]}},this.roles={list:[],search:null},this.requestType={list:[{requestTypeId:1,requestTypeName:"All Requests",requestCode:"ALL"},{requestTypeId:2,requestTypeName:"Pending Requests",requestCode:"PENDING"},{requestTypeId:3,requestTypeName:"Approved Requests",requestCode:"APPROVED"},{requestTypeId:4,requestTypeName:"Rejected Requests",requestCode:"REJECTED"},{requestTypeId:5,requestTypeName:"Cancelled Requests",requestCode:"CANCELLED"}]},this.delegationStatus={list:[{statusName:"All Delegations",statusCode:null},{statusName:"Cancelled Delegations",statusCode:"CANCELLED"},{statusName:"Declined Delegations",statusCode:"DECLINED"},{statusName:"Accepted Delegations",statusCode:"ACCEPTED"},{statusName:"Auto-Accepted Delegations",statusCode:"AUTO-ACCEPTED"},{statusName:"Pending Delegations",statusCode:"PENDING"},{statusName:"Lapsed Delegations",statusCode:"LAPSED"},{statusName:"Lapsed Unaccepted Delegations",statusCode:"LAPSED - UNACCEPTED"}]}}return e.prototype.ClearStore=function(){this.reports={list:[]},this.businessActivities={list:[]},this.regions={list:[],selected:null}},new e}angular.module("myApp").factory("ReportParametersComponentStore",e),e.$inject=[]}(),function(){"use strict";function e(l){this.GetReports=function(e){return l.Get(ApiRootDirectory.absoluteRootUrl+"api/reports/UserReports/"+e,{cache:!0}).then(function(e){return e})},this.GetBusinessActivitiesRegion=function(e){return l.Get(ApiRootDirectory.absoluteRootUrl+"api/reports/BusinessActivitiesRegion/"+e,{cache:!0}).then(function(e){return e})},this.GetBusinessActivitiesAuditor=function(e,t){var n={orgCode:t,approver:e};return l.Post(ApiRootDirectory.absoluteRootUrl+"api/reports/BusinessActivitiesAuditor",n).then(function(e){return e})},this.GetReportParameters=function(e){return l.Get(ApiRootDirectory.absoluteRootUrl+"api/reports/ReportParameters/"+e,{cache:!1}).then(function(e){return e})},this.GetCostPointRoleList=function(){return l.Get(ApiRootDirectory.absoluteRootUrl+"api/Lookup/GetCostPointRoleList",{cache:!1}).then(function(e){return e})},this.GetOpportunityStatus=function(){return l.Get(ApiRootDirectory.absoluteRootUrl+"api/reports/GetOpportunityStatus",{cache:!1}).then(function(e){return e})},this.GetAgreementStatus=function(){return l.Get(ApiRootDirectory.absoluteRootUrl+"api/reports/GetAgreementStatus",{cache:!1}).then(function(e){return e})},this.GetProjectType=function(){return l.Get(ApiRootDirectory.absoluteRootUrl+"api/reports/GetProjectType",{cache:!1}).then(function(e){return e})},this.GetProjectStatus=function(){return l.Get(ApiRootDirectory.absoluteRootUrl+"api/reports/GetProjectStatus",{cache:!1}).then(function(e){return e})},this.GetStatusDescen=function(){return l.Get(ApiRootDirectory.absoluteRootUrl+"api/reports/GetStatusDescen",{cache:!1}).then(function(e){return e})},this.GetClientType=function(){return l.Get(ApiRootDirectory.absoluteRootUrl+"api/reports/GetClientType",{cache:!1}).then(function(e){return e})}}angular.module("myApp").service("ReportsParameterComponentService",e),e.$inject=["DataAccess"]}(),function(){"use strict";function e(e,t,n,l){function o(e){for(var t="",n=0;n<e.length;n++)t+=n==e.length-1?e[n].Value:e[n].Value+"~";return t}this.GenerateReportURL=function(e){return t.GenerateReportURL(e).then(function(e){return e})},this.GenerateExportURL=function(e){ReportService.GenerateExportURL(e).then(function(e){return e})},this.BuildReportParameter=function(t,n){t.ReportFilters.forEach(function(e){switch(e.Key){case"Requestor":e.Value=l.objectIsNullorUndefined(t.filters.requestor)?"":angular.copy(t.filters.requestor.EMAIL_ADDRESS);break;case"ApproverUserName":case"ApproverUsername":e.Value=l.objectIsNullorUndefined(t.filters.approver)?"ApproverApprovalsRequest"===t.ReportPath?n.LoggedInEmail:"":angular.copy(t.filters.approver.EMAIL_ADDRESS);break;case"BusinessActivity":e.Value=angular.copy(t.filters.businessActivity);break;case"BusinessActivityRefNo":e.Value=l.objectIsNullorUndefined(t.filters.businessActivity)?"":angular.copy(t.filters.businessActivity);break;case"DateFrom":e.Value=angular.copy(t.filters.dateFrom);break;case"DateTo":e.Value=angular.copy(t.filters.dateTo);break;case"IsAdmin":e.Value=angular.copy(t.filters.viewAsAdmin);break;case"RequestStatus":e.Value="RequestorRequests"!==t.ReportPath&&"ApproverApprovalsRequest"!==t.ReportPath||"ALL"!==t.filters.requestStatus?angular.copy(t.filters.requestStatus):"";break;case"SearchKeyword":e.Value=null===t.filters.keyword?"":angular.copy(t.filters.keyword);break;case"OrganizationCode":e.Value="ALL"===t.Region.OrganizationCode&&"ChecksAndBalances"===t.ReportPath?"":angular.copy(t.Region.OrganizationCode);break;case"CostPointRoleId":e.Value=l.objectIsNullorUndefined(t.filters.roleSelected)?null:angular.copy(t.filters.roleSelected.ROLE_ID);break;case"DelegatorUsername":e.Value=l.objectIsNullorUndefined(t.filters.delgatedBy)?"":angular.copy(t.filters.delgatedBy.EMAIL_ADDRESS);break;case"DelegateeUsername":e.Value=l.objectIsNullorUndefined(t.filters.delegatedTo)?"":angular.copy(t.filters.delegatedTo.EMAIL_ADDRESS);break;case"DelegationStatus":e.Value=l.objectIsNullorUndefined(t.filters.delegationRoleStatus)?"ALL":angular.copy(t.filters.delegationRoleStatus);break;case"DelegationDateFrom":e.Value=angular.copy(t.filters.dateFrom);break;case"DelegationDateTo":e.Value=angular.copy(t.filters.dateTo);break;case"UserName":case"Username":e.Value=angular.copy(n.ViewAsEmail);break;case"LoggedInUsername":e.Value=l.objectIsNullorUndefined(t.filters.userName)?"":angular.copy(t.filters.userName);break;case"OrgId":e.Value=angular.copy(t.Region.OrganizationCode);break;case"RequestorUserName":e.Value=l.objectIsNullorUndefined(t.filters.requestor)?"RequestorRequests"===t.ReportPath?n.LoggedInEmail:"":angular.copy(t.filters.requestor.EMAIL_ADDRESS);break;case"RequestDateFrom":e.Value=angular.copy(t.filters.dateFrom);break;case"RequestDateTo":e.Value=angular.copy(t.filters.dateTo);break;case"ShowSteps":e.Value=angular.copy(t.filters.showSteps);break;case"ShowPendingOnly":e.Value=angular.copy(t.filters.showPendingOnly);break;case"Lookup_value":e.Value=l.objectIsNullorUndefined(t.filters.searchCriteria)?"":angular.copy(t.filters.searchCriteria);break;case"AgreementStatus":e.Value=o(t.filters.agreementStatus);break;case"ProjectStatus":e.Value=o(t.filters.projectStatus);break;case"OpportunityStatus":e.Value=o(t.filters.opportunityStatus);break;case"ProjectType":e.Value=o(t.filters.projectType);break;case"StatusDescen":e.Value=o(t.filters.statusDescen);break;case"Type":e.Value=o(t.filters.clientType)}})}}angular.module("myApp").service("ReportsBusiness",e),e.$inject=["ReportsStore","ReportService","LookupService","astigUtilityService"]}(),function(){"use strict";function e(n,e,t,l,o,r,i,a,s){var u=this;u.model=e,u.mainModel=l,u.events={onClicked_Export:function(e){var t={ReportName:"Approval_Items_Report",FileType:e,Division:"LBUS",ReportParameter:[{Key:"OrganizationCode",Value:"LBUS"}]};n.GenerateExportURL(t).then(function(e){window.location=e,window.setTimeout(function(){$("#overlayloader").hide()},15e3)})},onClicked_GenerateReport:function(e){var t=r.get(o.loggedInViewAs);null!==t&&(t=JSON.parse(i.decode(t)),n.BuildReportParameter(e,t),n.GenerateReportURL(e).then(function(e){u.model.reportUrl=a.trustAsResourceUrl(e),u.model.expandFilter=!1,$("#filter-body").collapse("hide"),u.model.reportParameter.reportPanelSwitch=!0}))}},t.$on("$destroy",function(){s.includes("am.reports.reportviewer")||u.model.ClearStore()})}angular.module("myApp").controller("ReportsController",e),e.$inject=["ReportsBusiness","ReportsStore","$scope","MainStore","SessionName","localStorageService","$base64","$sce","$state"]}(),function(){"use strict";angular.module("myApp").config(["$stateProvider","$urlRouterProvider",function(e,t){e.state({name:"am.reports.reportviewer",url:"reportviewer",templateUrl:"app/views/reports/reportviewer/index.html",controller:"ReportsController as vm",data:{pageName:"Reports",breadcrumbList:[{name:"Reports",className:"",route:""},{name:"Report Viewer",className:"",route:""}]}})}])}(),function(){"use strict";function e(t){this.GenerateReportURL=function(e){return t.Post(ApiRootDirectory.absoluteRootUrl+"api/reports/GenerateReportURL",e).then(function(e){return e})},this.GenerateExportURL=function(e){return t.Post(ApiRootDirectory.absoluteRootUrl+"api/reports/GenerateExportURL",e).then(function(e){return e})}}angular.module("myApp").service("ReportService",e),e.$inject=["DataAccess"]}(),function(){"use strict";function e(){return new function e(){this.reportUrl=null,this.expandFilter=!0,this.region={selected:[]},this.reportPanelSwitch=!1,this.reportParameter={ReportPath:null,Region:null,ReportFilters:[],reportPanelSwitch:!1,reportSelected:{ReportName:null,ReportId:null,ReportPath:null,ReportFilters:[]},filters:{requestStatus:"ALL",keyword:null,businessActivity:null,requestor:null,approver:null,dateFrom:null,dateTo:null,viewAsAdmin:"NOT ADMIN",userName:null,roleSelected:null,delegationRoleStatus:null,delgatedBy:null,delegatedTo:null,showSteps:"Y",showPendingOnly:"Y",opportunityStatus:null,projectType:null,projectStatus:null,agreementStatus:null,statusDescen:null,clientType:null,searchCriteria:null}},e.prototype.ClearStore=function(){this.reportUrl=null,this.expandFilter=!0,this.region={selected:[]},this.reportParameter={ReportPath:null,Region:null,ReportFilters:[],reportPanelSwitch:!1,reportSelected:{ReportName:null,ReportId:null,ReportPath:null,ReportFilters:[]},filters:{requestStatus:"ALL",keyword:null,businessActivity:null,requestor:null,approver:null,dateFrom:null,dateTo:null,viewAsAdmin:"NOT ADMIN",userName:null,roleSelected:null,delegationRoleStatus:null,delgatedBy:null,delegatedTo:null,showSteps:"Y",showPendingOnly:"Y",opportunityStatus:null,projectType:null,projectStatus:null,agreementStatus:null,statusDescen:null,clientType:null}}}}}angular.module("myApp").factory("ReportsStore",e),e.$inject=[]}(),function(){"use strict";function e(o,r,i,l,a,s,u,n){function c(){0<o.newAttestDocuments.length?0<i("filter")(o.newAttestDocuments,{Status:"Successful"},!0).length&&(o.attestDocumentSupplied=!0):o.attestDocumentSupplied=!1}function t(){var n={};return o.requests.detail.RequestSteps.forEach(function(t){0<t.Approvers.length&&t.Approvers.forEach(function(e){e.CostPointRoleId===a.Svp?n.Svp={ExecutionOrder:t.ExecutionOrder,MainApproverDisplayName:e.MainApproverDisplayName,MainApproverEmail:e.MainApproverEmail,MainApproverUsername:e.MainApproverUsername}:e.CostPointRoleId===a.Vp?n.Vp={ExecutionOrder:t.ExecutionOrder,MainApproverDisplayName:e.MainApproverDisplayName,MainApproverEmail:e.MainApproverEmail,MainApproverUsername:e.MainApproverUsername}:e.CostPointRoleId===a.Employee&&(n.Employee={ExecutionOrder:t.ExecutionOrder,MainApproverDisplayName:e.MainApproverDisplayName,MainApproverEmail:e.MainApproverEmail,MainApproverUsername:e.MainApproverUsername})})}),angular.equals(n,{})?null:n}function d(){var e=i("filter")(o.requests.detail.RequestSteps,{RequestStepStatus:o.requests.detail.RequestDetail.RequestStatus});return 0===e.length&&(e=o.requests.detail.RequestSteps.filter(function(e){return"REMINDER"===e.RequestStepStatus||"ESCALATED"===e.RequestStepStatus})),e}this.GetRequestDetails=function(e){return o.newRequestDocuments=[],r.GetRequestDetails(e).then(function(e){return o.requests.detail=e,function(){if(o.requests.userIsApprover=!1,o.requests.stepTypeReview=!1,"PENDING"===o.requests.detail.RequestDetail.RequestStatus){var t=o.requests.detail.RequestSteps.filter(function(e){return"PENDING"===e.RequestStepStatus||"REMINDER"===e.RequestStepStatus||"ESCALATED"===e.RequestStepStatus});if(0<t.length){s.stringIsNullUndefinedOrEmpty(t[0].Attest)||1===t.length&&(o.requests.attest=t[0].Attest);var n=!0,l=[];if(t.forEach(function(e){n&&0<(l=t[0].Approvers.filter(function(e){return e.MainApproverUsername===o.setUser})).length&&(n=!1)}),0<l.length)o.requests.userIsApprover=!o.userIsSupervisorApproval||"ALLOWED"===u.securityDetails.SupervisorAccess,"review"===t[0].StepType.toLowerCase()&&(o.requests.stepTypeReview=!o.userIsSupervisorApproval||"ALLOWED"===u.securityDetails.SupervisorAccess);else 0<i("filter")(o.requests.detail.RequestApprover,{ApproverUserName:o.setUser}).length&&(o.requests.userIsApprover=!o.userIsSupervisorApproval||"ALLOWED"===u.securityDetails.SupervisorAccess,"review"===t[0].StepType.toLowerCase()&&(o.requests.stepTypeReview=!o.userIsSupervisorApproval||"ALLOWED"===u.securityDetails.SupervisorAccess))}}}(),o.setUser===o.requests.detail.RequestDetail.RequestorUsername?(o.requests.userIsRequestor=!o.userIsSupervisorApproval||"ALLOWED"===u.securityDetails.SupervisorAccess,o.userForConfirmation=!1,"ON-HOLD"!==o.requests.detail.RequestDetail.RequestStatus||0<o.requests.detail.RequestSteps.filter(function(e){return"NOT RECOMMENDED"===e.RequestStepStatus&&"CONFIRM OR CANCEL"===e.StepBehavior}).length&&(o.userForConfirmation=!o.userIsSupervisorApproval||"ALLOWED"===u.securityDetails.SupervisorAccess)):o.requests.userIsRequestor=!1,function(){o.userCanReplyRFI=!1,o.userRFIRequester=!1;var e=o.requests.detail.RequestSteps.find(function(e){return"RFI-PENDING"===e.StepBehavior});if(!s.objectIsNullorUndefined(e)){var t=o.requests.detail.RequestForInformation.find(function(e){return"PENDING"===e.RequestForInformationStatus});if(!s.objectIsNullorUndefined(t)){if(0<i("filter")(o.requests.detail.RequestForInformation,{RequesterUsername:o.setUser}).length)o.userCanReplyRFI=!o.userIsSupervisorApproval||"ALLOWED"===u.securityDetails.SupervisorAccess,o.userRFIRequester=!o.userIsSupervisorApproval||"ALLOWED"===u.securityDetails.SupervisorAccess;else if(!0===o.userIsSupervisorApproval)0<i("filter")(o.requests.detail.RequestForInformation,{RequesterUsername:u.securityDetails.ViewAsUsername}).length&&(o.userCanReplyRFI=!0,o.userRFIRequester=!0);else o.requests.detail.RequestApprover.some(function(e){return e.ApproverUserName===o.setUser})&&(o.userCanReplyRFI=!0,o.userRFIRequester=!0);0<i("filter")(o.requests.detail.RequestForInformation,{RequesteeUsername:o.setUser}).length&&(o.userCanReplyRFI=!o.userIsSupervisorApproval||"ALLOWED"===u.securityDetails.SupervisorAccess)}}}(),function(){if(o.requests.userIsImplementor=!1,o.requests.detail.RequestDetail.IsForImplementation){0<i("filter")(o.requests.detail.RequestApprover,{ApproverUserName:o.setUser}).length&&(o.requests.userIsImplementor=!o.userIsSupervisorApproval||"ALLOWED"===u.securityDetails.SupervisorAccess)}}(),function(){if("BERGERWIN"===o.requests.detail.RequestDetail.Application){var e=angular.copy(o.requests.detail.RequestDetail.ApplicationForm);o.requests.detail.RequestDetail.ApplicationForm=s.keyValueListToObject(e)}}(),o.requests.detail.RequestImplementation.MaxDate=(new Date).toDateString(),0<o.requests.detail.RequestImplementation.length&&(o.requests.detail.RequestImplementation[0].hasOwnProperty("Requires")&&(o.requests.detail.RequestImplementation.Requires=JSON.parse(o.requests.detail.RequestImplementation[0].Requires)),s.objectIsNullorUndefined(o.requests.detail.RequestImplementation[0].LookupValue)||2<o.requests.detail.RequestImplementation[0].LookupValue.length&&(o.requests.detail.RequestImplementation.LookupValue=JSON.parse(o.requests.detail.RequestImplementation[0].LookupValue))),t(),e})},this.SubmitStepApproval=function(e){var t=d();if(0<t.length){var n="";!0===o.userIsSupervisorApproval&&(n=o.setUser);var l={RequestId:o.requests.detail.RequestDetail.RequestId,RequestStepId:t[0].RequestStepId,RequestStepStatus:e,Comments:o.requests.approvalComments,SubordinateUsername:n};return r.SubmitStepApproval(l)}return},this.SubmitAttestStepApproval=function(){var e=o.requests.detail.RequestSteps.filter(function(e){return"PENDING"===e.RequestStepStatus||"REMINDER"===e.RequestStepStatus||"ESCALATED"===e.RequestStepStatus}),t="";!0===o.userIsSupervisorApproval&&(t=o.setUser);if(0<e.length){var n={RequestStepApproval:{RequestId:o.requests.detail.RequestDetail.RequestId,RequestStepId:e[0].RequestStepId,RequestStepStatus:"APPROVED",Comments:o.requests.approvalComments,EngageOrAttest:"ATTESTED",SubordinateUsername:t},Documents:o.newAttestDocuments.filter(function(e){return"Successful"===e.Status}).map(function(e){return{ActualFileName:e.ActualFilename,GeneratedFileName:e.NewFilename}})};return r.SubmitAttestStepApproval(n)}return},this.CancelRequest=function(){var e={RequestId:o.requests.detail.RequestDetail.RequestId,Comments:o.requests.approvalComments};return r.CancelRequest(e)},this.UploadFileFinal=function(t){var e={},n=l.ValidateFile(t);if(null!==n)return void o.newRequestDocuments.push({ActualFilename:t.filename,NewFilename:"",Status:"Unsuccessful - "+n});e.RequestId=o.requests.detail.RequestDetail.RequestId,e.RequestDocumentType="REQUEST",e.RequestDocumentObjectId=o.requests.detail.RequestDetail.RequestId,e.File=t,e.Documentdto={SettingValue:"SUPPORTING",Title:"Support Documents",Notes:"",Required:"N",Multiple:"Y"},l.UploadFileFinal(e).then(function(e){e.payload.success?o.newRequestDocuments.push({ActualFilename:e.payload.actual_filename,NewFilename:e.payload.new_filename,Status:"Successful",UploadedBy:u.securityDetails.ViewAsUsername,SettingValue:"SUPPORTING",Title:"Support Documents",Notes:"",Required:"N",Multiple:"Y",UploadedDate:JSON.parse(JSON.stringify(new Date))}):o.newRequestDocuments.push({ActualFilename:t.filename,NewFilename:"",Status:"Unsuccessful",SettingValue:"",Title:"",Notes:"",Required:"N",Multiple:"Y",UploadedDate:JSON.parse(JSON.stringify(new Date))})})},this.UploadFileAttest=function(t){var e=l.ValidateFile(t);if(null!==e)return o.newAttestDocuments.push({ActualFilename:t.filename,NewFilename:"",Status:"Unsuccessful - "+e}),void c();l.UploadFileTemp(t).then(function(e){e.payload.success?o.newAttestDocuments.push({ActualFilename:e.payload.actual_filename,NewFilename:e.payload.new_filename,Status:"Successful"}):o.newAttestDocuments.push({ActualFilename:t.filename,NewFilename:"",Status:"Unsuccessful"}),c()})},this.SubmitEngageStepApproval=function(){var e=o.requests.detail.RequestSteps.filter(function(e){return"PENDING"===e.RequestStepStatus||"REMINDER"===e.RequestStepStatus||"ESCALATED"===e.RequestStepStatus}),t="";!0===o.userIsSupervisorApproval&&(t=o.setUser);if(0<e.length){var n={RequestId:o.requests.detail.RequestDetail.RequestId,RequestStepId:e[0].RequestStepId,RequestStepStatus:"APPROVED",Comments:o.requests.approvalComments,EngageOrAttest:"ENGAGED",SubordinateUsername:t};return r.SubmitStepApproval(n)}return},this.RequestForInformation=function(){var e=d(),t="";!0===o.userIsSupervisorApproval&&(t=o.setUser);if(0<e.length){var n={RequestId:o.requests.detail.RequestDetail.RequestId,RequestStepId:e[0].RequestStepId,Comments:o.requests.approvalComments,RequesteeUsername:o.rfiTo.EMAIL_ADDRESS,RequesteeDisplayName:o.rfiTo.FULL_NAME,RequesteeEmail:o.rfiTo.EMAIL_ADDRESS,Documents:o.newAttestDocuments.filter(function(e){return"Successful"===e.Status}).map(function(e){return{SettingValue:"08_RFI",Title:"Request For Information",Notes:"",Required:"N",Multiple:"Y",ActualFileName:e.ActualFilename,GeneratedFileName:e.NewFilename}}),SubordinateUsername:t};return r.RequestForInformation(n)}return},this.ResponseRFI=function(){var e=o.requests.detail.RequestForInformation.reduce(function(e,t){return t.RequestForInformationId>e?t.RequestForInformationId:e},o.requests.detail.RequestForInformation[0].RequestForInformationId),t={RequestId:o.requests.detail.RequestDetail.RequestId,RequestForInformationId:e,Comments:o.rfiResponse,RequestStepId:o.requests.detail.RequestForInformation[0].RequestStepId,RequestDocuments:o.requests.detail.RequestForInformation.RequestForInformationFiles,Documents:o.newAttestDocuments.filter(function(e){return"Successful"===e.Status}).map(function(e){return{SettingValue:"08_RFI",Title:"Request For Information",Notes:"",Required:"N",Multiple:"Y",ActualFileName:e.ActualFilename,GeneratedFileName:e.NewFilename}})};return r.ResponseRFI(t)},this.Implement=function(e){var t={RequestId:o.requests.detail.RequestDetail.RequestId,Comments:e.ImplementationComments?e.ImplementationComments:"",LookupValue:s.stringIsNullUndefinedOrEmpty(e.RequestImplementationText)?JSON.stringify(e.LookupValue):JSON.stringify({OBJECT_NAME:e.RequestImplementationText}),ImplementationDate:moment(e.ImplementationDate,"YYYY-MMM-DD")};return r.Implement(t).then(function(e){return e})},this.Acknowledge=function(){var e=o.requests.detail.RequestForInformation.reduce(function(e,t){return t.RequestForInformationId>e?t.RequestForInformationId:e},o.requests.detail.RequestForInformation[0].RequestForInformationId),t={RequestId:o.requests.detail.RequestDetail.RequestId,RequestForInformationId:e,RequestStepId:o.requests.detail.RequestForInformation[0].RequestStepId};return r.Acknowledge(t)},this.GetWorkflowInformation=function(e){return r.GetWorkflowInformation(e).then(function(e){return e})},this.GetDefaultControlsForResubmit=t,this.ConfirmRequest=function(){if("ON-HOLD"===o.requests.detail.RequestDetail.RequestStatus){var e=o.requests.detail.RequestSteps.filter(function(e){return"NOT RECOMMENDED"===e.RequestStepStatus&&"CONFIRM OR CANCEL"===e.StepBehavior});if(0<e.length){var t={RequestId:o.requests.detail.RequestDetail.RequestId,RequestStepId:e[0].RequestStepId,Comments:o.requests.approvalComments};return r.ConfirmRequest(t)}}return},this.IsRequiresUpload=function(){if(null!==o.requests.detail){if((void 0!==o.requests.detail.RequestItemSetting.find(function(e){return"UPLOAD"===e.SettingKey&&"REQUIRED"===e.SettingValue})||function(e){return e.forEach(function(e){0<e.Approvers.length&&e.Approvers.forEach(function(e){if(e.CostPointRoleId===a.BghBoardOfDirectors)return!0})}),!1}(o.requests.detail.RequestSteps))&&o.requests.detail.RequestDocuments.length+o.newRequestDocuments.length+o.newAttestDocuments.length<=0)return!0}return!1},this.IfLastApprove=function(e,t,n){var l={RequestId:e,EngageOrAttest:t,OnBehalf:n};return r.IfLastApprove(l).then(function(e){return e})},this.checkAttestSuppliedDocument=c,this.GetPostApprovalRequestDetails=function(e){var t={rID:-88888886,Data:"POSTREQUESTDETAILS",RequestId:e};return n.Get(t).then(function(e){return e})},Object.preventExtensions(o)}angular.module("myApp").service("RequestsDetailsBusiness",e),e.$inject=["RequestsDetailsStore","RequestsDetailsService","$filter","DocumentService","CostPointRoleIds","astigUtilityService","MainStore","GenericDataService"]}(),function(){"use strict";function e(l,o,t,r,i,n,a,e,s,u,c,d,p){var m=this;function f(){u.GetDetails().then(function(){r.stringIsNullUndefinedOrEmpty(t.user)?(m.model.setUser=m.mainModel.securityDetails.ViewAsUsername,m.model.userIsSupervisorApproval=!1):"Y"===m.mainModel.securityDetails.HasSubordinate?(m.model.setUser=t.user,m.model.userIsSupervisorApproval=!0):(m.model.setUser=m.mainModel.securityDetails.ViewAsUsername,m.model.userIsSupervisorApproval=!1),o.GetRequestDetails(t.requestid).then(function(e){0===l.requests.detail.RequestDetail.RequestId&&n.go("am.approvalitems.list"),"APPROVED"===l.requests.detail.RequestDetail.RequestStatus&&g()})})}function g(){o.GetPostApprovalRequestDetails(t.requestid).then(function(e){r.objectIsNullorUndefined(e[0])||(m.model.postrequests.detail=e[0][0],r.intIsNullorUndefinedorZero(m.model.postrequests.detail.PostRequestId)||(m.model.postrequests.hasPostRequest=!0,m.model.postrequests.showComponent=!0))})}function v(){var e=m.model.requests.approvalComments="",t="",n="";(m.model.requests.attestUpload=!1)===m.model.requests.stepTypeReview?(e="CONFIRM APPROVE",t="Are you sure you want to approve this request?",n="APPROVE",""!==m.model.requests.attest&&angular.element("#attest-engage-header").text("Group Level Approval")):(e="CONFIRM RECOMMEND",t="Are you sure you want to recommend this request?",n="RECOMMEND",m.model.requests.recommendationStatus="RECOMMENDED"),i.alertConfirm(e,t,function(){""!==m.model.requests.attest?angular.element("#attest").modal("show"):!0===m.model.requests.stepTypeReview?(m.model.requests.recommendationStatus="RECOMMENDED",angular.element("#recommend-comment").modal("show")):angular.element("#approve-comment").modal("show")},angular.noop,n,"CANCEL",!0)}function I(){o.SubmitAttestStepApproval().then(function(e){0===e?i.alertError("Error Approval","Error approval encountered.","none"):(a.GetRequestTotalCount(),o.GetRequestDetails(t.requestid))})}function E(){o.SubmitEngageStepApproval().then(function(e){0===e?i.alertError("Error Approval","Error approval encountered.","none"):(a.GetRequestTotalCount(),o.GetRequestDetails(t.requestid))})}function S(e,n){var l=document.querySelector(e),o=e.replaceAll("-","");m.components[o].listeners.forEach(function(t){Object.keys(t).forEach(function(e){l.addEventListener(e,t[e].event)})}),n&&m.components[o].requires&&Object.keys(m.components[o].requires).forEach(function(e){var t=m.components[o].requires[e];l[e]=n.detail[t]})}function N(t){var e=t.srcElement.localName.replaceAll("-","");y(m.components[e].listeners.find(function(e){return e[t.type]})[t.type].target,t)}function A(e){R(e,e.target.localName)}function y(e,t){var n=e.replaceAll("-","");S(e,t),angular.element(m.components[n].modalname).modal("show")}function R(e,t){var n=t.replaceAll("-","");angular.element(m.components[n].modalname).modal("hide"),s.$apply()}function O(e){A(e),m.model.postrequests.showComponent=!1,g(),f(),s.$apply()}m.model=l,m.mainModel=e,m.utility=r,m.utilService=p,m.events={formatDate:function(e,t){if(!e)return;-1===e.indexOf("Z")&&-1===e.indexOf("+")&&(e+="Z");return d("date")(e,t)},onClick_SubmitApproval:function(e){o.SubmitStepApproval(e).then(function(e){0===e?i.alertError("Error Approval","Error approval encountered.","none"):(a.GetRequestTotalCount(),o.GetRequestDetails(t.requestid).then(function(e){"APPROVED"===l.requests.detail.RequestDetail.RequestStatus&&g()}))})},onClick_Approve:function(){"01.01.01"===l.requests.detail.RequestDetail.RefNo?y(m.components.newopportunityapprovalform.componentelement):o.IfLastApprove(l.requests.detail.RequestDetail.RequestId,null,m.model.setUser).then(function(e){"NOT LAST"===e?v():o.IsRequiresUpload()?i.alertError("Upload Required","Please upload a file.","none"):v()})},onClick_Reject:function(){var e=m.model.requests.approvalComments="",t="",n="";n=!1===m.model.requests.stepTypeReview?(e="CONFIRM REJECT",t="Are you sure you want to reject this request?","REJECT"):(e="CONFIRM DO NOT RECOMMEND",t="Are you sure you want to not recommend this request?","DO NOT RECOMMEND");i.alertConfirm(e,t,function(){!0===m.model.requests.stepTypeReview?angular.element("#donotrecommend-comment").modal("show"):angular.element("#reject-comment").modal("show")},angular.noop,n,"CANCEL",!0)},onClick_Cancel:function(){m.model.requests.approvalComments="",i.alertConfirm("CONFIRM CANCEL","You have selected to Cancel this request. <br/> This will end the current workflow for this request. The request will remain in your queue and can be resubmitted at a later date restarting the workflow. Are you sure you wish to proceed?",function(){angular.element("#cancel-comment").modal("show")},angular.noop,"YES I WANT TO CANCEL THIS REQUEST AND END THE WORKFLOW","NO TAKE ME BACK",!0)},onClick_ApproveAndAttest:function(){o.IsRequiresUpload()?o.IfLastApprove(l.requests.detail.RequestDetail.RequestId,"ATTESTED",m.model.setUser).then(function(e){"NOT LAST"===e?I():i.alertError("Upload Required","Please upload a file.","none")}):I()},onClick_ApproveAndEngage:function(){o.IsRequiresUpload()?o.IfLastApprove(l.requests.detail.RequestDetail.RequestId,"ENGAGED",m.model.setUser).then(function(e){"NOT LAST"===e?E():i.alertError("Upload Required","Please upload a file.","none")}):E()},onClick_Engage:function(){m.model.requests.approvalComments="",angular.element("#approve-engage").modal("show")},onClick_CancelRequest:function(){o.CancelRequest().then(function(e){0===e?i.alertError("Error Cancelling Request","Error cancel request encountered.","none"):(a.GetRequestTotalCount(),i.alertSuccess("Cancelled","Request has been cancelled"),n.go("am.requests.list"))})},onAfterValidate_UploadFileFinal:function(e,t,n){angular.forEach(t,function(e){o.UploadFileFinal(e)})},onAfterValidate_UploadAttestFileFinal:function(e,t,n){angular.forEach(t,function(e){o.UploadFileAttest(e)})},onClick_CancelEditRequest:function(){f()},onClick_ResubmitRequest:function(){m.model.requests.approvalComments="",i.alertConfirm("CONFIRM EDIT & RESUBMIT","You have selected to Edit & Resubmit this request. <br/> This will restart your workflow from the beginning and will require re-approval from everyone in the workflow. If you change monetary threshold, you might need to access a completely separate approval item to remain complaint. Are you sure you wish to proceed?",function(){angular.element("#resubmit-comment").modal("show")},angular.noop,"YES I WANT TO EDIT THIS REQUEST AND RESTART THE WORKFLOW","NO TAKE ME BACK",!0)},onClick_ApproveAndAttestDocumentRequired:function(){angular.element("#attest-engage-header").text("ATTESTATION"),m.model.requests.attestUpload=!0,m.model.attestdocuments=null,m.model.newAttestDocuments=[],m.model.attestDocumentSupplied=!1},onClick_RequestForInformation:function(){o.RequestForInformation().then(function(e){0===e?i.alertError("Error Approval","Error request for information encountered.","none"):o.GetRequestDetails(t.requestid)})},onClick_OpenRequestForInfo:function(){m.model.rfiTo=null,m.model.requests.approvalComments="",m.model.newAttestDocuments=[],angular.element("#request-for-info").modal("show")},onClick_WithdrawRequest:function(){angular.element("#withdraw").modal("show")},onClick_SubmitResubmitRequest:function(){angular.element("#resubmit-comment").modal("hide"),n.go("am.approvalitems.resubmit",{org:l.requests.detail.RequestDetail.OrganizationCode,requestid:t.requestid,resubmitComment:l.requests.approvalComments,requestComment:l.requests.detail.RequestDetail.Comments,defaultControlValues:o.GetDefaultControlsForResubmit(),requestDetails:l.requests.detail.RequestDetail,requestDocuments:0<l.requests.detail.RequestDocuments.length?l.requests.detail.RequestDocuments:null})},onClick_ResponseRFI:function(){o.ResponseRFI().then(function(e){m.model.rfiResponse=null,0===e?i.alertError("Error","Error in replying to request for information.","none"):(o.GetRequestDetails(t.requestid),a.GetRequestTotalCount())})},onClick_ReplyRFI:function(){m.model.rfiResponse=null,m.model.attestdocuments=null,m.model.newAttestDocuments=[],angular.element("#request-for-info-response").modal("show")},onClick_Implement:function(){o.Implement(m.model.requests.detail.RequestImplementation).then(function(e){o.GetRequestDetails(t.requestid),a.GetRequestTotalCount()})},onClick_Acknowlege:function(){o.Acknowledge().then(function(e){0===e?i.alertError("Error","Error acknowledging request for information.","none"):(o.GetRequestDetails(t.requestid),i.alertSuccess("Response Acknowledged","Request is Pending",3e3))})},onClick_WorkflowTab:function(){m.model.postrequests.showWorkflow=!1,o.GetWorkflowInformation(t.requestid).then(function(e){l.requests.workflow=e,m.model.postrequests.showWorkflow=!0})},onClick_Confirmation:function(){m.model.requests.approvalComments="",i.alertConfirm("CONFIRM AND PROCEED","This request was not recommended by a reviewer. </br> </br> If you are sure you want to proceed with the request anyway, please click Yes. This will advance the request to the next-in-line reviewer or approver.  </br> </br> Otherwise, you can hit No, and then Cancel the Request or Resubmit (with edits).",function(){angular.element("#confirm-comment").modal("show")},angular.noop,"YES","NO",!0)},onClick_Confirm:function(){return o.ConfirmRequest().then(function(e){0===e?i.alertError("Error Confirm","Error confirming the request.","none"):(o.GetRequestDetails(t.requestid),i.alertSuccess("Confirmed","Request advanced to next-in-line Reviewer/Approver.",3e3))})},onClick_DeleteRFIDocument:function(t){m.model.newAttestDocuments=m.model.newAttestDocuments.filter(function(e){return angular.toJson(e)!==angular.toJson(t)})},onClick_DeleteRequestDocument:function(t){var e={Id:t.RequestDocumentId};i.alertConfirm("Confirm Deletion","Are you sure you want to delete "+t.ActualFileName+"?",function(){return c.DeleteDocument(e).then(function(e){null===e&&c.DeletePhysicalFile(t).then(function(e){i.alertSuccess("Success","Deleted "+t.ActualFileName+" successfully!"),m.model.requests.detail.RequestDocuments=m.model.requests.detail.RequestDocuments.filter(function(e){return angular.toJson(e)!==angular.toJson(t)})})})},angular.noop,"Yes","No",!0)},onClick_DeleteNewRequestDocument:function(t){var e={GeneratedFilename:t.NewFilename};i.alertConfirm("Confirm Deletion","Are you sure you want to delete "+t.ActualFilename+"?",function(){return c.DeleteDocumentByGeneratedFilename(e).then(function(e){null===e&&c.DeletePhysicalFile(t).then(function(e){i.alertSuccess("Success","Deleted "+t.ActualFilename+" successfully!"),m.model.newRequestDocuments=m.model.newRequestDocuments.filter(function(e){return angular.toJson(e)!==angular.toJson(t)})})})},angular.noop,"Yes","No",!0)},onClick_DeleteAttestDocument:function(t){m.model.newAttestDocuments=m.model.newAttestDocuments.filter(function(e){return angular.toJson(e)!==angular.toJson(t)}),o.checkAttestSuppliedDocument()},isCurrentApproverDocument:function(t){var n=!1;return l.requests.detail.RequestApprover.forEach(function(e){e.ApproverUserName.toLowerCase()===t.toLowerCase()&&(n=!0)}),n},onClick_OpenDocument:c.DownloadDocument,onInitialize_Lookup:function(e){0===l.requests.detail.RequestImplementation[0].RequestImplementationResponseId&&(l.requests.detail.RequestImplementation.LookupValue={},l.requests.detail.RequestImplementation.LookupValue[e]=null)},onRegisterComponent:S,exporttopdf:function(){var e=new jsPDF,t=$("#rdpdf").html();e.fromHTML(t,15,15,{width:180,elementHandlers:{}}),e.save("dataurlnewwindow.pdf")}},m.validation={validateImplementation:function(){var e=!1;m.model.requests.detail.RequestImplementation.Requires.COMMENTS&&(e=r.stringIsNullUndefinedOrEmpty(m.model.requests.detail.RequestImplementation.ImplementationComments));var t=!1,n=!r.isValidDateFormat(m.model.requests.detail.RequestImplementation.ImplementationDate,"yyyy-MMM-dd"),l=!1;m.model.requests.detail.RequestImplementation.Requires.TEXT&&(l=r.stringIsNullUndefinedOrEmpty(m.model.requests.detail.RequestImplementation.RequestImplementationText));m.model.requests.detail.RequestImplementation.Requires.LOOKUP&&(r.objectIsNullorUndefined(m.model.requests.detail.RequestImplementation.LookupValue)?t=!0:r.objectIsNullorUndefined(m.model.requests.detail.RequestImplementation.LookupValue[m.model.requests.detail.RequestImplementation.Requires.LOOKUP])&&(t=!0));return e||t||n||l}},m.components={newopportunityapprovalform:{modalname:"#newoppassignapprovermodal",componentelement:"new-opportunity-approval-form",listeners:[{"on-component-dispatch":{event:function(e){var t=e.detail.component.replaceAll("-","");m.components[t].events[e.detail.action](e.detail.response,t)}}}],events:{SUBMIT:function(e,t){e.StatusCode.includes("SUCCESS")?(R(e,t),v()):i.alertError("Error Upon Submission",'An error occured while processing your request. Please contact <a href="mailto:IAS-Admin@wsp.com" id="mailHelpDesk">IAS-Admin</a> to assist you. Thank you.',"none")},CLOSE:R}},postapprovalform:{componentelement:"post-approval-form",listeners:[{"on-pa-reload":{event:O}},{"on-pa-assign-to-others":{event:N,target:"post-approval-assign-to-others-form"}},{"on-pa-actions":{event:function(e){m.model.postrequests.component.actionType=e.detail.actionType,s.$apply(),N(e)},target:"post-approval-actions-form"}}]},postapprovalrfi:{componentelement:"post-approval-rfi",listeners:[{"on-pa-reload":{event:O}}]},postapprovalassigntoothersform:{modalname:"#assigntoothersmodal",componentelement:"post-approval-assign-to-others-form",listeners:[{"on-click-pa-close":{event:A}},{"on-pa-reload":{event:O}}]},postapprovalactionsform:{modalname:"#paactionconfmodal",componentelement:"post-approval-actions-form",listeners:[{"on-click-pa-actions-close":{event:A}},{"on-pa-reload":{event:O}}],requires:{actionType:"actionType",postRequestStepId:"postRequestStepId",postRequestId:"postRequestId"}}},f(),s.$on("$destroy",function(){m.model.ClearStore()})}angular.module("myApp").controller("RequestsDetailsController",e),e.$inject=["RequestsDetailsStore","RequestsDetailsBusiness","$stateParams","astigUtilityService","sweetDialogAlertService","$state","MainBusiness","MainStore","$scope","MainBusiness","DocumentService","$filter","UtilService"]}(),function(){"use strict";function e(t,o,e){this.GetRequestDetails=function(e){return t.Get(n+e,{}).then(function(e){return e.RequestSteps=function(e){var n=angular.copy(e),t=o.object_array_unique(n,"RequestStepId","RequestStepId"),l=(o.object_array_unique(n,"CostPointRoleId","CostPointRoleId"),[]);return t.forEach(function(t){var e=n.find(function(e){return t===e.RequestStepId});l.push({RequestStepId:e.RequestStepId,Sla:e.Sla,ExecutionOrder:e.ExecutionOrder,RequestStepStatus:e.RequestStepStatus,StepDistinction:e.StepDistinction,StepBehavior:e.StepBehavior,RecordStatus:e.RecordStatus,LastStatusChangeDate:e.LastStatusChangeDate,StepTableBasedSelection:null!==e.StepTableBasedSelection||void 0!==e.StepTableBasedSelection?JSON.parse(e.StepTableBasedSelection):null,StepName:e.StepName,StepType:e.StepType,Approvers:[],Attest:e.Attest,Comments:e.Comments,StepLevel:e.StepLevel,ConcurrentPosition:e.ConcurrentPosition,ConcurrentColor:e.ConcurrentColor})}),l.forEach(function(t){n.filter(function(e){return e.RequestStepId===t.RequestStepId}).forEach(function(e){t.Approvers.push({id:o.guid(),CostPointRoleId:e.CostPointRoleId,MainApproverUsername:e.MainApproverUsername,MainApproverDisplayName:e.MainApproverDisplayName,MainApproverEmail:e.MainApproverEmail,DelegatorUsername:e.DelegatorUsername,DelegatorDisplayName:e.DelegatorDisplayName,DelegatorEmail:e.DelegatorEmail})})}),l}(e.RequestSteps),e.RequestDocuments=e.RequestDocuments,null!==e.RequestDetail.Form&&(e.RequestDetail.Form=JSON.parse(e.RequestDetail.Form)),e.RequestForInformation=s(e.RequestForInformation,e.RequestForInformationDocument),e})},this.SubmitRequest=function(e){return t.Post(ApiRootDirectory.absoluteRootUrl+"api/Workflow/CreateRequest",e).then(function(e){return e})},this.SubmitStepApproval=function(e){return t.Post(ApiRootDirectory.absoluteRootUrl+"api/Workflow/SubmitStepApproval",e).then(function(e){return e})},this.SubmitAttestStepApproval=function(e){return t.Post(ApiRootDirectory.absoluteRootUrl+"api/Workflow/SubmitAttestStepApproval",e).then(function(e){return e})},this.CancelRequest=function(e){return t.Post(ApiRootDirectory.absoluteRootUrl+"api/Workflow/CancelRequest",e).then(function(e){return e})},this.RequestForInformation=function(e){return t.Post(ApiRootDirectory.absoluteRootUrl+"api/Workflow/RequestForInformation",e).then(function(e){return e})},this.ResponseRFI=function(e){return t.Post(ApiRootDirectory.absoluteRootUrl+"api/Workflow/ResponseRFI",e).then(function(e){return e})},this.Implement=function(e){return t.Post(ApiRootDirectory.absoluteRootUrl+"api/Requests/RequesttImplementation",e).then(function(e){return e})},this.Acknowledge=function(e){return t.Post(ApiRootDirectory.absoluteRootUrl+"api/Workflow/Acknowledge",e).then(function(e){return e})},this.GetWorkflowInformation=function(e){return t.Get(n+"WorkflowInformation/"+e,{}).then(function(e){return function(e,n,l){var o=[],r=[],i=[],a=[];return e.forEach(function(t){r=n.filter(function(e){return e.RequestStepId===t.RequestStepId}),i=l.filter(function(e){return e.RequestStepId===t.RequestStepId}),a=s(r,i),o.push({RequestStepId:t.RequestStepId,ExecutionOrder:t.ExecutionOrder,RequestStepStatus:t.RequestStepStatus,StepDistinction:t.StepDistinction,StepLevel:t.StepLevel,LastStatusChangeDate:t.LastStatusChangeDate,StepName:t.StepName,ActualApproverDisplayName:t.ActualApproverDisplayName,Comments:t.Comments,RFI:a,RequestStepRole:t.RequestStepRole,ViaEmailApprovalFlag:t.ViaEmailApprovalFlag,ConcurrentColor:t.ConcurrentColor})}),o}(e.RequestStepApproversReponses,e.RequestForInformation,e.RequestForInformationDocument)})},this.ConfirmRequest=function(e){return t.Post(ApiRootDirectory.absoluteRootUrl+"api/Workflow/ConfirmRequest",e).then(function(e){return e})},this.IfLastApprove=function(e){return t.Post(ApiRootDirectory.absoluteRootUrl+"api/Requests/IfLastApprove",e).then(function(e){return e})},this.GetRequestLookupFormInformation=function(e){return t.Get(ApiRootDirectory.absoluteRootUrl+"api/Requests/GetRequestLookupFormInformation/"+e,{}).then(function(e){return e})},this.SaveFinishLater=function(e){return t.Post(ApiRootDirectory.absoluteRootUrl+"api/Workflow/SaveFinishLater",e).then(function(e){return e})},this.GetSaveRequest=function(e){return t.Get(ApiRootDirectory.absoluteRootUrl+"api/requests/SaveRequests/"+e,{}).then(function(e){return e})},this.CancelSavedRequest=function(e){return t.Post(ApiRootDirectory.absoluteRootUrl+"api/Workflow/CancelSavedRequest",e).then(function(e){return e})},this.GetRequestAssignedTo=function(e){return t.Post(l,e).then(function(e){return e})},this.AssignRequestToOthers=function(e){return t.Post(n+"AssignRequestToOthers",e).then(function(e){return e})};var n=ApiRootDirectory.absoluteRootUrl+"api/requests/",l=ApiRootDirectory.absoluteRootUrl+"api/Generic/Data";function s(e,n){var l="",o="",r=[],i=[],a="",s="";return e.forEach(function(t){if(i=n.filter(function(e){return e.RequestForInformationResponseId===t.RequestForInformationResponseId}),l!==t.ResponseByUsername||o!==t.RequesteeUsername||"RESPONSE"===t.RequestForInformationRole)o=t.RequesteeUsername,l=t.ResponseByUsername,"REQUESTER"===t.RequestForInformationRole&&(s=t.RequesterDisplayName+" assigned to "+t.RequesteeDisplayName,a!==s?a=s:s=""),r.push({RequestStepId:t.RequestStepId,RequestForInformationId:t.RequestForInformationId,RequestForInformationResponseId:t.RequestForInformationResponseId,RequesterUsername:t.RequesterUsername,RequesterDisplayName:t.RequesterDisplayName,RequesterEmail:t.RequesterEmail,RequesteeUsername:t.RequesteeUsername,RequesteeDisplayName:t.RequesteeDisplayName,RequesteeEmail:t.RequesteeEmail,RequestForInformationRole:t.RequestForInformationRole,ResponseByUsername:t.ResponseByUsername,ResponseByDisplayName:t.ResponseByDisplayName,ResponseByEmail:t.ResponseByEmail,ActionDate:t.ActionDate,RequestForInformationStatus:t.RequestForInformationStatus,Response:[{Comments:t.Comments,Documents:i}],RequestAssignment:s});else{var e=r.length-1;r[0].RequestForInformationId=t.RequestForInformationId,r[0].RequestForInformationResponseId=t.RequestForInformationResponseId,r[0].RequestForInformationStatus=t.RequestForInformationStatus,r[e].Response.push({Comments:t.Comments,Documents:i})}}),r}}angular.module("myApp").service("RequestsDetailsService",e),e.$inject=["DataAccess","astigUtilityService","$base64"]}(),function(){"use strict";function e(){function e(){this.requests={detail:null,info:{OrganizationCode:null,Application:"AUTHORITYMATRIX"},userIsApprover:!1,userIsRequestor:!1,userIsImplementor:!1,attest:"",approvalComments:"",attestUpload:!1,workflow:null,stepTypeReview:!1,recommendationStatus:"",implementation:null},this.postrequests={detail:null,hasPostRequest:!1,showComponent:!1,showWorkflow:!1,component:{actionType:""}},this.documents=null,this.attestdocuments=null,this.newRequestDocuments=[],this.newAttestDocuments=[],this.attestDocumentSupplied=!1,this.rfiTo=null,this.rfiResponse=null,this.rfiDocuments=[],this.userCanReplyRFI=!1,this.userRFIRequester=!1,this.setUser=null,this.userIsSupervisorApproval=!1,this.userForConfirmation=!1,this.searchEmployee=null}return e.prototype.ClearStore=function(){this.requests={detail:null,userIsApprover:!1,userIsRequestor:!1,userIsImplementor:!1,attest:"",approvalComments:"",attestUpload:!1,edit:!1,workflow:null,stepTypeReview:!1,recommendationStatus:"",implementation:null},this.postrequests={detail:null,hasPostRequest:!1,showComponent:!1,showWorkflow:!1,component:{actionType:""}},this.documents=null,this.attestdocuments=null,this.newRequestDocuments=[],this.newAttestDocuments=[],this.attestDocumentSupplied=!1,this.rfiTo=null,this.rfiResponse=null,this.userCanReplyRFI=!1,this.userRFIRequester=!1,this.setUser=null,this.userIsSupervisorApproval=!1,this.userForConfirmation=!1,this.searchEmployee=null},new e}angular.module("myApp").factory("RequestsDetailsStore",e),e.$inject=[]}(),function(){"use strict";function e(n,l,e,o,r){this.GetRequests=function(){return l.GetRequests().then(function(e){var t=angular.copy(e);n.requests.list=e,n.requests.pendingRequestCount=t.filter(function(e){return"PENDING"==e.RequestStatus||"ON-HOLD"==e.RequestStatus||"NOT SUBMITTED"==e.RequestStatus}).length,n.pendingLoaded=!0})},this.GetPendingActionRequests=function(){return l.GetPendingActionRequests().then(function(e){var t=angular.copy(e);n.requests.pendingActionList=e,n.requests.pendingActionCount=t.filter(function(e){return 1===e.IsApproverFlag}).length,n.pendingActionLoaded=!0,n.filterPendingAction=!0,n.filterPending=!0})},this.GetSupervisorApprovalRequests=function(e){var t={ApproverUsername:e};return l.GetSupervisorApprovalRequests(t).then(function(e){n.requests.supervisorApprovalList=e})},this.ProcessRequest=function(e){var t={Id:e};return l.ProcessRequest(t)},this.ChangePageSize=function(e){n.currentPageSize=e},this.ChangeTab=function(e){if(2===(n.currentTab=e)&&"Y"===o.securityDetails.HasSubordinate&&"HIDDEN"!==o.securityDetails.SupervisorAccess&&o.securityDetails.SubordinateList.length<=0){var t={RoleId:-99999981,Parameters:{LOOKUP_VALUE:o.securityDetails.ViewAsUsername}};r.SearchApprover(t).then(function(e){o.securityDetails.SubordinateList=e})}},Object.preventExtensions(n)}angular.module("myApp").service("RequestsListBusiness",e),e.$inject=["RequestsListStore","RequestsListService","$filter","MainStore","LookupService"]}(),function(){"use strict";function e(e,t,n,l,o,r,i,a,s,u,c,d){var p=this;function m(e){d.go("am.requests.details",{requestid:e.detail.requestid})}p.model=e,p.mainModel=c,p.utilityService=n,p.events={onClick_Search:function(){p.model.search=""},onClick_SearchPendingAction:function(){p.model.searchPendingAction=""},formatDate:function(e,t){if(!e)return;-1===e.indexOf("Z")&&-1===e.indexOf("+")&&(e+="Z");return o("date")(e,t)},onClick_ProcessRequest:function(e){t.ProcessRequest(e.RequestId).then(function(){l.alertConfirm("Reprocess request","Request AID-"+e.RequestYear+("00000"+e.RequestDisplayId).slice(-5)+" is now reprocessed!",function(){t.GetRequests()},"","Ok","No",!1)})},onClick_Find:function(){var e=null;p.model.subordinateUsername=null,n.stringIsNullUndefinedOrEmpty(p.model.searchedSelectedSubordinate)?p.model.requests.supervisorApprovalList=[]:(e=p.model.searchedSelectedSubordinate.EMAIL,p.model.subordinateUsername=p.model.searchedSelectedSubordinate.EMAIL,p.model.currentsubordinateUsername=p.model.subordinateUsername,t.GetSupervisorApprovalRequests(e))},onChange_PageSize:function(e){t.ChangePageSize(e)},onSort_Field:function(e){p.model.sortPendingAction=!p.model.sortPendingAction,(p.model.sortPendingActionProperty=e).includes("Level")&&(e+="['EN']");p.model.requests.pendingActionList=i(p.model.requests.pendingActionList,e,p.model.sortPendingAction)},onSortRequests_Field:function(e){p.model.sortPendingAction=!p.model.sortPendingAction,(p.model.sortPendingActionProperty=e).includes("Level")&&(e+="['EN']");p.model.requests.list=i(p.model.requests.list,e,p.model.sortPendingAction)},onSortSupervisor_Field:function(e){p.model.sortPendingAction=!p.model.sortPendingAction,(p.model.sortPendingActionProperty=e).includes("Level")&&(e+="['EN']");p.model.requests.supervisorApprovalList=i(p.model.requests.supervisorApprovalList,e,p.model.sortPendingAction)},onClick_Tab:function(e){t.ChangeTab(e)},onHover:function(e){return 0<e.length?u.GetToolTip(e[0]):"No items to search"},initializeComponent:function(e){document.querySelector(e).addEventListener("on-click-request-id",m)}},u.GetDetails().then(function(){t.GetRequests(),t.GetPendingActionRequests().then(function(){var e=JSON.parse(a.get(s.prevState)).name;"am.approvalitems.details"===e||"am.approvalitems.viewsaveddetails"===e?t.ChangeTab(0):"am.requests.details"!==e&&"am.approvalitems.resubmit"!==e&&(0<p.model.requests.pendingActionCount?t.ChangeTab(1):t.ChangeTab(0))})}),r.$on("$destroy",function(){e.ClearStore()})}angular.module("myApp").controller("RequestsListController",e),e.$inject=["RequestsListStore","RequestsListBusiness","astigUtilityService","sweetDialogAlertService","$filter","$scope","orderByFilter","localStorageService","SessionName","MainBusiness","MainStore","$state"]}(),function(){"use strict";function e(t){this.GetRequests=function(){return t.Get(n).then(function(e){return e})},this.GetPendingActionRequests=function(){return t.Get(n+"PendingActions").then(function(e){return e})},this.GetSupervisorApprovalRequests=function(e){return t.Post(n+"SupervisorApproval",e).then(function(e){return e})},this.GetRequestTotalCount=function(){return t.Get(n+"TotalCount").then(function(e){return e})},this.ProcessRequest=function(e){return t.Post(ApiRootDirectory.absoluteRootUrl+"api/Workflow/ProcessRequest",e)};var n=ApiRootDirectory.absoluteRootUrl+"api/requests/"}angular.module("myApp").service("RequestsListService",e),e.$inject=["DataAccess"]}(),function(){"use strict";function e(e){function t(){this.requests={list:[],pendingRequestCount:0,pendingActionList:[],supervisorApprovalList:[],pendingActionCount:0},this.filterPending=!1,this.pendingLoaded=!1,this.filterPendingAction=!1,this.pendingActionLoaded=!1,this.filterForImplement=!1,this.filterSupervisorPendingAction=!0,this.sortPendingAction=!1,this.sortPendingActionProperty="",this.search="",this.searchPendingAction="",this.subordinateList=[],this.searchedSubordinate=null,this.searchedSelectedSubordinate=null,this.subordinateUsername=null,this.searchEmployee=null,this.requestsearchQuery=[{key:"StepType",value:["Submit","POST-APPROVAL (Step 1)","POST-APPROVAL (Step 2)","CONFIRM OR CANCEL","REQUEST FOR INFORMATION","APPROVAL","REVIEW"]}],this.currentsubordinateUsername="",this.pendingsearchQuery=[{key:"IsApproverFlag",value:[1]}],this.forImplementSearchQuery=[{key:"StepType",value:["POST-APPROVAL (Step 1)","POST-APPROVAL (Step 2)"],type:"reverse"}],this.pendingAndForImplementSearchQuery=[{key:"IsApproverFlag",value:[1]},{key:"StepType",value:["POST-APPROVAL (Step 1)","POST-APPROVAL (Step 2)"],type:"reverse"}],this.pageSizes=e,this.currentPageSize=10,this.currentTab=0}return t.prototype.ClearStore=function(){this.requests={list:[],pendingRequestCount:0,pendingActionList:[],supervisorApprovalList:[],pendingActionCount:0},this.filterPending=!1,this.filterPendingAction=!1,this.filterForImplement=!1,this.filterSupervisorPendingAction=!0,this.sortPendingAction=!1,this.sortPendingActionProperty="",this.search="",this.searchPendingAction="",this.subordinateList=[],this.searchedSubordinate=null,this.searchedSelectedSubordinate=null,this.subordinateUsername=null,this.searchEmployee=null,this.requestsearchQuery=[{key:"StepType",value:["Submit","POST-APPROVAL (Step 1)","POST-APPROVAL (Step 2)","CONFIRM OR CANCEL","REQUEST FOR INFORMATION","APPROVAL","REVIEW"]}],this.currentsubordinateUsername="",this.pendingsearchQuery=[{key:"IsApproverFlag",value:[1]}],this.forImplementSearchQuery=[{key:"StepType",value:["POST-APPROVAL (Step 1)","POST-APPROVAL (Step 2)"],type:"reverse"}],this.pendingAndForImplementSearchQuery=[{key:"IsApproverFlag",value:[1]},{key:"StepType",value:["POST-APPROVAL (Step 1)","POST-APPROVAL (Step 2)"],type:"reverse"}],this.pageSizes=e,this.currentPageSize=10},new t}angular.module("myApp").factory("RequestsListStore",e),e.$inject=["PageSizes"]}(),function(){"use strict";angular.module("myApp").config(["$stateProvider","$urlRouterProvider",function(e,t){e.state({name:"am.requests.list",url:"list",controller:"RequestsListController as vm",templateUrl:"app/views/requests/list/index.html",data:{pageName:"Requests",breadcrumbList:[{name:"Requests",className:"",route:""}]}}).state({name:"am.requests.details",url:"details/{requestid}",controller:"RequestsDetailsController as vm",templateUrl:"app/views/requests/details/index.html",data:{pageName:"Requests",breadcrumbList:[{name:"Requests",className:"",route:""},{name:"Details",className:"",route:""}]}}).state({name:"am.requests.supervisor",url:"details/{requestid}/{user}",controller:"RequestsDetailsController as vm",templateUrl:"app/views/requests/details/index.html",data:{pageName:"Requests",breadcrumbList:[{name:"Requests",className:"",route:""},{name:"Details",className:"",route:""}]}})}])}(),function(){"use strict";function e(){var e=this;e.clientModel={},e.opportunitymodel={},e.employeemodel={},e.employeedivspecmodel={},e.projoppmodel={},e.parentprojmodel={},e.dirprojmodel={},e.orgmodel={},e.inactiveorgmodel={},e.mastercontractmodel={},e.inactiveprojmodel={},e.bankaccountmodel={},e.cashaccountmodel={}}angular.module("myApp").controller("TestController",e),e.$inject=[]}(),function(){"use strict";function e(t){this.me=function(e){return t.defaults.headers.common.Authorization="Bearer "+e,t.get("https://graph.microsoft.com/v1.0/me",{headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.token}}).then(function(e){return e.data},function(e){return e})},this.login=function(){return $("#overlayloader").show(),clientApplication.loginPopup(e).then(function(e){return l()},function(e){return $("#overlayloader").hide(),!1})},this.logout=function(){clientApplication.logout(),delete localStorage.token,delete localStorage.user,delete localStorage.existingUser},this.test=function(){return DataAccess.Get(servicePath+"Get",{cache:!1}).then(function(e){return e})},this.authenticate=l,clientApplication=createApplication(msalConfig);var e={scopes:["user.read","mail.send"]},n={scopes:["user.read","mail.send"]};function l(){return $("#overlayloader").show(),clientApplication.acquireTokenSilent(n).then(function(e){return localStorage.token=e.accessToken,$("#overlayloader").hide(),!0},function(e){return clientApplication.acquireTokenPopup(n).then(function(e){return localStorage.token=e.accessToken,$("#overlayloader").hide(),!0},function(e){return $("#overlayloader").hide(),!1})})}}angular.module("myApp").service("AuthenticationService",e),e.$inject=["$http"]}(),function(){"use strict";function e(e,t,n){this.GetList=function(){return n(function(){return t.countries_state_cities()},1)}}angular.module("myApp").service("CountryStateCityService",e),e.$inject=["DataAccess","astigUtilityService","$timeout"]}(),function(){"use strict";function e(t,n,l,e,r){this.UploadFileTemp=function(e){return t.Post(i+"UploadFileTemp",e).then(function(e){return e})},this.UploadFileFinal=function(e){return t.Post(i+"UploadFileFinal",e).then(function(e){return e})},this.ValidateFile=function(e){if(e.filesize>l.MaxSize)return"Total MB of Files was too large.";var t=e.filename.substring(e.filename.lastIndexOf(".")+1).toLowerCase();return n.isInArray(t,l.ValidFileExtensions)?null:"Only files with the following extensions are allowed: .doc,.docx,.xlsx,.xls,.xlsm,.msg,.zip,image/*,.pdf,.ppt,.pptx,.csv"},this.DeleteDocument=function(e){return t.Post(i+"DeleteDocument",e).then(function(e){return e})},this.DeleteDocumentByGeneratedFilename=function(e){return t.Post(i+"DeleteDocumentFilename",e).then(function(e){return e})},this.DownloadDocument=function(e,o){return t.Get(i+"RequestDocumentAccess?documentId="+e,{cache:!1}).then(function(e){if(null!=e&&0!=JSON.parse(r.decode(decodeURIComponent(e))).parameters.documentId){var t=i+"OpenFile?u="+e,n=document.createElement("a"),l=document.createTextNode("my title text");n.appendChild(l),n.title="my title text",n.href=t,"email"!=o&&(n.target="_self"),document.body.appendChild(n),setTimeout(function(){n.click(),document.body.removeChild(n)},0)}return e})},this.DeletePhysicalFile=function(e){return t.Post(i+"DeletePhysicalFile",e).then(function(e){return e})};var i=ApiRootDirectory.absoluteRootUrl+"api/RequestDocument/"}angular.module("myApp").service("DocumentService",e),e.$inject=["DataAccess","astigUtilityService","DocumentValidation","UtilService","$base64"]}(),function(){"use strict";function e(n){this.GetData=function(e){return n.Post(l+"/GetData",e).then(function(e){return t(e)})},this.Get=function(e){var t=l+"?"+new URLSearchParams(e).toString();return n.Get(t).then(function(e){return e.map(function(e){return function(e){if(0<e.length){var n=[];return e.forEach(function(e){var t={};e.Value.forEach(function(e){t[e.Key]=e.Value}),n.push(t)}),n}return[]}(e)})})},this.GetDataNoLoading=function(e){return n.Post(l+"/GetData?noLoading",e).then(function(e){return t(e)})},this.SubmitTransaction=function(e){return n.Post(l+"/SubmitTransaction",e).then(function(e){return t(e)})};var l=ApiRootDirectory.absoluteRootUrl+"api/Data";function t(e){if(e){var n=[];return null!==e&&e.forEach(function(e){var t={};e.Value.forEach(function(e){t[e.Key]=e.Value}),n.push(t)}),n}return[]}}angular.module("myApp").service("GenericDataService",e),e.$inject=["DataAccess"]}(),function(){"use strict";function e(l){this.Search=function(e){return l.Post(o+"SearchLookupByRole",e).then(function(e){return n(e)})},this.SearchEmployee=function(e,t){return l.Get(o+"SearchEmployee/"+function(e){"."!=e.trim().substring(e.length-1)&&","!=e.trim().substring(e.length-1)||(e=angular.copy(e.trim().substring(0,e.trim().length-1)));return e}(e)+"/"+t,{cache:!0}).then(function(e){return e})},this.GetCostPointRoleList=function(){return l.Get(o+"GetCostPointRoleList",{cache:!0}).then(function(e){return e})},this.GetOrganizationLookup=function(){return l.Get(o+"GetOrganization",{cache:!1}).then(function(e){return e})},this.GetApprovalItemsPerRoleDivision=function(e,t,n){return l.Get(o+"GetApprovalItemsPerRoleDivision/"+e+"/"+t+"/"+n).then(function(e){return e})},this.GetUserRoleList=function(){return l.Get(o+"GetUserRoleList/",{cache:!1}).then(function(e){return e})},this.GetBankAccounts=function(e){return l.Get(o+"GetBankAccounts/"+e,{cache:!0}).then(function(e){return e})},this.GetCashAccounts=function(e){return l.Get(o+"GetCashAccounts/"+e,{cache:!0}).then(function(e){return e})},this.SearchApprover=function(e){return l.Post(o+"SearchApprover",e).then(function(e){return e})},this.GetGenericData=function(e){return l.Post(t,e).then(function(e){return n(e)})};var t=ApiRootDirectory.absoluteRootUrl+"api/Generic/Data",o=ApiRootDirectory.absoluteRootUrl+"api/Lookup/";function n(e){var n=[];return null!==e&&e.forEach(function(e){var t={};e.Value.forEach(function(e){t[e.Key]=e.Value}),n.push(t)}),n}}angular.module("myApp").service("LookupService",e),e.$inject=["DataAccess"]}(),function(){"use strict";function e(t,e){this.GetDetails=function(){return t.Get(n+"GetDetails").then(function(e){return e.GroupAccess=function(e){var t=[];e&&e.forEach(function(e){t.push(e.GroupAccess)});return t}(e.GroupAccess),e})},this.GetOrganizationSupervisorSettingValue=function(e){return t.Get(n+"GetOrganizationSupervisorSettingValue?orgCode="+e).then(function(e){return e})};var n=ApiRootDirectory.absoluteRootUrl+"api/Security/"}angular.module("myApp").service("SecurityService",e),e.$inject=["DataAccess","$log"]}(),function(){"use strict";angular.module("myApp").constant("agreementSeachTypeAheadPropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME"}).directive("agreementSearchTypeAhead",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asPlaceholder:"@",smallButton:"@?",clearSwitch:"=?",forReport:"@?",prop:"@?"},controller:["$scope","LookupService","LookupRoleIds","agreementSeachTypeAheadPropertyNames",function(t,l,o,r){function e(){null!==t.ngModel&&void 0!==t.ngModel&&t.ngModel.hasOwnProperty(r.Id)&&n({value:angular.copy(t.ngModel)})}function n(e){t.model.input=e.value.OBJECT_ID+" - "+e.value.OBJECT_NAME,t.ngModel=e.value}function i(){t.model.input="",t.model.selected=null,t.ngModel=null}t.model={input:""},t.search=function(e,t){var n={RoleId:o.agreementRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e,function(e){return{label:e[r.Id]+" - "+e[r.Name],value:e}}))})},t.autocompleteOnSelect=n,t.clearData=i,e(),t.$watch("ngModel",function(){null===t.ngModel&&i(),"Y"===t.clearSwitch&&(e(),t.clearSwitch="N")})}],templateUrl:"app/views/templates/directive-templates/generic-autocomplete.html"}})}(),function(){"use strict";function e(){return{restrict:"E",scope:{formObject:"=",details:"=?",formType:"@",searchFilters:"=?",organization:"@?",formValidation:"=?",oppName:"=?",isValid:"=?",lookupValue:"=?"},template:'<div ng-include="events.getTemplate();" class="row"></div>',controller:["$scope","FormTypes","Regex",function(e,t,n){e.model={dateRegex:n.datePattern,messageTitle:'<div align="left"><span>If you need to make changes to any imported data in this form:</span><ol type="1"><li>click Show Requested Edits to CRM Data</li><li>make edits where necessary</li><li>click Save & Finish Later, and then</li><li>click Assign to Others to engage your Marketing Representative or CRM Data Coordinator.</li></ol></div>'},e.formValidation={form:{}},e.events={getTemplate:function(){return e.formType===t.RequestDetails?"app/views/templates/directive-templates/approvalitem-form/requestdetails.html":e.formType===t.CreateRequest?"app/views/templates/directive-templates/approvalitem-form/createrequest.html":e.formType===t.Preview?"app/views/templates/directive-templates/approvalitem-form/preview.html":e.formType===t.Bergerwin?"app/views/templates/directive-templates/approvalitem-form/bergerwintemplate.html":""},isOptionControlRequired:function(e,t){var n=!1;if(t){for(var l=0;l<e.length;l++)if(e[l].IsChecked){n=!0;break}return!n}return!1},getBankAndCashAccountProjectId:function(e){if(void 0!==e)if(angular.isDefined(e.PARENTPROJECTTEMPLATE)){if(null!==e.PARENTPROJECTTEMPLATE)return e.PARENTPROJECTTEMPLATE.PROJ_ID}else if(angular.isDefined(e.DIRPROJECTTEMPLATE)&&null!==e.DIRPROJECTTEMPLATE)return e.DIRPROJECTTEMPLATE.PROJ_ID;return null},onLoad_PopOver:function(e){angular.element(e).popover("show")}}}]}}angular.module("myApp").directive("approvalitemForm",e),e.$inject=[]}(),function(){"use strict";angular.module("mmComponentsAutocomplete",[])}(),function(){"use strict";function e(e,t,n){return{restrict:"A",require:"ngModel",scope:{ngModel:"=",secondParameter:"=?",clicked:"=?",source:"=",onSelect:"=",onFocus:"=",onChange:"=",minLength:"="},controller:["$scope",function(e){}],link:function(n,e,t){e.autocomplete({source:n.source,minLength:n.minLength||3,select:function(e,t){n.clicked=!0,e.preventDefault(),n.ngModel=t.item.label,angular.isDefined(n.onSelect)&&angular.isFunction(n.onSelect)&&n.onSelect(t.item,n.secondParameter),n.$apply()},change:function(e,t){e.preventDefault(),angular.isDefined(n.onFocus)&&angular.isFunction(n.onFocus)&&n.onFocus(t.item,n.secondParameter)}}).data("ui-autocomplete")._renderItem=function(e,t){return t.value.hasOwnProperty("ISACTIVE")&&"N"==t.value.ISACTIVE?$('<li class="ui-state-disabled" disabled="disabled"><a style="pointer-events: none;"><i class="grayed-out">'+t.label+"</i></a></li>").appendTo(e):$("<li>").append("<a>"+t.label+"</a>").appendTo(e)},$(document).on("mousedown",function(){n.clicked||(n.ngModel=null,n.$apply())})}}}angular.module("mmComponentsAutocomplete").directive("mmAutocomplete",e),e.$inject=["$http","$interpolate","$parse"]}(),function(){"use strict";angular.module("myApp").constant("clientTypeAheadPropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME",Display:"OBJECT_DISPLAY"}).directive("clientSearchTypeAhead",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asPlaceholder:"@",smallButton:"@?",clearSwitch:"=?",forReport:"@?",prop:"@?"},controller:["$scope","LookupService","clientTypeAheadPropertyNames","LookupRoleIds",function(t,l,o,r){function e(){null!==t.ngModel&&void 0!==t.ngModel&&t.ngModel.hasOwnProperty(o.Id)&&n({value:angular.copy(t.ngModel)})}function n(e){t.ngModel=e.value,t.model.input=e.value.OWNER_NAME}function i(){t.model.input="",t.ngModel=null}t.model={input:""},t.search=function(e,t){var n={RoleId:r.clientActiveCrmRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e,function(e){return{label:e[o.Id]+" - "+e[o.Name],value:e}}))})},t.autocompleteOnSelect=n,t.clearData=i,e(),t.$watch("ngModel",function(){null===t.ngModel&&i(),"Y"===t.clearSwitch&&(e(),t.clearSwitch="N")})}],templateUrl:"app/views/templates/directive-templates/generic-autocomplete.html"}})}(),function(){"use strict";angular.module("myApp").constant("costCenterTypeAheadPropertyNames",{Id:"COST_CENTER_ID",Name:"COST_CENTER_NAME"}).directive("costCenterSearchTypeAhead",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asPlaceholder:"@",smallButton:"@?",clearSwitch:"=?"},controller:["$scope","LookupService","costCenterTypeAheadPropertyNames","LookupRoleIds",function(t,l,o,r){function e(){null!==t.ngModel&&void 0!==t.ngModel&&t.ngModel.hasOwnProperty(o.Id)&&n({value:angular.copy(t.ngModel)})}function n(e){t.ngModel=e.value,t.model.input=e.value[o.Name]}function i(){t.model.input="",t.ngModel=null}t.model={input:""},t.search=function(e,t){var n={RoleId:r.orgRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e,function(e){return{label:e[o.Id]+" - "+e[o.Name],value:e}}))})},t.autocompleteOnSelect=n,t.clearData=i,e(),t.$watch("ngModel",function(){null===t.ngModel&&i(),"Y"===t.clearSwitch&&(e(),t.clearSwitch="N")})}],templateUrl:"app/views/templates/directive-templates/generic-autocomplete.html"}})}(),function(){"use strict";angular.module("myApp").directive("gNgFormControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",details:"=",asForm:"=",formValidation:"=?",formType:"=?",isValid:"=?"},template:'<div ng-include="events.getTemplate();"></div>',controller:["$scope","FormOptions","FormAutoPopulatedPropertyNames","FormTwoWayBindPropertyNames","LookupService","LookupRoleIds","sweetDialogAlertService","astigUtilityService","FormMessages","CountryStateCityService","FormNewRecordPropertyNames","$filter","GngFormBusiness","ProjectSetupFormBusiness","localStorageService",function(s,e,u,c,t,n,a,d,l,o,p,r,i,m,f){var g=d.guid();s.model={prop:c,autoProp:u,newProp:p,messages:l,minDate:(new Date).toDateString(),clearSwitch:{projectManager:"N",pa:"N",pursuit:"N",client:"N",masterContract:"N",owner:"N",teaming:"N",competitors:"N"},isRCRInWorkflow:!1,errorSwitchDeliveryMethod:!1,errorSwitchClient:!1,errorSwitchOwner:!1,errorSwitchBusinessLine:!1,errorSwitchBusinessLineDivision:!1,showOriginalValues:!0,showEditValues:!1,switchForm:!0,isPublicThresholds:!1,totalLabor:{ps:null,qu:null,tp:null,cp:null,intvw:null,cn:null},totalCost:{ps:null,qu:null,tp:null,cp:null,intvw:null,cn:null},grandTotalCost:null,checkBoxes:{checkAll:!1,ps:!1,qu:!1,tp:!1,cp:!1,intvw:!1,cn:!1},object:{client:null,ultimateClient:null,division:null,district:null,area:null,costCenter:null,projectManager:null,pursuitManager:null,proposalManager:null,pic:null,pa:null,segment:null,marketArea:null,marketSector:null,primaryServiceType:null,serviceType:null,marketingCoordinator:null,masterContractAgreement:null},list:{complexity:e.Complexity,financialTerms:e.FinancialTerms,marketArea:[],marketSector:[],primaryServiceType:e.PrimaryServiceType,opportunityStatus:e.OpportunityStatus,opportunityStatusNew:e.OpportunityStatusNew,priority:e.Priority,rate:e.Rate,segment:[],serviceType:[],coreServiceType:[],yesNo:e.YesNo,yesNoNotApplicable:e.YesNoNotApplicable,yesNoUnknown:e.YesNoUnknown,ourRole:e.OurRole,taskOrder:e.TaskOrder,contractClassification:e.ContractClassification,otherStaff:[],teamingPartners:[],competitors:[],collaboration:e.Collaboration,collaborationSelected:[],division:[],district:[],area:[],deliveryMethod:[],costCenter:[],country:null,state:null,city:null,clientOwnerType:e.ClientOwnerType,none:e.None,packageType:e.PackageType,percent:e.Percent,ownerType:[],clientType:[],nblMarkets:[],nblMarketSelected:[{value:null,id:g}],nblMarketLead:[{value:null,email:null,id:g}]},selected:{},wizardselection:{}},s.switchOn=!0,s.switchSelected=!0,s.switchObject=!0,s.switchOtherStaffList=!0,s.switchTeamingPartnersList=!0,s.switchCompetitorsList=!0,s.switchcollaborationList=!0,s.switchCheckboxes=!0;var v=null,I=null;function E(){if(null!==s.ngModel&&void 0!==s.ngModel){var e={value:angular.copy(JSON.parse(s.ngModel))};"lead"===s.formType&&s.asForm&&(s.isValid.oppName=angular.copy(JSON.parse(s.ngModel).OPPORTUNITY_NAME_NEW)),s.model.switchForm=!1,s.switchOn=!1,D(),P(),h().then(function(){b().then(function(){A().then(function(){s.asForm?(s.model.isPublicThresholds=!(void 0===s.details.ApprovalItemDetail.find(function(e){return e.ApprovalItemName.EN.includes("<$1M")})&&void 0===s.details.ApprovalItemDetail.find(function(e){return e.ApprovalItemName.EN.includes("<$200K")})&&void 0===s.details.ApprovalItemDetail.find(function(e){return e.ApprovalItemName.EN.includes("<$100K")})&&void 0===s.details.ApprovalItemDetail.find(function(e){return e.ApprovalItemName.EN.includes("<$500K")})||void 0===s.details.ApprovalItemDetail.find(function(e){return"Direct Client = Federal"===e.ApprovalItemName.EN})&&void 0===s.details.ApprovalItemDetail.find(function(e){return"Owner = Federal"===e.ApprovalItemName.EN})),"lead"===s.formType?s.ngModel=i.FillUpRequestNewFields(s.model,p,e):N().then(function(){s.ngModel=i.FillUpTwoWayBindFields(s.model,c,e,s.asForm),_()})):(s.model.isPublicThresholds=!(void 0===s.details.RequestApprovalItems.find(function(e){return e.ApprovalItemName.EN.includes("<$1M")})&&void 0===s.details.RequestApprovalItems.find(function(e){return e.ApprovalItemName.EN.includes("<$200K")})&&void 0===s.details.RequestApprovalItems.find(function(e){return e.ApprovalItemName.EN.includes("<$100K")})&&void 0===s.details.RequestApprovalItems.find(function(e){return e.ApprovalItemName.EN.includes("<$500K")})||void 0===s.details.RequestApprovalItems.find(function(e){return"Direct Client = Federal"===e.ApprovalItemName.EN})&&void 0===s.details.RequestApprovalItems.find(function(e){return"Owner = Federal"===e.ApprovalItemName.EN})),"lead"===s.formType?s.ngModel=i.FillUpRequestNewFields(s.model,p,e):(s.model.showEditValues=!1,s.ngModel=i.FillUpAutoPopulatedFields(s.model,e,u,s.asForm,s.isValid,s.details),s.ngModel=i.FillUpTwoWayBindFields(s.model,c,e,s.asForm)),_())})})})}else s.model.isPublicThresholds=!(void 0===s.details.ApprovalItemDetail.find(function(e){return e.ApprovalItemName.EN.includes("<$1M")})&&void 0===s.details.ApprovalItemDetail.find(function(e){return e.ApprovalItemName.EN.includes("<$200K")})&&void 0===s.details.ApprovalItemDetail.find(function(e){return e.ApprovalItemName.EN.includes("<$100K")})&&void 0===s.details.ApprovalItemDetail.find(function(e){return e.ApprovalItemName.EN.includes("<$500K")})||void 0===s.details.ApprovalItemDetail.find(function(e){return"Direct Client = Federal"===e.ApprovalItemName.EN})&&void 0===s.details.ApprovalItemDetail.find(function(e){return"Owner = Federal"===e.ApprovalItemName.EN})),D(),P(),h(),b(),A(),_()}function S(){var e=f.get("GnGForm");if(!d.objectIsNullorUndefined(e)&&!d.objectIsNullorUndefined(s.ngModel)){var t=JSON.parse(e),n=JSON.parse(s.ngModel);if(t.OPPORTUNITY_NUMBER===n.OPPORTUNITY_NUMBER)return!0}return!1}function N(){if(null!==s.ngModel){var e={RoleId:n.gNgFormRoleId,Parameters:{LOOKUP_VALUE:angular.copy(JSON.parse(s.ngModel)[u.OpportunityNumber])}};return t.Search(e).then(function(e){if(void 0!==e[0]){var t={value:angular.copy(e[0])};JSON.parse(s.ngModel)[u.OpportunityNumber]!==s.model.selected[u.OpportunityNumber]&&T(),i.GetNblml(t.value[u.CostCenterId]).then(function(e){s.model.list.nblMarkets=angular.copy(e),s.ngModel=i.FillUpAutoPopulatedFields(s.model,t,u,s.asForm,s.isValid,s.details),_()})}})}}function A(){return i.GetCountryStateCity().then(function(e){s.model.list.country=e,"lead"===s.formType&&(s.model.list.state=e.find(function(e){return"USA"===e.iso3}),s.model.list.state.states=s.model.list.state.states.filter(function(e){return"NATIONWIDE"!==e.name}),s.model.list.state.states.push({id:0,name:"NATIONWIDE",state_code:"N/A",cities:[]}),s.model.selected[p.Country]=s.model.list.state.name)})}function y(){"TASK PIPELINE"===s.model.selected[p.OpportunityStatus]?i.ClearEcvValuesTaskPipeLine(s.model,p,!1,!0):i.ClearEcvValuesNotTaskPipeLine(s.model,p,!1,!0)}function R(){s.model.selected[p.IsBudgetFilledUp]="NO",d.stringIsNullUndefinedOrEmpty(s.model.selected[p.PreSubmittalExpense])&&d.stringIsNullUndefinedOrEmpty(s.model.selected[p.QualificationsExpense])&&d.stringIsNullUndefinedOrEmpty(s.model.selected[p.TechProposalExpense])&&d.stringIsNullUndefinedOrEmpty(s.model.selected[p.CostProposalExpense])&&d.stringIsNullUndefinedOrEmpty(s.model.selected[p.InterviewExpense])&&d.stringIsNullUndefinedOrEmpty(s.model.selected[p.ContractNegotiationsExpense])&&d.stringIsNullUndefinedOrEmpty(s.model.selected[p.PreSubmittalLaborHours])&&d.stringIsNullUndefinedOrEmpty(s.model.selected[p.QualificationsLaborHours])&&d.stringIsNullUndefinedOrEmpty(s.model.selected[p.TechProposalLaborHours])&&d.stringIsNullUndefinedOrEmpty(s.model.selected[p.CostProposalLaborHours])&&d.stringIsNullUndefinedOrEmpty(s.model.selected[p.InterviewLaborHours])&&d.stringIsNullUndefinedOrEmpty(s.model.selected[p.ContractNegotiationsLaborHours])||(s.model.selected[p.IsBudgetFilledUp]="YES")}function O(){return d.stringIsNullUndefinedOrEmpty(s.model.selected[c.OpportunityStatus])?"LEAD"===s.model.selected[u.OpportunityStatus]:"LEAD"===s.model.selected[c.OpportunityStatus]}function C(e,t){void 0!==s.formValidation&&s.formValidation.form.hasOwnProperty(t)&&(s.formValidation.form[t].$invalid=e)}function T(){s.model.selected={},s.model.object.pursuitCostCenterLead=null,s.model.object.proposalTechnicalLead=null,s.model.list.supportingCC=[],s.model.list.otherStaff=[],s.model.list.teamingPartners=[],s.model.list.competitors=[],s.model.object.client=null,s.model.object.division=null,s.model.object.district=null,s.model.object.area=null,s.model.object.costCenter=null,s.model.object.projectManager=null,s.model.object.pursuitManager=null,s.model.object.pa=null,s.model.object.marketingCoordinator=null,s.model.errorSwitchDeliveryMethod=!1,s.model.errorSwitchClient=!1,s.model.errorSwitchOwner=!1,s.model.errorSwitchBusinessLine=!1,s.model.errorSwitchBusinessLineDivision=!1,s.model.showEditValues=!1,s.model.showOriginalValues=!0,s.model.checkBoxes.ps=null,s.model.checkBoxes.qu=null,s.model.checkBoxes.tp=null,s.model.checkBoxes.cp=null,s.model.checkBoxes.intvw=null,s.model.checkBoxes.cn=null,s.model.list.nblMarkets=[],s.model.list.nblMarketSelected=[{value:null,id:g}],s.model.list.nblMarketLead=[{value:null,email:null,id:g}],function(){for(var e=0;e<s.model.list.collaboration.length;e++)s.model.list.collaboration[e].isChecked=!1}()}function h(){return i.GetAllOracleHierarchyList().then(function(e){void 0!==e&&(s.model.list.division=angular.copy(e))})}function b(){return i.GetDeliveryMethodList().then(function(e){void 0!==e&&e.forEach(function(e){s.model.list.deliveryMethod.push(e.DELIVERY_METHOD)})})}function D(){return i.GetSegmentAreaSectorList().then(function(e){void 0!==e&&(s.model.list.segment=angular.copy(e))})}function P(){return i.GetSegmentServiceTypeList().then(function(e){void 0!==e&&(s.model.list.coreServiceType=angular.copy(e))})}function L(e,t,n,l,o,r,i){var a=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});d.stringIsNullUndefinedOrEmpty(e.selected[t])?(e.totalLabor[n]=null,e.selected[l]=null):(e.totalLabor[n]=70*parseFloat(e.selected[t]),e.selected[l]=a.format(e.totalLabor[n])),M(e,o,n,r,i),function(e){d.stringIsNullUndefinedOrEmpty(e.selected[p.PreSubmittalLaborHours])&&d.stringIsNullUndefinedOrEmpty(e.selected[p.QualificationsLaborHours])&&d.stringIsNullUndefinedOrEmpty(e.selected[p.TechProposalLaborHours])&&d.stringIsNullUndefinedOrEmpty(e.selected[p.CostProposalLaborHours])&&d.stringIsNullUndefinedOrEmpty(e.selected[p.InterviewLaborHours])&&d.stringIsNullUndefinedOrEmpty(e.selected[p.ContractNegotiationsLaborHours])?e.selected[p.PusuitBudgetTotalLaborHours]=null:e.selected[p.PusuitBudgetTotalLaborHours]=(d.stringIsNullUndefinedOrEmpty(e.selected[p.PreSubmittalLaborHours])?0:parseFloat(e.selected[p.PreSubmittalLaborHours]))+(d.stringIsNullUndefinedOrEmpty(e.selected[p.QualificationsLaborHours])?0:parseFloat(e.selected[p.QualificationsLaborHours]))+(d.stringIsNullUndefinedOrEmpty(e.selected[p.TechProposalLaborHours])?0:parseFloat(e.selected[p.TechProposalLaborHours]))+(d.stringIsNullUndefinedOrEmpty(e.selected[p.CostProposalLaborHours])?0:parseFloat(e.selected[p.CostProposalLaborHours]))+(d.stringIsNullUndefinedOrEmpty(e.selected[p.InterviewLaborHours])?0:parseFloat(e.selected[p.InterviewLaborHours]))+(d.stringIsNullUndefinedOrEmpty(e.selected[p.ContractNegotiationsLaborHours])?0:parseFloat(e.selected[p.ContractNegotiationsLaborHours]));s.ngModel=JSON.stringify(s.model.selected)}(e),function(e){var t=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});d.stringIsNullUndefinedOrEmpty(e.totalLabor.ps)&&d.stringIsNullUndefinedOrEmpty(e.totalLabor.qu)&&d.stringIsNullUndefinedOrEmpty(e.totalLabor.tp)&&d.stringIsNullUndefinedOrEmpty(e.totalLabor.cp)&&d.stringIsNullUndefinedOrEmpty(e.totalLabor.intvw)&&d.stringIsNullUndefinedOrEmpty(e.totalLabor.cn)?e.selected[p.PusuitBudgetTotalLaborDollar]=null:(e.selected[p.PusuitBudgetTotalLaborDollar]=(d.stringIsNullUndefinedOrEmpty(e.totalLabor.ps)?0:parseFloat(e.totalLabor.ps))+(d.stringIsNullUndefinedOrEmpty(e.totalLabor.qu)?0:parseFloat(e.totalLabor.qu))+(d.stringIsNullUndefinedOrEmpty(e.totalLabor.tp)?0:parseFloat(e.totalLabor.tp))+(d.stringIsNullUndefinedOrEmpty(e.totalLabor.cn)?0:parseFloat(e.totalLabor.cn))+(d.stringIsNullUndefinedOrEmpty(e.totalLabor.cp)?0:parseFloat(e.totalLabor.cp))+(d.stringIsNullUndefinedOrEmpty(e.totalLabor.intvw)?0:parseFloat(e.totalLabor.intvw)),e.selected[p.PusuitBudgetTotalLaborDollar]=t.format(e.selected[p.PusuitBudgetTotalLaborDollar]));s.ngModel=JSON.stringify(s.model.selected)}(e),R(),s.ngModel=JSON.stringify(s.model.selected)}function M(e,t,n,l,o){var r=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});d.stringIsNullUndefinedOrEmpty(e.selected[t])&&d.stringIsNullUndefinedOrEmpty(e.totalLabor[n])?(e.selected[l]=null,e.totalCost[n]=null):(e.totalCost[n]=(d.stringIsNullUndefinedOrEmpty(e.selected[t])?0:parseFloat(e.selected[t]))+(d.stringIsNullUndefinedOrEmpty(e.totalLabor[n])?0:parseFloat(e.totalLabor[n])),e.selected[l]=r.format(e.totalCost[n])),function(e){var t=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});d.stringIsNullUndefinedOrEmpty(e.selected[p.PreSubmittalExpense])&&d.stringIsNullUndefinedOrEmpty(e.selected[p.QualificationsExpense])&&d.stringIsNullUndefinedOrEmpty(e.selected[p.TechProposalExpense])&&d.stringIsNullUndefinedOrEmpty(e.selected[p.CostProposalExpense])&&d.stringIsNullUndefinedOrEmpty(e.selected[p.InterviewExpense])&&d.stringIsNullUndefinedOrEmpty(e.selected[p.ContractNegotiationsExpense])?e.selected[p.PusuitBudgetTotalExpense]=null:(e.selected[p.PusuitBudgetTotalExpense]=(d.stringIsNullUndefinedOrEmpty(e.selected[p.PreSubmittalExpense])?0:parseFloat(e.selected[p.PreSubmittalExpense]))+(d.stringIsNullUndefinedOrEmpty(e.selected[p.QualificationsExpense])?0:parseFloat(e.selected[p.QualificationsExpense]))+(d.stringIsNullUndefinedOrEmpty(e.selected[p.TechProposalExpense])?0:parseFloat(e.selected[p.TechProposalExpense]))+(d.stringIsNullUndefinedOrEmpty(e.selected[p.CostProposalExpense])?0:parseFloat(e.selected[p.CostProposalExpense]))+(d.stringIsNullUndefinedOrEmpty(e.selected[p.InterviewExpense])?0:parseFloat(e.selected[p.InterviewExpense]))+(d.stringIsNullUndefinedOrEmpty(e.selected[p.ContractNegotiationsExpense])?0:parseFloat(e.selected[p.ContractNegotiationsExpense])),e.selected[p.PusuitBudgetTotalExpense]=t.format(e.selected[p.PusuitBudgetTotalExpense]));s.ngModel=JSON.stringify(s.model.selected)}(e),function(e){var t=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});d.stringIsNullUndefinedOrEmpty(e.totalCost.ps)&&d.stringIsNullUndefinedOrEmpty(e.totalCost.qu)&&d.stringIsNullUndefinedOrEmpty(e.totalCost.tp)&&d.stringIsNullUndefinedOrEmpty(e.totalCost.cp)&&d.stringIsNullUndefinedOrEmpty(e.totalCost.intvw)&&d.stringIsNullUndefinedOrEmpty(e.totalCost.cn)?(e.selected[p.PusuitBudgetTotalCost]=null,e.grandTotalCost=null):(e.grandTotalCost=(d.stringIsNullUndefinedOrEmpty(e.totalCost.ps)?0:parseFloat(e.totalCost.ps))+(d.stringIsNullUndefinedOrEmpty(e.totalCost.qu)?0:parseFloat(e.totalCost.qu))+(d.stringIsNullUndefinedOrEmpty(e.totalCost.tp)?0:parseFloat(e.totalCost.tp))+(d.stringIsNullUndefinedOrEmpty(e.totalCost.cn)?0:parseFloat(e.totalCost.cn))+(d.stringIsNullUndefinedOrEmpty(e.totalCost.cp)?0:parseFloat(e.totalCost.cp))+(d.stringIsNullUndefinedOrEmpty(e.totalCost.intvw)?0:parseFloat(e.totalCost.intvw)),e.selected[p.PusuitBudgetTotalCost]=t.format(e.grandTotalCost));s.ngModel=JSON.stringify(s.model.selected)}(e),function(e){d.decimalIsNullorUndefinedorZero(e.totalCost.ps)||d.decimalIsNullorUndefinedorZero(e.grandTotalCost)?e.selected[p.PreSubmittalTotalPercent]=null:(e.selected[p.PreSubmittalTotalPercent]=parseFloat(e.totalCost.ps)/parseFloat(e.grandTotalCost)*100,e.selected[p.PreSubmittalTotalPercent]=e.selected[p.PreSubmittalTotalPercent].toFixed(6));d.decimalIsNullorUndefinedorZero(e.totalCost.qu)||d.decimalIsNullorUndefinedorZero(e.grandTotalCost)?e.selected[p.QualificationsTotalPercent]=null:(e.selected[p.QualificationsTotalPercent]=parseFloat(e.totalCost.qu)/parseFloat(e.grandTotalCost)*100,e.selected[p.QualificationsTotalPercent]=e.selected[p.QualificationsTotalPercent].toFixed(6));d.decimalIsNullorUndefinedorZero(e.totalCost.tp)||d.decimalIsNullorUndefinedorZero(e.grandTotalCost)?e.selected[p.TechProposalTotalPercent]=null:(e.selected[p.TechProposalTotalPercent]=parseFloat(e.totalCost.tp)/parseFloat(e.grandTotalCost)*100,e.selected[p.TechProposalTotalPercent]=e.selected[p.TechProposalTotalPercent].toFixed(6));d.decimalIsNullorUndefinedorZero(e.totalCost.cp)||d.decimalIsNullorUndefinedorZero(e.grandTotalCost)?e.selected[p.CostProposalTotalPercent]=null:(e.selected[p.CostProposalTotalPercent]=parseFloat(e.totalCost.cp)/parseFloat(e.grandTotalCost)*100,e.selected[p.CostProposalTotalPercent]=e.selected[p.CostProposalTotalPercent].toFixed(6));d.decimalIsNullorUndefinedorZero(e.totalCost.intvw)||d.decimalIsNullorUndefinedorZero(e.grandTotalCost)?e.selected[p.InterviewTotalPercent]=null:(e.selected[p.InterviewTotalPercent]=parseFloat(e.totalCost.intvw)/parseFloat(e.grandTotalCost)*100,e.selected[p.InterviewTotalPercent]=e.selected[p.InterviewTotalPercent].toFixed(6));d.decimalIsNullorUndefinedorZero(e.totalCost.cn)||d.decimalIsNullorUndefinedorZero(e.grandTotalCost)?e.selected[p.ContractNegotiationsTotalPercent]=null:(e.selected[p.ContractNegotiationsTotalPercent]=parseFloat(e.totalCost.cn)/parseFloat(e.grandTotalCost)*100,e.selected[p.ContractNegotiationsTotalPercent]=e.selected[p.ContractNegotiationsTotalPercent].toFixed(6));d.decimalIsNullorUndefinedorZero(e.grandTotalCost)?e.selected[p.QuTpCpTotalPercent]=null:d.stringIsNullUndefinedOrEmpty(e.totalCost.qu)&&d.stringIsNullUndefinedOrEmpty(e.totalCost.tp)&&d.stringIsNullUndefinedOrEmpty(e.totalCost.cp)?e.selected[p.QuTpCpTotalPercent]=null:(e.selected[p.QuTpCpTotalPercent]=((d.stringIsNullUndefinedOrEmpty(e.totalCost.qu)?0:parseFloat(e.totalCost.qu))+(d.stringIsNullUndefinedOrEmpty(e.totalCost.tp)?0:parseFloat(e.totalCost.tp))+(d.stringIsNullUndefinedOrEmpty(e.totalCost.cp)?0:parseFloat(e.totalCost.cp)))/parseFloat(e.grandTotalCost)*100,e.selected[p.QuTpCpTotalPercent]=e.selected[p.QuTpCpTotalPercent].toFixed(6));s.ngModel=JSON.stringify(s.model.selected)}(e),U(e),R(),s.ngModel=JSON.stringify(s.model.selected)}function U(e){d.stringIsNullUndefinedOrEmpty(e.grandTotalCost)||d.stringIsNullUndefinedOrEmpty(e.selected[p.EstGrossEcvRaw])?e.selected[p.PercentOfGrossEcv]=null:(e.selected[p.PercentOfGrossEcv]=parseFloat(e.grandTotalCost)/parseFloat(e.selected[p.EstGrossEcvRaw])*100,e.selected[p.PercentOfGrossEcv]=e.selected[p.PercentOfGrossEcv].toFixed(6)),s.ngModel=JSON.stringify(s.model.selected)}function _(){s.asForm?s.details.ApprovalItemDetail.forEach(function(e){switch(e.ApprovalItemName.EN){case"Direct Client = Private":s.model.selected.WizardClient="Private",s.model.list.clientType=["Private","Regulated"];break;case"Direct Client = Federal":s.model.selected.WizardClient="Federal",s.model.list.clientType=["Public - Federal"],s.model.selected[c.ClientTypeExpected]="Public - Federal";break;case"Direct Client = Public (Non-Federal)":s.model.selected.WizardClient="Public (Non-Federal)",s.model.list.clientType=["Public - Regional/MPO","Public - State/Province","Public - Local/County"];break;case"Owner = Private":s.model.selected.WizardOwner="Private",s.model.list.ownerType=["Private","Regulated"];break;case"Owner = Federal":s.model.selected.WizardOwner="Federal",s.model.list.ownerType=["Public - Federal"],s.model.selected[c.UltimateClientTypeExpected]="Public - Federal";break;case"Owner = Public (Non-Federal)":s.model.selected.WizardOwner="Public (Non-Federal)",s.model.list.ownerType=["Public - Regional/MPO","Public - State/Province","Public - Local/County"]}}):s.details.RequestApprovalItems.forEach(function(e){switch(e.ApprovalItemName.EN){case"Direct Client = Private":s.model.selected.WizardClient="Private",s.model.list.clientType=["Private","Regulated"];break;case"Direct Client = Federal":s.model.selected.WizardClient="Federal",s.model.list.clientType=["Public - Federal"],s.model.selected[c.ClientTypeExpected]="Public - Federal";break;case"Direct Client = Public (Non-Federal)":s.model.selected.WizardClient="Public (Non-Federal)",s.model.list.clientType=["Public - Regional/MPO","Public - State/Province","Public - Local/County"];break;case"Owner = Private":s.model.selected.WizardOwner="Private",s.model.list.ownerType=["Private","Regulated"];break;case"Owner = Federal":s.model.selected.WizardOwner="Federal",s.model.list.ownerType=["Public - Federal"],s.model.selected[c.UltimateClientTypeExpected]="Public - Federal";break;case"Owner = Public (Non-Federal)":s.model.selected.WizardOwner="Public (Non-Federal)",s.model.list.ownerType=["Public - Regional/MPO","Public - State/Province","Public - Local/County"]}})}s.events={addToList:function(e,t){e[t].push({value:null})},addToNblMarketList:function(e,t){var n=d.guid();e[t].push({value:null,id:n}),e.nblMarketLead.push({value:null,email:null,id:n})},deleteItem:function(e,t,n){e[t].splice(n,1)},deleteNblMarketItem:function(e,t,n){e[t]=e[t].filter(function(e){return e.id!==n}),e.nblMarketLead=e.nblMarketLead.filter(function(e){return e.id!==n})},onClickPerDOA:function(e){i.ShowDOAError(e,s.details)},concatNblMarketLead:function(e,t,n){var l=e.nblMarkets.filter(function(e){return e.LocalBusinessLine.toUpperCase()===t.value.LocalBusinessLine.toUpperCase()&&("Y"===n?"NBLML - COMPREHENSIVE"===e.DerivedRoleName.toUpperCase():"NBLML - COMPREHENSIVE"!==e.DerivedRoleName.toUpperCase())}),o=e.nblMarketLead.findIndex(function(e){return e.id===t.id});if(-1!==o){e.nblMarketLead[o].value=null;for(var r=0;r<l.length;r++)e.nblMarketLead[o].value=(null===e.nblMarketLead[o].value?"":e.nblMarketLead[o].value+"<br/>")+l[r].MemberFullName,e.nblMarketLead[o].email=(null===e.nblMarketLead[o].email?"":e.nblMarketLead[o].email+"|")+l[r].MemberEmail}},getTemplate:function(){{if("formal"===s.formType)return"app/views/templates/form-templates/go-no-go-formal-form-template.html";if("preliminary"===s.formType)return"app/views/templates/form-templates/go-no-go-preliminary-form-template.html";if("lead"===s.formType)return"app/views/templates/form-templates/go-no-go-lead-form-template.html"}},onClickRefreshData:N,onChange_Division:function(e){i.GetDistrictList(s.model,e)},onChange_District:function(e){i.GetAreaList(s.model,e)},onChange_Area:function(e){i.GetCostCenterList(s.model,e)},onChange_CostCenter:function(e){i.GetCompany(s.model,e)},onLoad_PopOver:function(e){angular.element(e).popover("show")},onClick_Warning:function(){i.ShowValidationError(s.model)},onChange_Ecv:function(e){var t=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});d.stringIsNullUndefinedOrEmpty(s.model.selected[e.EstSubEcvRaw])&&d.stringIsNullUndefinedOrEmpty(s.model.selected[e.EstNetEcvRaw])&&d.stringIsNullUndefinedOrEmpty(s.model.selected[e.EstDirectExpensesRaw])?(s.model.selected[e.EstGrossEcvRaw]=null,s.model.selected[e.EstGrossEcv]=null):(s.model.selected[e.EstGrossEcvRaw]=(d.stringIsNullUndefinedOrEmpty(s.model.selected[e.EstSubEcvRaw])?0:parseInt(s.model.selected[e.EstSubEcvRaw]))+(d.stringIsNullUndefinedOrEmpty(s.model.selected[e.EstNetEcvRaw])?0:parseInt(s.model.selected[e.EstNetEcvRaw]))+(d.stringIsNullUndefinedOrEmpty(s.model.selected[e.EstDirectExpensesRaw])?0:parseInt(s.model.selected[e.EstDirectExpensesRaw])),s.model.selected[e.EstGrossEcv]=t.format(s.model.selected[e.EstGrossEcvRaw]));U(s.model)},onChange_WinProb:function(){d.stringIsNullUndefinedOrEmpty(s.model.selected[p.Wp])||d.stringIsNullUndefinedOrEmpty(s.model.selected[p.Ppp])?s.model.selected[p.GoGetPercent]=null:(s.model.selected[p.GoGetPercent]=parseInt(s.model.selected[p.Wp])/100*(parseInt(s.model.selected[p.Ppp])/100)*100,s.model.selected[p.GoGetPercent]=s.model.selected[p.GoGetPercent].toString().includes(".")?s.model.selected[p.GoGetPercent].toFixed(6):s.model.selected[p.GoGetPercent])},onChange_Segment:function(){i.GetCascadingToSegmentList(s.model)},onChange_MarketArea:function(){i.GetMarketSectorList(s.model)},onClick_Collaboration:function(e){s.model.list.collaborationSelected.push(e)},onChangeOpportunityStatus:function(){"TASK PIPELINE"===(d.stringIsNullUndefinedOrEmpty(s.model.selected[c.OpportunityStatus])?s.model.selected[u.OpportunityStatus]:s.model.selected[c.OpportunityStatus])?i.ClearEcvValuesTaskPipeLine(s.model,c,"TASK PIPELINE"===s.model.selected[u.OpportunityStatus],!1):i.ClearEcvValuesNotTaskPipeLine(s.model,c,"TASK PIPELINE"===s.model.selected[u.OpportunityStatus],!1)},onChange_OpportunityStatusNew:y,onChange_LaborHours:L,onChange_Expense:M,onClick_CheckBox:function(e,t,n,l,o,r,i){e.checkBoxes[n]=!e.checkBoxes[n],e.checkBoxes[n]||a.alertConfirm("CONFIRM","Entered values will be lost. Are you sure you wish to proceed?",function(){e.selected[t]=null,e.selected[o]=null,L(e,t,n,l,o,r,i),R(),s.$apply()},function(){e.checkBoxes[n]=!e.checkBoxes[n],s.$apply()},"Yes.","No",!0)},onChange_Classification:function(){switch(s.model.list.opportunityStatusNew[5].disabled="N",s.model.list.taskOrder[2].disabled="N",s.model.selected[p.TaskOrderPanel]=null,s.model.selected[p.OpportunityStatus]=null,s.model.selected[p.MasterContractAgreement]=null,s.model.selected[p.ContractUpsetLimit]=null,s.model.selected[p.ContractUpsetLimitValuesRaw]=null,s.model.selected[p.ContractClassification]){case"Stand Alone":s.model.selected[p.TaskOrderPanel]="NO",s.model.list.opportunityStatusNew[5].disabled="Y";break;case"MSA":s.model.list.taskOrder[2].disabled="Y",s.model.list.opportunityStatusNew[5].disabled="Y";break;case"Task Order":s.model.list.taskOrder[2].disabled="Y",s.model.selected[p.OpportunityStatus]="TASK PIPELINE",y()}},onClick_ContractUpsetLimit:function(e){"YES"===e?a.alertWarning("Warning",'<div align="center"><span>Please enter a monetary value in the Contract Upset Limit Value field.</span>',1e4):s.model.selected[p.ContractUpsetLimitValuesRaw]=null},ShowValidationRequestEdits:function(){i.ShowValidationRequestEdits()},onChange_Country:function(e,t){s.model.selected[t.Country]=e.name,e.states=e.states.filter(function(e){return"NATIONWIDE"!==e.name}),e.states.push({id:0,name:"NATIONWIDE",state_code:"N/A",cities:[]})},getMinDateRfpSubmittal:function(){return d.stringIsNullUndefinedOrEmpty(s.model.selected[p.RfpIssueDate])?null:s.model.selected[p.RfpIssueDate]},getMinExpectedDecision:function(){return d.stringIsNullUndefinedOrEmpty(s.model.selected[p.RfpSubmittalDate])?d.stringIsNullUndefinedOrEmpty(s.model.selected[p.RfpIssueDate])?s.model.minDate:moment(s.model.selected[p.RfpIssueDate])<moment(s.model.minDate)?s.model.minDate:s.model.selected[p.RfpIssueDate]:moment(s.model.selected[p.RfpSubmittalDate])<moment(s.model.minDate)?s.model.minDate:s.model.selected[p.RfpSubmittalDate]},getMinEstStartDate:function(){return d.stringIsNullUndefinedOrEmpty(s.model.selected[p.AnticipatedDecisionDate])?d.stringIsNullUndefinedOrEmpty(s.model.selected[p.RfpSubmittalDate])?d.stringIsNullUndefinedOrEmpty(s.model.selected[p.RfpIssueDate])?s.model.minDate:moment(s.model.selected[p.RfpIssueDate])<moment(s.model.minDate)?s.model.minDate:s.model.selected[p.RfpIssueDate]:moment(s.model.selected[p.RfpSubmittalDate])<moment(s.model.minDate)?s.model.minDate:s.model.selected[p.RfpSubmittalDate]:moment(s.model.selected[p.AnticipatedDecisionDate])<moment(s.model.minDate)?s.model.minDate:s.model.selected[p.AnticipatedDecisionDate]},clearInvalidDate:function(){var e=d.stringIsNullUndefinedOrEmpty(s.model.selected[p.RfpIssueDate])?null:moment(s.model.selected[p.RfpIssueDate]),t=d.stringIsNullUndefinedOrEmpty(s.model.selected[p.RfpSubmittalDate])?null:moment(s.model.selected[p.RfpSubmittalDate]),n=d.stringIsNullUndefinedOrEmpty(s.model.selected[p.AnticipatedDecisionDate])?null:moment(s.model.selected[p.AnticipatedDecisionDate]),l=d.stringIsNullUndefinedOrEmpty(s.model.selected[p.AnticipatedStartDate])?null:moment(s.model.selected[p.AnticipatedStartDate]);null!==e&&null!==t&&t<e&&(s.model.selected[p.RfpSubmittalDate]=null);null!==t&&null!==n&&n<t&&(s.model.selected[p.AnticipatedDecisionDate]=null);null!==n&&null!==l&&l<n&&(s.model.selected[p.AnticipatedStartDate]=null);null!==e&&null!==n&&n<e&&(s.model.selected[p.AnticipatedDecisionDate]=null);null!==e&&null!==l&&l<e&&(s.model.selected[p.AnticipatedStartDate]=null);null!==t&&null!==l&&l<t&&(s.model.selected[p.AnticipatedStartDate]=null)},getMinDateRfpSubmittalfgngpgng:function(){var e=d.stringIsNullUndefinedOrEmpty(s.model.selected[c.RfpIssueDate])?s.model.selected[u.RfpIssueDate]:s.model.selected[c.RfpIssueDate];d.stringIsNullUndefinedOrEmpty(s.model.selected[c.RfpSubmittalDate])?s.model.selected[u.RfpSubmittalDate]:s.model.selected[c.RfpSubmittalDate],d.stringIsNullUndefinedOrEmpty(s.model.selected[c.AnticipatedDecisionDate])?s.model.selected[u.AnticipatedDecisionDate]:s.model.selected[c.AnticipatedDecisionDate],d.stringIsNullUndefinedOrEmpty(s.model.selected[c.AnticipatedStartDate])?s.model.selected[u.AnticipatedStartDate]:s.model.selected[c.AnticipatedStartDate];return d.stringIsNullUndefinedOrEmpty(e)?null:e},getMinExpectedDecisionfgngpgng:function(){var e=d.stringIsNullUndefinedOrEmpty(s.model.selected[c.RfpIssueDate])?s.model.selected[u.RfpIssueDate]:s.model.selected[c.RfpIssueDate],t=d.stringIsNullUndefinedOrEmpty(s.model.selected[c.RfpSubmittalDate])?s.model.selected[u.RfpSubmittalDate]:s.model.selected[c.RfpSubmittalDate];return d.stringIsNullUndefinedOrEmpty(t)?d.stringIsNullUndefinedOrEmpty(e)?s.model.minDate:moment(e)<moment(s.model.minDate)?s.model.minDate:e:moment(t)<moment(s.model.minDate)?s.model.minDate:t},getMinEstStartDatefgngpgng:function(){var e=d.stringIsNullUndefinedOrEmpty(s.model.selected[c.RfpIssueDate])?s.model.selected[u.RfpIssueDate]:s.model.selected[c.RfpIssueDate],t=d.stringIsNullUndefinedOrEmpty(s.model.selected[c.RfpSubmittalDate])?s.model.selected[u.RfpSubmittalDate]:s.model.selected[c.RfpSubmittalDate],n=d.stringIsNullUndefinedOrEmpty(s.model.selected[c.AnticipatedDecisionDate])?s.model.selected[u.AnticipatedDecisionDate]:s.model.selected[c.AnticipatedDecisionDate];return d.stringIsNullUndefinedOrEmpty(n)?d.stringIsNullUndefinedOrEmpty(t)?d.stringIsNullUndefinedOrEmpty(e)?s.model.minDate:moment(e)<moment(s.model.minDate)?s.model.minDate:e:moment(t)<moment(s.model.minDate)?s.model.minDate:t:moment(n)<moment(s.model.minDate)?s.model.minDate:n},clearInvalidDatefgngpgng:function(){var e=d.stringIsNullUndefinedOrEmpty(s.model.selected[c.RfpIssueDate])?s.model.selected[u.RfpIssueDate]:s.model.selected[c.RfpIssueDate],t=d.stringIsNullUndefinedOrEmpty(s.model.selected[c.RfpSubmittalDate])?s.model.selected[u.RfpSubmittalDate]:s.model.selected[c.RfpSubmittalDate],n=d.stringIsNullUndefinedOrEmpty(s.model.selected[c.AnticipatedDecisionDate])?s.model.selected[u.AnticipatedDecisionDate]:s.model.selected[c.AnticipatedDecisionDate],l=d.stringIsNullUndefinedOrEmpty(s.model.selected[c.AnticipatedStartDate])?s.model.selected[u.AnticipatedStartDate]:s.model.selected[c.AnticipatedStartDate],o=d.stringIsNullUndefinedOrEmpty(e)?null:moment(e),r=d.stringIsNullUndefinedOrEmpty(t)?null:moment(t),i=d.stringIsNullUndefinedOrEmpty(n)?null:moment(n),a=d.stringIsNullUndefinedOrEmpty(l)?null:moment(l);null!==o&&null!==r&&r<o&&(s.model.selected[c.RfpSubmittalDate]=null);null!==r&&null!==i&&i<r&&(s.model.selected[c.AnticipatedDecisionDate]=null);null!==i&&null!==a&&a<i&&(s.model.selected[c.AnticipatedStartDate]=null);null!==o&&null!==i&&i<o&&(s.model.selected[c.AnticipatedDecisionDate]=null);null!==o&&null!==a&&a<o&&(s.model.selected[c.AnticipatedStartDate]=null);null!==r&&null!==a&&a<r&&(s.model.selected[c.AnticipatedStartDate]=null)},isTaskPipeLine:function(){return d.stringIsNullUndefinedOrEmpty(s.model.selected[c.OpportunityStatus])?"TASK PIPELINE"===s.model.selected[u.OpportunityStatus]:"TASK PIPELINE"===s.model.selected[c.OpportunityStatus]},onClick_SaveForm:function(){f.set("GnGForm",s.ngModel)},onClick_RestoreForm:function(){var e=f.get("GnGForm");s.ngModel=e,E()}},s.validations={validateSourceData:function(e,t){var n=d.stringIsNullUndefinedOrEmpty(t)?null:t.toUpperCase(),l=d.stringIsNullUndefinedOrEmpty(e)?null:e.toUpperCase();return d.stringIsNullUndefinedOrEmpty(e)&&!d.stringIsNullUndefinedOrEmpty(s.model.selected[u.OpportunityNumber])||null!==n&&n!==l},validateSourceDateData:function(e,t){return d.stringIsNullUndefinedOrEmpty(e)&&!d.stringIsNullUndefinedOrEmpty(s.model.selected[u.OpportunityNumber])||null!==t&&t!==e},validateSourceDataIntField:function(e,t){return d.stringIsNullUndefinedOrEmpty(e)&&!d.stringIsNullUndefinedOrEmpty(s.model.selected[u.OpportunityNumber])||null!=t&&""!==t&&parseInt(t)!==parseInt(e)},validateNotRequiredSourceData:function(e,t){var n=d.stringIsNullUndefinedOrEmpty(t)?null:t.toUpperCase(),l=d.stringIsNullUndefinedOrEmpty(e)?null:e.toUpperCase();return null!=t&&""!==t&&n!==l},validateNotRequiredSourceDateData:function(e,t){return null!=t&&""!==t&&t!==e},validateNotRequiredSourceDataIntField:function(e,t){return null!=t&&""!==t&&parseInt(t)!==parseInt(e)},validateOnlyRequiredSourceData:function(e){return d.stringIsNullUndefinedOrEmpty(e)&&!d.stringIsNullUndefinedOrEmpty(s.model.selected[u.OpportunityNumber])},validateForecast:function(e,t){var n=d.stringIsNullUndefinedOrEmpty(e[t.CurrentFy])?0:e[t.CurrentFy],l=d.stringIsNullUndefinedOrEmpty(e[t.NextFy])?0:e[t.NextFy],o=d.stringIsNullUndefinedOrEmpty(e[t.SubsequentFy])?0:e[t.SubsequentFy],r=parseFloat(n)+parseFloat(l)+parseFloat(o);return parseFloat(r)===parseFloat(100)?(e[t.CurrentFy]=null===e[t.CurrentFy]||void 0===e[t.CurrentFy]||""===e[t.CurrentFy]?0:e[t.CurrentFy],e[t.NextFy]=null===e[t.NextFy]||void 0===e[t.NextFy]||""===e[t.NextFy]?0:e[t.NextFy],e[t.SubsequentFy]=null===e[t.SubsequentFy]||void 0===e[t.SubsequentFy]||""===e[t.CurrentFy]?0:e[t.SubsequentFy],C(!1,"FORECAST"),!1):null!==e[t.CurrentFy]&&void 0!==e[t.CurrentFy]&&""!==e[t.CurrentFy]||null!==e[t.NextFy]&&void 0!==e[t.NextFy]&&""!==e[t.NextFy]||null!==e[t.SubsequentFy]&&void 0!==e[t.SubsequentFy]&&""!==e[t.SubsequentFy]?(C(!0,"FORECAST"),!0):(C(!1,"FORECAST"),!1)},validatePercent:function(e,t){return 100<e?(C(!0,t),!0):(C(!1,t),!1)},validateCascadingRequiredField:function(e,t){return d.stringIsNullUndefinedOrEmpty(e)&&null!=t&&""!==t&&JSON.stringify(t)!==JSON.stringify([])},validateOpportunitySelected:function(e,t,n){for(var l=0;l<n.length;l++)if(e.selected[t.OpportunityStatus]===n[l])return!0;return!1},validateSourceDataLeadStatus:function(e,t){return!!d.stringIsNullUndefinedOrEmpty(e)&&O()&&!d.stringIsNullUndefinedOrEmpty(s.model.selected[u.OpportunityNumber])||null!=t&&""!==t&&t!==e},validateSourceDataIntFieldLeadStatus:function(e,t){return!!d.stringIsNullUndefinedOrEmpty(e)&&O()&&!d.stringIsNullUndefinedOrEmpty(s.model.selected[u.OpportunityNumber])||null!=t&&""!==t&&parseInt(t)!==parseInt(e)},validateLeadStatus:O,validateDate:function(e,t,n){var l=moment(e),o=d.stringIsNullUndefinedOrEmpty(t)?moment(t):null,r=null!==d.stringIsNullUndefinedOrEmpty(n)?moment(n):null;{if(d.stringIsNullUndefinedOrEmpty(t)&&d.stringIsNullUndefinedOrEmpty(n))return l;if(d.stringIsNullUndefinedOrEmpty(n)&&!d.stringIsNullUndefinedOrEmpty(t)&&!d.stringIsNullUndefinedOrEmpty(e))return l<o?t:e;if(!(d.stringIsNullUndefinedOrEmpty(t)||d.stringIsNullUndefinedOrEmpty(e)||d.stringIsNullUndefinedOrEmpty(n)))return l<o?r<o?t:n:r<l?e:n;if(d.stringIsNullUndefinedOrEmpty(e)&&!d.stringIsNullUndefinedOrEmpty(t)&&!d.stringIsNullUndefinedOrEmpty(n))return r<o?t:n;if(d.stringIsNullUndefinedOrEmpty(t)&&!d.stringIsNullUndefinedOrEmpty(e)&&!d.stringIsNullUndefinedOrEmpty(n))return r<l?e:n}},validateTaskNetTaskGross:function(e,t,n,l){return parseInt(t)<parseInt(e)&&(a.alertWarning("Warning",'<div align="center"><span>Task Net ECV cannot be greater than Task Gross ECV. Task Net ECV will be cleared.</span>',1e4),!(n.selected[l]=null))},validateNewLineOfBusiness:function(){if(s.asForm)for(var e=0;e<s.details.ApprovalItemDetail.length;e++)if("New Line of Business"===s.details.ApprovalItemDetail[e].ApprovalItemName.EN)return!0;return!1},hasSavedRecord:S},E(),s.removeDivisionNull=function(e){return e.DIVISION_NAME?e:void 0},s.removeDistrictNull=function(e){return e.DISTRICT_NAME?e:void 0},s.removeAreaNull=function(e){return e.AREA_NAME?e:void 0},s.removeCostCenterNull=function(e){return e.COST_CENTER_NAME?e:void 0},s.$watch("ngModel",function(){if(null===s.ngModel?(T(),s.switchOn=!0):JSON.parse(s.ngModel)[u.OpportunityNumber]!==s.model.selected[u.OpportunityNumber]||d.stringIsNullUndefinedOrEmpty(JSON.parse(s.ngModel)[u.OpportunityNumber])?s.switchOn=!0:s.switchOn=!1,s.switchOn&&null!==s.ngModel&&(d.stringIsNullUndefinedOrEmpty(JSON.parse(s.ngModel)[u.OpportunityNumber])||(T(),N())),"lead"===s.formType&&null!==s.ngModel){var e=JSON.parse(s.ngModel);d.stringIsNullUndefinedOrEmpty(e.PA)||(null!==s.model.object.pa?e.PA!==s.model.object.pa.EMPLOYEE_NUMBER&&(s.model.selected[p.PaAuto]=angular.copy(e.PA),v=angular.copy(e.PA),I===e.COST_CENTER_ID||d.stringIsNullUndefinedOrEmpty(e.COST_CENTER_ID)||(I=e.COST_CENTER_ID,m.GetApproverForLbl(e.PA).then(function(e){s.model.object.pa=e,s.model.clearSwitch.pa="Y"}))):v!==e.PA&&(s.model.selected[p.PaAuto]=angular.copy(e.PA),v=angular.copy(e.PA),m.GetApproverForLbl(e.PA).then(function(e){s.model.object.pa=e,s.model.clearSwitch.pa="Y"})))}},!0),s.$watch("model.selected",function(){s.switchSelected||("lead"===s.formType?(s.model.selected[p.ClientType]=d.stringIsNullUndefinedOrEmpty(s.model.object.client)?s.model.selected[p.ClientType]:d.stringIsNullUndefinedOrEmpty(s.model.object.client.UC_TYPE)?s.model.selected[p.ClientType]:s.model.object.client.UC_TYPE,s.model.selected[p.UltimateClientType]=d.stringIsNullUndefinedOrEmpty(s.model.object.ultimateClient)?s.model.selected[p.UltimateClientType]:d.stringIsNullUndefinedOrEmpty(s.model.object.ultimateClient.UC_TYPE)?s.model.selected[p.UltimateClientType]:s.model.object.ultimateClient.UC_TYPE,s.model.selected[p.MarketingCoordinator]=d.stringIsNullUndefinedOrEmpty(s.model.object.marketingCoordinator)?null:JSON.stringify(s.model.object.marketingCoordinator),s.model.selected[p.ProposalManager]=d.stringIsNullUndefinedOrEmpty(s.model.object.proposalManager)?null:JSON.stringify(s.model.object.proposalManager),s.model.selected[p.Pic]=d.stringIsNullUndefinedOrEmpty(s.model.object.pic)?null:JSON.stringify(s.model.object.pic),s.model.selected[p.PmLevel]=d.stringIsNullUndefinedOrEmpty(s.model.object.projectManager)?null:d.stringIsNullUndefinedOrEmpty(s.model.object.projectManager.PM_LEVEL)?"PM Not a PMAP Participant":s.model.object.projectManager.PM_LEVEL,s.model.selected[p.MasterContractAgreement]=d.stringIsNullUndefinedOrEmpty(s.model.object.masterContractAgreement)?null:JSON.stringify(s.model.object.masterContractAgreement),i.StringifyCRMObjects(s.model,p)):(s.model.selected[c.ClientType]=d.stringIsNullUndefinedOrEmpty(s.model.object.client)?s.model.selected[c.ClientType]:d.stringIsNullUndefinedOrEmpty(s.model.object.client.UC_TYPE)?s.model.selected[c.ClientType]:s.model.object.client.UC_TYPE,s.model.selected[c.UltimateClientType]=d.stringIsNullUndefinedOrEmpty(s.model.object.ultimateClient)?s.model.selected[c.UltimateClientType]:d.stringIsNullUndefinedOrEmpty(s.model.object.ultimateClient.UC_TYPE)?s.model.selected[c.UltimateClientType]:s.model.object.ultimateClient.UC_TYPE,s.model.selected[c.PmLevel]=d.stringIsNullUndefinedOrEmpty(s.model.object.projectManager)?null:d.stringIsNullUndefinedOrEmpty(s.model.object.projectManager.PM_LEVEL)?"PM Not a PMAP Participant":s.model.object.projectManager.PM_LEVEL,s.model.selected[c.NblMarketLead]=d.stringIsNullUndefinedOrEmpty(s.model.list.nblMarketLead)?JSON.stringify([{value:null,email:null,id:g}]):JSON.stringify(s.model.list.nblMarketLead),s.model.selected[c.NblMarkets]=d.stringIsNullUndefinedOrEmpty(s.model.list.nblMarketSelected)?null:JSON.stringify(s.model.list.nblMarketSelected),i.StringifyCRMObjects(s.model,c)),s.ngModel=JSON.stringify(s.model.selected)),null!==s.ngModel?"lead"===s.formType?s.switchSelected=!1:s.switchSelected=d.stringIsNullUndefinedOrEmpty(JSON.parse(s.ngModel)[u.OpportunityNumber]):s.switchSelected=!1},!0),String.prototype.toProperCase=function(){return this.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})},s.$watch("model.object",function(){s.switchObject||("lead"===s.formType?(s.model.selected[p.ClientType]=d.stringIsNullUndefinedOrEmpty(s.model.object.client)?s.model.selected[p.ClientType]:d.stringIsNullUndefinedOrEmpty(s.model.object.client.UC_TYPE)?s.model.selected[p.ClientType]:s.model.object.client.UC_TYPE,s.model.selected[p.UltimateClientType]=d.stringIsNullUndefinedOrEmpty(s.model.object.ultimateClient)?s.model.selected[p.UltimateClientType]:d.stringIsNullUndefinedOrEmpty(s.model.object.ultimateClient.UC_TYPE)?s.model.selected[p.UltimateClientType]:s.model.object.ultimateClient.UC_TYPE,s.model.selected[p.MarketingCoordinator]=d.stringIsNullUndefinedOrEmpty(s.model.object.marketingCoordinator)?null:JSON.stringify(s.model.object.marketingCoordinator),s.model.selected[p.ProposalManager]=d.stringIsNullUndefinedOrEmpty(s.model.object.proposalManager)?null:JSON.stringify(s.model.object.proposalManager),s.model.selected[p.Pic]=d.stringIsNullUndefinedOrEmpty(s.model.object.pic)?null:JSON.stringify(s.model.object.pic),s.model.selected[p.MasterContractAgreement]=d.stringIsNullUndefinedOrEmpty(s.model.object.masterContractAgreement)?null:JSON.stringify(s.model.object.masterContractAgreement),s.model.selected[p.PmLevel]=d.stringIsNullUndefinedOrEmpty(s.model.object.projectManager)?null:d.stringIsNullUndefinedOrEmpty(s.model.object.projectManager.PM_LEVEL)?"PM Not a PMAP Participant":s.model.object.projectManager.PM_LEVEL,i.StringifyCRMObjects(s.model,p)):(s.model.selected[c.ClientType]=d.stringIsNullUndefinedOrEmpty(s.model.object.client)?s.model.selected[c.ClientType]:d.stringIsNullUndefinedOrEmpty(s.model.object.client.UC_TYPE)?s.model.selected[c.ClientType]:s.model.object.client.UC_TYPE,s.model.selected[c.UltimateClientType]=d.stringIsNullUndefinedOrEmpty(s.model.object.ultimateClient)?s.model.selected[c.UltimateClientType]:d.stringIsNullUndefinedOrEmpty(s.model.object.ultimateClient.UC_TYPE)?s.model.selected[c.UltimateClientType]:s.model.object.ultimateClient.UC_TYPE,s.model.selected[c.PmLevel]=d.stringIsNullUndefinedOrEmpty(s.model.object.projectManager)?null:d.stringIsNullUndefinedOrEmpty(s.model.object.projectManager.PM_LEVEL)?"PM Not a PMAP Participant":s.model.object.projectManager.PM_LEVEL,s.model.list.nblMarketLead=d.stringIsNullUndefinedOrEmpty(s.model.list.nblMarketLead)?[{value:null,email:null,id:g}]:s.model.list.nblMarketLead,s.model.list.nblMarketSelected=d.stringIsNullUndefinedOrEmpty(s.model.list.nblMarketSelected)?null:s.model.list.nblMarketSelected,i.StringifyCRMObjects(s.model,c)),s.ngModel=JSON.stringify(s.model.selected)),s.switchObject=!1},!0),s.$watch("model.list.otherStaff",function(){s.switchOtherStaffList||(s.model.selected[p.OtherStaff]=d.stringIsNullUndefinedOrEmpty(s.model.list.otherStaff)?null:JSON.stringify(s.model.list.otherStaff),s.ngModel=JSON.stringify(s.model.selected)),s.switchOtherStaffList=!1},!0),s.$watch("model.list.teamingPartners",function(){s.switchTeamingPartnersList||(s.model.selected[p.TeamingPartners]=d.stringIsNullUndefinedOrEmpty(s.model.list.teamingPartners)?null:JSON.stringify(s.model.list.teamingPartners),s.ngModel=JSON.stringify(s.model.selected)),s.switchTeamingPartnersList=!1},!0),s.$watch("model.list.competitors",function(){s.switchCompetitorsList||(s.model.selected[p.Competitors]=d.stringIsNullUndefinedOrEmpty(s.model.list.competitors)?null:JSON.stringify(s.model.list.competitors),s.ngModel=JSON.stringify(s.model.selected)),s.switchCompetitorsList=!1},!0),s.$watch("model.list.collaboration",function(){s.switchcollaborationList||(s.model.selected[p.Collaboration]=d.stringIsNullUndefinedOrEmpty(s.model.list.collaboration)?null:JSON.stringify(s.model.list.collaboration),s.ngModel=JSON.stringify(s.model.selected)),s.switchcollaborationList=!1},!0),s.$watch("model.list.nblMarketLead",function(){s.model.selected[c.NblMarketLead]=d.stringIsNullUndefinedOrEmpty(s.model.list.nblMarketLead)?null:JSON.stringify(s.model.list.nblMarketLead),s.ngModel=JSON.stringify(s.model.selected)},!0),s.$watch("model.list.nblMarketSelected",function(){s.model.selected[c.NblMarkets]=d.stringIsNullUndefinedOrEmpty(s.model.list.nblMarketSelected)?null:JSON.stringify(s.model.list.nblMarketSelected),s.ngModel=JSON.stringify(s.model.selected)},!0),s.$watch("model.checkBoxes",function(){s.switchCheckboxes||(s.model.selected[p.Ps]=angular.copy(s.model.checkBoxes.ps),s.model.selected[p.Qu]=angular.copy(s.model.checkBoxes.qu),s.model.selected[p.Tp]=angular.copy(s.model.checkBoxes.tp),s.model.selected[p.Cp]=angular.copy(s.model.checkBoxes.cp),s.model.selected[p.Intvw]=angular.copy(s.model.checkBoxes.intvw),s.model.selected[p.Cn]=angular.copy(s.model.checkBoxes.cn),s.ngModel=JSON.stringify(s.model.selected)),s.switchCheckboxes=!1},!0)}]}})}(),function(){"use strict";angular.module("myApp").directive("opportunityAgreementProjectFormControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",details:"=",isValid:"=?",formType:"="},controller:["$scope","FormOptions","AgreementProjectWarFormPropertyNames","astigUtilityService","sweetDialogAlertService","GngFormBusiness","ProjectSetupFormBusiness","FormAutoPopulatedPropertyNames",function(t,e,n,l,o,r,i,a){function s(){t.asForm?t.details.ApprovalItemDetail.forEach(function(e){switch(e.ApprovalItemName.EN){case"Direct Client = Private":t.model.selected.WizardClient="Private",t.model.list.clientType=["Private","Regulated"];break;case"Direct Client = Federal":t.model.selected.WizardClient="Federal",t.model.list.clientType=["Public - Federal"],t.model.selected[n.ClientTypeExpected]="Public - Federal";break;case"Direct Client = Public (Non-Federal)":t.model.selected.WizardClient="Public (Non-Federal)",t.model.list.clientType=["Public - Regional/MPO","Public - State/Province","Public - Local/County"];break;case"Owner = Private":t.model.selected.WizardOwner="Private",t.model.list.ownerType=["Private","Regulated"];break;case"Owner = Federal":t.model.selected.WizardOwner="Federal",t.model.list.ownerType=["Public - Federal"],t.model.selected[n.UltimateClientTypeExpected]="Public - Federal";break;case"Owner = Public (Non-Federal)":t.model.selected.WizardOwner="Public (Non-Federal)",t.model.list.ownerType=["Public - Regional/MPO","Public - State/Province","Public - Local/County"]}}):t.details.RequestApprovalItems.forEach(function(e){switch(e.ApprovalItemName.EN){case"Direct Client = Private":t.model.selected.WizardClient="Private",t.model.list.clientType=["Private","Regulated"];break;case"Direct Client = Federal":t.model.selected.WizardClient="Federal",t.model.list.clientType=["Public - Federal"],t.model.selected[n.ClientTypeExpected]="Public - Federal";break;case"Direct Client = Public (Non-Federal)":t.model.selected.WizardClient="Public (Non-Federal)",t.model.list.clientType=["Public - Regional/MPO","Public - State/Province","Public - Local/County"];break;case"Owner = Private":t.model.selected.WizardOwner="Private",t.model.list.ownerType=["Private","Regulated"];break;case"Owner = Federal":t.model.selected.WizardOwner="Federal",t.model.list.ownerType=["Public - Federal"],t.model.selected[n.UltimateClientTypeExpected]="Public - Federal";break;case"Owner = Public (Non-Federal)":t.model.selected.WizardOwner="Public (Non-Federal)",t.model.list.ownerType=["Public - Regional/MPO","Public - State/Province","Public - Local/County"]}})}t.model={prop:n,autoProp:a,errorSwitchDeliveryMethod:!1,errorSwitchClient:!1,errorSwitchOwner:!1,errorSwitchBusinessLine:!1,errorSwitchBusinessLineDivision:!1,list:{yesNo:e.YesNo,vendorFinancialExposure:[],ownerType:[],clientType:[]},object:{vendor:null},selected:{},objectList:{funding:{total:{Labor:null,Subcontractor:null,DirectExpense:null,TotalFunding:null,NetFunding:null,ManagementReserve:null,TargetMarginDollar:null,TargetMarginPercentOfTotal:null,TargetMarginPercentOfNet:null},list:[]}}},t.utility=l,t.switchObject=!0,t.switchVendorFinancialExposure=!0,(l.stringIsNullUndefinedOrEmpty(t.ngModel)?t.ngModel:JSON.parse(t.ngModel)[n.ObjectNumber])&&(t.model.object.vendor=l.stringIsNullUndefinedOrEmpty(JSON.parse(t.ngModel)[n.Vendor])?null:JSON.parse(JSON.parse(t.ngModel)[n.Vendor]),t.model.list.vendorFinancialExposure=l.stringIsNullUndefinedOrEmpty(JSON.parse(t.ngModel)[n.VendorFinancialExposure])?[]:JSON.parse(JSON.parse(t.ngModel)[n.VendorFinancialExposure]),t.model.selected=JSON.parse(t.ngModel),s(),t.asForm&&r.ValidateOpportunityVsApprovaltem(t.model,n,t.isValid,t.details)),t.events={onClickShowError:function(){o.alertWarningCustom("Warning",'<div align="left"><span>The following data does not match with the approval item selected:</span><ul>'+(t.model.errorSwitchClient?"<li>":"")+(t.model.errorSwitchClient?"<b>Client Type</b>":"")+(t.model.errorSwitchClient?"</li>":"")+(t.model.errorSwitchOwner?"<li>":"")+(t.model.errorSwitchOwner?"<b>Owner Type</b>":"")+(t.model.errorSwitchOwner?"</li>":"")+(t.model.errorSwitchDeliveryMethod?"<li>":"")+(t.model.errorSwitchDeliveryMethod?"<b>Delivery Method</b>":"")+(t.model.errorSwitchDeliveryMethod?"</li>":"")+(t.model.errorSwitchBusinessLine?"<li>":"")+(t.model.errorSwitchBusinessLine?"<b>Business Line</b>":"")+(t.model.errorSwitchBusinessLine?"</li>":"")+(t.model.errorSwitchBusinessLineDivision?"<li>":"")+(t.model.errorSwitchBusinessLineDivision?"<b>Federal Region</b>":"")+(t.model.errorSwitchBusinessLineDivision?"</li>":"")+'</ul><br /><span>To move forward, either:</span><ul><li>back out of this request and select the appropriate approval item for your request</li><li>update data in the applicable source of record</li></ul><br /><span>Guidance for updating data in the source system:</span><ul><li>If the necessary data is tied to an Opportunity, either update the Opportunity in CRM or contact your Regional CRM Data Coordinator.</li><li>If the necessary data is tied to an Agreement or Project, either update the data in the ERP or contact your Project Accountant.</li><li>For all other data, please contact <a href="mailto: IAS-Admin@wsp.com">IAS-Admin@wsp.com</a>.</li></ul></div>',"none")},onClickPerDOA:function(e){void 0===t.details.ApprovalItemSteps.find(function(e){return"US Risk Committee Review (RCR) Coordinator"===e.CostPointRoleName||"Federal Risk Committee Review (FRCR) Chair"===e.CostPointRoleName})&&"Yes"==e&&o.alertWarning("Request Warning",'<div align="left"><span>You have noted that Risk Committee Review (RCR) is required, yet the approval item selected does not include the RCR Coordinator.</span><br/><span>Please back out of this approval item and submit your request in connection with an appropriate approval item.</span><br/><span>RCR is automatically triggered via IAS in all of the following scenarios:</span><ul><li>High Risk Countries</li><li>High Risk, as per DoA</li><li>New Line of Business</li><li>Higher value ECV thresholds</li><ul></div>',2e4)},addToList:function(e,t){e[t].push({value:null,financialExposure:null})},deleteItem:function(e,t,n){e[t].splice(n,1)},onClick_ModificationBeingSigned:function(e){"No"===e&&(t.model.list.vendorFinancialExposure=[],t.model.object.vendor=null,t.model.selected[n.WorkWithSubPreviously]=null)},onClick_HasWspWorked:function(e){"Yes"===e?t.model.list.vendorFinancialExposure=[]:"No"===e&&(t.model.object.vendor=null)},onLoad_PopOver:function(e){angular.element(e).popover("show")},formatValue:function(e){var t=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),n=l.stringIsNullUndefinedOrEmpty(e)?"":e.toString().replace("$","").replace(",","").replace(",","").replace(",","");return l.stringIsNullUndefinedOrEmpty(e)?"":t.format(n)}},t.$watch("model.object",function(){t.switchObject||(t.model.selected[n.Vendor]=l.stringIsNullUndefinedOrEmpty(t.model.object.vendor)?null:JSON.stringify(t.model.object.vendor),t.ngModel=JSON.stringify(t.model.selected)),t.switchObject=!1},!0),t.$watch("model.list.vendorFinancialExposure",function(){t.switchVendorFinancialExposure||(t.model.selected[n.VendorFinancialExposure]=l.stringIsNullUndefinedOrEmpty(t.model.list.vendorFinancialExposure)?null:JSON.stringify(t.model.list.vendorFinancialExposure),t.ngModel=JSON.stringify(t.model.selected)),t.switchVendorFinancialExposure=!1},!0),t.$watch("ngModel",function(){null===t.ngModel?(t.model.selected={},t.model.errorSwitchDeliveryMethod=!1,t.model.errorSwitchClient=!1,t.model.errorSwitchOwner=!1,t.model.errorSwitchBusinessLine=!1,t.model.errorSwitchBusinessLineDivision=!1,t.model.list.supportingCC=[],t.switchOn=!0):JSON.parse(t.ngModel)[n.ObjectNumber]!==t.model.selected[n.ObjectNumber]||l.stringIsNullUndefinedOrEmpty(JSON.parse(t.ngModel)[n.ObjectNumber])?t.switchOn=!0:t.switchOn=!1,t.switchOn&&null!==t.ngModel&&(l.stringIsNullUndefinedOrEmpty(JSON.parse(t.ngModel)[n.ObjectNumber])||(t.model.selected=angular.copy(JSON.parse(t.ngModel)),s(),t.asForm&&r.ValidateOpportunityVsApprovaltem(t.model,n,t.isValid,t.details)))},!0),t.$watch("model.selected",function(){t.switchOn||(t.model.selected[n.Vendor]=l.stringIsNullUndefinedOrEmpty(t.model.object.vendor)?null:JSON.stringify(t.model.object.vendor),i.CalculateAnticipatedMarginPercentGrossForPricing(t.model),i.CalculateAnticipatedMarginPercentNetForPricing(t.model),t.ngModel=JSON.stringify(t.model.selected)),t.switchOn=!1},!0)}],templateUrl:"app/views/templates/form-templates/pricing-agreement-project-form-template.html"}})}(),function(){"use strict";angular.module("myApp").directive("opportunityFormControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",formValidation:"=?",details:"=",isValid:"=?"},controller:["$scope","FormAutoPopulatedPropertyNames","LookupService","LookupRoleIds","astigUtilityService","sweetDialogAlertService","FormOptions","FormMessages","FormTwoWayBindPropertyNames","GngFormBusiness","ProjectSetupFormBusiness","AgreementProjectWarFormPropertyNames","$q","$state",function(s,u,t,l,c,o,e,n,d,r,i,a,p,m){var f=c.guid();function g(n){if(null!==s.ngModel){var e={RoleId:l.gNgFormRoleId,Parameters:{LOOKUP_VALUE:angular.copy(JSON.parse(s.ngModel)[u.OpportunityNumber])}};return t.Search(e).then(function(e){if(void 0!==e[0]){var t={value:angular.copy(e[0])};JSON.parse(s.ngModel)[u.OpportunityNumber]!==s.model.selected[u.OpportunityNumber]&&N(),S(t),r.GetNblml(t.value[u.CostCenterId]).then(function(e){s.model.list.nblMarkets=angular.copy(e),s.ngModel=r.FillUpAutoPopulatedFields(s.model,t,u,s.asForm,s.isValid,s.details,n)})}})}}function v(){r.ShowValidationError(s.model)}function v(){r.ShowValidationError(s.model)}function I(){return r.GetCountryStateCity().then(function(e){s.model.list.country=e,"lead"===s.formType&&(s.model.list.state=e.find(function(e){return"USA"===e.iso3}),s.model.list.state.states=s.model.list.state.states.filter(function(e){return"NATIONWIDE"!==e.name}),s.model.list.state.states.push({id:0,name:"NATIONWIDE",state_code:"N/A",cities:[]}),s.model.selected[newProp.Country]=s.model.list.state.name)})}function E(){return c.stringIsNullUndefinedOrEmpty(s.model.selected[d.OpportunityStatus])?"LEAD"===s.model.selected[u.OpportunityStatus]:"LEAD"===s.model.selected[d.OpportunityStatus]}function S(e){"TASK PIPELINE"!==(c.stringIsNullUndefinedOrEmpty(e.value[d.OpportunityStatus])?e.value[u.OpportunityStatus]:e.value[d.OpportunityStatus])?(s.model.selected[d.AnticipatedGrossRevenue]=c.stringIsNullUndefinedOrEmpty(e.value[d.AnticipatedGrossRevenue])?c.stringIsNullUndefinedOrEmpty(e.value[d.EstGrossEcvRaw])?e.value[u.EstGrossEcvRaw]:e.value[d.EstGrossEcvRaw]:e.value[d.AnticipatedGrossRevenue],s.model.selected[d.AnticipatedNetRevenue]=c.stringIsNullUndefinedOrEmpty(e.value[d.AnticipatedNetRevenue])?c.stringIsNullUndefinedOrEmpty(e.value[d.EstNetEcvRaw])?e.value[u.EstNetEcvRaw]:e.value[d.EstNetEcvRaw]:e.value[d.AnticipatedNetRevenue]):(s.model.selected[d.AnticipatedGrossRevenue]=c.stringIsNullUndefinedOrEmpty(e.value[d.AnticipatedGrossRevenue])?c.stringIsNullUndefinedOrEmpty(e.value[d.TaskGrossEcvRaw])?e.value[u.TaskGrossEcvRaw]:e.value[d.TaskGrossEcvRaw]:e.value[d.AnticipatedGrossRevenue],s.model.selected[d.AnticipatedNetRevenue]=c.stringIsNullUndefinedOrEmpty(e.value[d.AnticipatedNetRevenue])?c.stringIsNullUndefinedOrEmpty(e.value[d.TaskNetEcvRaw])?e.value[u.TaskNetEcvRaw]:e.value[d.TaskNetEcvRaw]:e.value[d.AnticipatedNetRevenue]),s.model.selected[d.AnticipatedMarginPercentOfGross]=e.value[d.AnticipatedMarginPercentOfGross],s.model.selected[d.AnticipatedMarginPercentOfNet]=e.value[d.AnticipatedMarginPercentOfNet],s.model.selected[d.AnticipatedMargin]=e.value[d.AnticipatedMargin]}function N(){s.model.errorSwitchDeliveryMethod=!1,s.model.errorSwitchClient=!1,s.model.errorSwitchOwner=!1,s.model.errorSwitchBusinessLine=!1,s.model.errorSwitchBusinessLineDivision=!1,s.model.list.nblMarkets=[],s.model.list.nblMarketSelected=[{value:null,id:f}],s.model.list.nblMarketLead=[{value:null,email:null,id:f}],s.asForm&&(s.isValid.isFormValid=!0),s.model.selected={}}function A(e,t){void 0!==s.formValidation&&s.formValidation.form.hasOwnProperty(t)&&(s.formValidation.form[t].$invalid=e)}function N(){s.model.selected={},s.model.object.pursuitCostCenterLead=null,s.model.object.proposalTechnicalLead=null,s.model.list.supportingCC=[],s.model.list.otherStaff=[],s.model.list.teamingPartners=[],s.model.list.competitors=[],s.model.object.client=null,s.model.object.division=null,s.model.object.district=null,s.model.object.area=null,s.model.object.costCenter=null,s.model.object.projectManager=null,s.model.object.pursuitManager=null,s.model.object.pa=null,s.model.object.marketingCoordinator=null,s.model.errorSwitchDeliveryMethod=!1,s.model.errorSwitchClient=!1,s.model.errorSwitchOwner=!1,s.model.errorSwitchBusinessLine=!1,s.model.errorSwitchBusinessLineDivision=!1,s.model.showEditValues=!1,s.model.showOriginalValues=!0}function y(){return r.GetAllOracleHierarchyList().then(function(e){void 0!==e&&(s.model.list.division=angular.copy(e))})}function R(){return r.GetDeliveryMethodList().then(function(e){void 0!==e&&e.forEach(function(e){s.model.list.deliveryMethod.push(e.DELIVERY_METHOD)})})}function O(){return r.GetSegmentAreaSectorList().then(function(e){void 0!==e&&(s.model.list.segment=angular.copy(e))})}function C(){return r.GetSegmentServiceTypeList().then(function(e){void 0!==e&&(s.model.list.coreServiceType=angular.copy(e))})}function T(){s.asForm?s.details.ApprovalItemDetail.forEach(function(e){switch(e.ApprovalItemName.EN){case"Direct Client = Private":s.model.selected.WizardClient="Private",s.model.list.clientType=["Private","Regulated"];break;case"Direct Client = Federal":s.model.selected.WizardClient="Federal",s.model.list.clientType=["Public - Federal"],s.model.selected[d.ClientTypeExpected]="Public - Federal";break;case"Direct Client = Public (Non-Federal)":s.model.selected.WizardClient="Public (Non-Federal)",s.model.list.clientType=["Public - Regional/MPO","Public - State/Province","Public - Local/County"];break;case"Owner = Private":s.model.selected.WizardOwner="Private",s.model.list.ownerType=["Private","Regulated"];break;case"Owner = Federal":s.model.selected.WizardOwner="Federal",s.model.list.ownerType=["Public - Federal"],s.model.selected[d.UltimateClientTypeExpected]="Public - Federal";break;case"Owner = Public (Non-Federal)":s.model.selected.WizardOwner="Public (Non-Federal)",s.model.list.ownerType=["Public - Regional/MPO","Public - State/Province","Public - Local/County"]}}):s.details.RequestApprovalItems.forEach(function(e){switch(e.ApprovalItemName.EN){case"Direct Client = Private":s.model.selected.WizardClient="Private",s.model.list.clientType=["Private","Regulated"];break;case"Direct Client = Federal":s.model.selected.WizardClient="Federal",s.model.list.clientType=["Public - Federal"],s.model.selected[d.ClientTypeExpected]="Public - Federal";break;case"Direct Client = Public (Non-Federal)":s.model.selected.WizardClient="Public (Non-Federal)",s.model.list.clientType=["Public - Regional/MPO","Public - State/Province","Public - Local/County"];break;case"Owner = Private":s.model.selected.WizardOwner="Private",s.model.list.ownerType=["Private","Regulated"];break;case"Owner = Federal":s.model.selected.WizardOwner="Federal",s.model.list.ownerType=["Public - Federal"],s.model.selected[d.UltimateClientTypeExpected]="Public - Federal";break;case"Owner = Public (Non-Federal)":s.model.selected.WizardOwner="Public (Non-Federal)",s.model.list.ownerType=["Public - Regional/MPO","Public - State/Province","Public - Local/County"]}})}s.model={prop:d,origPm:null,origPa:null,origPursuit:null,autoProp:u,selected:{},minDate:(new Date).toDateString(),messages:n,errorSwitchDeliveryMethod:!1,errorSwitchClient:!1,errorSwitchOwner:!1,errorSwitchBusinessLine:!1,errorSwitchBusinessLineDivision:!1,showOriginalValues:!0,showEditValues:!1,switchForm:!0,isPublicThresholds:!1,switchField:{projectManager:!1,pa:!1,pursuitManager:!1},clearSwitch:{projectManager:"N",pa:"N",pursuitManager:"N"},object:{client:null,ultimateClient:null,division:null,district:null,area:null,costCenter:null,projectManager:null,pursuitManager:null,proposalManager:null,pic:null,pa:null,segment:null,marketArea:null,marketSector:null,primaryServiceType:null,serviceType:null,marketingCoordinator:null,masterContractAgreement:null},list:{complexity:e.Complexity,marketArea:[],marketSector:[],primaryServiceType:e.PrimaryServiceType,opportunityStatus:e.OpportunityStatus,opportunityStatusNew:e.OpportunityStatusNew,priority:e.Priority,rate:e.Rate,segment:[],serviceType:[],coreServiceType:[],yesNo:e.YesNo,ourRole:e.OurRole,taskOrder:e.TaskOrder,division:[],district:[],area:[],deliveryMethod:[],costCenter:[],country:null,state:null,city:null,clientOwnerType:e.ClientOwnerType,none:e.None,packageType:e.PackageType,percent:e.Percent,ownerType:[],clientType:[],nblMarkets:[],nblMarketSelected:[{value:null,id:f}],nblMarketLead:[{value:null,email:null,id:f}]},objectList:{funding:{total:{Labor:null,Subcontractor:null,DirectExpense:null,TotalFunding:null,NetFunding:null,ManagementReserve:null,TargetMarginDollar:null,TargetMarginPercentOfTotal:null,TargetMarginPercentOfNet:null},list:[]}}},s.switch={ngModel:!0,selected:!0,object:!0,origPa:!0,origPm:!0,origPursuit:!0},s.events={onClickRefreshData:g,onClickShowError:v,onLoad_PopOver:function(e){angular.element(e).popover("show")},onClickPerDOA:function(e){r.ShowDOAError(e,s.details)},addToList:function(e,t){e[t].push({value:null})},deleteItem:function(e,t,n){e[t].splice(n,1)},getTemplate:function(){{if("formal"===s.formType)return"app/views/templates/form-templates/go-no-go-formal-form-template.html";if("preliminary"===s.formType)return"app/views/templates/form-templates/go-no-go-preliminary-form-template.html";if("lead"===s.formType)return"app/views/templates/form-templates/go-no-go-lead-form-template.html"}},onChange_Division:function(e){r.GetDistrictList(s.model,e)},onChange_District:function(e){r.GetAreaList(s.model,e)},onChange_Area:function(e){r.GetCostCenterList(s.model,e)},onChange_CostCenter:function(e){r.GetCompany(s.model,e)},onClick_Warning:v,onChange_Ecv:function(e){var t=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});c.stringIsNullUndefinedOrEmpty(s.model.selected[e.EstSubEcvRaw])&&c.stringIsNullUndefinedOrEmpty(s.model.selected[e.EstNetEcvRaw])&&c.stringIsNullUndefinedOrEmpty(s.model.selected[e.EstDirectExpensesRaw])?(s.model.selected[e.EstGrossEcvRaw]=null,s.model.selected[e.EstGrossEcv]=null):(s.model.selected[e.EstGrossEcvRaw]=(c.stringIsNullUndefinedOrEmpty(s.model.selected[e.EstSubEcvRaw])?0:parseInt(s.model.selected[e.EstSubEcvRaw]))+(c.stringIsNullUndefinedOrEmpty(s.model.selected[e.EstNetEcvRaw])?0:parseInt(s.model.selected[e.EstNetEcvRaw]))+(c.stringIsNullUndefinedOrEmpty(s.model.selected[e.EstDirectExpensesRaw])?0:parseInt(s.model.selected[e.EstDirectExpensesRaw])),s.model.selected[e.EstGrossEcv]=t.format(s.model.selected[e.EstGrossEcvRaw]));computePercentOfGrossECV(s.model)},onChange_WinProb:function(){c.stringIsNullUndefinedOrEmpty(s.model.selected[newProp.Wp])||c.stringIsNullUndefinedOrEmpty(s.model.selected[newProp.Ppp])?s.model.selected[newProp.GoGetPercent]=null:(s.model.selected[newProp.GoGetPercent]=parseInt(s.model.selected[newProp.Wp])/100*(parseInt(s.model.selected[newProp.Ppp])/100)*100,s.model.selected[newProp.GoGetPercent]=s.model.selected[newProp.GoGetPercent].toString().includes(".")?s.model.selected[newProp.GoGetPercent].toFixed(6):s.model.selected[newProp.GoGetPercent])},onChange_Segment:function(){r.GetCascadingToSegmentList(s.model)},onChange_MarketArea:function(){r.GetMarketSectorList(s.model)},onClick_Collaboration:function(e){s.model.list.collaborationSelected.push(e)},onChangeOpportunityStatus:function(){"TASK PIPELINE"===(c.stringIsNullUndefinedOrEmpty(s.model.selected[d.OpportunityStatus])?s.model.selected[u.OpportunityStatus]:s.model.selected[d.OpportunityStatus])?r.ClearEcvValuesTaskPipeLine(s.model,d,"TASK PIPELINE"===s.model.selected[u.OpportunityStatus],!1):r.ClearEcvValuesNotTaskPipeLine(s.model,d,"TASK PIPELINE"===s.model.selected[u.OpportunityStatus],!1)},onChange_OpportunityStatusNew:function(){"TASK PIPELINE"===s.model.selected[newProp.OpportunityStatus]?r.ClearEcvValuesTaskPipeLine(s.model,newProp,!1,!0):r.ClearEcvValuesNotTaskPipeLine(s.model,newProp,!1,!0)},ShowValidationRequestEdits:function(){r.ShowValidationRequestEdits()},onChange_Country:function(e,t){s.model.selected[t.Country]=e.name,e.states=e.states.filter(function(e){return"NATIONWIDE"!==e.name}),e.states.push({id:0,name:"NATIONWIDE",state_code:"N/A",cities:[]})},getMinDateRfpSubmittalfgngpgng:function(){var e=c.stringIsNullUndefinedOrEmpty(s.model.selected[d.RfpIssueDate])?s.model.selected[u.RfpIssueDate]:s.model.selected[d.RfpIssueDate];c.stringIsNullUndefinedOrEmpty(s.model.selected[d.RfpSubmittalDate])?s.model.selected[u.RfpSubmittalDate]:s.model.selected[d.RfpSubmittalDate],c.stringIsNullUndefinedOrEmpty(s.model.selected[d.AnticipatedDecisionDate])?s.model.selected[u.AnticipatedDecisionDate]:s.model.selected[d.AnticipatedDecisionDate],c.stringIsNullUndefinedOrEmpty(s.model.selected[d.AnticipatedStartDate])?s.model.selected[u.AnticipatedStartDate]:s.model.selected[d.AnticipatedStartDate];return c.stringIsNullUndefinedOrEmpty(e)?null:e},getMinExpectedDecisionfgngpgng:function(){var e=c.stringIsNullUndefinedOrEmpty(s.model.selected[d.RfpIssueDate])?s.model.selected[u.RfpIssueDate]:s.model.selected[d.RfpIssueDate],t=c.stringIsNullUndefinedOrEmpty(s.model.selected[d.RfpSubmittalDate])?s.model.selected[u.RfpSubmittalDate]:s.model.selected[d.RfpSubmittalDate];return c.stringIsNullUndefinedOrEmpty(t)?c.stringIsNullUndefinedOrEmpty(e)?s.model.minDate:moment(e)<moment(s.model.minDate)?s.model.minDate:e:moment(t)<moment(s.model.minDate)?s.model.minDate:t},getMinEstStartDatefgngpgng:function(){var e=c.stringIsNullUndefinedOrEmpty(s.model.selected[d.RfpIssueDate])?s.model.selected[u.RfpIssueDate]:s.model.selected[d.RfpIssueDate],t=c.stringIsNullUndefinedOrEmpty(s.model.selected[d.RfpSubmittalDate])?s.model.selected[u.RfpSubmittalDate]:s.model.selected[d.RfpSubmittalDate],n=c.stringIsNullUndefinedOrEmpty(s.model.selected[d.AnticipatedDecisionDate])?s.model.selected[u.AnticipatedDecisionDate]:s.model.selected[d.AnticipatedDecisionDate];return c.stringIsNullUndefinedOrEmpty(n)?c.stringIsNullUndefinedOrEmpty(t)?c.stringIsNullUndefinedOrEmpty(e)?s.model.minDate:moment(e)<moment(s.model.minDate)?s.model.minDate:e:moment(t)<moment(s.model.minDate)?s.model.minDate:t:moment(n)<moment(s.model.minDate)?s.model.minDate:n},clearInvalidDatefgngpgng:function(){var e=c.stringIsNullUndefinedOrEmpty(s.model.selected[d.RfpIssueDate])?s.model.selected[u.RfpIssueDate]:s.model.selected[d.RfpIssueDate],t=c.stringIsNullUndefinedOrEmpty(s.model.selected[d.RfpSubmittalDate])?s.model.selected[u.RfpSubmittalDate]:s.model.selected[d.RfpSubmittalDate],n=c.stringIsNullUndefinedOrEmpty(s.model.selected[d.AnticipatedDecisionDate])?s.model.selected[u.AnticipatedDecisionDate]:s.model.selected[d.AnticipatedDecisionDate],l=c.stringIsNullUndefinedOrEmpty(s.model.selected[d.AnticipatedStartDate])?s.model.selected[u.AnticipatedStartDate]:s.model.selected[d.AnticipatedStartDate],o=c.stringIsNullUndefinedOrEmpty(e)?null:moment(e),r=c.stringIsNullUndefinedOrEmpty(t)?null:moment(t),i=c.stringIsNullUndefinedOrEmpty(n)?null:moment(n),a=c.stringIsNullUndefinedOrEmpty(l)?null:moment(l);null!==o&&null!==r&&r<o&&(s.model.selected[d.RfpSubmittalDate]=null);null!==r&&null!==i&&i<r&&(s.model.selected[d.AnticipatedDecisionDate]=null);null!==i&&null!==a&&a<i&&(s.model.selected[d.AnticipatedStartDate]=null);null!==o&&null!==i&&i<o&&(s.model.selected[d.AnticipatedDecisionDate]=null);null!==o&&null!==a&&a<o&&(s.model.selected[d.AnticipatedStartDate]=null);null!==r&&null!==a&&a<r&&(s.model.selected[d.AnticipatedStartDate]=null)},isTaskPipeLine:function(){return c.stringIsNullUndefinedOrEmpty(s.model.selected[d.OpportunityStatus])?"TASK PIPELINE"===s.model.selected[u.OpportunityStatus]:"TASK PIPELINE"===s.model.selected[d.OpportunityStatus]},formatValue:function(e){var t=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),n=c.stringIsNullUndefinedOrEmpty(e)?"":e.toString().replace("$","").replace(",","").replace(",","").replace(",","");return c.stringIsNullUndefinedOrEmpty(e)?"":t.format(n)}},s.validations={validateSourceData:function(e,t){var n=c.stringIsNullUndefinedOrEmpty(t)?null:t.toUpperCase(),l=c.stringIsNullUndefinedOrEmpty(e)?null:e.toUpperCase();return c.stringIsNullUndefinedOrEmpty(e)&&!c.stringIsNullUndefinedOrEmpty(s.model.selected[u.OpportunityNumber])||null!==n&&n!==l},validateNotRequiredSourceDateData:function(e,t){return null!=t&&""!==t&&t!==e},validateSourceDataIntField:function(e,t){return c.stringIsNullUndefinedOrEmpty(e)&&!c.stringIsNullUndefinedOrEmpty(s.model.selected[u.OpportunityNumber])||null!=t&&""!==t&&parseInt(t)!==parseInt(e)},validateNotRequiredSourceData:function(e,t){var n=c.stringIsNullUndefinedOrEmpty(t)?null:t.toUpperCase(),l=c.stringIsNullUndefinedOrEmpty(e)?null:e.toUpperCase();return null!=t&&""!==t&&n!==l},validateNotRequiredSourceDataIntField:function(e,t){return null!=t&&""!==t&&parseInt(t)!==parseInt(e)},validateOnlyRequiredSourceData:function(e){return c.stringIsNullUndefinedOrEmpty(e)&&!c.stringIsNullUndefinedOrEmpty(s.model.selected[u.OpportunityNumber])},validateForecast:function(e,t){var n=(c.stringIsNullUndefinedOrEmpty(e[t.CurrentFy])?0:e[t.CurrentFy])+(c.stringIsNullUndefinedOrEmpty(e[t.NextFy])?0:e[t.NextFy])+(c.stringIsNullUndefinedOrEmpty(e[t.SubsequentFy])?0:e[t.SubsequentFy]);return 100===parseInt(n)?(e[t.CurrentFy]=null===e[t.CurrentFy]||void 0===e[t.CurrentFy]||""===e[t.CurrentFy]?0:e[t.CurrentFy],e[t.NextFy]=null===e[t.NextFy]||void 0===e[t.NextFy]||""===e[t.NextFy]?0:e[t.NextFy],e[t.SubsequentFy]=null===e[t.SubsequentFy]||void 0===e[t.SubsequentFy]||""===e[t.CurrentFy]?0:e[t.SubsequentFy],A(!1,"FORECAST"),!1):null!==e[t.CurrentFy]&&void 0!==e[t.CurrentFy]&&""!==e[t.CurrentFy]||null!==e[t.NextFy]&&void 0!==e[t.NextFy]&&""!==e[t.NextFy]||null!==e[t.SubsequentFy]&&void 0!==e[t.SubsequentFy]&&""!==e[t.SubsequentFy]?(A(!0,"FORECAST"),!0):(A(!1,"FORECAST"),!1)},validatePercent:function(e,t){return 100<e?(A(!0,t),!0):(A(!1,t),!1)},validateCascadingRequiredField:function(e,t){return c.stringIsNullUndefinedOrEmpty(e)&&null!=t&&""!==t&&JSON.stringify(t)!==JSON.stringify([])},validateOpportunitySelected:function(e,t,n){for(var l=0;l<n.length;l++)if(e.selected[t.OpportunityStatus]===n[l])return!0;return!1},validateSourceDataLeadStatus:function(e,t){return!!c.stringIsNullUndefinedOrEmpty(e)&&E()&&!c.stringIsNullUndefinedOrEmpty(s.model.selected[u.OpportunityNumber])||null!=t&&""!==t&&t!==e},validateSourceDataIntFieldLeadStatus:function(e,t){return!!c.stringIsNullUndefinedOrEmpty(e)&&E()&&!c.stringIsNullUndefinedOrEmpty(s.model.selected[u.OpportunityNumber])||null!=t&&""!==t&&parseInt(t)!==parseInt(e)},validateLeadStatus:E,validateDate:function(e,t,n){var l=moment(e),o=c.stringIsNullUndefinedOrEmpty(t)?moment(t):null,r=null!==c.stringIsNullUndefinedOrEmpty(n)?moment(n):null;{if(c.stringIsNullUndefinedOrEmpty(t)&&c.stringIsNullUndefinedOrEmpty(n))return l;if(c.stringIsNullUndefinedOrEmpty(n)&&!c.stringIsNullUndefinedOrEmpty(t)&&!c.stringIsNullUndefinedOrEmpty(e))return l<o?t:e;if(!(c.stringIsNullUndefinedOrEmpty(t)||c.stringIsNullUndefinedOrEmpty(e)||c.stringIsNullUndefinedOrEmpty(n)))return l<o?r<o?t:n:r<l?e:n;if(c.stringIsNullUndefinedOrEmpty(e)&&!c.stringIsNullUndefinedOrEmpty(t)&&!c.stringIsNullUndefinedOrEmpty(n))return r<o?t:n;if(c.stringIsNullUndefinedOrEmpty(t)&&!c.stringIsNullUndefinedOrEmpty(e)&&!c.stringIsNullUndefinedOrEmpty(n))return r<l?e:n}},validateTaskNetTaskGross:function(e,t,n,l){return parseInt(t)<parseInt(e)&&(o.alertWarning("Warning",'<div align="center"><span>Task Net ECV cannot be greater than Task Gross ECV. Task Net ECV will be cleared.</span>',1e4),!(n.selected[l]=null))},validateNewLineOfBusiness:function(){if(s.asForm)for(var e=0;e<s.details.ApprovalItemDetail.length;e++)if("New Line of Business"===s.details.ApprovalItemDetail[e].ApprovalItemName.EN)return!0;return!1}},function(){if(null!==s.ngModel&&void 0!==s.ngModel){var t={value:angular.copy(JSON.parse(s.ngModel))};s.model.selected=JSON.parse(s.ngModel),p.all([O(),C(),R(),I(),y()]).then(function(e){s.asForm?g(t).then(function(){"am.approvalitems.viewsaveddetails"!==m.current.name&&"am.approvalitems.resubmit"!==m.current.name||S(t),s.ngModel=r.FillUpTwoWayBindFields(s.model,d,t,!0),T()}):(s.model.showEditValues=!1,S(t),s.ngModel=r.FillUpAutoPopulatedFields(s.model,t,u,s.asForm,s.isValid,s.details,t),s.ngModel=r.FillUpTwoWayBindFields(s.model,d,t,!0),T())})}else p.all([O(),C(),R(),I(),y()]).then(function(e){T()})}(),String.prototype.toProperCase=function(){return this.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})},s.removeDivisionNull=function(e){return e.DIVISION_NAME?e:void 0},s.removeDistrictNull=function(e){return e.DISTRICT_NAME?e:void 0},s.removeAreaNull=function(e){return e.AREA_NAME?e:void 0},s.removeCostCenterNull=function(e){return e.COST_CENTER_NAME?e:void 0},s.$watch("details.ApprovalItemSteps",function(){c.objectIsNullorUndefined(s.details)||c.objectIsNullorUndefined(s.details.ApprovalItemSteps)||s.details.ApprovalItemSteps.forEach(function(e){-1031==e.CostPointRoleId&&(s.model.switchField.projectManager=!0,0<e.MainApprovers.length&&null!==s.ngModel?(i.GetApproverByEmail(e.MainApprovers[0].MainApproverEmail,s.model,"projectManager").then(function(){}),s.switch.origPm&&(s.model.origPm=e.MainApprovers[0].MainApproverEmail)):(s.model.object.projectManager=null,s.switch.origPm&&(s.model.origPm=null)),s.switch.origPm=!1),-1032==e.CostPointRoleId&&(s.model.switchField.pa=!0,0<e.MainApprovers.length&&null!==s.ngModel?(i.GetApproverByEmail(e.MainApprovers[0].MainApproverEmail,s.model,"pa").then(function(){}),s.switch.origPa&&(s.model.origPa=e.MainApprovers[0].MainApproverEmail)):(s.model.object.pa=null,s.switch.origPa&&(s.model.origPa=null)),s.switch.origPa=!1),-1033==e.CostPointRoleId&&(s.model.switchField.pursuitManager=!0,0<e.MainApprovers.length&&null!==s.ngModel?(i.GetApproverByEmail(e.MainApprovers[0].MainApproverEmail,s.model,"pursuitManager").then(function(){}),s.switch.origPursuit&&(s.model.origPursuit=e.MainApprovers[0].MainApproverEmail)):(s.model.object.pursuitManager=null,s.switch.origPursuit&&(s.model.origPursuit=null)),s.switch.origPursuit=!1)})},!0),s.$watch("ngModel",function(){null===s.ngModel?(N(),s.switch.ngModel=!0):JSON.parse(s.ngModel)[u.OpportunityNumber]!==s.model.selected[u.OpportunityNumber]||c.stringIsNullUndefinedOrEmpty(JSON.parse(s.ngModel)[u.OpportunityNumber])?s.switch.ngModel=!0:s.switch.ngModel=!1,s.switch.ngModel&&null!==s.ngModel&&(c.stringIsNullUndefinedOrEmpty(JSON.parse(s.ngModel)[u.OpportunityNumber])||g({value:angular.copy(JSON.parse(s.ngModel))}).then(function(){T()}))},!0),s.$watch("model.list.nblMarketLead",function(){s.model.selected[d.NblMarketLead]=c.stringIsNullUndefinedOrEmpty(s.model.list.nblMarketLead)?null:JSON.stringify(s.model.list.nblMarketLead),s.ngModel=JSON.stringify(s.model.selected)},!0),s.$watch("model.list.nblMarketSelected",function(){s.model.selected[d.NblMarkets]=c.stringIsNullUndefinedOrEmpty(s.model.list.nblMarketSelected)?null:JSON.stringify(s.model.list.nblMarketSelected),s.ngModel=JSON.stringify(s.model.selected)},!0),s.$watch("model.selected",function(){s.switch.selected||(i.CalculateAnticipatedMarginPercentGrossForPricing(s.model),i.CalculateAnticipatedMarginPercentNetForPricing(s.model),s.model.selected[u.PaEdited]=c.stringIsNullUndefinedOrEmpty(s.model.object.pa)?null:JSON.stringify(s.model.object.pa),s.model.selected[u.ProjectManagerEdited]=c.stringIsNullUndefinedOrEmpty(s.model.object.projectManager)?null:JSON.stringify(s.model.object.projectManager),s.model.selected[d.PmLevel]=c.stringIsNullUndefinedOrEmpty(s.model.object.projectManager)?null:c.stringIsNullUndefinedOrEmpty(s.model.object.projectManager.PM_LEVEL)?"PM Not a PMAP Participant":s.model.object.projectManager.PM_LEVEL,s.model.selected[u.PursuitManagerEdited]=c.stringIsNullUndefinedOrEmpty(s.model.object.pursuitManager)?null:JSON.stringify(s.model.object.pursuitManager),s.model.selected[d.NblMarketLead]=c.stringIsNullUndefinedOrEmpty(s.model.list.nblMarketLead)?JSON.stringify([{value:null,email:null,id:f}]):JSON.stringify(s.model.list.nblMarketLead),s.model.selected[d.NblMarkets]=c.stringIsNullUndefinedOrEmpty(s.model.list.nblMarketSelected)?null:JSON.stringify(s.model.list.nblMarketSelected),r.StringifyCRMObjects(s.model,d),s.ngModel=JSON.stringify(s.model.selected)),s.switch.selected=!1},!0),s.$watch("model.object",function(){s.switch.object||(s.model.selected[d.ClientType]=c.stringIsNullUndefinedOrEmpty(s.model.object.client)?s.model.selected[d.ClientType]:c.stringIsNullUndefinedOrEmpty(s.model.object.client.UC_TYPE)?s.model.selected[d.ClientType]:s.model.object.client.UC_TYPE,s.model.selected[d.UltimateClientType]=c.stringIsNullUndefinedOrEmpty(s.model.object.ultimateClient)?s.model.selected[d.UltimateClientType]:c.stringIsNullUndefinedOrEmpty(s.model.object.ultimateClient.UC_TYPE)?s.model.selected[d.UltimateClientType]:s.model.object.ultimateClient.UC_TYPE,s.model.selected[d.PmLevel]=c.stringIsNullUndefinedOrEmpty(s.model.object.projectManager)?null:c.stringIsNullUndefinedOrEmpty(s.model.object.projectManager.PM_LEVEL)?"PM Not a PMAP Participant":s.model.object.projectManager.PM_LEVEL,s.model.selected[u.PaEdited]=c.stringIsNullUndefinedOrEmpty(s.model.object.pa)?null:JSON.stringify(s.model.object.pa),s.model.selected[u.ProjectManagerEdited]=c.stringIsNullUndefinedOrEmpty(s.model.object.projectManager)?null:JSON.stringify(s.model.object.projectManager),s.model.selected[u.PursuitManagerEdited]=c.stringIsNullUndefinedOrEmpty(s.model.object.pursuitManager)?null:JSON.stringify(s.model.object.pursuitManager),s.model.list.nblMarketLead=c.stringIsNullUndefinedOrEmpty(s.model.list.nblMarketLead)?[{value:null,email:null,id:f}]:s.model.list.nblMarketLead,s.model.list.nblMarketSelected=c.stringIsNullUndefinedOrEmpty(s.model.list.nblMarketSelected)?null:s.model.list.nblMarketSelected,r.StringifyCRMObjects(s.model,d),s.ngModel=JSON.stringify(s.model.selected)),s.switch.object=!1},!0)}],templateUrl:"app/views/templates/form-templates/pricing-opportunity-form-template.html"}})}(),function(){"use strict";angular.module("myApp").directive("eaNaNpSansOpportunityFormControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",details:"=",formType:"=?",formValidation:"=?"},controller:["$scope","ProjectSetupFormBusiness","AgreementProjectWarFormPropertyNames","FormMessages","astigUtilityService","GngFormBusiness","FormOptions","$q","sweetDialogAlertService","$filter",function(r,i,a,e,s,t,n,u,l,o){r.model={selected:{},prop:a,formType:r.formType,messages:e,minDate:(new Date).toDateString(),withManagementReserve:r.asForm?void 0!==r.details.ApprovalItemDetail.find(function(e){return e.ApprovalItemName.EN.includes("With Management Reserve")}):void 0!==r.details.RequestApprovalItems.find(function(e){return e.ApprovalItemName.EN.includes("With Management Reserve")}),isLblInWorkFlow:!1,isBurdeneCostValid:!0,burdenedCostLimit:null,clearSwitch:{projectManager:"N",pa:"N",client:"N",ultimateClient:"N",projectDirector:"N",pic:"N",td:"N",pb:"N"},object:{client:null,vendor:null,ultimateClient:null,projectManager:null,segment:null,marketArea:null,marketSector:null,serviceType:null,pa:null,projectDirector:null,pic:null,td:null,pb:null,sb:null,lbl:null,pbRef:null,engageGBS:!0},oldValue:{pb:null},list:{segment:[],marketArea:[],marketSector:[],primaryServiceType:n.PrimaryServiceType,serviceType:[],deliveryMethod:[],country:[],state:[],city:null,yesNo:n.YesNo,lbl:[],division:[],vendorFinancialExposure:[],sdl:[{clearSwitch:"N",value:null}],workflowLbl:[],gbsPASupport:[{clearSwitch:"N",value:null,name:null,id:s.guid()}]},objectList:{funding:{total:{Labor:null,Oh:null,Subcontractor:null,DirectExpense:null,NonReimbursableCost:null,TotalFunding:null,NetFunding:null,ManagementReserve:null,TargetMarginDollar:null,TargetMarginPercentOfTotal:null,TargetMarginMultiplier:null},list:[]}}},r.events={onLoad_PopOver:function(e){angular.element(e).popover("show")},onChange_Country:function(e,t){r.model.selected[t.Country]=e.name,e.states=e.states.filter(function(e){return"NATIONWIDE"!==e.name}),e.states.push({id:0,name:"NATIONWIDE",state_code:"N/A",cities:[]})},onChange_Lbl:I,onChange_FundingLbl:function(t){s.stringIsNullUndefinedOrEmpty(t.Lbl.selected)||i.GetApproverForLbl(t.Lbl.selected.EMPLOYEE_NUMBER).then(function(e){t.PA=e,t.ClearSwitch.PA="Y"})},onChange_Segment:function(){t.GetCascadingToSegmentList(r.model)},onClick_AddFunding:function(){i.AddToList(r.model,"funding",r.details.ApprovalItemDetail)},onClick_DeleteFunding:function(e){i.DeleteItem(r.model.objectList,"funding",e)},onChange_MarketArea:function(){t.GetMarketSectorList(r.model)},onChange_Division:function(e){i.GetDistrictList(e)},onChange_District:function(e){i.GetAreaList(e)},onChange_Area:function(e){i.GetCostCenterList(e)},onChange_CostCenter:function(t){s.stringIsNullUndefinedOrEmpty(t.Level4.selected)||i.GetLocalBusinessLine(t.Level4.selected.COST_CENTER_ID,"nanpSansOpportunitywf"===r.formType|"nanpSansOpportunity"===r.formType||"nanpSansOpportunitywar"===r.formType).then(function(e){t.Lbl.list=angular.copy(e)})},calculateNetFunding:function(e){i.CalculateNetFunding(e)},calculateTargetMargin:function(e){i.CalculateTargetMargin(e)},calculateTargetMarginPercentOfTotal:function(e){i.CalculateTargetMarginPercentOfTotal(e)},calculateTargetMarginPercentOfNetFunding:function(e){i.CalculateTargetMarginPercentOfNetFunding(e)},calculateAnticipatedMarginPercentNetForPricing:function(){i.CalculateAnticipatedMarginPercentNetForPricing(r.model)},calculateAnticipatedMarginPercentGrossForPricing:function(){i.CalculateAnticipatedMarginPercentGrossForPricing(r.model)},calculateTargetMultiplier:function(e){i.CalculateTargetMultiplier(e)},calculateTotal:function(e){i.CalculateTotal(r.model.objectList.funding,e)},calculateTotalValues:function(e){i.CalculateTotalValues(r.model,e)},formatValue:function(e){var t=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),n=s.stringIsNullUndefinedOrEmpty(e)?"":e.toString().replace("$","").replace(",","").replace(",","").replace(",","");return s.stringIsNullUndefinedOrEmpty(e)?"":t.format(n)},onClick_ModificationBeingSigned:function(e){"NO"===e&&(r.model.list.vendorFinancialExposure=[],r.model.object.vendor=null,r.model.selected[a.WorkWithSubPreviously]=null)},onClick_HasWspWorked:function(e){"YES"===e?r.model.list.vendorFinancialExposure=[]:"NO"===e&&(r.model.object.vendor=null)},deleteItem:function(e,t,n){e[t].splice(e.findIndex(function(e){e.name}),1),i.setClearSwitch(e,_prop)},deleteGBS:function(e,t,n){e[t]=e[t].filter(function(e){return e.id!==n})},addToList:function(e,t,n){var l="Y"===n?null:{OBJECT_NAME:null,OBJECT_ID:null,COST_CENTER_ID:null,OBJECT_DISPLAY:null,LOOKUP:null};e[t].push({value:l,financialExposure:null,isExist:n})},clearFunding:function(){r.model.objectList.funding={total:{Labor:null,Oh:null,Subcontractor:null,DirectExpense:null,NonReimbursableCost:null,TotalFunding:null,NetFunding:null,ManagementReserve:null,TargetMarginDollar:null,TargetMarginPercentOfTotal:null,TargetMarginPercentOfNet:null,TargetMarginMultiplier:null},list:[]},i.AddToList(r.model,"funding",r.details.ApprovalItemDetail),r.model.withManagementReserve&&i.AddManagementReserve(r.model,"funding",r.details.ApprovalItemDetail)},setMRDefault:S,onChange_BurdenedCost:function(){N()},showBurdenedCostError:function(){l.alertConfirm("Request Warning","<div><span>Burdened Cost should be "+r.model.burdenedCostLimit+"</span></div>",function(){r.$apply()},function(){},"Ok","",!1)},addGbsSupport:function(e,t){e[t].push({clearSwitch:"N",value:null,name:null,id:s.guid()})}},r.validations={validateCascadingRequiredField:function(e,t){return s.stringIsNullUndefinedOrEmpty(e)&&null!=t&&""!==t&&JSON.stringify(t)!==JSON.stringify([])}};var c={ngModel:!0,object:!0,objectList:!0,selected:!0,fundingList:!0};function d(){return t.GetSegmentAreaSectorList().then(function(e){void 0!==e&&(r.model.list.segment=angular.copy(e))})}function p(){return t.GetSegmentServiceTypeList().then(function(e){void 0!==e&&(r.model.list.coreServiceType=angular.copy(e))})}function m(){return t.GetDeliveryMethodList().then(function(e){void 0!==e&&e.forEach(function(e){r.model.list.deliveryMethod.push(e.DELIVERY_METHOD)})})}function f(){return t.GetCountryStateCity().then(function(e){r.model.list.country=e,r.model.list.state=e.find(function(e){return"USA"===e.iso3}),r.model.list.state.states=r.model.list.state.states.filter(function(e){return"NATIONWIDE"!==e.name}),r.model.list.state.states.push({id:0,name:"NATIONWIDE",state_code:"N/A",cities:[]}),r.model.selected[a.Country]=angular.copy(r.model.list.state.name)})}function g(){return t.GetAllOracleHierarchyList("nanpSansOpportunitywf"!==r.formType&&"nanpSansOpportunity"!==r.formType&&"nanpSansOpportunitywar"!==r.formType).then(function(e){void 0!==e&&(r.model.list.division=angular.copy(e),i.AddToList(r.model,"funding",r.details.ApprovalItemDetail),r.model.withManagementReserve&&i.AddManagementReserve(r.model,"funding",r.details.ApprovalItemDetail))})}function v(){r.model.list.lbl=[],r.model.list.city=null,r.model.object.projectManager=null,r.model.object.pa=null,r.model.object.projectDirector=null,r.model.object.pb=null,r.model.object.sb=null,r.model.object.td=null,r.model.object.lbl=null,r.model.object.client=null,r.model.object.ultimateClient=null,r.model.object.segment=null,r.model.object.marketArea=null,r.model.object.marketSector=null,r.model.object.serviceType=null,r.model.list.sdl=[{clearSwitch:"N",value:null}],r.model.list.gbsPASupport=[{clearSwitch:"N",value:null,name:null,id:s.guid()}],r.model.objectList.funding={total:{Labor:null,Oh:null,Subcontractor:null,DirectExpense:null,NonReimbursableCost:null,TotalFunding:null,NetFunding:null,ManagementReserve:null,TargetMarginDollar:null,TargetMarginPercentOfTotal:null,TargetMarginPercentOfNet:null,TargetMarginMultiplier:null},list:[]},r.model.selected={},r.model.selected[a.ContractClassification]="eanpSansOpportunity"===r.formType||"eanpSansOpportunitywf"===r.formType||"eanpSansOpportunitywar"===r.formType?"TASK ORDER":null,i.AddToList(r.model,"funding",r.details.ApprovalItemDetail),r.model.withManagementReserve&&i.AddManagementReserve(r.model,"funding",r.details.ApprovalItemDetail)}function I(){E({ROLE_LIST:angular.toJson(["1356","991","1343"]),COST_CENTER_ID:r.model.selected[a.CostCenterId],OBJECT_ID:null,LOOKUP:null,TABLEDATAROLEID:r.model.object.lbl.TableDataRoleId}),i.SetDefaultLblInFunding(r.model,JSON.parse(r.ngModel))}function E(e){i.GetKeyRoles(e).then(function(e){if(!s.stringIsNullUndefinedOrEmpty(e)){!function(e){for(var t=0;t<e.length;t++)switch(e[t].RoleId){case"216":r.model.selected[a.Rol]=null;break;case"257":r.model.selected[a.Rpa]=null;break;case"321":r.model.selected[a.Dol]=null;break;case"991":r.model.selected[a.Dbl]=null;break;case"996":r.model.selected[a.Dfl]=null;break;case"1000":r.model.selected[a.Dpa]=null;break;case"1356":r.model.selected[a.Pdm]=null;break;case"1686":r.model.selected[a.Rfl]=null;break;case"221":r.model.selected[a.Rpdl]=null;break;case"1922":r.model.selected[a.Sb]=null,r.model.object.sb=null;break;case"-1002":r.model.selected[a.Pb]=null,r.model.object.pb=null,r.model.object.pbRef=null;break;case"1343":r.model.selected[a.Sdl]=null,r.model.list.sdl=[{clearSwitch:"N",value:null}];break;case"1959":r.model.selected[a.GBSPAUSLead]=null;break;case"1958":r.model.selected[a.GBSPARegionalLead]=null;break;case"1984":r.model.selected[a.GBSPASupport]=null,r.model.list.gbsPASupport=[{clearSwitch:"N",value:null,name:null,id:s.guid()}]}}(e);for(var t=0;t<e.length;t++)switch(e[t].RoleId){case"216":r.model.selected[a.Rol]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Rol])?e[t].MemberDisplayName:r.model.selected[a.Rol]+"<br/>"+e[t].MemberDisplayName;break;case"257":r.model.selected[a.Rpa]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Rpa])?e[t].MemberDisplayName:r.model.selected[a.Rpa]+"<br/>"+e[t].MemberDisplayName;break;case"321":r.model.selected[a.Dol]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Dol])?e[t].MemberDisplayName:r.model.selected[a.Dol]+"<br/>"+e[t].MemberDisplayName;break;case"991":r.model.selected[a.Dbl]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Dbl])?e[t].MemberDisplayName:r.model.selected[a.Dbl]+"<br/>"+e[t].MemberDisplayName;break;case"996":r.model.selected[a.Dfl]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Dfl])?e[t].MemberDisplayName:r.model.selected[a.Dfl]+"<br/>"+e[t].MemberDisplayName;break;case"1000":r.model.selected[a.Dpa]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Dpa])?e[t].MemberDisplayName:r.model.selected[a.Dpa]+"<br/>"+e[t].MemberDisplayName;break;case"1356":r.model.selected[a.Pdm]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Pdm])?e[t].MemberDisplayName:r.model.selected[a.Pdm]+"<br/>"+e[t].MemberDisplayName;break;case"1686":r.model.selected[a.Rfl]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Rfl])?e[t].MemberDisplayName:r.model.selected[a.Rfl]+"<br/>"+e[t].MemberDisplayName;break;case"221":r.model.selected[a.Rpdl]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Rpdl])?e[t].MemberDisplayName:r.model.selected[a.Rpdl]+"<br/>"+e[t].MemberDisplayName;break;case"1922":r.model.selected[a.Sb]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Sb])?e[t].MemberDisplayName:r.model.selected[a.Sb]+"<br/>"+e[t].MemberDisplayName,i.GetApproverByEmail(e[t].MemberEmail,r.model,"sb").then(function(){});break;case"-1002":"nanpSansOpportunitywar"!==r.formType&&"nanpSansOpportunity"!==r.formType&&"nanpSansOpportunitywf"!==r.formType&&(i.GetApproverByEmail(e[t].MemberEmail,r.model,"pb").then(function(){}),i.GetApproverByEmail(e[t].MemberEmail,r.model,"pbRef").then(function(){}));break;case"1343":i.GetApproverByEmail(e[t].MemberEmail,r.model,"sdl",!0).then(function(){1<r.model.list.sdl.length&&(r.model.list.sdl=r.model.list.sdl.filter(function(e){return null!==e.value}))});break;case"1958":r.model.selected[a.GBSPARegionalLead]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.GBSPARegionalLead])?e[t].MemberDisplayName:r.model.selected[a.GBSPARegionalLead]+"<br/>"+e[t].MemberDisplayName;break;case"1959":r.model.selected[a.GBSPAUSLead]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.GBSPAUSLead])?e[t].MemberDisplayName:r.model.selected[a.GBSPAUSLead]+"<br/>"+e[t].MemberDisplayName;break;case"1984":i.GetApproverByEmail(e[t].MemberEmail,r.model,"gbsPASupport").then(function(){1<r.model.list.gbsPASupport.length&&(r.model.list.gbsPASupport=r.model.list.gbsPASupport.filter(function(e){return null!==e.value}))})}r.model.object.pb=s.stringIsNullUndefinedOrEmpty(r.model.object.pb)?null:"Y"===r.model.object.pb.ISACTIVE?r.model.object.pb:null,r.model.clearSwitch.pb="Y"}})}function S(){r.model.withManagementReserve&&1<r.model.objectList.funding.list.length&&(r.model.objectList.funding.list[1].Level1.selected=r.model.objectList.funding.list[0].Level1.selected,r.model.objectList.funding.list[1].Level2.selected=r.model.objectList.funding.list[0].Level2.selected,r.model.objectList.funding.list[1].Level3.selected=r.model.objectList.funding.list[0].Level3.selected,r.model.objectList.funding.list[1].Level4.selected=r.model.objectList.funding.list[0].Level4.selected,r.model.objectList.funding.list[1].Lbl.selected=r.model.objectList.funding.list[0].Lbl.selected,r.model.objectList.funding.list[1].TargetMarginDollar=s.stringIsNullUndefinedOrEmpty(r.model.objectList.funding.list[1].ManagementReserve)?null:-1*parseFloat(r.model.objectList.funding.list[1].ManagementReserve),r.model.objectList.funding.list[1].PA=r.model.objectList.funding.list[0].PA,r.model.objectList.funding.list[1].FundingSource.selected=r.model.objectList.funding.list[0].FundingSource.selected,r.model.objectList.funding.list[1].ProjectType.selected=r.model.objectList.funding.list[0].ProjectType.selected)}function N(){if(r.model.isBurdeneCostValid=!0,r.model.burdenedCostLimit=!0,r.asForm&&!s.stringIsNullUndefinedOrEmpty(r.details.ApprovalItemDetail)){var e=r.details.ApprovalItemDetail[0].ApprovalItemLabel.substring(r.details.ApprovalItemDetail[0].ApprovalItemLabel.indexOf("$"),r.details.ApprovalItemDetail[0].ApprovalItemLabel.length);switch(e.substring(0,e.indexOf(",")+1).replace(",","")){case"$25K":r.model.burdenedCostLimit="<$25K",r.model.isBurdeneCostValid=!!s.stringIsNullUndefinedOrEmpty(r.model.selected[a.BurdenedCost])||parseFloat(r.model.selected[a.BurdenedCost])<25e3;break;case"$25K but <$100K":r.model.burdenedCostLimit="≥$25K but <$100K",r.model.isBurdeneCostValid=!!s.stringIsNullUndefinedOrEmpty(r.model.selected[a.BurdenedCost])||25e3<=parseFloat(r.model.selected[a.BurdenedCost])&&parseFloat(r.model.selected[a.BurdenedCost])<1e5;break;case"$100K but <$250K":r.model.burdenedCostLimit="≥$100K but <$250K",r.model.isBurdeneCostValid=!!s.stringIsNullUndefinedOrEmpty(r.model.selected[a.BurdenedCost])||1e5<=parseFloat(r.model.selected[a.BurdenedCost])&&parseFloat(r.model.selected[a.BurdenedCost])<25e4;break;case"$250K but <$500K":r.model.burdenedCostLimit="≥$250K but <$500K",r.model.isBurdeneCostValid=!!s.stringIsNullUndefinedOrEmpty(r.model.selected[a.BurdenedCost])||25e4<=parseFloat(r.model.selected[a.BurdenedCost])&&parseFloat(r.model.selected[a.BurdenedCost])<5e5;break;case"$500K":r.model.burdenedCostLimit="≥$500K",r.model.isBurdeneCostValid=!!s.stringIsNullUndefinedOrEmpty(r.model.selected[a.BurdenedCost])||5e5<=parseFloat(r.model.selected[a.BurdenedCost])}}}!function(){if(N(),null!==r.ngModel&&void 0!==r.ngModel){var o={value:angular.copy(JSON.parse(r.ngModel))};"eanpSansOpportunitywf"===r.formType||"eanpSansOpportunity"===r.formType||"eanpSansOpportunitywar"===r.formType?s.stringIsNullUndefinedOrEmpty(JSON.parse(r.ngModel)[a.ObjectNumber])?u.all([d(),p(),m(),f(),g()]).then(function(e){}):(r.model.selected=angular.copy(o.value),u.all([d(),p(),m(),f(),g()]).then(function(e){var t=[];if("eanpSansOpportunitywf"===r.formType){o.value[a.Funding]=s.stringIsNullUndefinedOrEmpty(o.value[a.Funding])?null:JSON.parse(o.value[a.Funding]),o.value[a.Funding].list=JSON.parse(o.value[a.Funding].list);for(var n=0;n<o.value[a.Funding].list.length;n++){var l=s.stringIsNullUndefinedOrEmpty(o.value[a.Funding].list[n].Level4.selected)?0:JSON.parse(o.value[a.Funding].list[n].Level4.selected).COST_CENTER_ID;t.push(i.AssignLBL(l,o.value[a.Funding].list[n].Lbl,"nanpSansOpportunitywf"===r.formType|"nanpSansOpportunity"===r.formType||"nanpSansOpportunitywar"===r.formType))}}0<t.length?u.all(t).then(function(e){i.GetLocalBusinessLine(o.value[a.CostCenterId],"nanpSansOpportunitywf"===r.formType|"nanpSansOpportunity"===r.formType||"nanpSansOpportunitywar"===r.formType).then(function(e){r.model.list.lbl=angular.copy(e),r.ngModel=i.FillupAutopopulatedFields(r.model,a,o,r.formType,r.details.ApprovalItemDetail)})}):i.GetLocalBusinessLine(o.value[a.CostCenterId],"nanpSansOpportunitywf"===r.formType|"nanpSansOpportunity"===r.formType||"nanpSansOpportunitywar"===r.formType).then(function(e){r.model.list.lbl=angular.copy(e),r.ngModel=i.FillupAutopopulatedFields(r.model,a,o,r.formType,r.details.ApprovalItemDetail)})})):u.all([d(),p(),m(),f(),g()]).then(function(e){var t=[];if("nanpSansOpportunitywf"===r.formType&&!s.stringIsNullUndefinedOrEmpty(o.value[a.Funding])){o.value[a.Funding]=JSON.parse(o.value[a.Funding]),o.value[a.Funding].list=JSON.parse(o.value[a.Funding].list);for(var n=0;n<o.value[a.Funding].list.length;n++){var l=s.stringIsNullUndefinedOrEmpty(o.value[a.Funding].list[n].Level4.selected)?0:JSON.parse(o.value[a.Funding].list[n].Level4.selected).COST_CENTER_ID;t.push(i.AssignLBL(l,o.value[a.Funding].list[n].Lbl,"nanpSansOpportunitywf"===r.formType|"nanpSansOpportunity"===r.formType||"nanpSansOpportunitywar"===r.formType))}}0<t.length?u.all(t).then(function(e){r.ngModel=i.FillUpTwoWayBindFields(r.model,a,o,r.formType,r.details.ApprovalItemDetail)}):r.ngModel=i.FillUpTwoWayBindFields(r.model,a,o,r.formType,r.details.ApprovalItemDetail)})}else u.all([d(),p(),m(),f()],g()).then(function(e){})}(),String.prototype.toProperCase=function(){return this.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})},r.$watch("model.list.sdl",function(){r.model.selected[a.Sdl]=s.stringIsNullUndefinedOrEmpty(r.model.list.sdl)?null:JSON.stringify(r.model.list.sdl),r.ngModel=JSON.stringify(r.model.selected)},!0),r.$watch("model.list.gbsPASupport",function(){r.model.selected[a.GBSPASupport]=s.stringIsNullUndefinedOrEmpty(r.model.list.gbsPASupport)?null:JSON.stringify(o("orderBy")(r.model.list.gbsPASupport,function(e){return e.name})),r.ngModel=JSON.stringify(r.model.selected)},!0),r.$watch("model.selected",function(){c.selected||("nanpSansOpportunitywf"===r.formType||"nanpSansOpportunity"===r.formType||"nanpSansOpportunitywar"===r.formType?(r.model.selected[a.Client]=s.stringIsNullUndefinedOrEmpty(r.model.object.client)?null:JSON.stringify(r.model.object.client),r.model.selected[a.UltimateClient]=s.stringIsNullUndefinedOrEmpty(r.model.object.ultimateClient)?null:JSON.stringify(r.model.object.ultimateClient),r.model.selected[a.ClientType]=s.stringIsNullUndefinedOrEmpty(r.model.object.client)?null:s.stringIsNullUndefinedOrEmpty(r.model.object.client.UC_TYPE)?r.model.selected[a.ClientType]:r.model.object.client.UC_TYPE,r.model.selected[a.UltimateClientType]=s.stringIsNullUndefinedOrEmpty(r.model.object.ultimateClient)?null:s.stringIsNullUndefinedOrEmpty(r.model.object.ultimateClient.UC_TYPE)?r.model.selected[a.UltimateClientType]:r.model.object.ultimateClient.UC_TYPE,r.model.selected[a.ProjectManager]=s.stringIsNullUndefinedOrEmpty(r.model.object.projectManager)?null:JSON.stringify(r.model.object.projectManager),r.model.selected[a.PA]=s.stringIsNullUndefinedOrEmpty(r.model.object.pa)?null:JSON.stringify(r.model.object.pa),r.model.selected[a.MarketArea]=s.stringIsNullUndefinedOrEmpty(r.model.object.marketArea)?null:JSON.stringify(r.model.object.marketArea),r.model.selected[a.ServiceType]=s.stringIsNullUndefinedOrEmpty(r.model.object.serviceType)?null:JSON.stringify(r.model.object.serviceType),r.model.selected[a.MarketSector]=s.stringIsNullUndefinedOrEmpty(r.model.object.marketSector)?null:JSON.stringify(r.model.object.marketSector),r.model.selected[a.Segments]=s.stringIsNullUndefinedOrEmpty(r.model.object.segment)?null:JSON.stringify(r.model.object.segment)):(r.model.selected[a.ClientEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.client)?null:JSON.stringify(r.model.object.client),r.model.selected[a.UltimateClientEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.ultimateClient)?null:JSON.stringify(r.model.object.ultimateClient),r.model.selected[a.ClientTypeEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.client)?null:s.stringIsNullUndefinedOrEmpty(r.model.object.client.UC_TYPE)?r.model.selected[a.ClientType]:r.model.object.client.UC_TYPE,r.model.selected[a.UltimateClientTypeEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.ultimateClient)?null:s.stringIsNullUndefinedOrEmpty(r.model.object.ultimateClient.UC_TYPE)?r.model.selected[a.UltimateClientType]:r.model.object.ultimateClient.UC_TYPE,r.model.selected[a.ProjectManagerEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.projectManager)?null:JSON.stringify(r.model.object.projectManager),r.model.selected[a.PAEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.pa)?null:JSON.stringify(r.model.object.pa),r.model.selected[a.MarketAreaEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.marketArea)?null:JSON.stringify(r.model.object.marketArea),r.model.selected[a.ServiceTypeEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.serviceType)?null:JSON.stringify(r.model.object.serviceType),r.model.selected[a.MarketSectorEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.marketSector)?null:JSON.stringify(r.model.object.marketSector),r.model.selected[a.SegmentsEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.segment)?null:JSON.stringify(r.model.object.segment)),r.model.selected[a.Pb]=s.stringIsNullUndefinedOrEmpty(r.model.object.pb)?null:JSON.stringify(r.model.object.pb),r.model.selected[a.SbRef]=s.stringIsNullUndefinedOrEmpty(r.model.object.sb)?null:JSON.stringify(r.model.object.sb),r.model.selected[a.ProjectDirector]=s.stringIsNullUndefinedOrEmpty(r.model.object.projectDirector)?null:JSON.stringify(r.model.object.projectDirector),r.model.selected[a.Sdl]=s.stringIsNullUndefinedOrEmpty(r.model.list.sdl)?[{clearSwitch:"N",value:null}]:JSON.stringify(r.model.list.sdl),r.model.selected[a.GBSPASupport]=s.stringIsNullUndefinedOrEmpty(r.model.list.gbsPASupport)?JSON.stringify([{clearSwitch:"N",value:null,name:null,id:s.guid()}]):JSON.stringify(o("orderBy")(r.model.list.gbsPASupport,function(e){return e.name})),r.model.selected[a.Td]=s.stringIsNullUndefinedOrEmpty(r.model.object.td)?null:JSON.stringify(r.model.object.td),r.model.selected[a.PmLevel]=s.stringIsNullUndefinedOrEmpty(r.model.object.projectManager)?null:s.stringIsNullUndefinedOrEmpty(r.model.object.projectManager.PM_LEVEL)?"PM Not a PMAP Participant":r.model.object.projectManager.PM_LEVEL,r.model.selected[a.Country]=s.stringIsNullUndefinedOrEmpty(r.model.list.state)?null:r.model.list.state.name,r.model.selected[a.EngageGBS]=r.model.object.engageGBS?"YES":"NO","nanpSansOpportunitywf"!==r.formType&&(r.model.selected[a.Lbl]=s.stringIsNullUndefinedOrEmpty(r.model.object.lbl)?null:JSON.stringify(r.model.object.lbl)),"eanpSansOpportunitywf"!==r.formType&&"nanpSansOpportunitywf"!==r.formType||(i.CalculateTotalValues(r.model,a.AnticipatedGrossRevenueVariance),i.CalculateTotalValues(r.model,a.AnticipatedMarginPercentOfGross),i.CalculateTotalValues(r.model,a.AnticipatedNetRevenueVariance),i.CalculateTotalValues(r.model,a.AnticipatedMarginPercentOfNet),i.CalculateTotalValues(r.model,a.AnticipatedMarginVariance),i.CalculateTotalValues(r.model,a.AnticipatedMarginPercentOfGrossVariance),i.CalculateTotalValues(r.model,a.AnticipatedMarginPercentOfNetVariance),i.CalculateTotalValues(r.model,a.TotalAgreementFunding),i.StringiFyFundingObject(r.model)),r.ngModel=JSON.stringify(r.model.selected)),c.selected=!1},!0),r.$watch("model.object",function(){c.object||("nanpSansOpportunitywf"===r.formType||"nanpSansOpportunity"===r.formType||"nanpSansOpportunitywar"===r.formType?(r.model.selected[a.Client]=s.stringIsNullUndefinedOrEmpty(r.model.object.client)?null:JSON.stringify(r.model.object.client),r.model.selected[a.UltimateClient]=s.stringIsNullUndefinedOrEmpty(r.model.object.ultimateClient)?null:JSON.stringify(r.model.object.ultimateClient),r.model.selected[a.ClientType]=s.stringIsNullUndefinedOrEmpty(r.model.object.client)?null:s.stringIsNullUndefinedOrEmpty(r.model.object.client.UC_TYPE)?r.model.selected[a.ClientType]:r.model.object.client.UC_TYPE,r.model.selected[a.UltimateClientType]=s.stringIsNullUndefinedOrEmpty(r.model.object.ultimateClient)?null:s.stringIsNullUndefinedOrEmpty(r.model.object.ultimateClient.UC_TYPE)?r.model.selected[a.UltimateClientType]:r.model.object.ultimateClient.UC_TYPE,r.model.selected[a.ProjectManager]=s.stringIsNullUndefinedOrEmpty(r.model.object.projectManager)?null:JSON.stringify(r.model.object.projectManager),r.model.selected[a.PA]=s.stringIsNullUndefinedOrEmpty(r.model.object.pa)?null:JSON.stringify(r.model.object.pa),r.model.selected[a.PmLevel]=s.stringIsNullUndefinedOrEmpty(r.model.object.projectManager)?null:s.stringIsNullUndefinedOrEmpty(r.model.object.projectManager.PM_LEVEL)?"PM Not a PMAP Participant":r.model.object.projectManager.PM_LEVEL,r.model.selected[a.MarketArea]=s.stringIsNullUndefinedOrEmpty(r.model.object.marketArea)?null:JSON.stringify(r.model.object.marketArea),r.model.selected[a.ServiceType]=s.stringIsNullUndefinedOrEmpty(r.model.object.serviceType)?null:JSON.stringify(r.model.object.serviceType),r.model.selected[a.MarketSector]=s.stringIsNullUndefinedOrEmpty(r.model.object.marketSector)?null:JSON.stringify(r.model.object.marketSector),r.model.selected[a.Segments]=s.stringIsNullUndefinedOrEmpty(r.model.object.segment)?null:JSON.stringify(r.model.object.segment)):(r.model.selected[a.ClientEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.client)?null:JSON.stringify(r.model.object.client),r.model.selected[a.UltimateClientEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.ultimateClient)?null:JSON.stringify(r.model.object.ultimateClient),r.model.selected[a.ClientTypeEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.client)?null:s.stringIsNullUndefinedOrEmpty(r.model.object.client.UC_TYPE)?r.model.selected[a.ClientType]:r.model.object.client.UC_TYPE,r.model.selected[a.UltimateClientTypeEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.ultimateClient)?null:s.stringIsNullUndefinedOrEmpty(r.model.object.ultimateClient.UC_TYPE)?r.model.selected[a.UltimateClientType]:r.model.object.ultimateClient.UC_TYPE,r.model.selected[a.ProjectManagerEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.projectManager)?null:JSON.stringify(r.model.object.projectManager),r.model.selected[a.PAEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.pa)?null:JSON.stringify(r.model.object.pa),r.model.selected[a.PmLevelEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.projectManager)?null:s.stringIsNullUndefinedOrEmpty(r.model.object.projectManager.PM_LEVEL)?"PM Not a PMAP Participant":r.model.object.projectManager.PM_LEVEL,r.model.selected[a.MarketAreaEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.marketArea)?null:JSON.stringify(r.model.object.marketArea),r.model.selected[a.ServiceTypeEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.serviceType)?null:JSON.stringify(r.model.object.serviceType),r.model.selected[a.MarketSectorEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.marketSector)?null:JSON.stringify(r.model.object.marketSector),r.model.selected[a.SegmentsEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.segment)?null:JSON.stringify(r.model.object.segment)),null!==r.ngModel&&"N"!==r.model.oldValue.pb&&(r.model.object.pbRef=s.stringIsNullUndefinedOrEmpty(r.model.object.pbRef)?null:"Y"===r.model.object.pbRef.ISACTIVE?r.model.object.pbRef:null,r.model.object.pb=s.stringIsNullUndefinedOrEmpty(r.model.object.pb)?null:"Y"===r.model.object.pb.ISACTIVE?r.model.object.pb:null),r.model.list.sdl=s.stringIsNullUndefinedOrEmpty(r.model.list.sdl)?[{clearSwitch:"N",value:null}]:r.model.list.sdl,r.model.list.gbsPASupport=s.stringIsNullUndefinedOrEmpty(r.model.list.gbsPASupport)?[{clearSwitch:"N",value:null,name:null,id:s.guid()}]:r.model.list.gbsPASupport,r.model.selected[a.Pb]=s.stringIsNullUndefinedOrEmpty(r.model.object.pb)?null:JSON.stringify(r.model.object.pb),r.model.selected[a.SbRef]=s.stringIsNullUndefinedOrEmpty(r.model.object.sb)?null:JSON.stringify(r.model.object.sb),r.model.selected[a.ProjectDirector]=s.stringIsNullUndefinedOrEmpty(r.model.object.projectDirector)?null:JSON.stringify(r.model.object.projectDirector),r.model.selected[a.Td]=s.stringIsNullUndefinedOrEmpty(r.model.object.td)?null:JSON.stringify(r.model.object.td),r.model.selected[a.Pb]=s.stringIsNullUndefinedOrEmpty(r.model.object.pb)?null:JSON.stringify(r.model.object.pb),r.model.selected[a.Country]=s.stringIsNullUndefinedOrEmpty(r.model.list.state)?null:r.model.list.state.name,r.model.selected[a.EngageGBS]=r.model.object.engageGBS?"YES":"NO","nanpSansOpportunitywf"!==r.formType&&(r.model.selected[a.Lbl]=s.stringIsNullUndefinedOrEmpty(r.model.object.lbl)?null:JSON.stringify(r.model.object.lbl)),"nanpSansOpportunitywf"!==r.model.formType&&"eanpSansOpportunitywf"!==r.model.formType||i.StringiFyFundingObject(r.model),r.ngModel=JSON.stringify(r.model.selected)),c.object=!1},!0),r.$watch("model.object.pa",function(){"nanpSansOpportunitywf"!==r.formType&&"nanpSansOpportunitywf"!==r.formType||(i.SetDefaultPAinFunding(r.model),S())},!0),r.$watch("model.objectList",function(){c.objectList||"nanpSansOpportunitywf"!==r.model.formType&&"eanpSansOpportunitywf"!==r.model.formType||(i.CalculateNetFunding(r.model.objectList.funding.total),i.CalculateTargetMargin(r.model.objectList.funding.total),r.model.withManagementReserve&&(i.CalculateMRTargetMargin(r.model.objectList.funding),i.CalculateMRTargetMarginDollar(r.model.objectList.funding)),i.CalculateTargetMarginPercentOfTotal(r.model.objectList.funding.total),i.CalculateTargetMarginPercentOfNetFunding(r.model.objectList.funding.total),i.CalculateTargetMultiplier(r.model.objectList.funding.total),i.CalculateTotalValues(r.model,a.AnticipatedGrossRevenueVariance),i.CalculateTotalValues(r.model,a.AnticipatedMarginPercentOfGross),i.CalculateTotalValues(r.model,a.AnticipatedNetRevenueVariance),i.CalculateTotalValues(r.model,a.AnticipatedMarginPercentOfNet),i.CalculateTotalValues(r.model,a.AnticipatedMarginVariance),i.CalculateTotalValues(r.model,a.AnticipatedMarginPercentOfGrossVariance),i.CalculateTotalValues(r.model,a.AnticipatedMarginPercentOfNetVariance),i.CalculateTotalValues(r.model,a.TotalAgreementFunding),i.StringiFyFundingObject(r.model),r.ngModel=JSON.stringify(r.model.selected)),c.objectList=!1},!0),r.$watch("ngModel",function(){if("eanpSansOpportunitywf"===r.formType||"eanpSansOpportunity"===r.formType||"eanpSansOpportunitywar"===r.formType)null===r.ngModel?(v(),"eanpSansOpportunitywf"===r.formType&&i.ClearOracleHierarchy(r.model),c.ngModel=!0):JSON.parse(r.ngModel)[a.ObjectNumber]!==r.model.selected[a.ObjectNumber]||s.stringIsNullUndefinedOrEmpty(JSON.parse(r.ngModel)[a.ObjectNumber])?("eanpSansOpportunitywf"===r.formType&&i.ClearOracleHierarchy(r.model),c.ngModel=!0):c.ngModel=!1,c.ngModel&&null!==r.ngModel&&(s.stringIsNullUndefinedOrEmpty(JSON.parse(r.ngModel)[a.ObjectNumber])||function(){var n=JSON.parse(r.ngModel)[a.ObjectNumber],l=r.model.selected[a.ObjectNumber];i.GetFormDetails(n,r.formType).then(function(e){if(void 0!==e){var t={value:angular.copy(e),ROLE_LIST:angular.toJson(["991","1000","257","996","1686","221","1356","321","216","1922","-1002","1343","1984","1958","1959"]),COST_CENTER_ID:e[a.CostCenterId],OBJECT_ID:e[a.ObjectNumber],LOOKUP:e[a.Lookup],TABLEDATAROLEID:null};l!==n&&v(),i.GetLocalBusinessLine(t.value[a.CostCenterId],"nanpSansOpportunitywf"===r.formType|"nanpSansOpportunity"===r.formType||"nanpSansOpportunitywar"===r.formType).then(function(e){r.model.list.lbl=angular.copy(e),r.model.object.pb=null,r.model.object.pbRef=null,r.ngModel=i.FillupAutopopulatedFields(r.model,a,t,r.formType,r.details.ApprovalItemDetail),E(t)})}})}());else if("nanpSansOpportunitywf"===r.formType){var e=null,t=null;if(null!==r.ngModel&&(e=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Lbl])?null:r.model.selected[a.Lbl].TableDataRoleId,t=s.stringIsNullUndefinedOrEmpty(JSON.parse(r.ngModel)[a.Lbl])?null:JSON.parse(r.ngModel)[a.Lbl].TableDataRoleId),null===r.ngModel?(r.model.selected={},v(),i.ClearOracleHierarchy(r.model),c.ngModel=!0):JSON.parse(r.ngModel)[a.CostCenterId]!==r.model.selected[a.CostCenterId]||e!==t||s.stringIsNullUndefinedOrEmpty(JSON.parse(r.ngModel)[a.CostCenterId])?(r.model.selected=angular.copy(JSON.parse(r.ngModel)),r.model.object.engageGBS=!!s.stringIsNullUndefinedOrEmpty(JSON.parse(r.ngModel)[a.EngageGBS])||"YES"===JSON.parse(r.ngModel)[a.EngageGBS],i.ClearOracleHierarchy(r.model),c.ngModel=!0):c.ngModel=!1,c.ngModel&&null!==r.ngModel&&!s.stringIsNullUndefinedOrEmpty(JSON.parse(r.ngModel)[a.CostCenterId])){var n=s.stringIsNullUndefinedOrEmpty(JSON.parse(r.ngModel)[a.Lbl])?null:JSON.parse(r.ngModel)[a.Lbl].TableDataRoleId,l={value:angular.copy(JSON.parse(r.ngModel)),ROLE_LIST:angular.toJson(["991","1000","257","996","1686","221","1356","321","216","1922","-1002","1343","1984","1958","1959"]),COST_CENTER_ID:r.model.selected[a.CostCenterId],OBJECT_ID:null,LOOKUP:null,TABLEDATAROLEID:n};i.GetLocalBusinessLine(JSON.parse(r.ngModel)[a.CostCenterId]).then(function(e){r.model.list.lbl=angular.copy(e),r.model.object.pb=null,r.model.object.pbRef=null,E(l),i.SetDefaultOracleHierarchy(JSON.parse(r.ngModel),r.model,!0)})}null===r.ngModel||s.stringIsNullUndefinedOrEmpty(r.model.list.lbl)||i.SetDefaultOracleHierarchy(JSON.parse(r.ngModel),r.model,!0)}else if("nanpSansOpportunity"===r.formType||"nanpSansOpportunitywar"===r.formType){e=null,t=null;if(null!==r.ngModel&&(e=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Lbl])?null:r.model.selected[a.Lbl].TableDataRoleId,t=s.stringIsNullUndefinedOrEmpty(JSON.parse(r.ngModel)[a.Lbl])?null:JSON.parse(r.ngModel)[a.Lbl].TableDataRoleId),null===r.ngModel?(r.model.selected={},v(),c.ngModel=!0):JSON.parse(r.ngModel)[a.CostCenterId]!==r.model.selected[a.CostCenterId]||e!==t||s.stringIsNullUndefinedOrEmpty(JSON.parse(r.ngModel)[a.CostCenterId])?c.ngModel=!0:c.ngModel=!1,c.ngModel&&null!==r.ngModel&&!s.stringIsNullUndefinedOrEmpty(JSON.parse(r.ngModel)[a.CostCenterId])){r.model.selected=angular.copy(JSON.parse(r.ngModel)),r.model.object.engageGBS=!!s.stringIsNullUndefinedOrEmpty(JSON.parse(r.ngModel)[a.EngageGBS])||"YES"===JSON.parse(r.ngModel)[a.EngageGBS];n=s.stringIsNullUndefinedOrEmpty(JSON.parse(r.ngModel)[a.Lbl])?null:JSON.parse(r.ngModel)[a.Lbl].TableDataRoleId,l={value:angular.copy(JSON.parse(r.ngModel)),ROLE_LIST:angular.toJson(["991","1000","257","996","1686","221","1356","321","216","1922","-1002","1343","1984","1958","1959"]),COST_CENTER_ID:r.model.selected[a.CostCenterId],OBJECT_ID:null,LOOKUP:null,TABLEDATAROLEID:n};r.model.object.pb=null,r.model.object.pbRef=null,E(l)}}"eanpSansOpportunitywf"===r.formType&&(c.ngModel&&null!==r.ngModel?s.stringIsNullUndefinedOrEmpty(JSON.parse(r.ngModel)[a.CostCenterId])?i.SetDefaultOracleHierarchy(JSON.parse(r.ngModel),r.model,!1):(r.model.selected=angular.copy(JSON.parse(r.ngModel)),r.model.object.engageGBS=!!s.stringIsNullUndefinedOrEmpty(JSON.parse(r.ngModel)[a.EngageGBS])||"YES"===JSON.parse(r.ngModel)[a.EngageGBS],i.GetLocalBusinessLine(JSON.parse(r.ngModel)[a.CostCenterId],"nanpSansOpportunitywf"===r.formType|"nanpSansOpportunity"===r.formType||"nanpSansOpportunitywar"===r.formType).then(function(e){r.model.list.lbl=angular.copy(e),i.SetDefaultOracleHierarchy(JSON.parse(r.ngModel),r.model,!1)})):null===r.ngModel||s.stringIsNullUndefinedOrEmpty(r.model.list.lbl)||i.SetDefaultOracleHierarchy(JSON.parse(r.ngModel),r.model,!1),r.model.object.pb=s.stringIsNullUndefinedOrEmpty(r.model.object.pb)?null:"Y"===r.model.object.pb.ISACTIVE?r.model.object.pb:null,r.model.clearSwitch.pb="Y")}),r.$watch("model.list.vendorFinancialExposure",function(){r.switchVendorFinancialExposure||(r.model.selected[a.VendorFinancialExposure]=s.stringIsNullUndefinedOrEmpty(r.model.list.vendorFinancialExposure)?null:JSON.stringify(r.model.list.vendorFinancialExposure),r.ngModel=JSON.stringify(r.model.selected)),r.switchVendorFinancialExposure=!1},!0),r.$watch("details.ApprovalItemSteps",function(){s.objectIsNullorUndefined(r.details)||s.objectIsNullorUndefined(r.details.ApprovalItemSteps)||(r.model.isLblInWorkFlow=!1,r.details.ApprovalItemSteps.forEach(function(e){-1031==e.CostPointRoleId&&(0<e.MainApprovers.length&&null!==r.ngModel?i.GetApproverByEmail(e.MainApprovers[0].MainApproverEmail,r.model,"projectManager").then(function(){i.SetDefaultPMinFunding(r.model)}):r.model.object.projectManager=null),"Y"==e.HasLBL&&(r.model.isLblInWorkFlow=!0,!s.stringIsNullUndefinedOrEmpty(r.ngModel)&&0<r.model.list.lbl.length&&(s.stringIsNullUndefinedOrEmpty(e.StepTableBasedSelection)||(r.model.object.lbl=JSON.parse(e.StepTableBasedSelection),r.model.list.workflowLbl=angular.copy(e.TableData),I())))}))},!0)}],templateUrl:"app/views/templates/form-templates/project-setup-without-opportunity-form-template.html"}})}(),function(){"use strict";angular.module("myApp").directive("eaNaNpWithOpportunityFormControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",details:"=",formType:"=?",lookupValue:"=?",formValidation:"=?"},controller:["$scope","ProjectSetupFormBusiness","AgreementProjectWarFormPropertyNames","FormMessages","astigUtilityService","GngFormBusiness","FormOptions","$q","sweetDialogAlertService","$filter",function(r,i,a,e,s,t,n,u,l,o){var c={ngModel:!0,object:!0,objectList:!0,selected:!0,fundingList:!0,lookupValue:!0,workFlowLbl:!0,sdl:!0,pb:!0,sb:!0};function d(){m({ROLE_LIST:angular.toJson(["1356","991","1343"]),COST_CENTER_ID:r.model.selected[a.CostCenterId],OBJECT_ID:null,LOOKUP:null,TABLEDATAROLEID:r.model.object.lbl.TableDataRoleId}),i.SetDefaultLblInFunding(r.model,JSON.parse(r.ngModel))}function p(){r.model.list.lbl=[],r.model.object.projectManager=null,r.model.object.pa=null,r.model.object.projectDirector=null,r.model.object.pic=null,r.model.object.td=null,r.model.object.sb=null,r.model.object.pb=null,r.model.object.lbl=null,r.model.objectList.funding={total:{Labor:null,Oh:null,Subcontractor:null,DirectExpense:null,NonReimbursableCost:null,TotalFunding:null,NetFunding:null,ManagementReserve:null,TargetMarginDollar:null,TargetMarginPercentOfTotal:null,TargetMarginPercentOfNet:null,TargetMarginMultiplier:null},list:[]},r.model.selected={},r.model.list.sdl=[{clearSwitch:"N",value:null}],r.model.list.gbsPASupport=[{clearSwitch:"N",value:null,name:null,id:s.guid()}],r.model.selected[a.ContractClassification]="eanp"===r.formType||"eanpwar"===r.formType||"eanpwf"===r.formType?"TASK ORDER":null,i.AddToList(r.model,"funding",r.details.ApprovalItemDetail),r.model.withManagementReserve&&i.AddManagementReserve(r.model,"funding",r.details.ApprovalItemDetail)}function m(e){i.GetKeyRoles(e).then(function(e){if(!s.stringIsNullUndefinedOrEmpty(e)){f(e);for(var t=0;t<e.length;t++)switch(e[t].RoleId){case"216":r.model.selected[a.Rol]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Rol])?e[t].MemberDisplayName:r.model.selected[a.Rol]+"<br/>"+e[t].MemberDisplayName;break;case"257":r.model.selected[a.Rpa]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Rpa])?e[t].MemberDisplayName:r.model.selected[a.Rpa]+"<br/>"+e[t].MemberDisplayName;break;case"321":r.model.selected[a.Dol]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Dol])?e[t].MemberDisplayName:r.model.selected[a.Dol]+"<br/>"+e[t].MemberDisplayName;break;case"991":r.model.selected[a.Dbl]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Dbl])?e[t].MemberDisplayName:r.model.selected[a.Dbl]+"<br/>"+e[t].MemberDisplayName;break;case"996":r.model.selected[a.Dfl]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Dfl])?e[t].MemberDisplayName:r.model.selected[a.Dfl]+"<br/>"+e[t].MemberDisplayName;break;case"1000":r.model.selected[a.Dpa]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Dpa])?e[t].MemberDisplayName:r.model.selected[a.Dpa]+"<br/>"+e[t].MemberDisplayName;break;case"1356":r.model.selected[a.Pdm]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Pdm])?e[t].MemberDisplayName:r.model.selected[a.Pdm]+"<br/>"+e[t].MemberDisplayName;break;case"1686":r.model.selected[a.Rfl]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Rfl])?e[t].MemberDisplayName:r.model.selected[a.Rfl]+"<br/>"+e[t].MemberDisplayName;break;case"221":r.model.selected[a.Rpdl]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Rpdl])?e[t].MemberDisplayName:r.model.selected[a.Rpdl]+"<br/>"+e[t].MemberDisplayName;break;case"1922":r.model.selected[a.Sb]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Sb])?e[t].MemberDisplayName:r.model.selected[a.Sb]+"<br/>"+e[t].MemberDisplayName,i.GetApproverByEmail(e[t].MemberEmail,r.model,"sb").then(function(){});break;case"-1002":i.GetApproverByEmail(e[t].MemberEmail,r.model,"pb").then(function(){}),i.GetApproverByEmail(e[t].MemberEmail,r.model,"pbRef").then(function(){});break;case"1343":i.GetApproverByEmail(e[t].MemberEmail,r.model,"sdl").then(function(){1<r.model.list.sdl.length&&(r.model.list.sdl=r.model.list.sdl.filter(function(e){return null!==e.value}))});break;case"1958":r.model.selected[a.GBSPARegionalLead]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.GBSPARegionalLead])?e[t].MemberDisplayName:r.model.selected[a.GBSPARegionalLead]+"<br/>"+e[t].MemberDisplayName;break;case"1959":r.model.selected[a.GBSPAUSLead]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.GBSPAUSLead])?e[t].MemberDisplayName:r.model.selected[a.GBSPAUSLead]+"<br/>"+e[t].MemberDisplayName;break;case"1984":i.GetApproverByEmail(e[t].MemberEmail,r.model,"gbsPASupport").then(function(){1<r.model.list.gbsPASupport.length&&(r.model.list.gbsPASupport=r.model.list.gbsPASupport.filter(function(e){return null!==e.value}))})}r.model.object.pb=s.stringIsNullUndefinedOrEmpty(r.model.object.pb)?null:"Y"===r.model.object.pb.ISACTIVE?r.model.object.pb:null,r.model.object.pbRef=s.stringIsNullUndefinedOrEmpty(r.model.object.pbRef)?null:"Y"===r.model.object.pbRef.ISACTIVE?r.model.object.pbRef:null,r.model.clearSwitch.pb="Y"}})}function f(e){for(var t=0;t<e.length;t++)switch(e[t].RoleId){case"216":r.model.selected[a.Rol]=null;break;case"257":r.model.selected[a.Rpa]=null;break;case"321":r.model.selected[a.Dol]=null;break;case"991":r.model.selected[a.Dbl]=null;break;case"996":r.model.selected[a.Dfl]=null;break;case"1000":r.model.selected[a.Dpa]=null;break;case"1356":r.model.selected[a.Pdm]=null;break;case"1686":r.model.selected[a.Rfl]=null;break;case"221":r.model.selected[a.Rpdl]=null;break;case"1922":r.model.selected[a.Sb]=null,r.model.object.sb=null;break;case"-1002":r.model.selected[a.Pb]=null,r.model.object.pb=null,r.model.object.pbRef=null;break;case"1343":r.model.selected[a.Sdl]=null,r.model.list.sdl=[{clearSwitch:"N",value:null}];break;case"1959":r.model.selected[a.GBSPAUSLead]=null;break;case"1958":r.model.selected[a.GBSPARegionalLead]=null;break;case"1984":r.model.selected[a.GBSPASupport]=null,r.model.list.gbsPASupport=[{clearSwitch:"N",value:null,name:null,id:s.guid()}]}}function g(){r.model.withManagementReserve&&1<r.model.objectList.funding.list.length&&(r.model.objectList.funding.list[1].Level1.selected=r.model.objectList.funding.list[0].Level1.selected,r.model.objectList.funding.list[1].Level2.selected=r.model.objectList.funding.list[0].Level2.selected,r.model.objectList.funding.list[1].Level3.selected=r.model.objectList.funding.list[0].Level3.selected,r.model.objectList.funding.list[1].Level4.selected=r.model.objectList.funding.list[0].Level4.selected,r.model.objectList.funding.list[1].Lbl.selected=r.model.objectList.funding.list[0].Lbl.selected,r.model.objectList.funding.list[1].TargetMarginDollar=s.stringIsNullUndefinedOrEmpty(r.model.objectList.funding.list[1].ManagementReserve)?null:-1*parseFloat(r.model.objectList.funding.list[1].ManagementReserve),r.model.objectList.funding.list[1].PA=r.model.objectList.funding.list[0].PA,r.model.objectList.funding.list[1].FundingSource.selected=r.model.objectList.funding.list[0].FundingSource.selected,r.model.objectList.funding.list[1].ProjectType.selected=r.model.objectList.funding.list[0].ProjectType.selected)}function v(){if(r.model.isBurdeneCostValid=!0,r.model.burdenedCostLimit=!0,r.asForm&&!s.stringIsNullUndefinedOrEmpty(r.details.ApprovalItemDetail)){var e=r.details.ApprovalItemDetail[0].ApprovalItemLabel.substring(r.details.ApprovalItemDetail[0].ApprovalItemLabel.indexOf("$"),r.details.ApprovalItemDetail[0].ApprovalItemLabel.length);switch(e.substring(0,e.indexOf(",")+1).replace(",","")){case"$25K":r.model.burdenedCostLimit="<$25K",r.model.isBurdeneCostValid=!!s.stringIsNullUndefinedOrEmpty(r.model.selected[a.BurdenedCost])||parseFloat(r.model.selected[a.BurdenedCost])<25e3;break;case"$25K but <$100K":r.model.burdenedCostLimit="≥$25K but <$100K",r.model.isBurdeneCostValid=!!s.stringIsNullUndefinedOrEmpty(r.model.selected[a.BurdenedCost])||25e3<=parseFloat(r.model.selected[a.BurdenedCost])&&parseFloat(r.model.selected[a.BurdenedCost])<1e5;break;case"$100K but <$250K":r.model.burdenedCostLimit="≥$100K but <$250K",r.model.isBurdeneCostValid=!!s.stringIsNullUndefinedOrEmpty(r.model.selected[a.BurdenedCost])||1e5<=parseFloat(r.model.selected[a.BurdenedCost])&&parseFloat(r.model.selected[a.BurdenedCost])<25e4;break;case"$250K but <$500K":r.model.burdenedCostLimit="≥$250K but <$500K",r.model.isBurdeneCostValid=!!s.stringIsNullUndefinedOrEmpty(r.model.selected[a.BurdenedCost])||25e4<=parseFloat(r.model.selected[a.BurdenedCost])&&parseFloat(r.model.selected[a.BurdenedCost])<5e5;break;case"$500K":r.model.burdenedCostLimit="≥$500K",r.model.isBurdeneCostValid=!!s.stringIsNullUndefinedOrEmpty(r.model.selected[a.BurdenedCost])||5e5<=parseFloat(r.model.selected[a.BurdenedCost])}}}r.model={selected:{},prop:a,formType:r.formType,asForm:r.asForm,messages:e,minDate:(new Date).toDateString(),withManagementReserve:r.asForm?void 0!==r.details.ApprovalItemDetail.find(function(e){return e.ApprovalItemName.EN.includes("With Management Reserve")}):void 0!==r.details.RequestApprovalItems.find(function(e){return e.ApprovalItemName.EN.includes("With Management Reserve")}),isLblInWorkFlow:!1,isBurdeneCostValid:!0,burdenedCostLimit:null,clearSwitch:{projectManager:"N",pa:"N",projectDirector:"N",pic:"N",td:"N",pb:"N"},oldValue:{pb:null},list:{lbl:[],workflowLbl:[],division:[],yesNo:n.YesNo,vendorFinancialExposure:[],sdl:[{clearSwitch:"N",value:null}],gbsPASupport:[{clearSwitch:"N",value:null,name:null,id:s.guid()}]},object:{projectManager:null,vendor:null,pa:null,projectDirector:null,pic:null,pb:null,pbRef:null,td:null,lbl:null,sb:null,engageGBS:!0},objectList:{funding:{total:{Labor:null,Oh:null,Subcontractor:null,DirectExpense:null,NonReimbursableCost:null,TotalFunding:null,NetFunding:null,ManagementReserve:null,TargetMarginDollar:null,TargetMarginPercentOfTotal:null,TargetMarginPercentOfNet:null,TargetMarginMultiplier:null},list:[]}}},function(){if(v(),null!==r.ngModel)if(s.stringIsNullUndefinedOrEmpty(JSON.parse(r.ngModel)[a.ObjectNumber]))t.GetAllOracleHierarchyList(!0).then(function(e){void 0!==e&&(r.model.list.division=angular.copy(e),i.AddToList(r.model,"funding",r.details.ApprovalItemDetail),r.model.withManagementReserve&&i.AddManagementReserve(r.model,"funding",r.details.ApprovalItemDetail))});else{c.ngModel=!1;var o={value:angular.copy(JSON.parse(r.ngModel))};r.model.selected=angular.copy(o.value),t.GetAllOracleHierarchyList(!0).then(function(e){if(void 0!==e){r.model.list.division=angular.copy(e);var t=[];if("eanpwf"===r.formType||"nanpwf"===r.formType){o.value[a.Funding]=s.stringIsNullUndefinedOrEmpty(o.value[a.Funding])?null:JSON.parse(o.value[a.Funding]),o.value[a.Funding].list=JSON.parse(o.value[a.Funding].list);for(var n=0;n<o.value[a.Funding].list.length;n++){var l=s.stringIsNullUndefinedOrEmpty(o.value[a.Funding].list[n].Level4.selected)?0:JSON.parse(o.value[a.Funding].list[n].Level4.selected).COST_CENTER_ID;t.push(i.AssignLBL(l,o.value[a.Funding].list[n].Lbl))}}0<t.length?u.all(t).then(function(e){i.GetLocalBusinessLine(o.value[a.CostCenterId]).then(function(e){r.model.list.lbl=angular.copy(e),r.ngModel=i.FillupAutopopulatedFields(r.model,a,o,r.formType,r.details.ApprovalItemDetail)})}):i.GetLocalBusinessLine(o.value[a.CostCenterId]).then(function(e){r.model.list.lbl=angular.copy(e),r.ngModel=i.FillupAutopopulatedFields(r.model,a,o,r.formType,r.details.ApprovalItemDetail)})}})}else t.GetAllOracleHierarchyList(!0).then(function(e){void 0!==e&&(r.model.list.division=angular.copy(e),i.AddToList(r.model,"funding",r.details.ApprovalItemDetail),r.model.withManagementReserve&&i.AddManagementReserve(r.model,"funding",r.details.ApprovalItemDetail))})}(),r.events={onLoad_PopOver:function(e){angular.element(e).popover("show")},onChange_Lbl:d,onChange_FundingLbl:function(t){s.stringIsNullUndefinedOrEmpty(t.Lbl.selected)||i.GetApproverForLbl(t.Lbl.selected.EMPLOYEE_NUMBER).then(function(e){t.PA=e,t.ClearSwitch.PA="Y"})},onClick_AddFunding:function(){i.AddToList(r.model,"funding",r.details.ApprovalItemDetail)},onClick_DeleteFunding:function(e){i.DeleteItem(r.model.objectList,"funding",e)},onChange_Division:function(e,t){i.GetDistrictList(e,t,r.model,JSON.parse(r.ngModel))},onChange_District:function(e){i.GetAreaList(e)},onChange_Area:function(e){i.GetCostCenterList(e)},onChange_CostCenter:function(t){s.stringIsNullUndefinedOrEmpty(t.Level4.selected)||i.GetLocalBusinessLine(t.Level4.selected.COST_CENTER_ID).then(function(e){t.Lbl.list=angular.copy(e)})},calculateNetFunding:function(e){i.CalculateNetFunding(e)},calculateTargetMargin:function(e){i.CalculateTargetMargin(e)},calculateTargetMarginPercentOfTotal:function(e){i.CalculateTargetMarginPercentOfTotal(e)},calculateTargetMarginPercentOfNetFunding:function(e){i.CalculateTargetMarginPercentOfNetFunding(e)},calculateTargetMultiplier:function(e){i.CalculateTargetMultiplier(e)},calculateAnticipatedMarginPercentNetForPricing:function(){i.CalculateAnticipatedMarginPercentNetForPricing(r.model)},calculateAnticipatedMarginPercentGrossForPricing:function(){i.CalculateAnticipatedMarginPercentGrossForPricing(r.model)},calculateTotal:function(e){i.CalculateTotal(r.model.objectList.funding,e)},calculateTotalValues:function(e){i.CalculateTotalValues(r.model,e)},formatValue:function(e){var t=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),n=s.stringIsNullUndefinedOrEmpty(e)?"":e.toString().replace("$","").replace(",","").replace(",","").replace(",","");return s.stringIsNullUndefinedOrEmpty(e)?"":t.format(n)},onClick_ModificationBeingSigned:function(e){"NO"===e&&(r.model.list.vendorFinancialExposure=[],r.model.object.vendor=null,r.model.selected[a.WorkWithSubPreviously]=null)},onClick_HasWspWorked:function(e){"YES"===e?r.model.list.vendorFinancialExposure=[]:"NO"===e&&(r.model.object.vendor=null)},deleteItem:function(e,t,n){e[t].splice(n,1),i.setClearSwitch(e,t)},deleteGBS:function(e,t,n){e[t]=e[t].filter(function(e){return e.id!==n})},addToList:function(e,t,n){var l="Y"===n?null:{OBJECT_NAME:null,OBJECT_ID:null,COST_CENTER_ID:null,OBJECT_DISPLAY:null,LOOKUP:null};e[t].push({value:l,financialExposure:null,isExist:n})},clearFunding:function(){r.model.objectList.funding={total:{Labor:null,Oh:null,Subcontractor:null,DirectExpense:null,NonReimbursableCost:null,TotalFunding:null,NetFunding:null,ManagementReserve:null,TargetMarginDollar:null,TargetMarginPercentOfTotal:null,TargetMarginPercentOfNet:null,TargetMarginMultiplier:null},list:[]},i.AddToList(r.model,"funding",r.details.ApprovalItemDetail),r.model.withManagementReserve&&i.AddManagementReserve(r.model,"funding",r.details.ApprovalItemDetail)},setMRDefault:g,onChange_BurdenedCost:function(){v()},showBurdenedCostError:function(){l.alertConfirm("Request Warning","<div><span>Burdened Cost should be "+r.model.burdenedCostLimit+"</span></div>",function(){r.$apply()},function(){},"Ok","",!1)},addGbsSupport:function(e,t){e[t].push({clearSwitch:"N",value:null,name:null,id:s.guid()})}},r.validations={validateCascadingRequiredField:function(e){return s.stringIsNullUndefinedOrEmpty(e.selected)&&void 0!==e.list&&null!==e.list&&""!==e.list&&JSON.stringify(e.list)!==JSON.stringify([])}},r.$watch("lookupValue",function(){if(s.stringIsNullUndefinedOrEmpty(r.lookupValue))f([{RoleId:"-1002"}]),r.model.object.pb=null,c.lookupValue=!0;else{var e=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.LookupValue])?null:JSON.parse(r.model.selected[a.LookupValue])[a.ObjectNumber];if(null===r.lookupValue?(f([{RoleId:"-1002"}]),c.lookupValue=!0):r.lookupValue[a.ObjectNumber]!==e||s.stringIsNullUndefinedOrEmpty(r.lookupValue[a.ObjectNumber])?c.lookupValue=!0:c.lookupValue=!1,c.lookupValue&&null!==r.lookupValue&&(r.model.selected[a.LookupValue]=angular.copy(JSON.stringify(r.lookupValue)),!s.stringIsNullUndefinedOrEmpty(r.lookupValue[a.ObjectNumber]))){var t={value:angular.copy(r.lookupValue),ROLE_LIST:angular.toJson(["-1002"]),COST_CENTER_ID:r.lookupValue[a.CostCenterId],OBJECT_ID:r.lookupValue[a.ObjectNumber],LOOKUP:r.lookupValue[a.Lookup],TABLEDATAROLEID:null};r.model.object.pb=null,r.model.object.pbRef=null,m(t),r.model.object.pb=s.stringIsNullUndefinedOrEmpty(r.model.object.pb)?null:"Y"===r.model.object.pb.ISACTIVE?r.model.object.pb:null,r.model.object.pbRef=s.stringIsNullUndefinedOrEmpty(r.model.object.pbRef)?null:"Y"===r.model.object.pbRef.ISACTIVE?r.model.object.pbRef:null,r.model.clearSwitch.pb="Y"}}}),r.$watch("ngModel",function(){if(null===r.ngModel?(p(),c.ngModel=!0):JSON.parse(r.ngModel)[a.ObjectNumber]!==r.model.selected[a.ObjectNumber]||s.stringIsNullUndefinedOrEmpty(JSON.parse(r.ngModel)[a.ObjectNumber])?c.ngModel=!0:c.ngModel=!1,c.ngModel&&null!==r.ngModel&&(s.stringIsNullUndefinedOrEmpty(JSON.parse(r.ngModel)[a.ObjectNumber])||function(){var n=JSON.parse(r.ngModel)[a.ObjectNumber],l=r.model.selected[a.ObjectNumber];i.GetFormDetails(n,r.formType).then(function(e){if(void 0!==e){var t={value:angular.copy(e),ROLE_LIST:angular.toJson(["991","1000","257","996","1686","221","1356","321","216","1922","-1002","1343","1984","1958","1959"]),COST_CENTER_ID:e[a.CostCenterId],OBJECT_ID:e[a.ObjectNumber],LOOKUP:e[a.Lookup],TABLEDATAROLEID:null};l!==n&&p(),i.GetLocalBusinessLine(t.value[a.CostCenterId]).then(function(e){r.model.list.lbl=angular.copy(e),r.ngModel=i.FillupAutopopulatedFields(r.model,a,t,r.formType,r.details.ApprovalItemDetail),m(t),r.model.object.pb=s.stringIsNullUndefinedOrEmpty(r.model.object.pb)?null:"Y"===r.model.object.pb.ISACTIVE?r.model.object.pb:null,r.model.object.pbRef=s.stringIsNullUndefinedOrEmpty(r.model.object.pbRef)?null:"Y"===r.model.object.pbRef.ISACTIVE?r.model.object.pbRef:null,r.model.clearSwitch.pb="Y"})}})}()),null!==r.ngModel){var e=JSON.parse(r.ngModel);i.SetDefaultOracleHierarchy(e,r.model)}}),r.$watch("model.selected",function(){c.ngModel||(r.model.selected[a.ProjectManagerEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.projectManager)?null:JSON.stringify(r.model.object.projectManager),r.model.selected[a.PAEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.pa)?null:JSON.stringify(r.model.object.pa),r.model.selected[a.ProjectDirector]=s.stringIsNullUndefinedOrEmpty(r.model.object.projectDirector)?null:JSON.stringify(r.model.object.projectDirector),r.model.selected[a.Sdl]=s.stringIsNullUndefinedOrEmpty(r.model.list.sdl)?JSON.stringify([{clearSwitch:"N",value:null}]):JSON.stringify(r.model.list.sdl),r.model.selected[a.Td]=s.stringIsNullUndefinedOrEmpty(r.model.object.td)?null:JSON.stringify(r.model.object.td),r.model.selected[a.Pb]=s.stringIsNullUndefinedOrEmpty(r.model.object.pb)?null:JSON.stringify(r.model.object.pb),r.model.selected[a.SbRef]=s.stringIsNullUndefinedOrEmpty(r.model.object.sb)?null:JSON.stringify(r.model.object.sb),r.model.selected[a.Lbl]=s.stringIsNullUndefinedOrEmpty(r.model.object.lbl)?null:JSON.stringify(r.model.object.lbl),r.model.selected[a.PmLevel]=s.stringIsNullUndefinedOrEmpty(r.model.object.projectManager)?null:s.stringIsNullUndefinedOrEmpty(r.model.object.projectManager.PM_LEVEL)?"PM Not a PMAP Participant":r.model.object.projectManager.PM_LEVEL,r.model.selected[a.GBSPASupport]=s.stringIsNullUndefinedOrEmpty(r.model.list.gbsPASupport)?JSON.stringify([{clearSwitch:"N",value:null,name:null,id:s.guid()}]):JSON.stringify(o("orderBy")(r.model.list.gbsPASupport,function(e){return e.name})),r.model.selected[a.EngageGBS]=r.model.object.engageGBS?"YES":"NO","eanpwf"!==r.formType&&"nanpwf"!==r.formType||(i.CalculateTotalValues(r.model,a.AnticipatedGrossRevenueVariance),i.CalculateTotalValues(r.model,a.AnticipatedMarginPercentOfGross),i.CalculateTotalValues(r.model,a.AnticipatedNetRevenueVariance),i.CalculateTotalValues(r.model,a.AnticipatedMarginPercentOfNet),i.CalculateTotalValues(r.model,a.AnticipatedMarginVariance),i.CalculateTotalValues(r.model,a.AnticipatedMarginPercentOfGrossVariance),i.CalculateTotalValues(r.model,a.AnticipatedMarginPercentOfNetVariance),i.CalculateTotalValues(r.model,a.TotalAgreementFunding),i.StringiFyFundingObject(r.model)),r.ngModel=JSON.stringify(r.model.selected)),null!==r.ngModel?c.ngModel=s.stringIsNullUndefinedOrEmpty(JSON.parse(r.ngModel)[a.ObjectNumber]):c.ngModel=!1},!0),r.$watch("model.object.pa",function(){"nanpwf"!==r.formType&&"eanpwf"!==r.formType||(i.SetDefaultPAinFunding(r.model),g())},!0),r.$watch("model.list.sdl",function(){c.sdl||(r.model.selected[a.Sdl]=s.stringIsNullUndefinedOrEmpty(r.model.list.sdl)?null:JSON.stringify(r.model.list.sdl),r.ngModel=JSON.stringify(r.model.selected)),c.sdl=!1},!0),r.$watch("model.list.gbsPASupport",function(){r.model.selected[a.GBSPASupport]=s.stringIsNullUndefinedOrEmpty(r.model.list.gbsPASupport)?null:JSON.stringify(o("orderBy")(r.model.list.gbsPASupport,function(e){return e.name})),r.ngModel=JSON.stringify(r.model.selected)},!0),r.$watch("model.object",function(){c.object||(r.model.object.pbRef=s.stringIsNullUndefinedOrEmpty(r.model.object.pbRef)?null:"Y"===r.model.object.pbRef.ISACTIVE?r.model.object.pbRef:null,"N"!==r.model.oldValue.pb&&(r.model.object.pb=s.stringIsNullUndefinedOrEmpty(r.model.object.pb)?null:"Y"===r.model.object.pb.ISACTIVE?r.model.object.pb:null),r.model.list.sdl=null!==r.model.list.sdl?r.model.list.sdl:[{clearSwitch:"N",value:null}],r.model.selected[a.ProjectManagerEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.projectManager)?null:JSON.stringify(r.model.object.projectManager),r.model.selected[a.PAEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.pa)?null:JSON.stringify(r.model.object.pa),r.model.selected[a.ProjectDirector]=s.stringIsNullUndefinedOrEmpty(r.model.object.projectDirector)?null:JSON.stringify(r.model.object.projectDirector),r.model.selected[a.Sdl]=s.stringIsNullUndefinedOrEmpty(r.model.list.sdl)?null:JSON.stringify(r.model.list.sdl),r.model.selected[a.Td]=s.stringIsNullUndefinedOrEmpty(r.model.object.td)?null:JSON.stringify(r.model.object.td),r.model.selected[a.Pb]=s.stringIsNullUndefinedOrEmpty(r.model.object.pb)?null:JSON.stringify(r.model.object.pb),r.model.selected[a.SbRef]=s.stringIsNullUndefinedOrEmpty(r.model.object.sb)?null:JSON.stringify(r.model.object.sb),r.model.selected[a.Lbl]=s.stringIsNullUndefinedOrEmpty(r.model.object.lbl)?null:JSON.stringify(r.model.object.lbl),r.model.selected[a.PmLevel]=s.stringIsNullUndefinedOrEmpty(r.model.object.projectManager)?null:s.stringIsNullUndefinedOrEmpty(r.model.object.projectManager.PM_LEVEL)?"PM Not a PMAP Participant":r.model.object.projectManager.PM_LEVEL,r.model.list.gbsPASupport=s.stringIsNullUndefinedOrEmpty(r.model.list.gbsPASupport)?[{clearSwitch:"N",value:null,name:null,id:s.guid()}]:r.model.list.gbsPASupport,r.model.selected[a.EngageGBS]=r.model.object.engageGBS?"YES":"NO","nanpwf"!==r.model.formType&&"eanpwf"!==r.model.formType||i.StringiFyFundingObject(r.model),r.ngModel=JSON.stringify(r.model.selected)),c.object=!1},!0),r.$watch("model.objectList",function(){c.objectList||"nanpwf"!==r.model.formType&&"eanpwf"!==r.model.formType||(i.CalculateNetFunding(r.model.objectList.funding.total),i.CalculateTargetMargin(r.model.objectList.funding.total),r.model.withManagementReserve&&(i.CalculateMRTargetMargin(r.model.objectList.funding),i.CalculateMRTargetMarginDollar(r.model.objectList.funding)),i.CalculateTargetMarginPercentOfTotal(r.model.objectList.funding.total),i.CalculateTargetMarginPercentOfNetFunding(r.model.objectList.funding.total),i.CalculateTargetMultiplier(r.model.objectList.funding.total),i.CalculateTotalValues(r.model,a.AnticipatedGrossRevenueVariance),i.CalculateTotalValues(r.model,a.AnticipatedMarginPercentOfGross),i.CalculateTotalValues(r.model,a.AnticipatedNetRevenueVariance),i.CalculateTotalValues(r.model,a.AnticipatedMarginPercentOfNet),i.CalculateTotalValues(r.model,a.AnticipatedMarginVariance),i.CalculateTotalValues(r.model,a.AnticipatedMarginPercentOfGrossVariance),i.CalculateTotalValues(r.model,a.AnticipatedMarginPercentOfNetVariance),i.CalculateTotalValues(r.model,a.TotalAgreementFunding),i.StringiFyFundingObject(r.model),r.ngModel=JSON.stringify(r.model.selected)),c.objectList=!1},!0),r.$watch("model.list.vendorFinancialExposure",function(){r.switchVendorFinancialExposure||(r.model.selected[a.VendorFinancialExposure]=s.stringIsNullUndefinedOrEmpty(r.model.list.vendorFinancialExposure)?null:JSON.stringify(r.model.list.vendorFinancialExposure),r.ngModel=JSON.stringify(r.model.selected)),r.switchVendorFinancialExposure=!1},!0),r.$watch("model.list.workflowLbl",function(){r.workFlowLbl||(r.model.selected[a.WorkflowLbl]=s.stringIsNullUndefinedOrEmpty(r.model.list.workflowLbl)?null:JSON.stringify(r.model.list.workflowLbl),r.ngModel=JSON.stringify(r.model.selected)),r.workFlowLbl=!1},!0),r.$watch("details.ApprovalItemSteps",function(){s.objectIsNullorUndefined(r.details)||s.objectIsNullorUndefined(r.details.ApprovalItemSteps)||(r.model.isLblInWorkFlow=!1,r.details.ApprovalItemSteps.forEach(function(e){-1031==e.CostPointRoleId&&(0<e.MainApprovers.length&&!s.stringIsNullUndefinedOrEmpty(JSON.parse(r.ngModel)[a.ObjectNumber])?i.GetApproverByEmail(e.MainApprovers[0].MainApproverEmail,r.model,"projectManager").then(function(){i.SetDefaultPMinFunding(r.model)}):r.model.object.projectManager=null),"Y"==e.HasLBL&&(r.model.isLblInWorkFlow=!0,!s.stringIsNullUndefinedOrEmpty(r.ngModel)&&0<r.model.list.lbl.length&&(s.stringIsNullUndefinedOrEmpty(e.StepTableBasedSelection)||(r.model.object.lbl=JSON.parse(e.StepTableBasedSelection),r.model.list.workflowLbl=angular.copy(e.TableData),d())))}))},!0)}],templateUrl:"app/views/templates/form-templates/project-setup-with-opportunity-form-template.html"}})}(),function(){"use strict";angular.module("myApp").directive("projectUpdateFormControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",details:"=",formType:"=?",formValidation:"=?",lookupValue:"=?"},controller:["$scope","ProjectSetupFormBusiness","AgreementProjectWarFormPropertyNames","FormMessages","astigUtilityService","GngFormBusiness","$q","FormOptions","$filter",function(r,i,a,e,s,t,u,n,l){var o={ngModel:!0,object:!0,objectList:!0,selected:!0,fundingList:!0};function c(){d({ROLE_LIST:angular.toJson(["1356","991","1343"]),COST_CENTER_ID:r.model.selected[a.CostCenterId],OBJECT_ID:null,LOOKUP:null,TABLEDATAROLEID:r.model.object.lbl.TableDataRoleId}),i.SetDefaultLblInFunding(r.model,JSON.parse(r.ngModel))}function d(e){i.GetKeyRoles(e).then(function(e){if(!s.stringIsNullUndefinedOrEmpty(e)){p(e);for(var t=0;t<e.length;t++)switch(e[t].RoleId){case"216":r.model.selected[a.Rol]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Rol])?e[t].MemberDisplayName:r.model.selected[a.Rol]+"<br/>"+e[t].MemberDisplayName;break;case"257":r.model.selected[a.Rpa]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Rpa])?e[t].MemberDisplayName:r.model.selected[a.Rpa]+"<br/>"+e[t].MemberDisplayName;break;case"321":r.model.selected[a.Dol]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Dol])?e[t].MemberDisplayName:r.model.selected[a.Dol]+"<br/>"+e[t].MemberDisplayName;break;case"991":r.model.selected[a.Dbl]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Dbl])?e[t].MemberDisplayName:r.model.selected[a.Dbl]+"<br/>"+e[t].MemberDisplayName;break;case"996":r.model.selected[a.Dfl]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Dfl])?e[t].MemberDisplayName:r.model.selected[a.Dfl]+"<br/>"+e[t].MemberDisplayName;break;case"1000":r.model.selected[a.Dpa]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Dpa])?e[t].MemberDisplayName:r.model.selected[a.Dpa]+"<br/>"+e[t].MemberDisplayName;break;case"1356":r.model.selected[a.Pdm]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Pdm])?e[t].MemberDisplayName:r.model.selected[a.Pdm]+"<br/>"+e[t].MemberDisplayName;break;case"1686":r.model.selected[a.Rfl]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Rfl])?e[t].MemberDisplayName:r.model.selected[a.Rfl]+"<br/>"+e[t].MemberDisplayName;break;case"221":r.model.selected[a.Rpdl]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Rpdl])?e[t].MemberDisplayName:r.model.selected[a.Rpdl]+"<br/>"+e[t].MemberDisplayName;break;case"1922":r.model.selected[a.Sb]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.Sb])?e[t].MemberDisplayName:r.model.selected[a.Sb]+"<br/>"+e[t].MemberDisplayName,i.GetApproverByEmail(e[t].MemberEmail,r.model,"sb").then(function(){});break;case"-1002":i.GetApproverByEmail(e[t].MemberEmail,r.model,"pb").then(function(){});break;case"1343":i.GetApproverByEmail(e[t].MemberEmail,r.model,"sdl",!0).then(function(){1<r.model.list.sdl.length&&(r.model.list.sdl=r.model.list.sdl.filter(function(e){return null!==e.value}))});break;case"1958":r.model.selected[a.GBSPARegionalLead]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.GBSPARegionalLead])?e[t].MemberDisplayName:r.model.selected[a.GBSPARegionalLead]+"<br/>"+e[t].MemberDisplayName;break;case"1959":r.model.selected[a.GBSPAUSLead]=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.GBSPAUSLead])?e[t].MemberDisplayName:r.model.selected[a.GBSPAUSLead]+"<br/>"+e[t].MemberDisplayName;break;case"1984":i.GetApproverByEmail(e[t].MemberEmail,r.model,"gbsPASupport").then(function(){1<r.model.list.gbsPASupport.length&&(r.model.list.gbsPASupport=r.model.list.gbsPASupport.filter(function(e){return null!==e.value}))})}}})}function p(e){for(var t=0;t<e.length;t++)switch(e[t].RoleId){case"216":r.model.selected[a.Rol]=null;break;case"257":r.model.selected[a.Rpa]=null;break;case"321":r.model.selected[a.Dol]=null;break;case"991":r.model.selected[a.Dbl]=null;break;case"996":r.model.selected[a.Dfl]=null;break;case"1000":r.model.selected[a.Dpa]=null;break;case"1356":r.model.selected[a.Pdm]=null;break;case"1686":r.model.selected[a.Rfl]=null;break;case"221":r.model.selected[a.Rpdl]=null;break;case"1922":r.model.selected[a.Sb]=null,r.model.object.sb=null;break;case"-1002":r.model.selected[a.Pb]=null,r.model.object.pb=null,r.model.object.pbRef=null;break;case"1343":r.model.selected[a.Sdl]=null,r.model.list.sdl=[{clearSwitch:"N",value:null}];break;case"1959":r.model.selected[a.GBSPAUSLead]=null;break;case"1958":r.model.selected[a.GBSPARegionalLead]=null;break;case"1984":r.model.selected[a.GBSPASupport]=null,r.model.list.gbsPASupport=[{clearSwitch:"N",value:null,name:null,id:s.guid()}]}}function m(){r.model.withManagementReserve&&1<r.model.objectList.funding.list.length&&(r.model.objectList.funding.list[1].Level1.selected=r.model.objectList.funding.list[0].Level1.selected,r.model.objectList.funding.list[1].Level2.selected=r.model.objectList.funding.list[0].Level2.selected,r.model.objectList.funding.list[1].Level3.selected=r.model.objectList.funding.list[0].Level3.selected,r.model.objectList.funding.list[1].Level4.selected=r.model.objectList.funding.list[0].Level4.selected,r.model.objectList.funding.list[1].Lbl.selected=r.model.objectList.funding.list[0].Lbl.selected,r.model.objectList.funding.list[1].TargetMarginDollar=s.stringIsNullUndefinedOrEmpty(r.model.objectList.funding.list[1].ManagementReserve)?null:-1*parseFloat(r.model.objectList.funding.list[1].ManagementReserve),r.model.objectList.funding.list[1].PA=r.model.objectList.funding.list[0].PA,r.model.objectList.funding.list[1].FundingSource.selected=r.model.objectList.funding.list[0].FundingSource.selected,r.model.objectList.funding.list[1].ProjectType.selected=r.model.objectList.funding.list[0].ProjectType.selected)}r.switchOn=!0,r.model={selected:{},prop:a,formType:r.formType,messages:e,withManagementReserve:r.asForm?void 0!==r.details.ApprovalItemDetail.find(function(e){return e.ApprovalItemName.EN.includes("With Management Reserve")}):void 0!==r.details.RequestApprovalItems.find(function(e){return e.ApprovalItemName.EN.includes("With Management Reserve")}),clearSwitch:{projectManager:"N",pa:"N",projectDirector:"N",pic:"N",pb:"N",td:"N"},list:{lbl:[],division:[],yesNo:n.YesNo,sdl:[{clearSwitch:"N",value:null}],workflowLbl:[],gbsPASupport:[{clearSwitch:"N",value:null,name:null,id:s.guid()}]},object:{projectManager:null,pa:null,projectDirector:null,pic:null,pb:null,td:null,sb:null,lbl:null,sdl:null,engageGBS:!0},oldValue:{pb:null},objectList:{funding:{total:{Labor:null,Oh:null,Subcontractor:null,DirectExpense:null,NonReimbursableCost:null,TotalFunding:null,NetFunding:null,ManagementReserve:null,TargetMarginDollar:null,TargetMarginPercentOfTotal:null,TargetMarginPercentOfNet:null,TargetMarginMultiplier:null},list:[]}}},function(){if(s.stringIsNullUndefinedOrEmpty(r.ngModel)?r.ngModel:JSON.parse(r.ngModel)[a.ObjectNumber]){var o={value:angular.copy(JSON.parse(r.ngModel))};r.model.selected=angular.copy(JSON.parse(r.ngModel)),u.all([t.GetAllOracleHierarchyList(!0).then(function(e){void 0!==e&&(r.model.list.division=angular.copy(e),i.AddToList(r.model,"funding",r.details.ApprovalItemDetail),r.model.withManagementReserve&&i.AddManagementReserve(r.model,"funding",r.details.ApprovalItemDetail))})]).then(function(e){var t=[];o.value[a.Funding]=s.stringIsNullUndefinedOrEmpty(o.value[a.Funding])?null:JSON.parse(o.value[a.Funding]),o.value[a.Funding].list=JSON.parse(o.value[a.Funding].list);for(var n=0;n<o.value[a.Funding].list.length;n++){var l=s.stringIsNullUndefinedOrEmpty(o.value[a.Funding].list[n].Level4.selected)?0:JSON.parse(o.value[a.Funding].list[n].Level4.selected).COST_CENTER_ID;t.push(i.AssignLBL(l,o.value[a.Funding].list[n].Lbl))}0<t.length?u.all(t).then(function(e){i.GetLocalBusinessLine(o.value[a.CostCenterId]).then(function(e){r.model.list.lbl=angular.copy(e),r.ngModel=i.FillupAutopopulatedFields(r.model,a,o,r.formType,r.details.ApprovalItemDetail)})}):i.GetLocalBusinessLine(o.value[a.CostCenterId]).then(function(e){r.model.list.lbl=angular.copy(e),r.ngModel=i.FillupAutopopulatedFields(r.model,a,o,r.formType,r.details.ApprovalItemDetail)})})}else t.GetAllOracleHierarchyList(!0).then(function(e){void 0!==e&&(r.model.list.division=angular.copy(e),i.AddToList(r.model,"funding",r.details.ApprovalItemDetail),r.model.withManagementReserve&&i.AddManagementReserve(r.model,"funding",r.details.ApprovalItemDetail))})}(),r.events={onLoad_PopOver:function(e){angular.element(e).popover("show")},onChange_Lbl:c,onChange_FundingLbl:function(t){s.stringIsNullUndefinedOrEmpty(t.Lbl.selected)||i.GetApproverForLbl(t.Lbl.selected.EMPLOYEE_NUMBER).then(function(e){t.PA=e,t.ClearSwitch.PA="Y"})},onClick_AddFunding:function(){i.AddToList(r.model,"funding",r.details.ApprovalItemDetail)},onClick_DeleteFunding:function(e){i.DeleteItem(r.model.objectList,"funding",e)},onChange_Division:function(e){i.GetDistrictList(e)},onChange_District:function(e){i.GetAreaList(e)},onChange_Area:function(e){i.GetCostCenterList(e)},onChange_CostCenter:function(t){s.stringIsNullUndefinedOrEmpty(t.Level4.selected)||i.GetLocalBusinessLine(t.Level4.selected.COST_CENTER_ID).then(function(e){t.Lbl.list=angular.copy(e)})},calculateNetFunding:function(e){i.CalculateNetFunding(e)},calculateTargetMargin:function(e){i.CalculateTargetMargin(e)},calculateTargetMultiplier:function(e){i.CalculateTargetMultiplier(e)},calculateTargetMarginPercentOfTotal:function(e){i.CalculateTargetMarginPercentOfTotal(e)},calculateTargetMarginPercentOfNetFunding:function(e){i.CalculateTargetMarginPercentOfNetFunding(e)},calculateAnticipatedMarginPercentNetForPricing:function(){i.CalculateAnticipatedMarginPercentNetForPricing(r.model)},calculateAnticipatedMarginPercentGrossForPricing:function(){i.CalculateAnticipatedMarginPercentGrossForPricing(r.model)},calculateTotal:function(e){i.CalculateTotal(r.model.objectList.funding,e)},calculateTotalValues:function(e){i.CalculateTotalValues(r.model,e)},formatValue:function(e){var t=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),n=s.stringIsNullUndefinedOrEmpty(e)?"":e.toString().replace("$","").replace(",","").replace(",","").replace(",","");return s.stringIsNullUndefinedOrEmpty(e)?"":t.format(n)},setMRDefault:m,addGbsSupport:function(e,t){e[t].push({clearSwitch:"Y",value:null,name:null,id:s.guid()})},deleteItem:function(e,t,n){e[t].splice(n,1),i.setClearSwitch(e,t)},deleteGBS:function(e,t,n){e[t]=e[t].filter(function(e){return e.id!==n})}},r.validations={validateCascadingRequiredField:function(e){return s.stringIsNullUndefinedOrEmpty(e.selected)&&void 0!==e.list&&null!==e.list&&""!==e.list&&JSON.stringify(e.list)!==JSON.stringify([])}},r.removeDivisionNull=function(e){return e.DIVISION_NAME?e:void 0},r.removeDistrictNull=function(e){return e.DISTRICT_NAME?e:void 0},r.removeAreaNull=function(e){return e.AREA_NAME?e:void 0},r.removeCostCenterNull=function(e){return e.COST_CENTER_NAME?e:void 0},r.$watch("lookupValue",function(){if(s.stringIsNullUndefinedOrEmpty(r.lookupValue))p([{RoleId:"-1002"}]),r.model.object.pb=null,o.lookupValue=!0;else{var e=s.stringIsNullUndefinedOrEmpty(r.model.selected[a.LookupValue])?null:JSON.parse(r.model.selected[a.LookupValue])[a.ObjectNumber];if(null===r.lookupValue?(p([{RoleId:"-1002"}]),r.model.object.pb=null,o.lookupValue=!0):r.lookupValue[a.ObjectNumber]!==e||s.stringIsNullUndefinedOrEmpty(r.lookupValue[a.ObjectNumber])?o.lookupValue=!0:o.lookupValue=!1,o.lookupValue&&null!==r.lookupValue&&(r.model.selected[a.LookupValue]=angular.copy(JSON.stringify(r.lookupValue)),!s.stringIsNullUndefinedOrEmpty(r.lookupValue[a.ObjectNumber]))){var t={value:angular.copy(r.lookupValue),ROLE_LIST:angular.toJson(["-1002"]),COST_CENTER_ID:r.lookupValue[a.CostCenterId],OBJECT_ID:r.lookupValue[a.ObjectNumber],LOOKUP:r.lookupValue[a.Lookup],TABLEDATAROLEID:null};r.model.object.pb=null,r.model.object.pbRef=null,d(t),r.model.object.pb=s.stringIsNullUndefinedOrEmpty(r.model.object.pb)?null:"Y"===r.model.object.pb.ISACTIVE?r.model.object.pb:r.model.object.sb,r.model.object.pbRef=s.stringIsNullUndefinedOrEmpty(r.model.object.pbRef)?null:"Y"===r.model.object.pbRef.ISACTIVE?r.model.object.pbRef:r.model.object.sb,r.model.clearSwitch.pb="Y"}}}),r.$watch("model.list.sdl",function(){r.model.selected[a.Sdl]=s.stringIsNullUndefinedOrEmpty(r.model.list.sdl)?null:JSON.stringify(r.model.list.sdl),r.ngModel=JSON.stringify(r.model.selected)},!0),r.$watch("model.list.gbsPASupport",function(){r.model.selected[a.GBSPASupport]=s.stringIsNullUndefinedOrEmpty(r.model.list.gbsPASupport)?null:JSON.stringify(l("orderBy")(r.model.list.gbsPASupport,function(e){return e.name})),r.ngModel=JSON.stringify(r.model.selected)},!0),r.$watch("ngModel",function(){if(null===r.ngModel?(r.model.object.pb=null,r.model.object.pbRef=null,r.model.selected={},r.model.list.lbl=[],r.model.object.projectManager=null,r.model.object.pa=null,r.model.object.pb=null,r.model.object.td=null,r.model.object.lbl=null,r.model.object.projectDirector=null,r.model.list.gbsPASupport=[{clearSwitch:"N",value:null,name:null,id:s.guid()}],r.model.list.sdl=[{clearSwitch:"N",value:null}],r.model.objectList.funding={total:{Labor:null,Oh:null,Subcontractor:null,DirectExpense:null,NonReimbursableCost:null,TotalFunding:null,NetFunding:null,ManagementReserve:null,TargetMarginDollar:null,TargetMarginPercentOfTotal:null,TargetMarginPercentOfNet:null,TargetMarginMultiplier:null},list:[]},i.AddToList(r.model,"funding",r.details.ApprovalItemDetail),r.model.withManagementReserve&&i.AddManagementReserve(r.model,"funding",r.details.ApprovalItemDetail),i.ClearOracleHierarchy(r.model),o.ngModel=!0):JSON.parse(r.ngModel)[a.ObjectNumber]!==r.model.selected[a.ObjectNumber]||s.stringIsNullUndefinedOrEmpty(JSON.parse(r.ngModel)[a.ObjectNumber])?(i.ClearOracleHierarchy(r.model),o.ngModel=!0):o.ngModel=!1,o.ngModel&&null!==r.ngModel&&!s.stringIsNullUndefinedOrEmpty(JSON.parse(r.ngModel)[a.CostCenterId])){r.model.selected=angular.copy(JSON.parse(r.ngModel));var t={value:angular.copy(JSON.parse(r.ngModel)),ROLE_LIST:angular.toJson(["991","1000","257","996","1686","221","-1005","1356","321","216","1922","-1002","1343","1984","1958","1959"]),COST_CENTER_ID:r.model.selected[a.CostCenterId],OBJECT_ID:r.model.selected[a.ObjectNumber],LOOKUP:r.model.selected[a.Lookup],TABLEDATAROLEID:null};i.GetLocalBusinessLine(JSON.parse(r.ngModel)[a.CostCenterId]).then(function(e){r.model.list.lbl=angular.copy(e),d(t),r.ngModel=i.FillupAutopopulatedFields(r.model,a,t,r.formType,r.details.ApprovalItemDetail),i.SetDefaultOracleHierarchy(JSON.parse(r.ngModel),r.model,!1)})}null===r.ngModel||s.stringIsNullUndefinedOrEmpty(r.model.list.lbl)||i.SetDefaultOracleHierarchy(JSON.parse(r.ngModel),r.model,!1)}),r.$watch("model.selected",function(){o.ngModel||(r.model.selected[a.ProjectManagerEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.projectManager)?null:JSON.stringify(r.model.object.projectManager),r.model.selected[a.PmLevelEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.projectManager)?null:s.stringIsNullUndefinedOrEmpty(r.model.object.projectManager.PM_LEVEL)?"PM Not a PMAP Participant":r.model.object.projectManager.PM_LEVEL,r.model.selected[a.PAEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.pa)?null:JSON.stringify(r.model.object.pa),r.model.selected[a.Lbl]=s.stringIsNullUndefinedOrEmpty(r.model.object.lbl)?null:JSON.stringify(r.model.object.lbl),r.model.selected[a.ProjectDirector]=s.stringIsNullUndefinedOrEmpty(r.model.object.projectDirector)?null:JSON.stringify(r.model.object.projectDirector),r.model.selected[a.Sdl]=s.stringIsNullUndefinedOrEmpty(r.model.list.sdl)?JSON.stringify([{clearSwitch:"N",value:null}]):JSON.stringify(r.model.list.sdl),r.model.selected[a.GBSPASupport]=s.stringIsNullUndefinedOrEmpty(r.model.list.gbsPASupport)?JSON.stringify([{clearSwitch:"N",value:null,name:null,id:s.guid()}]):JSON.stringify(l("orderBy")(r.model.list.gbsPASupport,function(e){return e.name})),r.model.selected[a.EngageGBS]=r.model.object.engageGBS?"YES":"NO",r.model.selected[a.Pb]=s.stringIsNullUndefinedOrEmpty(r.model.object.pb)?null:JSON.stringify(r.model.object.pb),r.model.selected[a.Td]=s.stringIsNullUndefinedOrEmpty(r.model.object.td)?null:JSON.stringify(r.model.object.td),i.CalculateTotalValues(r.model,a.AnticipatedGrossRevenueVariance),i.CalculateTotalValues(r.model,a.AnticipatedMarginPercentOfGross),i.CalculateTotalValues(r.model,a.AnticipatedNetRevenueVariance),i.CalculateTotalValues(r.model,a.AnticipatedMarginPercentOfNet),i.CalculateTotalValues(r.model,a.AnticipatedMarginVariance),i.CalculateTotalValues(r.model,a.AnticipatedMarginPercentOfGrossVariance),i.CalculateTotalValues(r.model,a.AnticipatedMarginPercentOfNetVariance),i.CalculateTotalValues(r.model,a.TotalAgreementFunding),i.StringiFyFundingObject(r.model),r.ngModel=JSON.stringify(r.model.selected)),null!==r.ngModel?o.ngModel=s.stringIsNullUndefinedOrEmpty(JSON.parse(r.ngModel)[a.ObjectNumber]):o.ngModel=!1},!0),r.$watch("model.object",function(){o.object||(null!==r.ngModel&&"N"!==r.model.oldValue.pb&&(r.model.object.pbRef=s.stringIsNullUndefinedOrEmpty(r.model.object.pbRef)?null:"Y"===r.model.object.pbRef.ISACTIVE?r.model.object.pbRef:null,r.model.object.pb=s.stringIsNullUndefinedOrEmpty(r.model.object.pb)?null:"Y"===r.model.object.pb.ISACTIVE?r.model.object.pb:null),r.model.list.sdl=s.stringIsNullUndefinedOrEmpty(r.model.list.sdl)?[{clearSwitch:"N",value:null}]:r.model.list.sdl,r.model.clearSwitch.pb="Y",r.model.selected[a.ProjectManagerEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.projectManager)?null:JSON.stringify(r.model.object.projectManager),r.model.selected[a.PmLevelEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.projectManager)?null:s.stringIsNullUndefinedOrEmpty(r.model.object.projectManager.PM_LEVEL)?"PM Not a PMAP Participant":r.model.object.projectManager.PM_LEVEL,r.model.selected[a.PAEdited]=s.stringIsNullUndefinedOrEmpty(r.model.object.pa)?null:JSON.stringify(r.model.object.pa),r.model.selected[a.Lbl]=s.stringIsNullUndefinedOrEmpty(r.model.object.lbl)?null:JSON.stringify(r.model.object.lbl),r.model.selected[a.ProjectDirector]=s.stringIsNullUndefinedOrEmpty(r.model.object.projectDirector)?null:JSON.stringify(r.model.object.projectDirector),r.model.selected[a.Sdl]=s.stringIsNullUndefinedOrEmpty(r.model.list.sdl)?JSON.stringify([{clearSwitch:"N",value:null}]):JSON.stringify(r.model.list.sdl),r.model.selected[a.Pb]=s.stringIsNullUndefinedOrEmpty(r.model.object.pb)?null:JSON.stringify(r.model.object.pb),r.model.selected[a.SbRef]=s.stringIsNullUndefinedOrEmpty(r.model.object.sb)?null:JSON.stringify(r.model.object.sb),r.model.selected[a.Td]=s.stringIsNullUndefinedOrEmpty(r.model.object.td)?null:JSON.stringify(r.model.object.td),r.model.selected[a.PmLevel]=s.stringIsNullUndefinedOrEmpty(r.model.object.projectManager)?null:s.stringIsNullUndefinedOrEmpty(r.model.object.projectManager.PM_LEVEL)?"PM Not a PMAP Participant":r.model.object.projectManager.PM_LEVEL,r.model.list.gbsPASupport=s.stringIsNullUndefinedOrEmpty(r.model.list.gbsPASupport)?[{clearSwitch:"N",value:null,name:null,id:s.guid()}]:r.model.list.gbsPASupport,r.model.selected[a.EngageGBS]=r.model.object.engageGBS?"YES":"NO",i.StringiFyFundingObject(r.model),r.ngModel=JSON.stringify(r.model.selected)),o.object=!1},!0),r.$watch("model.object.pa",function(){i.SetDefaultPAinFunding(r.model),m()},!0),r.$watch("model.objectList",function(){i.CalculateNetFunding(r.model.objectList.funding.total),i.CalculateTargetMargin(r.model.objectList.funding.total),r.model.withManagementReserve&&(i.CalculateMRTargetMargin(r.model.objectList.funding),i.CalculateMRTargetMarginDollar(r.model.objectList.funding)),i.CalculateTargetMarginPercentOfTotal(r.model.objectList.funding.total),i.CalculateTargetMultiplier(r.model.objectList.funding.total),i.CalculateTargetMarginPercentOfNetFunding(r.model.objectList.funding.total),i.CalculateTotalValues(r.model,a.AnticipatedGrossRevenueVariance),i.CalculateTotalValues(r.model,a.AnticipatedMarginPercentOfGross),i.CalculateTotalValues(r.model,a.AnticipatedNetRevenueVariance),i.CalculateTotalValues(r.model,a.AnticipatedMarginPercentOfNet),i.CalculateTotalValues(r.model,a.AnticipatedMarginVariance),i.CalculateTotalValues(r.model,a.AnticipatedMarginPercentOfGrossVariance),i.CalculateTotalValues(r.model,a.AnticipatedMarginPercentOfNetVariance),i.CalculateTotalValues(r.model,a.TotalAgreementFunding),i.StringiFyFundingObject(r.model),r.ngModel=JSON.stringify(r.model.selected),o.objectList=!1},!0),r.$watch("details.ApprovalItemSteps",function(){s.objectIsNullorUndefined(r.details)||s.objectIsNullorUndefined(r.details.ApprovalItemSteps)||r.details.ApprovalItemSteps.forEach(function(e){-1031==e.CostPointRoleId&&(0<e.MainApprovers.length?i.GetApproverByEmail(e.MainApprovers[0].MainApproverEmail,r.model,"projectManager").then(function(){i.SetDefaultPMinFunding(r.model)}):r.model.object.projectManager=null),"Y"==e.HasLBL&&(r.model.isLblInWorkFlow=!0,!s.stringIsNullUndefinedOrEmpty(r.ngModel)&&0<r.model.list.lbl.length&&(s.stringIsNullUndefinedOrEmpty(e.StepTableBasedSelection)||(r.model.object.lbl=JSON.parse(e.StepTableBasedSelection),r.model.list.workflowLbl=angular.copy(e.TableData),c())))})},!0)}],templateUrl:"app/views/templates/form-templates/project-update-form-template.html"}})}(),function(){"use strict";angular.module("myApp").directive("nblMarkets",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",isNewLineOfBusiness:"="},controller:["$scope","astigUtilityService",function(n,l){n.concatNblMarketLead=function(e,t,n){if(null!==t.value){var l=e.nblMarkets.filter(function(e){return e.LocalBusinessLine.toUpperCase()===t.value.LocalBusinessLine.toUpperCase()&&("Y"===n?"NBLML - COMPREHENSIVE"===e.DerivedRoleName.toUpperCase():"NBLML - COMPREHENSIVE"!==e.DerivedRoleName.toUpperCase())}),o=e.nblMarketLead.findIndex(function(e){return e.id===t.id});if(-1!==o){e.nblMarketLead[o].value=null;for(var r=0;r<l.length;r++)e.nblMarketLead[o].value=(null===e.nblMarketLead[o].value?"":e.nblMarketLead[o].value+"<br/>")+l[r].MemberFullName,e.nblMarketLead[o].email=(null===e.nblMarketLead[o].email?"":e.nblMarketLead[o].email+"|")+l[r].MemberEmail}}},n.addToNblMarketList=function(e,t){var n=l.guid();e[t].push({value:null,id:n}),e.nblMarketLead.push({value:null,email:null,id:n})},n.deleteNblMarketItem=function(e,t,n){e[t]=e[t].filter(function(e){return e.id!==n}),e.nblMarketLead=e.nblMarketLead.filter(function(e){return e.id!==n})},n.validateNblMarketSelected=function(){return 0===n.ngModel.nblMarketSelected.filter(function(e){return null===e.value}).length},n.validateNblMarkets=function(){return 0===n.ngModel.nblMarkets.filter(function(e){return"NBLML - Comprehensive"!==e.DerivedRoleName}).length},n.$watch("ngModel.nblMarkets",function(){if(n.asForm)for(var t=0;t<n.ngModel.nblMarketSelected.length;t++)null!==n.ngModel.nblMarketSelected[t].value&&(n.ngModel.nblMarketSelected[t].value=l.stringIsNullUndefinedOrEmpty(n.ngModel.nblMarketSelected[t].value)?null:n.ngModel.nblMarkets.find(function(e){return e.LocalBusinessLine.toUpperCase()===n.ngModel.nblMarketSelected[t].value.LocalBusinessLine.toUpperCase()&&e.DerivedRoleName.toUpperCase()===n.ngModel.nblMarketSelected[t].value.DerivedRoleName.toUpperCase()}))})}],templateUrl:"app/views/templates/directive-templates/form-shared-directives/nbl-markets.html"}})}(),function(){"use strict";angular.module("myApp").directive("workAtRiskFormControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",details:"=",isValid:"=?",formType:"=?",formValidation:"=?",lookupValue:"=?"},controller:["$scope","FormOptions","AgreementProjectWarFormPropertyNames","astigUtilityService","sweetDialogAlertService","GngFormBusiness","ProjectSetupFormBusiness","FormMessages","$filter",function(n,e,l,o,t,r,i,a,s){var u={lookupValue:!0};n.model={prop:l,errorSwitchDeliveryMethod:!1,errorSwitchClient:!1,errorSwitchOwner:!1,errorSwitchBusinessLine:!1,errorSwitchBusinessLineDivision:!1,minDate:(new Date).toDateString(),isBurdeneCostValid:!0,isTotalBurdeneCostValid:!0,burdenedCostLimit:null,messages:a,isLblInWorkFlow:!1,clearSwitch:{projectManager:"N",pa:"N",projectDirector:"N",pic:"N",td:"N",pb:"N"},list:{yesNo:e.YesNo,warExtensionType:e.WarExtensionType,vendorFinancialExposure:[],lbl:[],sdl:[{clearSwitch:"N",value:null}],workflowLbl:[],gbsPASupport:[{clearSwitch:"N",value:null,name:null,id:o.guid()}]},object:{vendor:null,lbl:null,projectManager:null,pa:null,projectDirector:null,pic:null,td:null,sdl:null,pb:null,engageGBS:!0},oldValue:{pb:null},selected:{}},n.utility=o,n.switchObject=!0,n.switchSelected=!1,n.switchOn=!1;u={lookupValue:n.switchVendorFinancialExposure=!0,object:!0};function c(){d({ROLE_LIST:angular.toJson(["1356","991","1343"]),COST_CENTER_ID:n.model.selected[l.CostCenterId],OBJECT_ID:null,LOOKUP:null,TABLEDATAROLEID:n.model.object.lbl.TableDataRoleId})}function d(e){i.GetKeyRoles(e).then(function(e){if(!o.stringIsNullUndefinedOrEmpty(e)){p(e);for(var t=0;t<e.length;t++)switch(e[t].RoleId){case"216":n.model.selected[l.Rol]=o.stringIsNullUndefinedOrEmpty(n.model.selected[l.Rol])?e[t].MemberDisplayName:n.model.selected[l.Rol]+"<br/>"+e[t].MemberDisplayName;break;case"257":n.model.selected[l.Rpa]=o.stringIsNullUndefinedOrEmpty(n.model.selected[l.Rpa])?e[t].MemberDisplayName:n.model.selected[l.Rpa]+"<br/>"+e[t].MemberDisplayName;break;case"321":n.model.selected[l.Dol]=o.stringIsNullUndefinedOrEmpty(n.model.selected[l.Dol])?e[t].MemberDisplayName:n.model.selected[l.Dol]+"<br/>"+e[t].MemberDisplayName;break;case"991":n.model.selected[l.Dbl]=o.stringIsNullUndefinedOrEmpty(n.model.selected[l.Dbl])?e[t].MemberDisplayName:n.model.selected[l.Dbl]+"<br/>"+e[t].MemberDisplayName;break;case"996":n.model.selected[l.Dfl]=o.stringIsNullUndefinedOrEmpty(n.model.selected[l.Dfl])?e[t].MemberDisplayName:n.model.selected[l.Dfl]+"<br/>"+e[t].MemberDisplayName;break;case"1000":n.model.selected[l.Dpa]=o.stringIsNullUndefinedOrEmpty(n.model.selected[l.Dpa])?e[t].MemberDisplayName:n.model.selected[l.Dpa]+"<br/>"+e[t].MemberDisplayName;break;case"1356":n.model.selected[l.Pdm]=o.stringIsNullUndefinedOrEmpty(n.model.selected[l.Pdm])?e[t].MemberDisplayName:n.model.selected[l.Pdm]+"<br/>"+e[t].MemberDisplayName;break;case"1686":n.model.selected[l.Rfl]=o.stringIsNullUndefinedOrEmpty(n.model.selected[l.Rfl])?e[t].MemberDisplayName:n.model.selected[l.Rfl]+"<br/>"+e[t].MemberDisplayName;break;case"221":n.model.selected[l.Rpdl]=o.stringIsNullUndefinedOrEmpty(n.model.selected[l.Rpdl])?e[t].MemberDisplayName:n.model.selected[l.Rpdl]+"<br/>"+e[t].MemberDisplayName;break;case"1922":n.model.selected[l.Sb]=o.stringIsNullUndefinedOrEmpty(n.model.selected[l.Sb])?e[t].MemberDisplayName:n.model.selected[l.Sb]+"<br/>"+e[t].MemberDisplayName,i.GetApproverByEmail(e[t].MemberEmail,n.model,"sb").then(function(){});break;case"-1002":i.GetApproverByEmail(e[t].MemberEmail,n.model,"pb",!0).then(function(){});break;case"1343":i.GetApproverByEmail(e[t].MemberEmail,n.model,"sdl",!0).then(function(){1<n.model.list.sdl.length&&(n.model.list.sdl=n.model.list.sdl.filter(function(e){return null!==e.value}))});break;case"1958":n.model.selected[l.GBSPARegionalLead]=o.stringIsNullUndefinedOrEmpty(n.model.selected[l.GBSPARegionalLead])?e[t].MemberDisplayName:n.model.selected[l.GBSPARegionalLead]+"<br/>"+e[t].MemberDisplayName;break;case"1959":n.model.selected[l.GBSPAUSLead]=o.stringIsNullUndefinedOrEmpty(n.model.selected[l.GBSPAUSLead])?e[t].MemberDisplayName:n.model.selected[l.GBSPAUSLead]+"<br/>"+e[t].MemberDisplayName;break;case"1984":i.GetApproverByEmail(e[t].MemberEmail,n.model,"gbsPASupport").then(function(){1<n.model.list.gbsPASupport.length&&(n.model.list.gbsPASupport=n.model.list.gbsPASupport.filter(function(e){return null!==e.value}))})}}})}function p(e){for(var t=0;t<e.length;t++)switch(e[t].RoleId){case"216":n.model.selected[l.Rol]=null;break;case"257":n.model.selected[l.Rpa]=null;break;case"321":n.model.selected[l.Dol]=null;break;case"991":n.model.selected[l.Dbl]=null;break;case"996":n.model.selected[l.Dfl]=null;break;case"1000":n.model.selected[l.Dpa]=null;break;case"1356":n.model.selected[l.Pdm]=null;break;case"1686":n.model.selected[l.Rfl]=null;break;case"221":n.model.selected[l.Rpdl]=null;break;case"1922":n.model.selected[l.Sb]=null,n.model.object.sb=null;break;case"-1002":n.model.selected[l.Pb]=null,n.model.object.pb=null;break;case"1343":n.model.selected[l.Sdl]=null,n.model.list.sdl=[{clearSwitch:"N",value:null}];break;case"1959":n.model.selected[l.GBSPAUSLead]=null;break;case"1958":n.model.selected[l.GBSPARegionalLead]=null;break;case"1984":n.model.selected[l.GBSPASupport]=null,n.model.list.gbsPASupport=[{clearSwitch:"N",value:null,name:null,id:o.guid()}]}}function m(e,t){return new Date(e.getTime()+24*t*60*60*1e3)}function f(){n.model.isBurdeneCostValid=!0,n.model.burdenedCostLimit=!0;var e="extension"===n.formType?l.TotalWarBudget:l.BurdenedCost;if(n.asForm&&!o.stringIsNullUndefinedOrEmpty(n.details.ApprovalItemDetail))switch(n.details.ApprovalItemDetail[0].ApprovalItemLabel.substring(n.details.ApprovalItemDetail[0].ApprovalItemLabel.indexOf("$"),n.details.ApprovalItemDetail[0].ApprovalItemLabel.length)){case"$25K":n.model.burdenedCostLimit="<$25K",n.model.isBurdeneCostValid=!!o.stringIsNullUndefinedOrEmpty(n.model.selected[e])||parseFloat(n.model.selected[e])<25e3;break;case"$25K but <$100K":n.model.burdenedCostLimit="≥$25K but <$100K",n.model.isBurdeneCostValid=!!o.stringIsNullUndefinedOrEmpty(n.model.selected[e])||25e3<=parseFloat(n.model.selected[e])&&parseFloat(n.model.selected[e])<1e5;break;case"$100K but <$250K":n.model.burdenedCostLimit="≥$100K but <$250K",n.model.isBurdeneCostValid=!!o.stringIsNullUndefinedOrEmpty(n.model.selected[e])||1e5<=parseFloat(n.model.selected[e])&&parseFloat(n.model.selected[e])<25e4;break;case"$250K but <$500K":n.model.burdenedCostLimit="≥$250K but <$500K",n.model.isBurdeneCostValid=!!o.stringIsNullUndefinedOrEmpty(n.model.selected[e])||25e4<=parseFloat(n.model.selected[e])&&parseFloat(n.model.selected[e])<5e5;break;case"$500K":n.model.burdenedCostLimit="≥$500K",n.model.isBurdeneCostValid=!!o.stringIsNullUndefinedOrEmpty(n.model.selected[e])||5e5<=parseFloat(n.model.selected[e])}}o.stringIsNullUndefinedOrEmpty(n.ngModel)||(n.switchOn=!1,n.model.object.lbl=o.stringIsNullUndefinedOrEmpty(JSON.parse(n.ngModel)[l.Lbl])?null:JSON.parse(JSON.parse(n.ngModel)[l.Lbl]),n.model.object.vendor=o.stringIsNullUndefinedOrEmpty(JSON.parse(n.ngModel)[l.Vendor])?null:JSON.parse(JSON.parse(n.ngModel)[l.Vendor]),n.model.list.vendorFinancialExposure=o.stringIsNullUndefinedOrEmpty(JSON.parse(n.ngModel)[l.VendorFinancialExposure])?[]:JSON.parse(JSON.parse(n.ngModel)[l.VendorFinancialExposure]),n.model.selected=JSON.parse(n.ngModel),n.model.selected[l.PreviouslyApprovedWar]=o.stringIsNullUndefinedOrEmpty(JSON.parse(n.ngModel)[l.PreviouslyApprovedWar])?JSON.parse(n.ngModel).BurdenedCostBudgetRequest:JSON.parse(n.ngModel)[l.PreviouslyApprovedWar],n.model.clearSwitch.pa=o.stringIsNullUndefinedOrEmpty(n.model.selected[l.PAEdited])?"N":"Y",n.model.clearSwitch.projectManager=o.stringIsNullUndefinedOrEmpty(n.model.selected[l.ProjectManagerEdited])?"N":"Y",n.model.clearSwitch.projectDirector=o.stringIsNullUndefinedOrEmpty(n.model.selected[l.ProjectDirector])?"N":"Y",n.model.clearSwitch.pic=o.stringIsNullUndefinedOrEmpty(n.model.selected[l.Sdl])?"N":"Y",n.model.clearSwitch.td=o.stringIsNullUndefinedOrEmpty(n.model.selected[l.Td])?"N":"Y",o.stringIsNullUndefinedOrEmpty(n.model.selected[l.PAEdited])?i.GetApprover(n.model.selected[l.PAId],n.model,"pa"):n.model.object.pa=JSON.parse(n.model.selected[l.PAEdited]),o.stringIsNullUndefinedOrEmpty(n.model.selected[l.ProjectManagerEdited])?i.GetApprover(n.model.selected[l.ProjectManagerId],n.model,"projectManager"):n.model.object.projectManager=JSON.parse(n.model.selected[l.ProjectManagerEdited]),n.model.object.projectDirector=o.stringIsNullUndefinedOrEmpty(n.model.selected[l.ProjectDirector])?null:JSON.parse(n.model.selected[l.ProjectDirector]),n.model.list.sdl=o.stringIsNullUndefinedOrEmpty(n.model.selected[l.Sdl])?null:JSON.parse(n.model.selected[l.Sdl]),n.model.object.td=o.stringIsNullUndefinedOrEmpty(n.model.selected[l.Td])?null:JSON.parse(n.model.selected[l.Td]),n.model.object.pb=o.stringIsNullUndefinedOrEmpty(n.model.selected[l.Pb])?null:JSON.parse(n.model.selected[l.Pb]),f(),i.GetLocalBusinessLine(JSON.parse(n.ngModel)[l.CostCenterId]).then(function(e){n.model.list.lbl=angular.copy(e)})),n.events={onChange_Lbl:c,addToList:function(e,t,n){var l="Y"===n?null:{OBJECT_NAME:null,OBJECT_ID:null,COST_CENTER_ID:null,OBJECT_DISPLAY:null,LOOKUP:null};e[t].push({value:l,financialExposure:null,isExist:n})},deleteItem:function(e,t,n){e[t].splice(n,1),i.setClearSwitch(e,t)},deleteGBS:function(e,t,n){e[t]=e[t].filter(function(e){return e.id!==n})},onClick_ModificationBeingSigned:function(e){"NO"===e&&(n.model.list.vendorFinancialExposure=[],n.model.object.vendor=null,n.model.selected[l.WorkWithSubPreviously]=null)},onClick_HasWspWorked:function(e){"YES"===e?n.model.list.vendorFinancialExposure=[]:"NO"===e&&(n.model.object.vendor=null)},onLoad_PopOver:function(e){angular.element(e).popover("show")},formatValue:function(e){var t=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),n=o.stringIsNullUndefinedOrEmpty(e)?"":e.toString().replace("$","").replace(",","").replace(",","").replace(",","");return o.stringIsNullUndefinedOrEmpty(e)?"":t.format(n)},onChange_Wartype:function(){var e=m(new Date,90);"Time Extension"===n.model.selected[l.Wartype]?(n.model.selected[l.PreviouslyApprovedWar]=null,n.model.selected[l.AdditionalWarBudget]=null,n.model.selected[l.TotalWarBudget]=null,n.model.selected[l.RequestToWarUntil]=moment(e).format("YYYY-MMM-DD")):"Budget Increase"===n.model.selected[l.Wartype]?(n.model.selected[l.RequestToWarUntil]=null,n.model.selected[l.ContractAnticipatedDate]=null):n.model.selected[l.RequestToWarUntil]=o.stringIsNullUndefinedOrEmpty(n.model.selected[l.RequestToWarUntil])?moment(e).format("YYYY-MMM-DD"):n.model.selected[l.RequestToWarUntil]},calculateTotalWarBudget:function(){var e=o.stringIsNullUndefinedOrEmpty(n.model.selected[l.PreviouslyApprovedWar])?0:parseFloat(n.model.selected[l.PreviouslyApprovedWar].toString().replace("$","").replace(",","").replace(",","").replace(",","")),t=o.stringIsNullUndefinedOrEmpty(n.model.selected[l.AdditionalWarBudget])?0:parseFloat(n.model.selected[l.AdditionalWarBudget].toString().replace("$","").replace(",","").replace(",","").replace(",",""));n.model.selected[l.TotalWarBudget]=e+t},onChange_BurdenedCost:function(){f()},showBurdenedCostError:function(e){t.alertConfirm("Request Warning","<div><span>"+e+" should be "+n.model.burdenedCostLimit+"</span></div>",function(){n.$apply()},function(){},"Ok","",!1)},addGbsSupport:function(e,t){e[t].push({clearSwitch:"N",value:null,name:null,id:o.guid()})}},n.$watch("lookupValue",function(){if(o.stringIsNullUndefinedOrEmpty(n.lookupValue))p(angular.toJson([{RoleId:"-1002"}])),n.model.object.pb=null,u.lookupValue=!1;else{var e=o.stringIsNullUndefinedOrEmpty(n.model.selected[l.LookupValue])?null:JSON.parse(n.model.selected[l.LookupValue])[l.ObjectNumber];if(null===n.lookupValue?(p(angular.toJson([{RoleId:"-1002"}])),n.model.object.pb=null,u.lookupValue=!0):n.lookupValue[l.ObjectNumber]!==e||o.stringIsNullUndefinedOrEmpty(n.lookupValue[l.ObjectNumber])?u.lookupValue=!0:u.lookupValue=!1,u.lookupValue&&null!==n.lookupValue)if(n.model.selected[l.LookupValue]=angular.copy(JSON.stringify(n.lookupValue)),!o.stringIsNullUndefinedOrEmpty(n.lookupValue[l.ObjectNumber]))d({value:angular.copy(n.lookupValue),ROLE_LIST:angular.toJson(["-1002"]),COST_CENTER_ID:n.lookupValue[l.CostCenterId],OBJECT_ID:n.lookupValue[l.ObjectNumber],LOOKUP:n.lookupValue[l.Lookup],TABLEDATAROLEID:null})}}),n.$watch("model.list.sdl",function(){n.model.selected[l.Sdl]=o.stringIsNullUndefinedOrEmpty(n.model.list.sdl)?null:JSON.stringify(n.model.list.sdl),n.ngModel=JSON.stringify(n.model.selected)},!0),n.$watch("model.list.gbsPASupport",function(){n.model.selected[l.GBSPASupport]=o.stringIsNullUndefinedOrEmpty(n.model.list.gbsPASupport)?null:JSON.stringify(s("orderBy")(n.model.list.gbsPASupport,function(e){return e.name})),n.ngModel=JSON.stringify(n.model.selected)},!0),n.$watch("model.object",function(){n.switchObject||("N"!==n.model.oldValue.pb&&(n.model.object.pb=o.stringIsNullUndefinedOrEmpty(n.model.object.pb)?null:"Y"===n.model.object.pb.ISACTIVE?n.model.object.pb:null),n.model.list.sdl=o.stringIsNullUndefinedOrEmpty(n.model.list.sdl)?[{clearSwitch:"N",value:null}]:n.model.list.sdl,n.model.list.gbsPASupport=o.stringIsNullUndefinedOrEmpty(n.model.list.gbsPASupport)?[{clearSwitch:"N",value:null,name:null,id:o.guid()}]:n.model.list.gbsPASupport,n.model.clearSwitch.pb="Y",n.model.selected[l.ProjectManagerEdited]=o.stringIsNullUndefinedOrEmpty(n.model.object.projectManager)?null:JSON.stringify(n.model.object.projectManager),n.model.selected[l.PAEdited]=o.stringIsNullUndefinedOrEmpty(n.model.object.pa)?null:JSON.stringify(n.model.object.pa),n.model.selected[l.ProjectDirector]=o.stringIsNullUndefinedOrEmpty(n.model.object.projectDirector)?null:JSON.stringify(n.model.object.projectDirector),n.model.selected[l.Sdl]=o.stringIsNullUndefinedOrEmpty(n.model.object.sdl)?null:JSON.stringify(n.model.object.sdl),n.model.selected[l.Td]=o.stringIsNullUndefinedOrEmpty(n.model.object.td)?null:JSON.stringify(n.model.object.td),n.model.selected[l.Lbl]=o.stringIsNullUndefinedOrEmpty(n.model.object.lbl)?null:JSON.stringify(n.model.object.lbl),n.model.selected[l.Pb]=o.stringIsNullUndefinedOrEmpty(n.model.object.pb)?null:JSON.stringify(n.model.object.pb),n.model.selected[l.SbRef]=o.stringIsNullUndefinedOrEmpty(n.model.object.sb)?null:JSON.stringify(n.model.object.sb),n.model.selected[l.PmLevel]=o.stringIsNullUndefinedOrEmpty(n.model.object.projectManager)?null:o.stringIsNullUndefinedOrEmpty(n.model.object.projectManager.PM_LEVEL)?"PM Not a PMAP Participant":n.model.object.projectManager.PM_LEVEL,n.model.selected[l.EngageGBS]=n.model.object.engageGBS?"YES":"NO",n.ngModel=JSON.stringify(n.model.selected)),n.switchObject=!1},!0),n.$watch("model.list.vendorFinancialExposure",function(){n.switchVendorFinancialExposure||(n.model.selected[l.VendorFinancialExposure]=o.stringIsNullUndefinedOrEmpty(n.model.list.vendorFinancialExposure)?null:JSON.stringify(n.model.list.vendorFinancialExposure),n.ngModel=JSON.stringify(n.model.selected)),n.switchVendorFinancialExposure=!1},!0),n.$watch("ngModel",function(){if(null===n.ngModel?(n.model.selected={},n.model.errorSwitchDeliveryMethod=!1,n.model.errorSwitchClient=!1,n.model.errorSwitchOwner=!1,n.model.errorSwitchBusinessLine=!1,n.model.errorSwitchBusinessLineDivision=!1,n.model.list.supportingCC=[],n.model.list.sdl=[{clearSwitch:"N",value:null}],n.modelvendor=null,n.model.object.lbl=null,n.model.object.projectManager=null,n.model.object.pa=null,n.model.object.projectDirector=null,n.model.object.sb=null,n.model.object.pb=null,n.model.object.td=null,n.model.list.gbsPASupport=[{clearSwitch:"N",value:null,name:null,id:o.guid()}],n.switchOn=!0):JSON.parse(n.ngModel)[l.ObjectNumber]!==n.model.selected[l.ObjectNumber]||o.stringIsNullUndefinedOrEmpty(JSON.parse(n.ngModel)[l.ObjectNumber])?n.switchOn=!0:n.switchOn=!1,n.switchOn&&null!==n.ngModel&&!o.stringIsNullUndefinedOrEmpty(JSON.parse(n.ngModel)[l.ObjectNumber])){n.model.selected=angular.copy(JSON.parse(n.ngModel));var e=m(new Date,90);n.model.selected[l.RequestToWarUntil]=o.stringIsNullUndefinedOrEmpty(JSON.parse(n.ngModel)[l.RequestToWarUntil])?moment(e).format("YYYY-MMM-DD"):JSON.parse(n.ngModel)[l.RequestToWarUntil],n.model.selected[l.PreviouslyApprovedWar]=o.stringIsNullUndefinedOrEmpty(JSON.parse(n.ngModel)[l.PreviouslyApprovedWar])?JSON.parse(n.ngModel).BurdenedCostBudgetRequest:JSON.parse(n.ngModel)[l.PreviouslyApprovedWar],n.model.object.engageGBS=!!o.stringIsNullUndefinedOrEmpty(JSON.parse(n.ngModel)[l.EngageGBS])||"YES"===JSON.parse(n.ngModel)[l.EngageGBS],i.GetLocalBusinessLine(JSON.parse(n.ngModel)[l.CostCenterId]).then(function(e){n.model.list.lbl=angular.copy(e),n.model.clearSwitch.pa=o.stringIsNullUndefinedOrEmpty(n.model.selected[l.PAEdited])?"N":"Y",n.model.clearSwitch.projectManager=o.stringIsNullUndefinedOrEmpty(n.model.selected[l.ProjectManagerEdited])?"N":"Y",o.stringIsNullUndefinedOrEmpty(n.model.selected[l.PAEdited])?i.GetApprover(n.model.selected[l.PAId],n.model,"pa"):n.model.object.pa=JSON.parse(n.model.selected[l.PAEdited]),o.stringIsNullUndefinedOrEmpty(n.model.selected[l.ProjectManagerEdited])?i.GetApprover(n.model.selected[l.ProjectManagerId],n.model,"projectManager"):n.model.object.projectManager=JSON.parse(n.model.selected[l.ProjectManagerEdited]),d({ROLE_LIST:angular.toJson(["991","1000","257","996","1686","221","1356","321","216","1922","-1002","1984","1343","1958","1959"]),COST_CENTER_ID:n.model.selected[l.CostCenterId],OBJECT_ID:n.model.selected[l.ObjectNumber],LOOKUP:n.model.selected[l.Lookup],TABLEDATAROLEID:null})})}},!0),n.$watch("model.selected",function(){n.switchSelected||(n.model.selected[l.ProjectManagerEdited]=o.stringIsNullUndefinedOrEmpty(n.model.object.projectManager)?null:JSON.stringify(n.model.object.projectManager),n.model.selected[l.PAEdited]=o.stringIsNullUndefinedOrEmpty(n.model.object.pa)?null:JSON.stringify(n.model.object.pa),n.model.selected[l.ProjectDirector]=o.stringIsNullUndefinedOrEmpty(n.model.object.projectDirector)?null:JSON.stringify(n.model.object.projectDirector),n.model.selected[l.Sdl]=o.stringIsNullUndefinedOrEmpty(n.model.list.sdl)?JSON.stringify([{clearSwitch:"N",value:null}]):JSON.stringify(n.model.list.sdl),n.model.selected[l.Td]=o.stringIsNullUndefinedOrEmpty(n.model.object.td)?null:JSON.stringify(n.model.object.td),n.model.selected[l.Lbl]=o.stringIsNullUndefinedOrEmpty(n.model.object.lbl)?null:JSON.stringify(n.model.object.lbl),n.model.selected[l.Pb]=o.stringIsNullUndefinedOrEmpty(n.model.object.pb)?null:JSON.stringify(n.model.object.pb),n.model.selected[l.SbRef]=o.stringIsNullUndefinedOrEmpty(n.model.object.sb)?null:JSON.stringify(n.model.object.sb),n.model.selected[l.GBSPASupport]=o.stringIsNullUndefinedOrEmpty(n.model.list.gbsPASupport)?JSON.stringify([{clearSwitch:"N",value:null,name:null,id:o.guid()}]):JSON.stringify(s("orderBy")(n.model.list.gbsPASupport,function(e){return e.name})),n.model.selected[l.EngageGBS]=n.model.object.engageGBS?"YES":"NO",n.ngModel=JSON.stringify(n.model.selected)),n.switchSelected=!1},!0),n.$watch("details.ApprovalItemSteps",function(){o.objectIsNullorUndefined(n.details)||o.objectIsNullorUndefined(n.details.ApprovalItemSteps)||(n.model.isLblInWorkFlow=!1,n.details.ApprovalItemSteps.forEach(function(e){-1031==e.CostPointRoleId&&(0<e.MainApprovers.length?i.GetApproverByEmail(e.MainApprovers[0].MainApproverEmail,n.model,"projectManager").then(function(){i.SetDefaultPMinFunding(n.model)}):n.model.object.projectManager=null),"Y"==e.HasLBL&&(n.model.isLblInWorkFlow=!0,!o.stringIsNullUndefinedOrEmpty(n.ngModel)&&0<n.model.list.lbl.length&&(o.stringIsNullUndefinedOrEmpty(e.StepTableBasedSelection)||(n.model.object.lbl=JSON.parse(e.StepTableBasedSelection),n.model.list.workflowLbl=angular.copy(e.TableData),c())))}))},!0)}],templateUrl:"app/views/templates/form-templates/work-at-risk-form-template.html"}})}(),function(){"use strict";angular.module("myApp").directive("delegationsEmployeeSearchTypeAhead",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asPlaceholder:"@",userEmail:"=?",forReport:"@?",smallButton:"@?",ngChange:"&"},controller:["$scope","LookupService","LookupRoleIds",function(l,o,r){function e(e){l.ngModel=e.value,l.model.input=e.value.FULL_NAME}function t(){l.model.input="",l.ngModel=null}l.model={input:""},l.search=function(e,t){var n={RoleId:r.delegationsEmployeeLookup,Parameters:{LOOKUP_VALUE:e.term,SUPERVISOR:l.userEmail}};o.Search(n).then(function(e){e&&t($.map(function(e){var t=angular.copy(e);return t=t.filter(function(e){return e.EMAIL_ADDRESS!==l.userEmail})}(e),function(e){return{label:e.FULL_NAME,value:e}}))})},l.autocompleteOnSelect=e,l.clearData=t,function(){if(null!==l.ngModel&&void 0!==l.ngModel){if(l.ngModel.hasOwnProperty("FULL_NAME"))e({value:angular.copy(l.ngModel)})}}(),l.$watch("ngModel",function(){null===l.ngModel?t():void 0===l.ngModel&&(l.model.input="")})}],templateUrl:"app/views/templates/directive-templates/generic-autocomplete.html"}})}(),function(){"use strict";angular.module("myApp").directive("dropdownSearch",function(){return{restrict:"E",require:"ngModel",scope:{options:"=",searchLimit:"=?",ngModel:"=",displayProp:"@?",defaultMessage:"@?",disabledMessage:"@?",selectionLimit:"=?",searchFilter:"=?",disabled:"=?ngDisabled",classesBtn:"=?",placeholder:"@?"},controller:["$scope",function(o){o.toggleDropdown=function(){o.open=!o.open},o.selectItem=function(e){o.ngModel=e,o.open=!1},o.Init=function(e){if(0<e.length){for(var t=Object.keys(e[0]),n="",l=0;l<t.length;l++)n+=l==t.length-1?" and "+t[l].toLowerCase():t[l].toLowerCase()+", ";o.message="Fields searched include: "+n}else o.message="No items to search"}}],templateUrl:"app/views/templates/directive-templates/dropdown-search.html"}})}(),function(){"use strict";angular.module("myApp").directive("employeeSearchTypeAheadAutoPopulated",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asPlaceholder:"@",filterList:"=?",forReport:"@?",smallButton:"@?",ngChange:"&",clearSwitch:"=?",oldValue:"=?"},controller:["$scope","LookupService",function(n,l){function e(){null!==n.ngModel&&void 0!==n.ngModel&&n.ngModel.hasOwnProperty("FULL_NAME")&&t({value:angular.copy(n.ngModel)})}function t(e){n.ngModel=e.value,n.oldValue=e.value,n.model.input=e.value.FULL_NAME}function o(e){"Y"===e&&(n.oldValue="N"),n.model.input="",n.ngModel=null}n.model={input:""},n.search=function(e,t){l.SearchEmployee(e.term,50).then(function(e){e&&t($.map(n.filterList?function(e,t){var n=angular.copy(e);return t.forEach(function(t){n=n.filter(function(e){return e.EMAIL_ADDRESS!==t.userName})}),n}(e,n.filterList):e,function(e){return{label:e.FULL_NAME,value:e}}))})},n.autocompleteOnSelect=t,n.clearData=o,e(),n.$watch("ngModel",function(){null===n.ngModel?o("N"):void 0===n.ngModel&&(n.model.input=""),"Y"===n.clearSwitch&&(e(),n.clearSwitch="N")})}],templateUrl:"app/views/templates/directive-templates/generic-autocomplete-old-value.html"}})}(),function(){"use strict";angular.module("myApp").directive("employeeSearchTypeAheadGbsPa",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",gbsName:"=",asPlaceholder:"@",filterList:"=?",forReport:"@?",smallButton:"@?",ngChange:"&",clearSwitch:"=?"},controller:["$scope","LookupService",function(n,l){function e(){null!==n.ngModel&&void 0!==n.ngModel&&n.ngModel.hasOwnProperty("FULL_NAME")&&t({value:angular.copy(n.ngModel)})}function t(e){n.ngModel=e.value,n.gbsName=e.value.FULL_NAME,n.model.input=e.value.FULL_NAME}function o(){n.model.input="",n.gbsName=null,n.ngModel=null}n.model={input:""},n.search=function(e,t){l.SearchEmployee(e.term,50).then(function(e){e&&t($.map(n.filterList?function(e,t){var n=angular.copy(e);return t.forEach(function(t){n=n.filter(function(e){return e.EMAIL_ADDRESS!==t.userName})}),n}(e,n.filterList):e,function(e){return{label:e.FULL_NAME,value:e}}))})},n.autocompleteOnSelect=t,n.clearData=o,e(),n.$watch("ngModel",function(){null===n.ngModel?o():void 0===n.ngModel&&(n.model.input="",n.gbsName=null),"Y"===n.clearSwitch&&(e(),n.clearSwitch="N")})}],templateUrl:"app/views/templates/directive-templates/generic-autocomplete.html"}})}(),function(){"use strict";angular.module("myApp").directive("employeeSearchTypeAhead",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asPlaceholder:"@",filterList:"=?",forReport:"@?",smallButton:"@?",ngChange:"&",clearSwitch:"=?"},controller:["$scope","LookupService",function(n,l){function e(){null!==n.ngModel&&void 0!==n.ngModel&&n.ngModel.hasOwnProperty("FULL_NAME")&&t({value:angular.copy(n.ngModel)})}function t(e){n.ngModel=e.value,n.model.input=e.value.FULL_NAME}function o(){n.model.input="",n.ngModel=null}n.model={input:""},n.search=function(e,t){l.SearchEmployee(e.term,50).then(function(e){e&&t($.map(n.filterList?function(e,t){var n=angular.copy(e);return t.forEach(function(t){n=n.filter(function(e){return e.EMAIL_ADDRESS!==t.userName})}),n}(e,n.filterList):e,function(e){return{label:e.FULL_NAME,value:e}}))})},n.autocompleteOnSelect=t,n.clearData=o,e(),n.$watch("ngModel",function(){null===n.ngModel?o():void 0===n.ngModel&&(n.model.input=""),"Y"===n.clearSwitch&&(e(),n.clearSwitch="N")})}],templateUrl:"app/views/templates/directive-templates/generic-autocomplete.html"}})}(),function(){"use strict";function e(l,o){return{restrict:"A",link:function(e,t,n){o.pdfImageSaveButtons.push(t),e.buttonText="Button",t.on("click",function(){$("#overlayloader").show();var e=n.pdfImageSaveButton,t=n.pdfName;l.$broadcast("saveImagePdfEvent",{activePdfSaveId:e,activePdfSaveName:t})})}}}function t(e,p){return{link:function(e,u,t){p.pdfImageSaveContents.push(u);var n=e.$on("saveImagePdfEvent",function(e,t){for(var n=u[0].getAttribute("pdf-image-save-content"),l=p.pdfImageSaveContents,o=t.activePdfSaveId,c=t.activePdfSaveName||"default.pdf",d=[],r=0;r<l.length;r++)if(a(o,n)){var i=l[r][0].getAttribute("pdf-image-save-content");if(a(i,o)){l,function(e,t){$("div[pdf-image-save-content="+t+"]")[0];for(var n=new jsPDF("l","pt","legal"),l=$("div[pdf-image-save-content="+t+"] [pdf-page]").length||1,o=0;o<l;o++)d.push(s.bind(this,t,o,n));d[0]()}(0,i);break}}function a(e,t){return e==t}function s(e,a,s){var u=1<($("div[pdf-image-save-content="+e+"] [pdf-page]").length||1)?$("div[pdf-image-save-content="+e+"] [pdf-page="+(a+1)+"]")[0]:$("div[pdf-image-save-content="+e+"]")[0];htmlToImage.toCanvas(u).then(function(e){for(var t=0;t<=u.clientHeight/900;t++){var n=e,l=900*t;window.onePageCanvas=document.createElement("canvas"),onePageCanvas.setAttribute("width",1580),onePageCanvas.setAttribute("height",900),onePageCanvas.style.backgroundColor="white",onePageCanvas.getContext("2d").drawImage(n,0,l,1580,900,0,0,1580,900);var o=onePageCanvas.toDataURL("image/png",1),r=onePageCanvas.width,i=onePageCanvas.clientHeight;0<t&&s.addPage(1008,612),s.addImage(o,"png",20,40,.62*r,.62*i)}a===d.length-1?s.save(c):(s.addPage(1008,612),d[a+1]()),$("#overlayloader").hide()}).catch(function(e){$("#overlayloader").hide()})}});e.$on("$destroy",n)}}}angular.module("myApp").directive("pdfImageSaveButton",e).directive("pdfImageSaveContent",t).service("$pdfImageStorage",function(){this.pdfImageSaveButtons=[],this.pdfImageSaveContents=[]}),e.$inject=["$rootScope","$pdfImageStorage"],t.$inject=["$rootScope","$pdfImageStorage"]}(),function(){"use strict";function e(o,n){return{restrict:"A",link:function(e,t,l){n.pdfSaveButtons.push(t),e.buttonText="Button",t.on("click",function(){var e=l.pdfSaveButton,t=l.pdfName,n=l.pdfRequiresReload;o.$broadcast("savePdfEvent",{activePdfSaveId:e,activePdfSaveName:t,requiresreload:n})})}}}function t(e,m){return{link:function(e,u,t){m.pdfSaveContents.push(u);var n=e.$on("savePdfEvent",function(e,t){var n=u[0].getAttribute("pdf-save-content");$("#overlayloader").show();for(var l=m.pdfSaveContents,o=t.activePdfSaveId,c=t.requiresreload||!1,d=t.activePdfSaveName||"default.pdf",p=[],r=0;r<l.length;r++)if(a(o,n)){var i=l[r][0].getAttribute("pdf-save-content");if(a(i,o)){l,function(e,t){$("div[pdf-save-content="+t+"]")[0];for(var n=new jsPDF("l","pt","legal"),l=$("div[pdf-save-content="+t+"] [pdf-page]").length||1,o=0;o<l;o++)p.push(s.bind(this,t,o,n));p[0]()}(0,i);break}}function a(e,t){return e==t}function s(e,a,s){var u=1<($("div[pdf-save-content="+e+"] [pdf-page]").length||1)?$("div[pdf-save-content="+e+"] [pdf-page="+(a+1)+"]")[0]:$("div[pdf-save-content="+e+"]")[0];html2canvas(u,{onrendered:function(e){for(var t=0;t<=u.clientHeight/900;t++){var n=e,l=900*t;window.onePageCanvas=document.createElement("canvas"),onePageCanvas.setAttribute("width",1580),onePageCanvas.setAttribute("height",900),onePageCanvas.getContext("2d").drawImage(n,0,l,1580,900,0,0,1580,900);var o=onePageCanvas.toDataURL("image/jpeg",1),r=onePageCanvas.width,i=onePageCanvas.clientHeight;0<t&&s.addPage(1008,612),s.addImage(o,"JPEG",20,40,.62*r,.62*i)}a===p.length-1?(s.save(d),c?location.reload():$("#overlayloader").hide()):(s.addPage(1008,612),p[a+1]())}})}});e.$on("$destroy",n)}}}angular.module("myApp").directive("pdfSaveButton",e).directive("pdfSaveContent",t).service("$pdfStorage",function(){this.pdfSaveButtons=[],this.pdfSaveContents=[]}).service("pdfSaveConfig",function(){this.pdfName="default.pdf"}),e.$inject=["$rootScope","$pdfStorage"],t.$inject=["$rootScope","$pdfStorage"]}(),function(){"use strict";angular.module("myApp").constant("agreementAutocompleteLabels",{Title:"Agreement (Active)",SearchLabel:"Search Agreement",IdLabel:"Agreement Number",NameLabel:"Agreement Name"}).constant("agreementAutocompletePropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME"}).directive("agreementAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",agreementId:"="},controller:["$scope","LookupService","agreementAutocompleteLabels","LookupRoleIds","agreementAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.agreementRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Id]+" - "+e[i.Name],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.agreementId||""!==t.agreementId)&&void 0!==t.agreementId){var e={RoleId:r.agreementRoleId,Parameters:{LOOKUP_VALUE:t.agreementId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Id]+" - "+e[0][i.Name],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("agreementClosedAutocompleteLabels",{Title:"Agreements (Closed)",SearchLabel:"Search Closed Agreement",IdLabel:"Agreement ID",NameLabel:"Agreement Name"}).constant("agreementClosedAutocompletePropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME"}).directive("agreementClosedAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",agreementId:"="},controller:["$scope","LookupService","agreementClosedAutocompleteLabels","LookupRoleIds","agreementClosedAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.agreementClosedRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Id]+" - "+e[i.Name],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.agreementId||""!==t.agreementId)&&void 0!==t.agreementId){var e={RoleId:r.agreementClosedRoleId,Parameters:{LOOKUP_VALUE:t.agreementId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Id]+" - "+e[0][i.Name],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("agreementOpportunityProjectAutocompleteLabels",{Title:"Opportunities/Agreements/Projects (Active)",SearchLabel:"Search Opportunity / Agreement / Project",IdLabel:"Opportunity / Agreement / Project Number",NameLabel:"Opportunity / Agreement / Project Name"}).constant("agreementOpportunityProjectAutocompletePropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME"}).directive("agreementOpportunityProjectAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",agreementOpportunityProjectId:"="},controller:["$scope","LookupService","agreementOpportunityProjectAutocompleteLabels","LookupRoleIds","agreementOpportunityProjectAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.agreementOpportunityProjectRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Id]+" - "+e[i.Name],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.agreementOpportunityProjectId||""!==t.agreementOpportunityProjectId)&&void 0!==t.projectOpportunityId){var e={RoleId:r.agreementOpportunityProjectRoleId,Parameters:{LOOKUP_VALUE:t.agreementOpportunityProjectId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Id]+" - "+e[0][i.Name],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("agreementProjectAutocompleteLabels",{Title:"Agreements/Direct Projects (Active)",SearchLabel:"Search Agreement / Project",IdLabel:"Agreement / Project Number",NameLabel:"Agreement / Project Name"}).constant("agreementProjectAutocompletePropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME"}).directive("agreementProjectAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",objectId:"="},controller:["$scope","LookupService","agreementProjectAutocompleteLabels","LookupRoleIds","agreementProjectAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.agreementProjectRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Id]+" - "+e[i.Name],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.objectId||""!==t.objectId)&&void 0!==t.objectId){var e={RoleId:r.agreementProjectRoleId,Parameters:{LOOKUP_VALUE:t.objectId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Id]+" - "+e[0][i.Name],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("agreementProjectClosedAutocompleteLabels",{Title:"Agreements/Direct Projects (Closed)",SearchLabel:"Search Closed Agreement / Project",IdLabel:"Agreement / Project Number",NameLabel:"Agreement / Project Name"}).constant("agreementProjectClosedAutocompletePropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME",Display:"OBJECT_DISPLAY"}).directive("agreementProjectClosedAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",agreementProjectId:"="},controller:["$scope","LookupService","agreementProjectClosedAutocompleteLabels","LookupRoleIds","agreementProjectClosedAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.agreementProjectClosedRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Display],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.agreementProjectId||""!==t.agreementProjectId)&&void 0!==t.agreementProjectId){var e={RoleId:r.agreementProjectClosedRoleId,Parameters:{LOOKUP_VALUE:t.agreementProjectId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Display],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("areasAutocompleteLabels",{Title:"Areas",SearchLabel:"Search Areas",IdLabel:"Area ID",NameLabel:"Area Name"}).constant("areasAutocompletePropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME"}).directive("areasAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",areaId:"="},controller:["$scope","LookupService","areasAutocompleteLabels","LookupRoleIds","areasAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.areasRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Id]+" - "+e[i.Name],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.areaId||""!==t.areaId)&&void 0!==t.areaId){var e={RoleId:r.areasRoleId,Parameters:{LOOKUP_VALUE:t.areaId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Id]+" - "+e[0][i.Name],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("bankaccountDropdownLabels",{Title:"Bank Account",SearchLabel:"Search Bank Account",IdLabel:"Bank ID",NameLabel:"Bank Name"}).constant("bankaccountDropdownPropertyNames",{Id:"BANK_ID",Name:"BANK_NAME"}).directive("bankaccountDropdownControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",projectId:"=",stringify:"=",asForm:"="},controller:["$scope","LookupService","bankaccountDropdownLabels","LookupRoleIds","bankaccountDropdownPropertyNames",function(t,e,n,l,o){function r(){if(null!==t.projectId&&void 0!==t.projectId)return e.GetBankAccounts(t.projectId).then(function(e){t.model.list=function(e){void 0!==e&&e.forEach(function(e){e._value=e[o.Id]+" - "+e[o.Name],e._label=n.Title,e.PROJ_ID=t.projectId});return e}(e)})}t.model={labels:n,properties:o,list:[],selected:null,errorMessage:null},t.onChange_Dropdown=function(e){t.ngModel=t.stringify?JSON.stringify(e):angular.copy(e)},t.$watch("projectId",function(){r()}),t.$watch("ngModel",function(){!function(){if(t.ngModel&&!angular.isUndefined(t.ngModel)){var e=t.ngModel;e&&!t.asForm&&(t.model.selected=t.stringify?JSON.parse(e):angular.copy(e))}}()})}],templateUrl:"app/views/templates/lookup-templates/bankcashaccount-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("cascadingOracleHierarchyControlLabels",{Title:"Oracle Hierarchy"}).constant("cascadingOracleHierarchyControlPropertyNames",{Level1:"DIVISION",Level2:"DISTRICT",Level3:"AREA",Level4:"COST_CENTER",CostCenterId:"COST_CENTER_ID",CostCenterName:"COST_CENTER_NAME",AreaId:"AREA_ID",AreaName:"AREA_NAME",DistrictId:"DISTRICT_ID",DistrictName:"DISTRICT_NAME",DivisionId:"DIVISION_ID",DvisionName:"DIVISION_NAME",CompanyNumber:"COMPANY_NUMBER",CompanyName:"COMPANY_NAME",OpertatingUnitId:"OPERATING_UNIT_ID",OperatingUnitName:"OPERATING_UNIT_NAME",CcMgrId:"CC_MGR_ID",AreaMgrId:"AREA_MGR_ID",DistrictMgrId:"DISTRICT_MGR_ID",DivisionMgrId:"DIVISION_MGR_ID",InactiveCC:"INACTIVE_CC",LastSyncDate:"LAST_SYNC_DATE",Company:"COMPANY_NUMBER_NAME",Lbl:"LOCAL_BUSINESS_LINE",PA:"PA"}).directive("cascadingOracleHierarchyControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",stringify:"=",asForm:"="},controller:["$scope","LookupService","cascadingOracleHierarchyControlLabels","LookupRoleIds","cascadingOracleHierarchyControlPropertyNames","GngFormBusiness","astigUtilityService","ProjectSetupFormBusiness",function(n,e,l,t,o,r,i,a){function s(){i.stringIsNullUndefinedOrEmpty(n.ngModel)?u():(n.model.selected=n.stringify?JSON.parse(n.ngModel):n.ngModel,n.showForm=!1,u().then(function(e){var t=n.stringify?JSON.parse(n.ngModel):n.ngModel[o.CostCenterId];a.GetLocalBusinessLineForLead(t,n.isCrm).then(function(e){n.model.list.lbl=angular.copy(e),function(t){n.model.object.division=i.stringIsNullUndefinedOrEmpty(t[o.Level1])?null:n.model.list.division.find(function(e){return e.COST_CENTER_ID==(n.stringify?JSON.parse(t[o.Level1]).COST_CENTER_ID:t[o.Level1].COST_CENTER_ID)}),n.model.object.district=i.stringIsNullUndefinedOrEmpty(t[o.Level2])?null:n.model.list.division.find(function(e){return e.COST_CENTER_ID==(n.stringify?JSON.parse(t[o.Level2]).COST_CENTER_ID:t[o.Level2].COST_CENTER_ID)}),n.model.object.area=i.stringIsNullUndefinedOrEmpty(t[o.Level3])?null:n.model.list.division.find(function(e){return e.COST_CENTER_ID==(n.stringify?JSON.parse(t[o.Level3]).COST_CENTER_ID:t[o.Level3].COST_CENTER_ID)}),n.model.object.costCenter=i.stringIsNullUndefinedOrEmpty(t[o.Level4])?null:n.model.list.division.find(function(e){return e.COST_CENTER_ID==(n.stringify?JSON.parse(t[o.Level4]).COST_CENTER_ID:t[o.Level4].COST_CENTER_ID)}),n.model.object.lbl=i.stringIsNullUndefinedOrEmpty(t[o.Lbl])?null:n.model.list.lbl.find(function(e){return e.TableDataRoleId==(n.stringify?JSON.parse(t[o.Lbl]).TableDataRoleId:t[o.Lbl].TableDataRoleId)}),r.GetCompany(n.model,o),n.model.list.district=null!==n.model.object.division?c("DIVISION_ID",n.model.object.division,n.model.list.division,!0):null,n.model.list.area=null!==n.model.object.district?c("DISTRICT_ID",n.model.object.district,n.model.list.district,!0):null,n.model.list.costCenter=null!==n.model.object.area?c("AREA_ID",n.model.object.area,n.model.list.area,!0):null,n.model.selected._value=n.model.object.costCenter.DIVISION_NAME+"<br/>"+n.model.object.costCenter.DISTRICT_NAME+"<br/>"+n.model.object.costCenter.AREA_NAME+"<br/>"+n.model.object.costCenter.COST_CENTER_NAME+(i.stringIsNullUndefinedOrEmpty(n.model.object.lbl)?"<br/>":"<br/>"+n.model.object.lbl.TableDataName+"<br/>")+n.model.object.costCenter.COMPANY_NUMBER+" - "+n.model.object.costCenter.COMPANY_NAME,n.model.selected._label=l.Title,n.showForm=!0}(n.model.selected)})}))}function u(){return r.GetAllOracleHierarchyList().then(function(e){void 0!==e&&(n.model.list.division=angular.copy(e))})}function c(t,n,e,l){return e.filter(function(e){return null!=n&&""!==n&&(l?parseInt(e[t])===parseInt(n[t]):e[t]===n[t])})}n.model={labels:l,properties:o,list:{division:[],district:[],area:[],costCenter:[],lbl:[]},selected:{},errorMessage:null,object:{division:null,district:null,area:null,costCenter:null,lbl:null}},n.showForm=!0,n.clearForm=function(){n.model.object.division=null,n.model.object.area=null,n.model.list.district=[],n.model.list.area=[],n.model.list.lbl=[],n.model.list.costCenter=[],n.model.object.district=null,n.model.object.costCenter=null,n.model.object.lbl=null,n.model.selected={},n.ngModel=null},n.switchObject=!0,n.events={onChange_Division:function(e){r.GetDistrictList(n.model,e)},onChange_District:function(e){r.GetAreaList(n.model,e)},onChange_Area:function(e){r.GetCostCenterList(n.model,e)},onChange_CostCenter:function(e){i.stringIsNullUndefinedOrEmpty(n.model.object.costCenter)||(a.GetLocalBusinessLineForLead(n.model.object.costCenter.COST_CENTER_ID,n.isCrm).then(function(e){n.model.list.lbl=angular.copy(e)}),r.GetCompany(n.model,e),n.model.selected[e.CostCenterId]=angular.copy(n.model.object.costCenter.COST_CENTER_ID),n.model.selected[e.CostCenterName]=angular.copy(n.model.object.costCenter.COST_CENTER_NAME),n.model.selected[e.AreaId]=angular.copy(n.model.object.costCenter.AREA_ID),n.model.selected[e.AreaName]=angular.copy(n.model.object.costCenter.AREA_NAME),n.model.selected[e.DistrictId]=angular.copy(n.model.object.costCenter.DISTRICT_ID),n.model.selected[e.DistrictName]=angular.copy(n.model.object.costCenter.DISTRICT_NAME),n.model.selected[e.DivisionId]=angular.copy(n.model.object.costCenter.DIVISION_ID),n.model.selected[e.DvisionName]=angular.copy(n.model.object.costCenter.DIVISION_NAME),n.model.selected[e.CompanyNumber]=angular.copy(n.model.object.costCenter.COMPANY_NUMBER),n.model.selected[e.CompanyName]=angular.copy(n.model.object.costCenter.COMPANY_NAME),n.model.selected[e.OpertatingUnitId]=angular.copy(n.model.object.costCenter.OPERATING_UNIT_ID),n.model.selected[e.OperatingUnitName]=angular.copy(n.model.object.costCenter.OPERATING_UNIT_NAME),n.model.selected[e.CcMgrId]=angular.copy(n.model.object.costCenter.CC_MGR_ID),n.model.selected[e.AreaMgrId]=angular.copy(n.model.object.costCenter.AREA_MGR_ID),n.model.selected[e.DistrictMgrId]=angular.copy(n.model.object.costCenter.DISTRICT_MGR_ID),n.model.selected[e.DivisionMgrId]=angular.copy(n.model.object.costCenter.DIVISION_MGR_ID),n.model.selected[e.InactiveCC]=angular.copy(n.model.object.costCenter.INACTIVE_CC),n.model.selected[e.LastSyncDate]=angular.copy(n.model.object.costCenter.LAST_SYNC_DATE),n.model.selected[e.Level1]=i.stringIsNullUndefinedOrEmpty(n.model.object.division)?null:n.stringify?JSON.stringify(n.model.object.division):n.model.object.division,n.model.selected[e.Level2]=i.stringIsNullUndefinedOrEmpty(n.model.object.district)?null:n.stringify?JSON.stringify(n.model.object.district):n.model.object.district,n.model.selected[e.Level3]=i.stringIsNullUndefinedOrEmpty(n.model.object.area)?null:n.stringify?JSON.stringify(n.model.object.area):n.model.object.area,n.model.selected[e.Level4]=i.stringIsNullUndefinedOrEmpty(n.model.object.costCenter)?null:n.stringify?JSON.stringify(n.model.object.costCenter):n.model.object.costCenter,n.model.selected[e.Lbl]=i.stringIsNullUndefinedOrEmpty(n.model.object.lbl)?null:n.stringify?JSON.stringify(n.model.object.lbl):angular.copy(n.model.object.lbl),n.model.selected._value=n.model.object.costCenter.DIVISION_NAME+"<br/>"+n.model.object.costCenter.DISTRICT_NAME+"<br/>"+n.model.object.costCenter.AREA_NAME+"<br/>"+n.model.object.costCenter.COST_CENTER_NAME+"<br/>"+n.model.object.costCenter.COMPANY_NUMBER+" - "+n.model.object.costCenter.COMPANY_NAME,n.model.selected._label=l.Title,n.ngModel=n.stringify?JSON.stringify(n.model.selected):n.model.selected)},onChange_Lbl:function(){i.stringIsNullUndefinedOrEmpty(n.model.object.lbl)||(n.model.selected[o.PA]=angular.copy(n.model.object.lbl.EMPLOYEE_NUMBER),n.model.selected[o.Lbl]=i.stringIsNullUndefinedOrEmpty(n.model.object.lbl)?null:n.stringify?JSON.stringify(n.model.object.lbl):angular.copy(n.model.object.lbl),n.model.selected._value=n.model.object.costCenter.DIVISION_NAME+"<br/>"+n.model.object.costCenter.DISTRICT_NAME+"<br/>"+n.model.object.costCenter.AREA_NAME+"<br/>"+n.model.object.costCenter.COST_CENTER_NAME+"<br/>"+(i.stringIsNullUndefinedOrEmpty(n.model.object.lbl)?"":n.model.object.lbl.TableDataName+"<br/>")+n.model.object.costCenter.COMPANY_NUMBER+" - "+n.model.object.costCenter.COMPANY_NAME,n.ngModel=n.stringify?JSON.stringify(n.model.selected):n.model.selected)}},n.validations={validateCascadingRequiredField:function(e,t){return i.stringIsNullUndefinedOrEmpty(e)&&null!=t&&""!==t&&JSON.stringify(t)!==JSON.stringify([])}},s(),n.$watch("ngModel",function(){s()})}],templateUrl:"app/views/templates/lookup-templates/cascading-oracle-hierarchy-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("cashaccountDropdownLabels",{Title:"Cash Account",SearchLabel:"Search Cash Account",IdLabel:"Bank ID",NameLabel:"Bank Name"}).constant("cashaccountDropdownPropertyNames",{Id:"BANK_ID",Name:"BANK_NAME"}).directive("cashaccountDropdownControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",projectId:"=",stringify:"=",asForm:"="},controller:["$scope","LookupService","cashaccountDropdownLabels","LookupRoleIds","cashaccountDropdownPropertyNames",function(t,e,n,l,o){function r(){if(null!==t.projectId&&void 0!==t.projectId)return e.GetCashAccounts(t.projectId).then(function(e){t.model.list=function(e){void 0!==e&&e.forEach(function(e){e._value=e[o.Id]+" - "+e[o.Name],e._label=n.Title,e.PROJ_ID=t.projectId});return e}(e)})}t.model={labels:n,properties:o,list:[],selected:null,errorMessage:null},t.onChange_Dropdown=function(e){t.ngModel=t.stringify?JSON.stringify(e):angular.copy(e)},t.$watch("projectId",function(){r()}),t.$watch("ngModel",function(){!function(){if(t.ngModel&&!angular.isUndefined(t.ngModel)){var e=t.ngModel;e&&!t.asForm&&(t.model.selected=t.stringify?JSON.parse(e):angular.copy(e))}}()})}],templateUrl:"app/views/templates/lookup-templates/bankcashaccount-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("clientActiveCrmAutocompleteLabels",{Title:"Clients (Active per CRM)",SearchLabel:"Search Client Active per Crm",IdLabel:"Client ID",NameLabel:"Client Name"}).constant("clientActiveCrmAutocompletePropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME",Display:"OBJECT_DISPLAY"}).directive("clientActiveCrmAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",clientId:"="},controller:["$scope","LookupService","clientActiveCrmAutocompleteLabels","LookupRoleIds","clientActiveCrmAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.clientActiveCrmRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Display],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.clientId||""!==t.clientId)&&void 0!==t.clientId){var e={RoleId:r.clientActiveCrmRoleId,Parameters:{LOOKUP_VALUE:t.clientId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Display],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("clientAutocompleteLabels",{Title:"Clients (per CRM)",SearchLabel:"Search Client",IdLabel:"Client Number",NameLabel:"Client Name"}).constant("clientAutocompletePropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME",Display:"OBJECT_DISPLAY"}).directive("clientAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",clientId:"="},controller:["$scope","LookupService","clientAutocompleteLabels","LookupRoleIds","clientAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.clientRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Display],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.clientId||""!==t.clientId)&&void 0!==t.clientId){var e={RoleId:r.clientRoleId,Parameters:{LOOKUP_VALUE:t.clientId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Display],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("clientCustomerAllActiveAutocompleteLabels",{Title:"All Clients/Customers (Active)",SearchLabel:"Search Client / Customer",IdLabel:"Client / Customer Number",NameLabel:"Client / Customer Name"}).constant("clientCustomerAllActiveAutocompletePropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME",Display:"OBJECT_DISPLAY"}).directive("clientCustomerAllActiveAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",clientCustomerId:"="},controller:["$scope","LookupService","clientCustomerAllActiveAutocompleteLabels","LookupRoleIds","clientCustomerAllActiveAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.clientCustomerAllActiveRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Display],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.clientCustomerId||""!==t.clientCustomerId)&&void 0!==t.clientCustomerId){var e={RoleId:r.clientCustomerAllActiveRoleId,Parameters:{LOOKUP_VALUE:t.clientCustomerId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Display],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("clientCustomerErpAutocompleteLabels",{Title:"All Clients/Customers",SearchLabel:"Search Client/Customer",IdLabel:"Client / Customer Number",NameLabel:"Client / Customer Name"}).constant("clientCustomerErpAutocompletePropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME",Display:"OBJECT_DISPLAY"}).directive("clientCustomerErpAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",clientCustomerId:"="},controller:["$scope","LookupService","clientCustomerErpAutocompleteLabels","LookupRoleIds","clientCustomerErpAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.clientCustomerErpRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Display],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.clientCustomerId||""!==t.clientCustomerId)&&void 0!==t.clientCustomerId){var e={RoleId:r.clientCustomerErpRoleId,Parameters:{LOOKUP_VALUE:t.clientCustomerId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Display],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("companyAutocompleteLabels",{Title:"Companies",SearchLabel:"Search Companies",IdLabel:"Company ID",NameLabel:"Company Name"}).constant("companyAutocompletePropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME"}).directive("companyAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",companyId:"="},controller:["$scope","LookupService","companyAutocompleteLabels","LookupRoleIds","companyAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.companyRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Id]+" - "+e[i.Name],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.companyId||""!==t.companyId)&&void 0!==t.companyId){var e={RoleId:r.companyRoleId,Parameters:{LOOKUP_VALUE:t.companyId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Id]+" - "+e[0][i.Name],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("costCenterInactiveAutocompleteLabels",{Title:"Cost Center Inactive",SearchLabel:"Search Inactive Cost Centers",IdLabel:"Cost Center Number",NameLabel:"Cost Center Name"}).constant("costCenterInactiveAutocompletePropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME",Display:"OBJECT_DISPLAY"}).directive("costCenterInactiveAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",costCenterId:"="},controller:["$scope","LookupService","costCenterInactiveAutocompleteLabels","LookupRoleIds","costCenterInactiveAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.costCenterInactiveRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Display],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.costCenterId||""!==t.costCenterId)&&void 0!==t.costCenterId){var e={RoleId:r.costCenterInactiveRoleId,Parameters:{LOOKUP_VALUE:t.costCenterId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Display],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("customerActiveErpAutocompleteLabels",{Title:"Customers (Active, per ERP)",SearchLabel:"Search Active ERP Customer",IdLabel:"Customer Number",NameLabel:"Customer Name"}).constant("customerActiveErpAutocompletePropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME",Display:"OBJECT_DISPLAY"}).directive("customerActiveErpAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",customerId:"="},controller:["$scope","LookupService","customerActiveErpAutocompleteLabels","LookupRoleIds","customerActiveErpAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.customerActiveErpRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Display],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.customerId||""!==t.customerId)&&void 0!==t.customerId){var e={RoleId:r.customerActiveErpRoleId,Parameters:{LOOKUP_VALUE:t.customerId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Display],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("districtsAutocompleteLabels",{Title:"Districts",SearchLabel:"Search Districts",IdLabel:"Districts ID",NameLabel:"Districts Name"}).constant("districtsAutocompletePropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME"}).directive("districtsAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",districtId:"="},controller:["$scope","LookupService","districtsAutocompleteLabels","LookupRoleIds","districtsAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.districtsRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Id]+" - "+e[i.Name],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.districtId||""!==t.districtId)&&void 0!==t.districtId){var e={RoleId:r.districtsRoleId,Parameters:{LOOKUP_VALUE:t.districtId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Id]+" - "+e[0][i.Name],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("divisionAutocompleteLabels",{Title:"Division",SearchLabel:"Search Division",IdLabel:"Division ID",NameLabel:"Division Name"}).constant("divisionAutocompletePropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME"}).directive("divisionAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",divisionId:"="},controller:["$scope","LookupService","divisionAutocompleteLabels","LookupRoleIds","divisionAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.divisionRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Id]+" - "+e[i.Name],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.divisionId||""!==t.divisionId)&&void 0!==t.divisionId){var e={RoleId:r.divisionRoleId,Parameters:{LOOKUP_VALUE:t.divisionId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Id]+" - "+e[0][i.Name],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("employeeAutocompleteLabels",{Title:"Employees (Current)",SearchLabel:"Search Employees",IdLabel:"Employee Number",NameLabel:"Employee Name"}).constant("employeeAutocompletePropertyNames",{Id:"EMPLOYEE_NUMBER",Name:"LAST_FIRST_NAME",CostCenter:"COST_CENTER_ID"}).directive("employeeAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",employeeId:"="},controller:["$scope","LookupService","employeeAutocompleteLabels","LookupRoleIds","employeeAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.employeeRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Id]+" - "+e[i.Name],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.employeeId||""!==t.employeeId)&&void 0!==t.employeeId){var e={RoleId:r.employeeRoleId,Parameters:{LOOKUP_VALUE:t.employeeId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Id]+" - "+e[0][i.Name],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("employeeDivsionSpecificAutocompleteLabels",{Title:"Division Specific Employee",SearchLabel:"Search Employee",IdLabel:"Employee Number",NameLabel:"Employee Name"}).constant("employeeDivsionSpecificAutocompletePropertyNames",{Id:"EMPLOYEE_NUMBER",Name:"LAST_FIRST_NAME"}).directive("employeeDivsionSpecificAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",currentDivisionLevel:"@?",employeeId:"="},controller:["$scope","LookupService","employeeDivsionSpecificAutocompleteLabels","LookupRoleIds","employeeDivsionSpecificAutocompletePropertyNames",function(l,o,r,i,a){l.model={labels:r,properties:a,input:"",list:[],selected:null,errorMessage:null},l.search=function(e,t){var n={RoleId:i.employeeRoleId,Parameters:{SEARCH_VALUE:e.term,DIVISION:"LBINT"===l.currentDivisionLevel?"LBI":l.currentDivisionLevel}};o.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[a.Id]+" - "+e[a.Name],e._label=r.Title,{label:e._value,value:e}}))})},l.autocompleteOnSelect=function(e){l.model.selected=e.value,l.ngModel=l.stringify?JSON.stringify(e.value):e.value,l.$apply()},l.clearForm=function(){l.model.input="",l.model.selected=null,l.ngModel=null},l.$watch("ngModel",function(){!function(){if(l.model.selected=l.stringify?JSON.parse(l.ngModel):l.ngModel,(null!==l.employeeId||""!==l.employeeId)&&void 0!==l.employeeId){var e={RoleId:i.employeeRoleId,Parameters:{SEARCH_VALUE:l.employeeId,DIVISION:"LBINT"===l.currentDivisionLevel?"LBI":l.currentDivisionLevel}};o.Search(e).then(function(e){e[0]._value=e[0][a.Id]+" - "+e[0][a.Name],e[0]._label=r.Title,l.model.selected=e[0],l.ngModel=l.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("employeeInactiveAutocompleteLabels",{Title:"Employees (Inactive)",SearchLabel:"Search Inactive Employee",IdLabel:"Employee Number",NameLabel:"Employee Name"}).constant("employeeInactiveAutocompletePropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME",Display:"OBJECT_DISPLAY"}).directive("employeeInactiveAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",employeeId:"="},controller:["$scope","LookupService","employeeInactiveAutocompleteLabels","LookupRoleIds","employeeInactiveAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.employeeInactiveRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Display],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.employeeId||""!==t.employeeId)&&void 0!==t.employeeId){var e={RoleId:r.employeeInactiveRoleId,Parameters:{LOOKUP_VALUE:t.employeeId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Display],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("inactiveOrgAutocompleteLabels",{Title:"Inactive Organization",SearchLabel:"Search Organization",IdLabel:"Organization ID",NameLabel:"Organization Name"}).constant("inactiveOrgAutocompletePropertyNames",{Id:"ORG_ID",Name:"ORG_NAME"}).directive("inactiveOrgAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",currentDivisionLevel:"@?",orgId:"="},controller:["$scope","LookupService","inactiveOrgAutocompleteLabels","LookupRoleIds","inactiveOrgAutocompletePropertyNames",function(l,o,r,i,a){l.model={labels:r,properties:a,input:"",list:[],selected:null,errorMessage:null},l.search=function(e,t){var n={RoleId:i.orgRoleId,Parameters:{SEARCH_VALUE:e.term,DIVISION:"LBINT"===l.currentDivisionLevel?"LBI":l.currentDivisionLevel,ACTIVE_FL:"N"}};o.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[a.Id]+" - "+e[a.Name],e._label=r.Title,{label:e._value,value:e}}))})},l.autocompleteOnSelect=function(e){l.model.selected=e.value,l.ngModel=l.stringify?JSON.stringify(e.value):e.value,l.$apply()},l.clearForm=function(){l.model.input="",l.model.selected=null,l.ngModel=null},l.$watch("ngModel",function(){!function(){if(l.model.selected=l.stringify?JSON.parse(l.ngModel):l.ngModel,(null!==l.orgId||""!==l.orgId)&&void 0!==l.orgId){var e={RoleId:i.orgRoleId,Parameters:{SEARCH_VALUE:l.orgId,DIVISION:"LBINT"===l.currentDivisionLevel?"LBI":l.currentDivisionLevel,ACTIVE_FL:"N"}};o.Search(e).then(function(e){e[0]._value=e[0][a.Id]+" - "+e[0][a.Name],e[0]._label=r.Title,l.model.selected=e[0],l.ngModel=l.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("inactiveProjectAutocompleteLabels",{Title:"Inactive Project",SearchLabel:"Search Inactive Project",IdLabel:"Project ID",NameLabel:"Project Name"}).constant("inactiveProjectAutocompletePropertyNames",{Id:"PROJ_ID",Name:"PROJ_NAME"}).directive("inactiveProjectAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",currentDivisionLevel:"@?",projId:"="},controller:["$scope","LookupService","inactiveProjectAutocompleteLabels","LookupRoleIds","inactiveProjectAutocompletePropertyNames",function(l,o,r,i,a){l.model={labels:r,properties:a,input:"",list:[],selected:null,errorMessage:null},l.search=function(e,t){var n={RoleId:i.inactiveProjectId,Parameters:{SEARCH_VALUE:e.term,DIVISION:"LBINT"===l.currentDivisionLevel?"LBI":l.currentDivisionLevel}};o.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[a.Id]+" - "+e[a.Name],e._label=r.Title,{label:e._value,value:e}}))})},l.autocompleteOnSelect=function(e){l.model.selected=e.value,l.ngModel=l.stringify?JSON.stringify(e.value):e.value,l.$apply()},l.clearForm=function(){l.model.input="",l.model.selected=null,l.ngModel=null},l.$watch("ngModel",function(){!function(){if(l.model.selected=l.stringify?JSON.parse(l.ngModel):l.ngModel,(null!==l.projId||""!==l.projId)&&void 0!==l.projId){var e={RoleId:i.inactiveProjectId,Parameters:{SEARCH_VALUE:l.projId,DIVISION:"LBINT"===l.currentDivisionLevel?"LBI":l.currentDivisionLevel}};o.Search(e).then(function(e){e[0]._value=e[0][a.Id]+" - "+e[0][a.Name],e[0]._label=r.Title,l.model.selected=e[0],l.ngModel=l.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("locationAutocompleteLabels",{Title:"Office Location",SearchLabel:"Search Location",IdLabel:"Location Code",NameLabel:"Location Name"}).constant("agreementAutocompletePropertyNames",{Id:"LOCATION_CODE",Name:"LOCATION_NAME"}).directive("locationAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",locationId:"="},controller:["$scope","LookupService","locationAutocompleteLabels","LookupRoleIds","agreementAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.agreementRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Id]+" - "+e[i.Name],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.locationId||""!==t.locationId)&&void 0!==t.locationId){var e={RoleId:r.locationRoleId,Parameters:{LOOKUP_VALUE:t.locationId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Id]+" - "+e[0][i.Name],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("mastercontractAutocompleteLabels",{Title:"Master Contract",SearchLabel:"Search Master Contract",IdLabel:"Master Contract ID",NameLabel:"Master Contract Name"}).constant("mastercontractAutocompletePropertyNames",{Id:"PROJ_ID",Name:"PROJ_NAME"}).directive("mastercontractAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",currentDivisionLevel:"@?",masterContractId:"="},controller:["$scope","LookupService","mastercontractAutocompleteLabels","LookupRoleIds","mastercontractAutocompletePropertyNames",function(l,o,r,i,a){l.model={labels:r,properties:a,input:"",list:[],selected:null,errorMessage:null},l.search=function(e,t){var n={RoleId:i.masterContractRoleId,Parameters:{SEARCH_VALUE:e.term,DIVISION:"LBINT"===l.currentDivisionLevel?"LBI":l.currentDivisionLevel}};o.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[a.Id]+" - "+e[a.Name],e._label=r.Title,{label:e._value,value:e}}))})},l.autocompleteOnSelect=function(e){l.model.selected=e.value,l.ngModel=l.stringify?JSON.stringify(e.value):e.value,l.$apply()},l.clearForm=function(){l.model.input="",l.model.selected=null,l.ngModel=null},l.$watch("ngModel",function(){!function(){if(l.model.selected=l.stringify?JSON.parse(l.ngModel):l.ngModel,(null!==l.masterContractId||""!==l.masterContractId)&&void 0!==l.masterContractId){var e={RoleId:i.masterContractRoleId,Parameters:{SEARCH_VALUE:l.masterContractId,DIVISION:"LBINT"===l.currentDivisionLevel?"LBI":l.currentDivisionLevel}};o.Search(e).then(function(e){e[0]._value=e[0][a.Id]+" - "+e[0][a.Name],e[0]._label=r.Title,l.model.selected=e[0],l.ngModel=l.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("opportunityAgreementProjectSpecialAutocompleteLabels",{Title:"Agreements / Projects (Active) with details",SearchLabel:"Search Agreement / Project",IdLabel:"Agreement / Project Number",NameLabel:"Agreement / Project Name",DivisionNameLabel:"Division Name",DistrictNameLabel:"District Name",AreaNameLabel:"Area Name",CostCenterNameLabel:"Cost Center Name",UltimateClientNameLabel:"Ultimate Client",ClientNameLabel:"Client",CompanyLabel:"Company"}).constant("opportunityAgreementProjectSpecialAutocompletePropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME",Display:"OBJECT_DISPLAY",DivisionName:"DIVISION_NAME",DistrictName:"DISTRICT_NAME",AreaName:"AREA_NAME",CostCenterName:"COST_CENTER_NAME",OwnerName:"OWNER_NAME",ClientName:"CLIENT_NAME",ClientType:"CLIENT_TYPE",CompanyName:"COMPANY_NAME",OwnerType:"OWNER_TYPE",City:"CITY",State:"PROJ_STATE",Country:"COUNTRY",ProjectManager:"PROJECT_MANAGER",PA:"PA",DeliveryMethod:"DELIVERY_METHOD",Segments:"SEGMENTS",ServiceType:"SERVICE_TYPE"}).directive("opportunityAgreementProjectSpecialAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",opportunityAgreementProjectSpecialId:"="},controller:["$scope","LookupService","opportunityAgreementProjectSpecialAutocompleteLabels","LookupRoleIds","opportunityAgreementProjectSpecialAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.opportunityAgreementProjectSpecialRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Display],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.opportunityAgreementProjectSpecialId||""!==t.opportunityAgreementProjectSpecialId)&&void 0!==t.projectOpportunityId){var e={RoleId:r.opportunityAgreementProjectSpecialRoleId,Parameters:{LOOKUP_VALUE:t.opportunityAgreementProjectSpecialId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Display],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("opportunityAutocompleteLabels",{Title:"Opportunities (Active)",SearchLabel:"Search Opportunity",IdLabel:"Opportunity ID",NameLabel:"Opportunity Name"}).constant("opportunityAutocompletePropertyNames",{Id:"OPPORTUNITY_NUMBER",Name:"OPPORTUNITY_NAME",CostCenter:"COST_CENTER_ID"}).directive("opportunityAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",currentDivisionLevel:"@?",opportunityId:"=",isGng:"@?"},controller:["$scope","LookupService","opportunityAutocompleteLabels","LookupRoleIds","opportunityAutocompletePropertyNames","sweetDialogAlertService","$base64","RequestsDetailsService",function(l,o,r,i,a,s,u,c){function d(){l.model.input="",l.model.selected=null,l.ngModel=null}l.model={labels:r,properties:a,input:"",list:[],selected:null,errorMessage:null},l.search=function(e,t){var n={RoleId:i.opportunityRoleId,Parameters:{LOOKUP_VALUE:e.term}};o.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[a.Id]+" - "+e[a.Name],e._label=r.Title,{label:e._value,value:e}}))})},l.autocompleteOnSelect=function(t){if("NORMAL"!==l.isGng&&"PS"!==l.isGng&&"WAR"!==l.isGng&&void 0!==l.isGng&&""!==l.isGng&&null!==l.isGng){if("Y"===t.value.IN_USE&&null!==t.value.SaveRequestId&&""!==t.value.SaveRequestId){var n={routeName:"am.approvalitems.viewsaveddetails",parameters:{saveRequestId:t.value.SaveRequestId,org:t.value.OrganizationCode}};return void function(e){var t={RoleId:-99999965,Parameters:{Id:e,Data:"ASSIGNEDTOSAVEREQUEST"}};return c.GetRequestAssignedTo(t).then(function(e){var t="";if(null===e)return t;for(var n=0;n<e.length;n++)t+=void 0!==e[n].Value[1]?"<li>"+e[n].Value[1].Value+"</li>":"";return t})}(t.value.SaveRequestId).then(function(e){s.alertWarning("Warning",'<div align="left">This opportunity is associated to temporary request <a href="'+redirectApiRequests+u.encode(JSON.stringify(n))+'">'+t.value.RequestApprovalId+"</a>, pending with:</br> <ul>"+e+"<li>"+t.value.RequestorDisplayName+"</li><ul></div>",2e4),d()})}if("Y"===t.value.IN_USE&&null!==t.value.RequestId&&""!==t.value.RequestId){n={routeName:"am.requests.details",parameters:{requestid:t.value.RequestId}};return s.alertWarning("Warning",'This opportunity is associated to request <a href="'+redirectApiRequests+u.encode(JSON.stringify(n))+'">'+t.value.RequestApprovalId+"</a>",2e4),void d()}l.model.selected=t.value,l.ngModel=l.stringify?JSON.stringify(t.value):t.value,l.$apply()}else l.model.selected=t.value,l.ngModel=l.stringify?JSON.stringify(t.value):t.value,l.$apply()},l.clearForm=d,l.$watch("ngModel",function(){!function(){if(l.model.selected=l.stringify?JSON.parse(l.ngModel):l.ngModel,(null!==l.opportunityId||""!==l.opportunityId)&&void 0!==l.opportunityId){var e={RoleId:i.opportunityRoleId,Parameters:{LOOKUP_VALUE:l.opportunityId}};o.Search(e).then(function(e){e[0]._value=e[0][a.Id]+" - "+e[0][a.Name],e[0]._label=r.Title,l.model.selected=e[0],l.ngModel=l.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("opportunityInactiveAutocompleteLabels",{Title:"Opportunities (Inactive)",SearchLabel:"Search Inactive Opportunity",IdLabel:"Opportunity Number",NameLabel:"Opportunity Name"}).constant("opportunityInactiveAutocompletePropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME",Display:"OBJECT_DISPLAY"}).directive("opportunityInactiveAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",customerId:"="},controller:["$scope","LookupService","opportunityInactiveAutocompleteLabels","LookupRoleIds","opportunityInactiveAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.opportunityInactiveRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Display],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.customerId||""!==t.customerId)&&void 0!==t.customerId){var e={RoleId:r.opportunityInactiveRoleId,Parameters:{LOOKUP_VALUE:t.customerId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Display],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("opportunitySpecialAutocompleteLabels",{Title:"Opportunities (Active) with details",SearchLabel:"Search Opportunity",IdLabel:"Opportunity Number",NameLabel:"Opportunity Name",DivisionNameLabel:"Division Name",DistrictNameLabel:"District Name",AreaNameLabel:"Area Name",CostCenterNameLabel:"Cost Center Name",UltimateClientNameLabel:"Ultimate Client",ClientNameLabel:"Client",CompanyLabel:"Company"}).constant("opportunitySpecialAutocompletePropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME",Display:"OBJECT_DISPLAY",DivisionName:"DIVISION_NAME",DistrictName:"DISTRICT_NAME",AreaName:"AREA_NAME",CostCenterName:"COST_CENTER_NAME",OwnerName:"OWNER_NAME",ClientName:"CLIENT_NAME",ClientType:"CLIENT_TYPE",CompanyName:"COMPANY_NAME",OwnerType:"OWNER_TYPE",City:"CITY",State:"PROJ_STATE",Country:"COUNTRY",ProjectManager:"PROJECT_MANAGER",PA:"PA",DeliveryMethod:"DELIVERY_METHOD",Segments:"SEGMENTS",ServiceType:"SERVICE_TYPE"}).directive("opportunitySpecialAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",opportunitySpecialId:"="},controller:["$scope","LookupService","opportunitySpecialAutocompleteLabels","LookupRoleIds","opportunitySpecialAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.opportunitySpecialRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Display],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.opportunitySpecialId||""!==t.opportunitySpecialId)&&void 0!==t.projectOpportunityId){var e={RoleId:r.opportunitySpecialRoleId,Parameters:{LOOKUP_VALUE:t.opportunitySpecialId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Display],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("orgAutocompleteLabels",{Title:"Cost Centers (Active)",SearchLabel:"Search Cost Centers",IdLabel:"Cost Center ID",NameLabel:"Cost Center Name"}).constant("orgAutocompletePropertyNames",{Id:"COST_CENTER_ID",Name:"COST_CENTER_NAME"}).directive("orgAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",currentDivisionLevel:"@?",orgId:"=",projectModel:"=?"},controller:["$scope","LookupService","orgAutocompleteLabels","LookupRoleIds","orgAutocompletePropertyNames","$filter",function(n,l,o,r,i,e){function a(){n.model.input="",n.model.selected=null,n.ngModel=null}n.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},n.search=function(e,t){var n={RoleId:r.orgRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Id]+" - "+e[i.Name],e._label=o.Title,{label:e._value,value:e}}))})},n.autocompleteOnSelect=function(e){n.model.selected=e.value,n.ngModel=n.stringify?JSON.stringify(e.value):e.value,n.$apply()},n.clearForm=a,n.filterData=function(e){return function(e,t){if(""===t)return!0;return e.split(/[ _-]+/).some(function(e){return 0===e.toLowerCase().indexOf(t.toLowerCase())})}(e.ORG_ID,"")},n.$watch("ngModel",function(){!function(){if(n.model.selected=n.stringify?JSON.parse(n.ngModel):n.ngModel,(null!==n.orgId||""!==n.orgId)&&void 0!==n.orgId){var e={RoleId:r.orgRoleId,Parameters:{LOOKUP_VALUE:n.orgId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Id]+" - "+e[0][i.Name],e[0]._label=o.Title,n.model.selected=e[0],n.ngModel=n.stringify?JSON.stringify(e[0]):e[0]})}}()}),n.$watch("projectModel",function(){if(angular.isDefined(n.projectModel))if(null===n.projectModel||angular.equals(n.projectModel,{}))a();else if(null!==n.projectModel.COST_CENTER_ID){var e={RoleId:r.orgRoleId,Parameters:{LOOKUP_VALUE:n.projectModel.COST_CENTER_ID}};l.Search(e).then(function(e){if(0===e.length)n.model.errorMessage="No organization found",a();else{n.model.errorMessage=null,e[0]._value=e[0][i.Id]+" - "+e[0][i.Name],e[0]._label=o.Title;var t=angular.copy(e[0]);n.model.selected=t,n.model.input=t[i.Id]+" - "+t[i.Name],n.ngModel=n.stringify?JSON.stringify(t):t}})}else n.model.errorMessage="No organization found"})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("overheadProjectAutocompleteLabels",{Title:"Project",SearchLabel:"Search Project",IdLabel:"Project ID",NameLabel:"Project Name"}).constant("overheadProjectAutocompletePropertyNames",{Id:"PROJECT_NUMBER",Name:"PROJECT_NAME"}).directive("overheadProjectAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",currentDivisionLevel:"@?",projId:"=",isActive:"@?",optionvalue:"@"},controller:["$scope","LookupService","overheadProjectAutocompleteLabels","LookupRoleIds","overheadProjectAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.projectRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Id]+" - "+e[i.Name],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.projId||""!==t.projId)&&void 0!==t.projId){var e={RoleId:r.overheadProjectRoleId,Parameters:{LOOKUP_VALUE:t.projId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Id]+" - "+e[0][i.Name],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("projectAllActiveAutocompleteLabels",{Title:"All Projects (Active)",SearchLabel:"Search All Projects Active",IdLabel:"Project ID",NameLabel:"Project Name"}).constant("projectAllActiveAutocompletePropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME"}).directive("projectAllActiveAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",projectId:"="},controller:["$scope","LookupService","projectAllActiveAutocompleteLabels","LookupRoleIds","projectAllActiveAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.projectAllActiveRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Id]+" - "+e[i.Name],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.projectId||""!==t.projectId)&&void 0!==t.projectId){var e={RoleId:r.projectAllActiveRoleId,Parameters:{LOOKUP_VALUE:t.projectId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Id]+" - "+e[0][i.Name],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("projectAutocompleteLabels",{Title:"Direct Projects (Active)",SearchLabel:"Search Projects",IdLabel:"Project Number",NameLabel:"Project Name"}).constant("projectAutocompletePropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME",Display:"OBJECT_DISPLAY"}).directive("projectAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",projectId:"="},controller:["$scope","LookupService","projectAutocompleteLabels","LookupRoleIds","projectAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.projectRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Display],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.projectId||""!==t.projectId)&&void 0!==t.projectId){var e={RoleId:r.projectRoleId,Parameters:{LOOKUP_VALUE:t.projectId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Display],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("projectDirectClosedAutocompleteLabels",{Title:"Direct Projects (Closed)",SearchLabel:"Search Closed Projects",IdLabel:"Project ID",NameLabel:"Project Name"}).constant("projectDirectClosedAutocompletePropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME"}).directive("projectDirectClosedAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",projectId:"="},controller:["$scope","LookupService","projectDirectClosedAutocompleteLabels","LookupRoleIds","projectDirectClosedAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.projectDirectClosedRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Id]+" - "+e[i.Name],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.projectId||""!==t.projectId)&&void 0!==t.projectId){var e={RoleId:r.projectDirectClosedRoleId,Parameters:{LOOKUP_VALUE:t.projectId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Id]+" - "+e[0][i.Name],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("projectIndirectActiveAutocompleteLabels",{Title:"Indirect Projects (Active)",SearchLabel:"Search Active Indirect Project",IdLabel:"Project Number",NameLabel:"Project Name"}).constant("projectIndirectActiveAutocompletePropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME",Display:"OBJECT_DISPLAY"}).directive("projectIndirectActiveAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",projectId:"="},controller:["$scope","LookupService","projectIndirectActiveAutocompleteLabels","LookupRoleIds","projectIndirectActiveAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.projectIndirectActiveRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Display],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.projectId||""!==t.projectId)&&void 0!==t.projectId){var e={RoleId:r.projectIndirectActiveRoleId,Parameters:{LOOKUP_VALUE:t.projectId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Display],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("projectIndirectInactiveAutocompleteLabels",{Title:"Indirect Projects (Inactive)",SearchLabel:"Search Inactive Indirect Project",IdLabel:"Project Number",NameLabel:"Project Name"}).constant("projectIndirectInactiveAutocompletePropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME",Display:"OBJECT_DISPLAY"}).directive("projectIndirectInactiveAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",projectId:"="},controller:["$scope","LookupService","projectIndirectInactiveAutocompleteLabels","LookupRoleIds","projectIndirectInactiveAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.projectIndirectInactiveRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Display],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.projectId||""!==t.projectId)&&void 0!==t.projectId){var e={RoleId:r.projectIndirectInactiveRoleId,Parameters:{LOOKUP_VALUE:t.projectId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Display],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("projectOpportunityAutocompleteLabels",{Title:"Project / Opportunity",SearchLabel:"Search Project / Opportunity",IdLabel:"Project / Opportunity ID",NameLabel:"Project / Opportunity Name"}).constant("projectOpportunityAutocompletePropertyNames",{Id:"ID",Name:"NAME"}).directive("projectOpportunityAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",currentDivisionLevel:"@?",projectOpportunityId:"=",isActive:"@?"},controller:["$scope","LookupService","projectOpportunityAutocompleteLabels","LookupRoleIds","projectOpportunityAutocompletePropertyNames",function(l,o,r,i,a){l.model={labels:r,properties:a,input:"",list:[],selected:null,errorMessage:null},l.search=function(e,t){var n={RoleId:i.projectOpportunityRoleId,Parameters:{SEARCH_VALUE:e.term,DIVISION:"LBINT"===l.currentDivisionLevel?"LBI":l.currentDivisionLevel,ACTIVE_FL:l.isActive}};o.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[a.Id]+" - "+e[a.Name],e._label=r.Title,{label:e._value,value:e}}))})},l.autocompleteOnSelect=function(e){l.model.selected=e.value,l.ngModel=l.stringify?JSON.stringify(e.value):e.value,l.$apply()},l.clearForm=function(){l.model.input="",l.model.selected=null,l.ngModel=null},l.$watch("ngModel",function(){!function(){if(l.model.selected=l.stringify?JSON.parse(l.ngModel):l.ngModel,(null!==l.projectOpportunityId||""!==l.projectOpportunityId)&&void 0!==l.projectOpportunityId){var e={RoleId:i.projectOpportunityRoleId,Parameters:{SEARCH_VALUE:l.projectOpportunityId,DIVISION:"LBINT"===l.currentDivisionLevel?"LBI":l.currentDivisionLevel,ACTIVE_FL:l.isActive}};o.Search(e).then(function(e){e[0]._value=e[0][a.Id]+" - "+e[0][a.Name],e[0]._label=r.Title,l.model.selected=e[0],l.ngModel=l.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("pursuitProjectAutocompleteLabels",{Title:"Pursuit Projects (Active)",SearchLabel:"Search Pursuit Project",IdLabel:"Pursuit Project ID",NameLabel:"Pursuit Project Name"}).constant("pursuitProjectAutocompletePropertyNames",{Id:"PROJECT_NUMBER",Name:"PROJECT_NAME"}).directive("pursuitProjectAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",currentDivisionLevel:"@?",projId:"=",isActive:"@?",optionvalue:"@"},controller:["$scope","LookupService","pursuitProjectAutocompleteLabels","LookupRoleIds","pursuitProjectAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.projectRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Id]+" - "+e[i.Name],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.projId||""!==t.projId)&&void 0!==t.projId){var e={RoleId:r.pursuitProjectRoleId,Parameters:{LOOKUP_VALUE:t.projId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Id]+" - "+e[0][i.Name],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("pursuitProjectClosedAutocompleteLabels",{Title:"Pursuit Projects (Closed)",SearchLabel:"Search Closed Pursuit Project",IdLabel:"Project Number",NameLabel:"Project Name"}).constant("pursuitProjectClosedAutocompletePropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME",Display:"OBJECT_DISPLAY"}).directive("pursuitProjectClosedAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",projectId:"="},controller:["$scope","LookupService","pursuitProjectClosedAutocompleteLabels","LookupRoleIds","pursuitProjectClosedAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.pursuitProjectClosedRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Display],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.projectId||""!==t.projectId)&&void 0!==t.projectId){var e={RoleId:r.pursuitProjectClosedRoleId,Parameters:{LOOKUP_VALUE:t.projectId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Display],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("ultimateClientAutocompleteLabels",{Title:"Customers (per ERP)",SearchLabel:"Search Customers",IdLabel:"Customer Number",NameLabel:"Customer Name"}).constant("ultimateClientAutocompletePropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME",Display:"OBJECT_DISPLAY"}).directive("ultimateClientAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",customerId:"="},controller:["$scope","LookupService","ultimateClientAutocompleteLabels","LookupRoleIds","ultimateClientAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.ultimateClientRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Display],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.customerId||""!==t.customerId)&&void 0!==t.customerId){var e={RoleId:r.ultimateClientRoleId,Parameters:{LOOKUP_VALUE:t.customerId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Display],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";angular.module("myApp").constant("vendorAutocompleteLabels",{Title:"Suppliers/Subs/Vendors",SearchLabel:"Search Suppliers / Subs / Vendors",IdLabel:"Vendor Number",NameLabel:"Vendor Name"}).constant("vendorAutocompletePropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME",Display:"OBJECT_DISPLAY"}).directive("vendorAutocompleteControl",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asForm:"=",asTextbox:"=",stringify:"=",isRequired:"=?",vendorId:"="},controller:["$scope","LookupService","vendorAutocompleteLabels","LookupRoleIds","vendorAutocompletePropertyNames",function(t,l,o,r,i){t.model={labels:o,properties:i,input:"",list:[],selected:null,errorMessage:null},t.search=function(e,t){var n={RoleId:r.vendorRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e.slice(0,50),function(e){return e._value=e[i.Display],e._label=o.Title,{label:e._value,value:e}}))})},t.autocompleteOnSelect=function(e){t.model.selected=e.value,t.ngModel=t.stringify?JSON.stringify(e.value):e.value,t.$apply()},t.clearForm=function(){t.model.input="",t.model.selected=null,t.ngModel=null},t.$watch("ngModel",function(){!function(){if(t.model.selected=t.stringify?JSON.parse(t.ngModel):t.ngModel,(null!==t.vendorId||""!==t.vendorId)&&void 0!==t.vendorId){var e={RoleId:r.vendorRoleId,Parameters:{LOOKUP_VALUE:t.vendorId}};l.Search(e).then(function(e){e[0]._value=e[0][i.Display],e[0]._label=o.Title,t.model.selected=e[0],t.ngModel=t.stringify?JSON.stringify(e[0]):e[0]})}}()})}],templateUrl:"app/views/templates/lookup-templates/generic-lookup.html"}})}(),function(){"use strict";function e(){return{restrict:"E",controller:["MainStore","LookupService","$scope","localStorageService","SessionName","$base64","$state","MainBusiness","astigUtilityService",function(e,n,t,l,o,r,i,a,s){t.model={isOpen:!1,searchInput:null,selected:null,mainStore:e},t.events={onClick_OpenMasquerade:function(){t.model.isOpen=!t.model.isOpen},employeeSource:function(e,t){n.SearchEmployee(e.term,50).then(function(e){e&&t($.map(e,function(e){return{label:e.FULL_NAME,value:e}}))})},onSelect_SearchEmployee:function(e){t.model.selected=e.value},onClick_MasqueradeUser:function(){e.securityDetails.ViewAsUsername=t.model.selected.EMAIL_ADDRESS,e.securityDetails.ViewAsDisplayName=t.model.selected.FULL_NAME,e.securityDetails.ViewAsEmail=t.model.selected.EMAIL_ADDRESS,e.securityDetails.SubordinateList=[],e.securityDetails.HasSubordinate=t.model.selected.HASSUBORDINATE,e.securityDetails.IsGBSPersonnel=t.model.selected.ISGBSPERSONNEL,e.securityDetails.GroupIds=0<t.model.selected.GroupIds.length?JSON.parse(t.model.selected.GroupIds):[],e.securityDetails.DefaultOrg=a.IdentifyOrgCode(t.model.selected.ORG_ID,t.model.selected.REGION,t.model.selected.SUB_REGION),l.remove(o.currentSelectedOrg),l.remove(o.loggedInViewAs),l.set(o.loggedInViewAs,r.encode(JSON.stringify(e.securityDetails))),e.removeMenu?location.reload():i.go("am.approvalitems.list",{},{reload:!0})},onClick_RemoveMasqueradeUser:function(){e.securityDetails.ViewAsUsername=e.securityDetails.LoggedInUsername,e.securityDetails.ViewAsDisplayName=e.securityDetails.LoggedInDisplayName,e.securityDetails.ViewAsEmail=e.securityDetails.LoggedInEmail,e.securityDetails.DefaultOrg=angular.copy(e.securityDetails.OrigOrg),l.remove(o.currentSelectedOrg),l.remove(o.loggedInViewAs),l.set(o.loggedInViewAs,r.encode(JSON.stringify(e.securityDetails))),e.removeMenu?location.reload():i.go("am.approvalitems.list",{},{reload:!0})}},t.methods={utilityService:s}}],templateUrl:"app/views/templates/directive-templates/masquerade.html"}}angular.module("myApp").directive("masquerade",e),e.$inject=[]}(),function(){"use strict";angular.module("myApp").factory("optionParser",["$parse",function(n){var l=/^\s*(.*?)(?:\s+as\s+(.*?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+(.*)$/;return{parse:function(e){var t=e.match(l);if(!t)throw new Error("Expected typeahead specification in form of '_modelValue_ (as _label_)? for _item_ in _collection_' but got '"+e+"'.");return{itemName:t[3],source:n(t[4]),viewMapper:n(t[2]||t[1]),modelMapper:n(t[1])}}}}]).directive("multiselect",["$parse","$document","$compile","optionParser",function(f,e,g,v){return{restrict:"E",require:"ngModel",link:function(o,e,t,n){var l=t.options,r=v.parse(l),i=!!t.multiple,a=!1,s=o.$new(),u=t.change||anguler.noop;s.items=[],s.header="No Selected",s.multiple=i,s.disabled=!1,s.defaultValues=s.$eval(t.defaultvalues),o.$on("$destroy",function(){s.$destroy()});var c=angular.element("<multiselect-popup></multiselect-popup>");function d(){s.items.length=0;for(var e=r.source(o),t=0;t<e.length;t++){var n={};n[r.itemName]=e[t];var l=r.viewMapper(n);s.items.push({label:l,model:e[t],checked:m(l)})}p(s.multiple)}function p(e){var t;e?(t=[],angular.forEach(s.items,function(e){e.checked&&t.push(e.model)})):angular.forEach(s.items,function(e){if(e.checked)return t=e.model,!1}),n.$setViewValue(t)}function m(t){return void 0!==s.defaultValues.find(function(e){return e===t})}(t.required||t.ngRequired)&&(a=!0),t.$observe("required",function(e){a=e}),s.$watch(function(){return f(t.disabled)(o)},function(e){s.disabled=e}),s.$watch(function(){return f(t.multiple)(o)},function(e){i=e||!1}),s.$watch(function(){return r.source(o)},function(e){angular.isDefined(e)&&d()}),s.$watch(function(){return n.$modelValue},function(e,t){angular.isDefined(e)&&(function(t){angular.isArray(t)?angular.forEach(t,function(t){angular.forEach(s.items,function(e){angular.equals(e.model,t)&&(e.checked=!0)})}):angular.forEach(s.items,function(e){if(angular.equals(e.model,t))return!(e.checked=!0)})}(e),s.$eval(u)),function(){if(!n.$modelValue||!n.$modelValue.length)return s.header="Select";if(i)s.header=n.$modelValue.length+" selected";else{var e={};e[r.itemName]=n.$modelValue,s.header=r.viewMapper(e)}}(),n.$setValidity("required",s.valid())},!0),d(),e.append(g(c)(s)),s.valid=function(){if(!a)return!0;var e=n.$modelValue;return angular.isArray(e)&&0<e.length||!angular.isArray(e)&&null!=e},s.checkAll=function(){i&&(angular.forEach(s.items,function(e){e.checked=!0}),p(!0))},s.uncheckAll=function(){angular.forEach(s.items,function(e){e.checked=!1}),p(!0)},s.select=function(e){!1===i?(function(e){e.checked?s.uncheckAll():(s.uncheckAll(),e.checked=!e.checked),p(!1)}(e),s.toggleSelect()):function(e){e.checked=!e.checked,p(!0)}(e)}}}}]).directive("multiselectPopup",["$document",function(r){return{restrict:"E",scope:!1,replace:!0,templateUrl:"app/views/templates/directive-templates/multiselect.html",link:function(t,n,e){function l(e){o(e.target,n.find(e.target.tagName))||(n.removeClass("open"),r.unbind("click",l),t.$digest())}t.isVisible=!1,t.toggleSelect=function(){n.hasClass("open")?(n.removeClass("open"),r.unbind("click",l)):(n.addClass("open"),r.bind("click",l))};var o=function(e,t){for(var n=0;n<t.length;n++)if(e==t[n])return!0;return!1}}}}])}(),function(){"use strict";angular.module("myApp").directive("onlyDigitsOp",["astigUtilityService","$filter","$timeout",function(s,e,u){return{scope:{ngModel:"=",min:"@",max:"@",errorClass:"@",name:"@",decimalPlaces:"@",preventGreater:"@"},require:"ngModel",restrict:"A",link:function(l,o,e,r){function i(e,t){if(e.setSelectionRange)e.focus(),e.setSelectionRange(t,t);else if(e.createTextRange){var n=e.createTextRange();n.collapse(!0),n.moveEnd("character",t),n.moveStart("character",t),n.select()}}function a(e){var t=0;if(document.selection){e.focus();var n=document.selection.createRange();n.moveStart("character",-e.value.length),t=n.text.length}else!e.selectionStart&&"0"!=e.selectionStart||(t=e.selectionStart);return t}function t(e){if(null!=e||!isNaN(e)){var t=!1,n=!1;if(angular.isDefined(l.max))t=parseFloat(l.max)<e;if(angular.isDefined(l.min))n=e<parseFloat(l.min);t||n?(o.addClass(l.errorClass),r.$setValidity(l.name,!1)):(o.removeClass(l.errorClass),r.$setValidity(l.name,!0))}return null===e&&(s.objectIsNullorUndefined(o[0])||(o[0].value="")),l.ngModel=e}angular.isDefined(l.decimalPlaces)&&o.number(!0,l.decimalPlaces),o.on("paste",function(){l.ngModel=o[0].value,l.$apply()}),o.on("focus",function(){null!==l.ngModel&&void 0!==l.ngModel&&""!==l.ngModel||l.$apply(function(){l.ngModel=null})}),o.on("focusout",function(){null!==l.ngModel&&void 0!==l.ngModel&&""!==l.ngModel||s.objectIsNullorUndefined(o[0])||(o[0].value="",l.ngModel=null)}),o.on("keydown",function(e){var t=a(o[0]);switch(e.keyCode){case 48:case 96:l.negative?"-0"==o.val()&&"-0.00"==o[0].value&&3==t?l.caretposition=3:l.caretposition=null:"0"==o.val()&&"0.00"==o[0].value&&2==t?l.caretposition=2:l.caretposition=null;break;case 8:0===t&&""==o.val()&&(o[0].value="0.00",l.$apply())}}),o.on("keyup",function(e){var t=a(o[0]);switch(e.keyCode){case 48:case 96:l.negative?"0"==o.val()&&"0.00"==o[0].value&&s.objectIsNullorUndefined(l.caretposition)?(o[0].value="-0.00",i(o[0],2)):"0"==o.val()&&"0.00"==o[0].value&&3===l.caretposition&&(o[0].value="-0.00",i(o[0],4)):"0"==o.val()&&"0.00"==o[0].value&&s.objectIsNullorUndefined(l.caretposition)?(o[0].value="0.00",i(o[0],1)):"0"==o.val()&&"0.00"==o[0].value&&2===l.caretposition&&(o[0].value="0.00",i(o[0],3));break;case 110:case 190:l.negative?"0.21"==o.val()&&"0.21"==o[0].value&&(o[0].value="-0.00",i(o[0],3)):"0.21"==o.val()&&"0.21"==o[0].value&&(o[0].value="0.00",i(o[0],2));break;case 109:case 189:"-0.21"==o.val()&&"-0.21"==o[0].value?(o[0].value=l.min<0||void 0===l.min?"-":"",l.negative=!0,i(o[0],2)):s.decimalIsNullorUndefinedorZero(o[0].value)||(o[0].value=-1*o[0].value,o.val(o[0].value),l.ngModel=o[0].value);break;case 39:case 37:break;default:l.negative=null;var n=parseFloat(l.ngModel);n<1&&0<n?i(o[0],.09<n?t+2:t+3):n<0&&-1<n&&i(o[0],n<-.09?t+2:t+3)}""===o.val()&&u(function(){l.ngModel=null},100)}),r.$formatters.unshift(t),r.$parsers.push(t)}}}])}(),function(){"use strict";angular.module("myApp").directive("onlyDigits",function(){return{require:"ngModel",restrict:"A",link:function(e,t,n,l){l.$parsers.push(function(e){if(e){var t=e.toString().replace(/[^0-9\.]+/g,"");return t!==e&&(l.$setViewValue(t),l.$render()),parseFloat(t,10)}if(""==e)return""})}}})}(),function(){"use strict";angular.module("myApp").constant("opportunityAgreementSearchTypeAheadPropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME"}).directive("opportunityAgreementSearchTypeAhead",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asPlaceholder:"@",smallButton:"@?",clearSwitch:"=?",forReport:"@?",prop:"@?"},controller:["$scope","LookupService","LookupRoleIds","opportunityAgreementSearchTypeAheadPropertyNames",function(t,l,o,r){function e(){null!==t.ngModel&&void 0!==t.ngModel&&t.ngModel.hasOwnProperty(r.Id)&&n({value:angular.copy(t.ngModel)})}function n(e){t.model.input=e.value.OBJECT_ID+" - "+e.value.OBJECT_NAME,t.ngModel=e.value}function i(){t.model.input="",t.model.selected=null,t.ngModel=null}t.model={input:""},t.search=function(e,t){var n={RoleId:o.opportunityAgreementRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e,function(e){return{label:e[r.Id]+" - "+e[r.Name],value:e}}))})},t.autocompleteOnSelect=n,t.clearData=i,e(),t.$watch("ngModel",function(){null===t.ngModel&&i(),"Y"===t.clearSwitch&&(e(),t.clearSwitch="N")})}],templateUrl:"app/views/templates/directive-templates/generic-autocomplete.html"}})}(),function(){"use strict";angular.module("myApp").directive("mmPopOver",function(){return{restrict:"A",link:function(e,t,n){e.label=n.popoverLabel;var l="hover";n.popoverTrigger&&(l=n.popoverTrigger),$(t).popover({trigger:l,html:!0,content:n.popoverHtml,placement:n.popoverPlacement})}}})}(),function(){"use strict";angular.module("myApp").directive("psOnlyDigitsOp",["astigUtilityService","$filter","$timeout",function(s,e,t){return{scope:{ngModel:"=",min:"@",max:"@",errorClass:"@",name:"@",decimalPlaces:"@",preventGreater:"@"},require:"ngModel",restrict:"A",link:function(l,o,e,r){function i(e,t){if(e.setSelectionRange)e.focus(),e.setSelectionRange(t,t);else if(e.createTextRange){var n=e.createTextRange();n.collapse(!0),n.moveEnd("character",t),n.moveStart("character",t),n.select()}}function a(e){var t=0;if(document.selection){e.focus();var n=document.selection.createRange();n.moveStart("character",-e.value.length),t=n.text.length}else!e.selectionStart&&"0"!=e.selectionStart||(t=e.selectionStart);return t}function t(e){if(null!=e||!isNaN(e)){var t=!1,n=!1;if(angular.isDefined(l.max))t=parseFloat(l.max)<e;if(angular.isDefined(l.min))n=e<parseFloat(l.min);t||n?(o.addClass(l.errorClass),r.$setValidity(l.name,!1)):(o.removeClass(l.errorClass),r.$setValidity(l.name,!0))}return null===e&&(s.objectIsNullorUndefined(o[0])||(o[0].value="")),l.ngModel=e}angular.isDefined(l.decimalPlaces)&&o.number(!0,l.decimalPlaces),o.on("paste",function(){setTimeout(function(){l.ngModel=o.val(),l.$apply()},5)}),o.on("focus",function(){null!==l.ngModel&&void 0!==l.ngModel&&""!==l.ngModel||l.$apply(function(){l.ngModel=null})}),o.on("focusout",function(){null!==l.ngModel&&void 0!==l.ngModel&&""!==l.ngModel||s.objectIsNullorUndefined(o[0])||(o[0].value="",l.ngModel=null)}),o.on("keydown",function(e){var t=a(o[0]);switch(e.keyCode){case 48:case 96:l.negative?"-0"==o.val()&&"-0.00"==o[0].value&&3==t?l.caretposition=3:l.caretposition=null:"0"==o.val()&&"0.00"==o[0].value&&2==t?l.caretposition=2:l.caretposition=null;break;case 8:0===t&&""==o.val()&&(o[0].value="0.00",l.$apply());break;case 109:case 189:if("-0.21"==o.val()&&"-0.21"==o[0].value)o[0].value="-",l.$apply(),l.negative=!0,i(o[0],2);else if(!s.decimalIsNullorUndefinedorZero(o[0].value)){parseFloat(o[0].value.replace(",","").replace(",","").replace(",",""));o.val(o[0].value),l.ngModel=o[0].value,l.$apply()}}}),o.on("keyup",function(e){var t=a(o[0]);switch(e.keyCode){case 48:case 96:l.negative?"0"==o.val()&&"0.00"==o[0].value&&s.objectIsNullorUndefined(l.caretposition)?(o[0].value="-0.00",l.$apply(),i(o[0],2)):"0"==o.val()&&"0.00"==o[0].value&&3===l.caretposition&&(o[0].value="-0.00",l.$apply(),i(o[0],4)):"0"==o.val()&&"0.00"==o[0].value&&s.objectIsNullorUndefined(l.caretposition)?(o[0].value="0.00",l.$apply(),i(o[0],1)):"0"==o.val()&&"0.00"==o[0].value&&2===l.caretposition&&(o[0].value="0.00",l.$apply(),i(o[0],3));break;case 110:case 190:l.negative?"0.21"==o.val()&&"0.21"==o[0].value&&(o[0].value="-0.00",l.$apply(),i(o[0],3)):"0.21"==o.val()&&"0.21"==o[0].value&&(o[0].value="0.00",l.$apply(),i(o[0],2));break;case 8:case 39:case 37:break;default:l.negative=null;var n=parseFloat(l.ngModel);n<1&&0<n?i(o[0],.09<n?t+2:t+3):n<0&&-1<n&&i(o[0],n<-.09?t+2:t+3)}""==o.val()&&(l.ngModel=null)}),r.$formatters.unshift(t),r.$parsers.push(t)}}}])}(),function(){"use strict";angular.module("myApp").constant("ultimateClientTypeAheadPropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME",Display:"OBJECT_DISPLAY"}).directive("ultimateClientSearchTypeAhead",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asPlaceholder:"@",smallButton:"@?",clearSwitch:"=?",forReport:"@?"},controller:["$scope","LookupService","ultimateClientTypeAheadPropertyNames","LookupRoleIds",function(t,l,o,r){function e(){null!==t.ngModel&&void 0!==t.ngModel&&t.ngModel.hasOwnProperty(o.Id)&&n({value:angular.copy(t.ngModel)})}function n(e){t.ngModel=e.value,t.model.input=e.value.OWNER_NAME}function i(){t.model.input="",t.ngModel=null}t.model={input:""},t.search=function(e,t){var n={RoleId:r.ultimateClientRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e,function(e){return{label:e[o.Id]+" - "+e[o.Name],value:e}}))})},t.autocompleteOnSelect=n,t.clearData=i,e(),t.$watch("ngModel",function(){null===t.ngModel&&i(),"Y"===t.clearSwitch&&(e(),t.clearSwitch="N")})}],templateUrl:"app/views/templates/directive-templates/generic-autocomplete.html"}})}(),function(){"use strict";angular.module("myApp").constant("vendorsClientTypeAheadPropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME",Display:"OBJECT_DISPLAY"}).directive("vendorsClientSearchTypeAhead",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asPlaceholder:"@",smallButton:"@?",clearSwitch:"=?",forReport:"@?"},controller:["$scope","LookupService","vendorsClientTypeAheadPropertyNames","LookupRoleIds",function(t,l,o,r){function e(){null!==t.ngModel&&void 0!==t.ngModel&&t.ngModel.hasOwnProperty(o.Id)&&n({value:angular.copy(t.ngModel)})}function n(e){t.ngModel=e.value,t.model.input=e.value.OBJECT_DISPLAY}function i(){t.model.input="",t.ngModel=null}t.model={input:""},t.search=function(e,t){var n={RoleId:r.vendorClientRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e,function(e){return{label:e[o.Id]+" - "+e[o.Name],value:e}}))})},t.autocompleteOnSelect=n,t.clearData=i,e(),t.$watch("ngModel",function(){null===t.ngModel&&i(),"Y"===t.clearSwitch&&(e(),t.clearSwitch="N")})}],templateUrl:"app/views/templates/directive-templates/generic-autocomplete.html"}})}(),function(){"use strict";angular.module("myApp").constant("vendorsTypeAheadPropertyNames",{Id:"OBJECT_ID",Name:"OBJECT_NAME",Display:"OBJECT_DISPLAY"}).directive("vendorsSearchTypeAhead",function(){return{restrict:"E",require:"ngModel",scope:{ngModel:"=",asPlaceholder:"@",smallButton:"@?",clearSwitch:"=?",forReport:"@?"},controller:["$scope","LookupService","vendorsTypeAheadPropertyNames","LookupRoleIds",function(t,l,o,r){function e(){null!==t.ngModel&&void 0!==t.ngModel&&t.ngModel.hasOwnProperty(o.Id)&&n({value:angular.copy(t.ngModel)})}function n(e){t.ngModel=e.value,t.model.input=e.value.OBJECT_DISPLAY}function i(){t.model.input="",t.ngModel=null}t.model={input:""},t.search=function(e,t){var n={RoleId:r.vendorRoleId,Parameters:{LOOKUP_VALUE:e.term}};l.Search(n).then(function(e){e&&t($.map(e,function(e){return{label:e[o.Id]+" - "+e[o.Name],value:e}}))})},t.autocompleteOnSelect=n,t.clearData=i,e(),t.$watch("ngModel",function(){null===t.ngModel&&i(),"Y"===t.clearSwitch&&(e(),t.clearSwitch="N")})}],templateUrl:"app/views/templates/directive-templates/generic-autocomplete.html"}})}(),function(){"use strict";function e(e,t,n){this.model={},this.methods={},this.currentState=e,this.model.mainModel=t,this.methods.utilityService=n}angular.module("myApp").component("amContainerHeading",{templateUrl:"app/views/templates/component-templates/am-container-heading.html",controller:e,controllerAs:"vm"}),e.$inject=["$state","MainStore","astigUtilityService"]}(),function(){"use strict";function e(l,o){function r(){l.form={settingType:"REMINDER",requestStatus:"APPROVED",settingValue:"USER",displayName:null,email:null,user:null,role:null,group:null,lookup:null}}this.GetSettings=function(e,t){return o.GetApprovalItemSettingDetails(e,t).then(function(e){l.settingList=e,l.settingListCopy=angular.copy(e)})},this.AddSetting=function(e){"AUDITOR"===e&&(l.form.settingType="AUDITOR",l.form.requestStatus="");var t={ApprovalItemSettingId:0,ApprovalSettingType:l.form.settingType,ApprovalSettingValue:l.form.settingValue,REQUESTSTATUS:l.form.requestStatus,OBJECTID:null,OBJECTDISPLAYNAME:null,OBJECTEMAIL:null,LOOKUP:null!==l.form.lookup?l.form.lookup.value.toUpperCase():null};"USER"===l.form.settingValue?(t.OBJECTID=l.form.user.EMAIL_ADDRESS,t.OBJECTDISPLAYNAME=l.form.user.FULL_NAME,t.OBJECTEMAIL=l.form.user.EMAIL_ADDRESS):"GROUP"===l.form.settingValue?(t.OBJECTID=l.form.group.GroupId,t.OBJECTDISPLAYNAME=l.form.group.GroupName,t.OBJECTEMAIL=""):"ROLE"===l.form.settingValue?(t.OBJECTID=l.form.role.RoleId,t.OBJECTDISPLAYNAME=l.form.role.RoleName,t.OBJECTEMAIL=""):"DEFINED"===l.form.settingValue&&(t.OBJECTID="",t.OBJECTDISPLAYNAME=l.form.displayName,t.OBJECTEMAIL=l.form.email);var n=angular.copy(t);l.settingList.push(n),r()},this.RemoveSetting=function(t){l.settingList=l.settingList.filter(function(e){return angular.toJson(e)!==angular.toJson(t)})},this.ClearForm=r,this.SaveSettings=function(e,t){l.settingList.forEach(function(e){null===e.REQUESTSTATUS&&(e.REQUESTSTATUS="")});var n={ApprovalItemId:e,SettingType:t,ApprovalItemSettings:l.settingList};return o.SaveSettings(n).then(function(e){return e})},Object.preventExtensions(l)}angular.module("myApp").service("ApprovalItemSettingsComponentBusiness",e),e.$inject=["ApprovalItemSettingsComponentStore","ApprovalItemSettingsComponentService"]}(),function(){"use strict";function e(t,n,l,e){var o=this;function r(){return null!==n.form.role&&("LOOKUP"===n.form.role.RoleType||"CONDITIONAL LOOKUP"===n.form.role.RoleType)}o.model=n,o.events={onClick_AddSetting:function(){t.AddSetting(o.settingType)},onClick_RemoveSetting:function(e){t.RemoveSetting(e)},validateForm:function(){if("USER"===n.form.settingValue){if(null===n.form.user)return!0}else if("GROUP"===n.form.settingValue){if(null===n.form.group)return!0}else if("ROLE"===n.form.settingValue){if(null===n.form.role)return!0;if("FYI"===n.form.settingType&&r()&&null===n.form.lookup)return!0}else if("DEFINED"===n.form.settingValue&&(null===n.form.displayName||""===n.form.displayName||null===n.form.email||""===n.form.email))return!0;return!1},onClick_SaveSettings:function(){t.SaveSettings(o.approvalItemId,o.settingType).then(function(e){null===e&&(n.ClearStore(),t.GetSettings(o.approvalItemId,o.settingType),l.alertSuccess("Success","NOTIFICATION"===o.settingType?"Successfully saved notifications":"Successfully saved auditors"))})},getTemplate:function(){{if("NOTIFICATION"===o.settingType)return"app/views/templates/component-templates/approvalitem-settings/notification.html";if("AUDITOR"===o.settingType)return"app/views/templates/component-templates/approvalitem-settings/auditor.html"}return""},isRoleRequiresLookup:r},e.$on("$destroy",function(){n.ClearStore()})}angular.module("myApp").component("approvalItemSettingsAdminModalComponent",{template:'<span ng-include="vm.events.getTemplate()"></span>',controller:e,controllerAs:"vm",bindings:{approvalItemId:"=",roleList:"=",groupList:"=",settingType:"@",roleNeedsLookupList:"=",lookupList:"="}}),e.$inject=["ApprovalItemSettingsComponentBusiness","ApprovalItemSettingsComponentStore","sweetDialogAlertService","$scope"]}(),function(){"use strict";function e(n){this.SaveSettings=function(e){return n.Post(l+"ApprovalItemSettingDetailsInsertUpdate",e).then(function(e){return e})},this.GetApprovalItemSettingDetails=function(e,t){return n.Get(l+"GetApprovalItemSettingDetails/"+e+"/"+t).then(function(e){return e})};var l=ApiRootDirectory.absoluteRootUrl+"api/approvalitem/admin/"}angular.module("myApp").service("ApprovalItemSettingsComponentService",e),e.$inject=["DataAccess"]}(),function(){"use strict";function e(){function e(){this.settingList=[],this.settingListCopy=[],this.form={settingType:"REMINDER",requestStatus:"APPROVED",settingValue:"USER",displayName:null,email:null,user:null,role:null,group:null,lookup:null}}return e.prototype.ClearStore=function(){this.settingList=[],this.settingListCopy=[],this.form={settingType:"REMINDER",requestStatus:"APPROVED",settingValue:"USER",displayName:null,email:null,user:null,role:null,group:null,lookup:null}},new e}angular.module("myApp").factory("ApprovalItemSettingsComponentStore",e),e.$inject=[]}(),function(){"use strict";function e(n,t,e,l,c,o,r){function i(e){e.forEach(function(e){e.children.length<=0?(e.label=e.RefNo+" - "+e.ApprovalItemName.EN,n.approvalItemList.push(e)):i(e.children)})}function a(e,t,n,l){var o,r,i={},a=[];for(r=0;r<e.length;r+=1){e[i[e[r][t]]=r][l]=[];var s=angular.copy(e[r]);if(0===e.filter(function(e){return e[n]==s[t]}).length&&c.stringIsNullUndefinedOrEmpty(s.ApprovalItemLabel)){var u=angular.copy(s);u.ApprovalItemParentId=s.ApprovalItemId,u.ApprovalItemId=5e5,"01.06"===u.RefNo.substr(0,5)?u.ApprovalItemName.EN="Start Pricing Review & Bid Submission : "+u.ApprovalItemName.EN:u.ApprovalItemName.EN="Start "+u.ApprovalItemName.EN,e.push(u)}}for(r=0;r<e.length;r+=1)0!==(o=e[r])[n]?e[i[o[n]]][l].push(o):a.push(o);return a}this.GetApprovalItemsByOrg=function(e){{if(null!==n.selectedOrg)return"am.approvalitems.list"===o.current.name?t.GetApprovalItemsByOrgWithCaching(n.selectedOrg.OrganizationCode,e).then(function(e){n.approvalItemList=[],n.treeviewList=c.listToTree(e,"ApprovalItemId","ApprovalItemParentId","children"),i(n.treeviewList)}):t.GetApprovalItemsByOrg(n.selectedOrg.OrganizationCode,e).then(function(e){n.approvalItemList=[],n.treeviewList=c.listToTree(e,"ApprovalItemId","ApprovalItemParentId","children"),i(n.treeviewList)});n.treeviewList=[],n.alternativeTreeviewList=[],n.approvalItemList=[]}},this.GetOrganizationLookup=function(){return l.GetOrganizationLookup().then(function(e){n.orgList=e})},this.GetApprovalItemTree=function(){return t.GetApprovalItemTree(n.selectedSearchApprovalItem.value.ApprovalItemId).then(function(e){e.forEach(function(e){e.isOpen=!0}),n.treeviewList=c.listToTree(e,"ApprovalItemId","ApprovalItemParentId","children")})},this.SetDefaultOrg=function(t){n.selectedOrg=n.orgList.find(function(e){return e.OrganizationCode===t})},this.RefreshApprovalItemList=function(){{if(null!==n.selectedOrg)return t.GetApprovalItemsByOrg(n.selectedOrg.OrganizationCode,!1).then(function(e){n.approvalItemList=[],n.treeviewList=c.listToTree(e,"ApprovalItemId","ApprovalItemParentId","children"),i(n.treeviewList)});n.treeviewList=[],n.alternativeTreeviewList=[],n.approvalItemList=[]}},this.GetApprovalItemsForWizard=function(e){return"am.approvalitems.list"===o.current.name?t.GetApprovalItems(n.selectedOrg.OrganizationCode,e).then(function(e){n.approvalItemList=[],n.treeviewList=a(e,"ApprovalItemId","ApprovalItemParentId","children"),i(n.treeviewList)}):t.GetApprovalItems(n.selectedOrg.OrganizationCode,e).then(function(e){n.approvalItemList=[],n.treeviewList=a(e,"ApprovalItemId","ApprovalItemParentId","children"),i(n.treeviewList)})},Object.preventExtensions(n)}angular.module("myApp").service("ApprovalItemTreeviewComponentBusiness",e),e.$inject=["ApprovalItemTreeviewComponentStore","ApprovalItemTreeviewComponentService","$filter","LookupService","astigUtilityService","$state","UtilService"]}(),function(){"use strict";function e(t){return{restrict:"E",scope:{data:"=",forAdmin:"=",fullAccess:"=?",manageFunction:"=?",isBusinessActivity:"=?"},templateUrl:"app/views/templates/component-templates/approvalitems-treeview/treeview.html",compile:function(e){return t.compile(e)},controller:["$scope","$state","ApprovalItemTreeviewComponentStore","MainStore","astigUtilityService",function(t,e,n,l,o){t.events={onInitialize_Row:function(e){angular.isUndefined(e.isOpen)&&(e.isOpen=0==e.ApprovalItemParentId)},onClick_Item:function(e){0<e.children.length?e.isOpen=!e.isOpen:t.manageFunction("update",e,n.selectedOrg.OrganizationCode)},onLoad_Notes:function(e){angular.element("#notes-"+e).popover("show")},onClick_AddItem:function(e){t.manageFunction("add",e,n.selectedOrg.OrganizationCode)},onClick_DeleteItem:function(e){t.manageFunction("delete",e,n.selectedOrg.OrganizationCode)},onClick_ManageItem:function(e){t.manageFunction("update",e,n.selectedOrg.OrganizationCode)},onClick_ManageAuditor:function(e){t.manageFunction("auditor",e,n.selectedOrg.OrganizationCode)},isInArray:o.isInArray},t.mainModel=l}]}}angular.module("myApp").directive("approvalItemsTreeviewDirective",e),e.$inject=["RecursionHelper"]}(),function(){"use strict";function e(l){this.GetApprovalItemsByOrg=function(e,t){var n=o+"GetApprovalItemsByOrg?orgCode="+e;angular.isDefined(t)&&t&&(n=o+"GetApprovalItemsByOrg?orgCode="+e+"&noloading=true");return l.Get(n,{cache:!1}).then(function(e){return e})},this.GetApprovalItemTree=function(e){return l.Get(o+"GetApprovalItemTree/"+e,{cache:!1}).then(function(e){return e})},this.GetApprovalItemsByOrgWithCaching=function(e,t){var n=o+"GetApprovalItemsByOrg?orgCode="+e+"&u="+APIguid;angular.isDefined(t)&&t&&(n=o+"GetApprovalItemsByOrg?orgCode="+e+"&noloading=true&u="+APIguid);return l.Get(n,{cache:!0}).then(function(e){return e})},this.GetApprovalItems=function(e,t){var n=o+"GetApprovalItems?orgCode="+e;angular.isDefined(t)&&t&&(n=o+"GetApprovalItems?orgCode="+e+"&noloading=true");return l.Get(n,{cache:!1}).then(function(e){return e})};var o=ApiRootDirectory.absoluteRootUrl+"api/approvalitem/"}angular.module("myApp").service("ApprovalItemTreeviewComponentService",e),e.$inject=["DataAccess"]}(),function(){"use strict";function e(){function e(){this.treeviewList=[],this.selectedOrg=null,this.orgList=[],this.approvalItemList=[],this.alternativeTreeviewList=[],this.searchInput=null,this.selectedSearchApprovalItem=null,this.initcalled=!1}return e.prototype.ClearStore=function(){this.treeviewList=[],this.selectedOrg=null,this.orgList=[],this.approvalItemList=[],this.alternativeTreeviewList=[],this.searchInput=null,this.selectedSearchApprovalItem=null,this.initcalled=!1},new e}angular.module("myApp").factory("ApprovalItemTreeviewComponentStore",e),e.$inject=[]}(),function(){"use strict";function e(n,l,e,o,t,r,i,a,s,u){var c=this;function d(){var e=i.get(a.loggedInViewAs),t=i.get(a.currentSelectedOrg);null!==e&&(e=JSON.parse(s.decode(e)),n.GetOrganizationLookup().then(function(){n.SetDefaultOrg(null===t?e.DefaultOrg:t),c.forAdmin?n.GetApprovalItemsByOrg(!1):n.GetApprovalItemsForWizard(!1)}))}c.model={},c.model=l,c.events={onSelect_Organization:function(){i.set(a.currentSelectedOrg,l.selectedOrg.OrganizationCode),n.GetApprovalItemsByOrg(!1)},onClick_Manage:function(e,t,n){c.manageFunction(e,t,n)},onSearch_ApprovalItem:function(e,t){var n=o("filter")(l.approvalItemList,e.term);n&&t($.map(n.slice(0,50),function(e){return{label:e.RefNo+" - "+e.ApprovalItemLabel,value:e}}))},onSelectSearched_ApprovalItem:function(e){l.selectedSearchApprovalItem=e,c.manageFunction("update",e.value,e.value.OrganizationCode)},onChange_SearchApprovalItem:function(){null!==l.selectedSearchApprovalItem&&l.searchInput!==l.selectedSearchApprovalItem.label&&(l.selectedSearchApprovalItem=null,n.GetApprovalItemsByOrg(!1))},onHover:function(e){return 0<e.length?u.GetToolTip(e[0]):"No items to search"}},l.ClearStore(),d(),t.$on("LOAD_DEFAULT_ORG_AND_APPROVAL_ITEM",function(e,t){t.init&&!l.initcalled&&(l.initcalled=!0,d())})}angular.module("myApp").component("approvalItemsTreeviewComponent",{templateUrl:"app/views/templates/component-templates/approvalitems-treeview/index.html",controller:e,controllerAs:"vm",bindings:{forAdmin:"<",manageFunction:"=?"}}),e.$inject=["ApprovalItemTreeviewComponentBusiness","ApprovalItemTreeviewComponentStore","$scope","$filter","$rootScope","MainStore","localStorageService","SessionName","$base64","MainBusiness"]}(),function(){"use strict";function e(e){this.currentState=e}angular.module("myApp").component("breadcrumb",{templateUrl:"app/views/templates/component-templates/breadcrumb.html",controller:e,controllerAs:"vm"}),e.$inject=["$state"]}(),function(){"use strict";function e(e,t){this.event={logout:function(){e.logout().then(function(e){t.go("am")})}}}angular.module("myApp").component("fixedTop",{templateUrl:"app/views/templates/component-templates/fixed-top.html",controller:e,controllerAs:"vm",bindings:{displayName:"="}}),e.$inject=["MainBusiness","$state"]}(),function(){"use strict";angular.module("myApp").component("footerComponent",{templateUrl:"app/views/templates/component-templates/footer.html"})}(),function(){"use strict";function e(e,l,o,n){var r=this;r.events={formatDate:function(e,t){if(!e)return;-1===e.indexOf("Z")&&-1===e.indexOf("+")&&(e+="Z");return n("date")(e,t)},onClick_DeleteDocument:function(n){var e={Id:n.RequestDocumentId};o.alertConfirm("Confirm Deletion","Are you sure you want to delete "+n.ActualFileName+"?",function(){return l.DeleteDocument(e).then(function(e){if(null===e){var t={GeneratedFileName:n.GeneratedFilename};l.DeletePhysicalFile(t).then(function(e){o.alertSuccess("Success","Deleted "+n.ActualFileName+" successfully!"),r.rficonversation.forEach(function(e){e.Response.forEach(function(e){e.Documents=e.Documents.filter(function(e){return angular.toJson(e)!==angular.toJson(n)})})})})}})},angular.noop,"Yes","No",!0)},onClick_OpenDocument:l.DownloadDocument}}angular.module("myApp").component("rfiConversation",{templateUrl:"app/views/templates/component-templates/rfi-conversation.html",controller:e,controllerAs:"vm",bindings:{rficonversation:"=",securitydetails:"="}}),e.$inject=["astigUtilityService","DocumentService","sweetDialogAlertService","$filter"]}(),function(){"use strict";angular.module("myApp").component("sectionHeader",{templateUrl:"app/views/templates/component-templates/section-header.html"})}(),function(){"use strict";function e(e,t){this.model=t,this.events={login:function(){e.login()},isAuthenticated:function(){return!(null===localStorage.getItem("user")||void 0===localStorage.getItem("user")||"undefined"===localStorage.getItem("user"))}}}angular.module("myApp").component("sectionMenu",{templateUrl:"app/views/templates/component-templates/section-menu.html",controller:e,controllerAs:"vm"}),e.$inject=["MainBusiness","MainStore"]}(),function(){"use strict";function e(e,t,n){var l=this;l.model={},l.methods={},l.state=e,l.model.mainStore=t,l.methods.getTemplate=function(){if(e.includes("am.admin"))return"app/views/templates/component-templates/admin-side-menu.html";return"app/views/templates/component-templates/main-side-menu.html"},l.methods.showHideMenu=function(){l.model.mainStore.showMenu=!l.model.mainStore.showMenu},l.methods.utilityService=n}angular.module("myApp").component("sideMenu",{template:'<span ng-include="vm.methods.getTemplate()"></span>',controller:e,controllerAs:"vm"}),e.$inject=["$state","MainStore","astigUtilityService"]}(),function(){"use strict";function e(u,c,e,n,d){function r(e,t){var n=e.Roles.find(function(e){return e.CostPointRoleId==t.CostPointRoleId});c.objectIsNullorUndefined(n)||(n.LookupValue=t.LookupValue,a(t,e,n,!0))}function i(e,o){0!==u.approvalItem.steps.length&&(e.forEach(function(t){t.HasChanged&&(t.HasChanged=!1);var n=u.approvalItem.steps.find(function(e){return e.ExecutionOrder==t.ExecutionOrder});if(!c.objectIsNullorUndefined(n)){var l=n.Roles.find(function(e){return e.CostPointRoleId==t.CostPointRoleId});if(!c.objectIsNullorUndefined(l))switch(l.NoApprovers=t.NoApprovers,t.RoleType){case"LOOKUP":l.CostPointApprovers=[],l.CostPointInactiveApprovers=[],l.LookupValue=t.LookupValue,"DROPDOWN"===t.RoleBehavior?(n.costPointApprovers=[],n.costPointInactiveApprovers=[],n.Roles.forEach(function(e){e.CostPointRoleId!==t.CostPointRoleId&&(e.CostPointApprovers.forEach(function(e){n.costPointApprovers.push(e.MainApproverDisplayName)}),e.CostPointInactiveApprovers.forEach(function(e){n.costPointInactiveApprovers.push(cpa.MainApproverDisplayName)}))}),u.approvalItem.approverlist[l.CostPointRoleId]=[],t.MainApprovers.forEach(function(e){u.approvalItem.approverlist[l.CostPointRoleId].push(e)})):c.objectIsNullorUndefined(o[t.LookupValue])?a(t,n,l,!1):a(t,n,l,!0);break;case"CONDITIONAL LOOKUP":switch(l.DerivedRoleType=t.DerivedRoleType,l.DerivedRoleBehavior=t.DerivedRoleBehavior,t.DerivedRoleType){case"UNIVERSAL":r(n,t);break;case"TABLE-BASED":l.TableData=t.TableData,l.DerivedRoleId=t.DerivedRoleId,l.DerivedChildRoleIds=t.DerivedChildRoleIds,l.DerivedParentTableDataRoleIds=t.DerivedParentTableDataRoleIds,l.LookupValue=t.LookupValue,u.approvalItem.selectedTableData[l.DerivedRoleId]=null,n.costPointApprovers=[],n.costPointInactiveApprovers=[],l.CostPointApprovers=[],l.CostPointInactiveApprovers=[],n.Roles.forEach(function(e){e.CostPointRoleId!==t.CostPointRoleId&&(e.CostPointApprovers.forEach(function(e){n.costPointApprovers.push(e.MainApproverDisplayName)}),e.CostPointInactiveApprovers.forEach(function(e){n.costPointInactiveApprovers.push(cpa.MainApproverDisplayName)}))});break;case"LOOKUP":l.LookupValue=t.LookupValue,a(t,n,l,!0);break;default:n.costPointApprovers=[],n.costPointInactiveApprovers=[],n.costPointRoles=[],n.costPointRoleNames=[],a(t,n,l,!1),delete n.TableData}}}}),l(o,e),t())}function p(e,l){0!==u.approvalItem.steps.length&&l.Roles.forEach(function(t){switch(t.RoleType){case"LOOKUP":var n=e.find(function(e){return e.ExecutionOrder===l.ExecutionOrder&&e.CostPointRoleId===t.CostPointRoleId});"DROPDOWN"===t.RoleBehavior&&a(n,l,t,!0);break;case"TABLE-BASED":(n=e.find(function(e){return e.ExecutionOrder===l.ExecutionOrder&&e.CostPointRoleId===t.CostPointRoleId})).MainApprovers=[],c.objectIsNullorUndefined(u.approvalItem.selectedTableData[t.CostPointRoleId])||(l.costPointApprovers=[],l.costPointInactiveApprovers=[],t.CostPointApprovers=[],t.CostPointInactiveApprovers=[],n.StepTableBasedSelection=angular.copy(JSON.stringify(u.approvalItem.selectedTableData[t.CostPointRoleId])),u.approvalItem.selectedTableData[t.CostPointRoleId].TableDataMembers.forEach(function(e){l.Roles.forEach(function(e){e.CostPointRoleId!==n.CostPointRoleId&&(e.CostPointApprovers.forEach(function(e){l.costPointApprovers.push(e.MainApproverDisplayName)}),e.CostPointInactiveApprovers.forEach(function(e){l.costPointInactiveApprovers.push(cpa.MainApproverDisplayName)}))}),n.MainApprovers.push(e),"Y"===e.IsActive?(t.CostPointApprovers.push(e),l.costPointApprovers.push(e.MainApproverDisplayName)):(t.CostPointInactiveApprovers.push(e),l.costPointInactiveApprovers.push(e.MainApproverDisplayName)),n.MainApprovers.length===t.CostPointInactiveApprovers.length&&0!==t.CostPointInactiveApprovers.length&&(t.NoApprovers=!0)}),o(e));break;case"CONDITIONAL LOOKUP":switch(t.DerivedRoleType){case"LOOKUP":"DROPDOWN"===t.RoleBehavior&&(n.MainApprovers.push(u.approvalItem.selectedApprover[t.DerivedRoleId]),a(n,l,t,!0));break;case"TABLE-BASED":(n=e.find(function(e){return e.ExecutionOrder===l.ExecutionOrder&&e.CostPointRoleId===t.CostPointRoleId})).MainApprovers=[],c.objectIsNullorUndefined(u.approvalItem.selectedTableData[t.DerivedRoleId])||(n.StepTableBasedSelection=angular.copy(JSON.stringify(u.approvalItem.selectedTableData[t.DerivedRoleId])),l.costPointApprovers=[],l.costPointInactiveApprovers=[],t.CostPointApprovers=[],t.CostPointInactiveApprovers=[],u.approvalItem.selectedTableData[t.DerivedRoleId].TableDataMembers.forEach(function(e){l.Roles.forEach(function(e){e.DerivedRoleId!==n.DerivedRoleId&&(e.CostPointApprovers.forEach(function(e){l.costPointApprovers.push(e.MainApproverDisplayName)}),e.CostPointInactiveApprovers.forEach(function(e){l.costPointInactiveApprovers.push(cpa.MainApproverDisplayName)}))}),n.MainApprovers.push(e),"Y"===e.IsActive?(t.CostPointApprovers.push(e),l.costPointApprovers.push(e.MainApproverDisplayName)):(t.CostPointInactiveApprovers.push(e),l.costPointInactiveApprovers.push(e.MainApproverDisplayName)),n.MainApprovers.length===t.CostPointInactiveApprovers.length&&0!==t.CostPointInactiveApprovers.length&&(t.NoApprovers=!0)}),o(e))}}})}function a(t,n,l,e){n.costPointApprovers=[],n.costPointInactiveApprovers=[],l.CostPointApprovers=[],l.CostPointInactiveApprovers=[],n.Roles.forEach(function(e){e.CostPointRoleId!==t.CostPointRoleId&&(e.CostPointApprovers.forEach(function(e){n.costPointApprovers.push(e.MainApproverDisplayName)}),e.CostPointInactiveApprovers.forEach(function(e){n.costPointInactiveApprovers.push(cpa.MainApproverDisplayName)}))}),0<t.MainApprovers.length?(t.MainApprovers.forEach(function(e){"Y"===e.IsActive?(l.CostPointApprovers.push(e),n.costPointApprovers.push(e.MainApproverDisplayName)):(l.CostPointInactiveApprovers.push(e),n.costPointInactiveApprovers.push(e.MainApproverDisplayName))}),t.MainApprovers.length===n.costPointInactiveApprovers.length&&0!==n.costPointInactiveApprovers.length&&(l.NoApprovers=!0)):(t.NoApprovers=e,l.NoApprovers=e)}function o(e){e.forEach(function(o){if("TABLE-BASED"===o.RoleType||"TABLE-BASED"===o.DerivedRoleType){var r=u.approvalItem.steps.find(function(e){return e.ExecutionOrder===o.ExecutionOrder}),i=r.Roles.find(function(e){return e.CostPointRoleId===o.CostPointRoleId});Object.keys(u.approvalItem.selectedTableData).forEach(function(e){var t=angular.copy(u.approvalItem.selectedTableData[e]),n=null;if(!c.objectIsNullorUndefined(t)){n=angular.copy(i.TableData.find(function(e){return d.isInArray(e.TableDataRoleId,t.DerivedParentTableDataRoleIds)}));if(!c.objectIsNullorUndefined(n)){o.MainApprovers=[];var l="TABLE-BASED"==i.RoleType?i.CostPointRoleId:i.DerivedRoleId;u.approvalItem.selectedTableData[l]=n,o.StepTableBasedSelection=angular.copy(JSON.stringify(u.approvalItem.selectedTableData[l])),r.costPointApprovers=[],r.costPointInactiveApprovers=[],i.CostPointApprovers=[],i.CostPointInactiveApprovers=[],u.approvalItem.selectedTableData[l].TableDataMembers.forEach(function(e){r.Roles.forEach(function(e){e.CostPointRoleId!==o.CostPointRoleId&&(e.CostPointApprovers.forEach(function(e){r.costPointApprovers.push(e.MainApproverDisplayName)}),e.CostPointInactiveApprovers.forEach(function(e){r.costPointInactiveApprovers.push(cpa.MainApproverDisplayName)}))}),o.MainApprovers.push(e),"Y"===e.IsActive?(i.CostPointApprovers.push(e),r.costPointApprovers.push(e.MainApproverDisplayName)):(i.CostPointInactiveApprovers.push(e),r.costPointInactiveApprovers.push(e.MainApproverDisplayName)),o.MainApprovers.length===i.CostPointInactiveApprovers.length&&0!==i.CostPointInactiveApprovers.length&&(i.NoApprovers=!0)})}}})}})}function t(){var t=0;u.approvalItem.steps.forEach(function(e){e.Roles.forEach(function(e){e.NoApprovers&&t++})});0<t&&n.alertWarningCustom("Warning",'<h3 style="text-align:left; font-weight:bold; font-size:14px; font-weight:bold">IAS relies on accurate data in other source systems in order for certain roles to auto-populate.</h3><p style="text-align:left; font-weight:bold; font-size:12px; font-weight:bold"> To submit this request, the missing personnel assignments must be updated in the applicable source system.</p><ul style="text-align:left; font-weight:normal; font-size:12px;"><li>If the necessary role is tied to an Opportunity, either update the Opportunity in CRM or contact your Regional CRM Data Coordinator.</li><li>If the necessary role is tied to an Agreement or Project, either update the data in the ERP or contact your Project Accountant.</li><li>For all other roles, please contact <a href="mailto:IAS-Admin@wsp.com">IAS-Admin@wsp.com</a>.</li></ul>',"none","noApprover_swal")}function l(e,r){var i=null,a=null;if(e.hasOwnProperty("CASCADINGORACLEHIERARCHYTEMPLATE")){var s=null;if(c.objectIsNullorUndefined(e.CASCADINGORACLEHIERARCHYTEMPLATE))return;if(e.CASCADINGORACLEHIERARCHYTEMPLATE.hasOwnProperty("LOCAL_BUSINESS_LINE")&&(s=e.CASCADINGORACLEHIERARCHYTEMPLATE.LOCAL_BUSINESS_LINE),c.objectIsNullorUndefined(s))u.approvalItem.steps.forEach(function(e){e.Roles.forEach(function(t){if("TABLE-BASED"===t.RoleType||"TABLE-BASED"===t.DerivedRoleType){var n=t.DerivedChildRoleIds,e=u.approvalItem.steps.find(function(e){var t=e.Roles.find(function(e){if("TABLE-BASED"===e.RoleType||"TABLE-BASED"===e.DerivedRoleType){var t="TABLE-BASED"===e.RoleType?e.CostPointRoleId:e.DerivedRoleId;return d.isInArray(t,n)}});return!c.objectIsNullorUndefined(t)});c.objectIsNullorUndefined(e)?(t.HasChild="N",r.find(function(e){e.CostPointRoleId==t.CostPointRoleId&&(e.HasLBL="Y")})):t.HasChild="Y"}})});else if(u.approvalItem.steps.forEach(function(o){o.Roles.forEach(function(t){if("TABLE-BASED"===t.RoleType||"TABLE-BASED"===t.DerivedRoleType){var n=t.DerivedChildRoleIds,e=u.approvalItem.steps.find(function(e){var t=e.Roles.find(function(e){if("TABLE-BASED"===e.RoleType||"TABLE-BASED"===e.DerivedRoleType){var t="TABLE-BASED"===e.RoleType?e.CostPointRoleId:e.DerivedRoleId;return d.isInArray(t,n)}});return!c.objectIsNullorUndefined(t)});if(c.objectIsNullorUndefined(e)){var l=u.approvalItem.steps.find(function(e){var t=e.Roles.find(function(e){if("TABLE-BASED"===e.RoleType||"TABLE-BASED"===e.DerivedRoleType)return e.TableData.some(function(e){var t=JSON.parse(e.DerivedParentTableDataRoleIds),n=JSON.parse(s.DerivedParentTableDataRoleIds);return t.some(function(t){return n.some(function(e){return t==e})})})});return!c.objectIsNullorUndefined(t)&&(a=t,!0)});c.objectIsNullorUndefined(l)?(t.HasChild="N",r.find(function(e){e.CostPointRoleId==t.CostPointRoleId&&(e.HasLBL="Y")})):(t.HasChild="Y",i=o)}else t.HasChild="Y"}})}),!c.objectIsNullorUndefined(i)&&!c.objectIsNullorUndefined(a)){var t="TABLE-BASED"===a.RoleType?a.CostPointRoleId:a.DerivedRoleId;u.approvalItem.selectedTableData[t]=a.TableData.find(function(e){var t=JSON.parse(e.DerivedParentTableDataRoleIds),n=JSON.parse(s.DerivedParentTableDataRoleIds);return t.some(function(t){return n.some(function(e){return t==e})})}),p(r,i)}}else u.approvalItem.steps.forEach(function(e){e.Roles.forEach(function(t){if("TABLE-BASED"===t.RoleType||"TABLE-BASED"===t.DerivedRoleType){var n=t.DerivedChildRoleIds,e=u.approvalItem.steps.find(function(e){var t=e.Roles.find(function(e){if("TABLE-BASED"===e.RoleType||"TABLE-BASED"===e.DerivedRoleType){var t="TABLE-BASED"===e.RoleType?e.CostPointRoleId:e.DerivedRoleId;return d.isInArray(t,n)}});return!c.objectIsNullorUndefined(t)});c.objectIsNullorUndefined(e)?(t.HasChild="N",r.find(function(e){e.CostPointRoleId==t.CostPointRoleId&&(e.HasLBL="Y")})):t.HasChild="Y"}})})}this.SetCostPointRoleIds=function(){u.costPointRoleIds=e},this.SetDefaultControls=function(e){void 0!==e.Svp&&(u.approvalItem.selectedSvp[e.Svp.ExecutionOrder]={MainApproverDisplayName:e.Svp.MainApproverDisplayName,MainApproverEmail:e.Svp.MainApproverEmail,MainApproverUsername:e.Svp.MainApproverUsername});void 0!==e.Vp&&(u.approvalItem.selectedVp[e.Vp.ExecutionOrder]={MainApproverDisplayName:e.Vp.MainApproverDisplayName,MainApproverEmail:e.Vp.MainApproverEmail,MainApproverUsername:e.Vp.MainApproverUsername});void 0!==e.Employee&&(u.approvalItem.selectedEmployee[e.Employee.ExecutionOrder]={FULL_NAME:e.Employee.MainApproverDisplayName,EMAIL_ADDRESS:e.Employee.MainApproverEmail})},this.ProcessApprovalItemStepInit=function(e){c.objectIsNullorUndefined(e)||(u.approvalItem.steps=[],e.forEach(function(t){var e=u.approvalItem.steps.find(function(e){return e.ExecutionOrder===t.ExecutionOrder}),n={};if(c.objectIsNullorUndefined(e))switch(n.StepType=t.StepType,n.ExecutionOrder=t.ExecutionOrder,n.StepDistinction=t.StepDistinction,n.StepLevel=t.StepLevel,n.Sla=t.Sla,n.IsAnd=t.IsAnd,n.ConcurrentPosition=t.ConcurrentPosition,n.ConcurrentColor=t.ConcurrentColor,n.costPointApprovers=[],n.costPointInactiveApprovers=[],n.Roles=[{CostPointRoleId:t.CostPointRoleId,CostPointRoleName:t.CostPointRoleName,RoleType:t.RoleType,RoleBehavior:t.RoleBehavior,DerivedRoleId:t.DerivedRoleId,DerivedRoleType:t.DerivedRoleType,DerivedRoleBehavior:t.DerivedRoleBehavior,NoApprovers:t.NoApprovers,LookupValue:t.LookupValue,HasChanged:!1,CostPointApprovers:[],CostPointInactiveApprovers:[],DerivedChildRoleIds:t.DerivedChildRoleIds,DerivedParentTableDataRoleIds:t.DerivedParentTableDataRoleIds,TableData:t.TableData}],t.RoleType){case"UNIVERSAL":r(n,t),u.approvalItem.steps.push(n);break;default:u.approvalItem.steps.push(n)}else{var l={CostPointRoleId:t.CostPointRoleId,CostPointRoleName:t.CostPointRoleName,RoleType:t.RoleType,RoleBehavior:t.RoleBehavior,DerivedRoleId:t.DerivedRoleId,DerivedRoleType:t.DerivedRoleType,DerivedRoleBehavior:t.DerivedRoleBehavior,NoApprovers:t.NoApprovers,LookupValue:t.LookupValue,HasChanged:!1,CostPointApprovers:[],CostPointInactiveApprovers:[],DerivedChildRoleIds:t.DerivedChildRoleIds,DerivedParentTableDataRoleIds:t.DerivedParentTableDataRoleIds,TableData:t.TableData};switch(e.Roles.push(l),t.RoleType){case"UNIVERSAL":r(e,t)}}}),l({},null))},this.ProcessApprovalItemStepLookups=i,this.ProcessApprovalStepsDropdown=p,this.VerifyLookupApprovers=t,this.GetSelectedValues=function(e){switch(e){case"TABLEDATA":return JSON.stringify(u.approvalItem.selectedTableData);case"APPROVER":return JSON.stringify(u.approvalItem.selectedApprover);case"EMPLOYEESEARCH":return JSON.stringify(u.approvalItem.selectedEmployee)}},this.SetSelectedValues=function(e,t){switch(e){case"EMPLOYEESEARCH":u.clearswitch="Y",u.approvalItem.selectedEmployee=JSON.parse(t)}},this.ProcessApprovalItemSaveRequest=function(l,e,o,t){u.approvalItem.selectedApprover=e,i(o,t),Object.keys(l).forEach(function(n){c.objectIsNullorUndefined(u.approvalItem.selectedTableData[n])&&u.approvalItem.steps.forEach(function(e){var t=e.Roles.find(function(e){return e.CostPointRoleId==n||e.DerivedRoleId==n});c.objectIsNullorUndefined(t)||(u.approvalItem.selectedTableData[n]=t.TableData.find(function(e){return e.TableDataRoleId===l[n].TableDataRoleId}),p(o,e))})})},this.ProcessEmployeeSearch=function(e,t,n){var l=e.find(function(e){return e.CostPointRoleId==n});c.objectIsNullorUndefined(t)?l.MainApprovers=[]:l.MainApprovers=[{IsActive:"Y",MainApproverDisplayName:t.FULL_NAME,MainApproverEmail:t.EMAIL_ADDRESS,MainApproverUsername:t.EMAIL_ADDRESS}]},this.SetLookup=function(e){u.lookups=e},Object.preventExtensions(u)}angular.module("myApp").service("WorkflowStepsComponentBusiness",e),e.$inject=["WorkflowStepsComponentStore","astigUtilityService","CostPointRoleIds","sweetDialogAlertService","UtilService"]}(),function(){"use strict";function e(e,t,l,n,o){var r=this;r.model=t,r.utilities=n,r.events={getTemplate:function(){{if(e.includes("am.approvalitems.details")||e.includes("am.approvalitems.resubmit")||e.includes("am.approvalitems.viewsaveddetails"))return"app/views/templates/component-templates/workflow-steps/approvalitem-details.html";if(e.includes("am.requests.details")||e.includes("am.requests.supervisor"))return"app/views/templates/component-templates/workflow-steps/request-details.html"}return""},isInObjectArray:n.isInObjectArray,onChange_StepControls:function(e){l.ProcessApprovalStepsDropdown(r.steps,e)},onMouseEnter_DelegatorPopover:function(e){angular.element("#delegator-"+e).popover("show")},VerifyLookupApprovers:function(){l.VerifyLookupApprovers()}},l.SetCostPointRoleIds(),o.$watch("vm.model.approvalItem.selectedEmployee",function(t,n){angular.equals(r.model.approvalItem.selectedEmployee,{})||Object.keys(t).forEach(function(e){angular.equals(n[e],t[e])||l.ProcessEmployeeSearch(r.steps,t[e],e)})},!0),o.$on("$destroy",function(){t.ClearStore()})}angular.module("myApp").component("workflowSteps",{template:'<span ng-include="vm.events.getTemplate()"></span>',controller:e,controllerAs:"vm",bindings:{steps:"="}}),e.$inject=["$state","WorkflowStepsComponentStore","WorkflowStepsComponentBusiness","astigUtilityService","$scope"]}(),function(){"use strict";function e(){function e(){this.approvalItem={steps:[],svpList:[],vpList:[],selectedSvp:{},selectedVp:{},selectedTableData:{},approverlist:{},selectedApprover:{},selectedEmployee:{}},this.costPointRoleIds={},this.clearswitch="N",this.lookups=null}return e.prototype.ClearStore=function(){this.approvalItem={steps:[],svpList:[],vpList:[],selectedSvp:{},selectedVp:{},selectedTableData:{},approverlist:{},selectedApprover:{},selectedEmployee:{}},this.costPointRoleIds={},this.clearswitch="N",this.lookups=null},new e}angular.module("myApp").factory("WorkflowStepsComponentStore",e),e.$inject=[]}(),function(){"use strict";function e(s,n,o,r,e,t,l){function a(e,t,n,l){e.errorSwitchDeliveryMethod=!1,e.errorSwitchClient=!1,e.errorSwitchOwner=!1,e.errorSwitchBusinessLine=!1,e.errorSwitchBusinessLineDivision=!1,n.isFormValid=!0,"WSP Internal"===e.selected[t.ClientType]&&s.stringIsNullUndefinedOrEmpty(e.selected[t.UltimateClient])?(e.errorSwitchClient=!0,e.errorSwitchOwner=!0):"Joint Venture"===e.selected[t.ClientType]&&s.stringIsNullUndefinedOrEmpty(e.selected[t.UltimateClient])?(i("Private",l,e),u("Private",l,e)):"Joint Venture"===e.selected[t.UltimateClientType]?(i(e.selected[t.ClientType],l,e),u("Private",l,e)):"Joint Venture"===e.selected[t.ClientType]?"INTERNAL JV"===e.selected[t.Type]?void 0!==l.ApprovalItemDetail.find(function(e){return"Direct Client = Private"===e.ApprovalItemName.EN})?(e.errorSwitchClient=!1,e.errorSwitchOwner=!1):(i(e.selected[t.UltimateClientType],l,e),u(e.selected[t.UltimateClientType],l,e)):(void 0===l.ApprovalItemDetail.find(function(e){return"Direct Client = Private"===e.ApprovalItemName.EN})?e.errorSwitchClient=!0:e.errorSwitchClient=!1,u(e.selected[t.UltimateClientType],l,e)):"WSP Internal"===e.selected[t.ClientType]?void 0!==l.ApprovalItemDetail.find(function(e){return"Direct Client = Private"===e.ApprovalItemName.EN})?(e.errorSwitchClient=!1,e.errorSwitchOwner=!1):(i(e.selected[t.UltimateClientType],l,e),u(e.selected[t.UltimateClientType],l,e)):s.stringIsNullUndefinedOrEmpty(e.selected[t.UltimateClient])?(i(e.selected[t.ClientType],l,e),u(e.selected[t.ClientType],l,e)):(i(e.selected[t.ClientType],l,e),u(e.selected[t.UltimateClientType],l,e)),void 0===l.ApprovalItemDetail.find(function(e){return"Delivery Method = Design Build"===e.ApprovalItemName.EN})||!s.stringIsNullUndefinedOrEmpty(e.selected[t.DeliveryMethod])&&"DESIGN/BID/BUILD"!==e.selected[t.DeliveryMethod]&&e.selected[t.DeliveryMethod].includes("DESIGN")||(e.errorSwitchDeliveryMethod=!0),void 0!==l.ApprovalItemDetail.find(function(e){return"Delivery Method ≠ Design Build"===e.ApprovalItemName.EN})&&(s.stringIsNullUndefinedOrEmpty(e.selected[t.DeliveryMethod])||"DESIGN/BID/BUILD"!==e.selected[t.DeliveryMethod]&&e.selected[t.DeliveryMethod].includes("DESIGN"))&&(e.errorSwitchDeliveryMethod=!0),void 0!==l.ApprovalItemDetail.find(function(e){return"Project's P&L outside Federal Region"===e.ApprovalItemName.EN})&&(e.errorSwitchClient=!1,e.errorSwitchOwner=!1,"Public - Federal"===e.selected[t.ClientType]||0==e.selected[e.autoProp.ClientType].length&&s.stringIsNullUndefinedOrEmpty(e.selected[e.prop.ClientType])&&""!=e.selected[e.autoProp.Client]||"Public - Federal"===e.selected[t.UltimateClientType]||0==e.selected[e.autoProp.UltimateClientType].length&&s.stringIsNullUndefinedOrEmpty(e.selected[e.prop.UltimateClientType])&&""!=e.selected[e.autoProp.UltimateClient]||!s.stringIsNullUndefinedOrEmpty(e.selected[t.Level1])&&e.selected[t.Level1].toUpperCase().includes("FEDV")||(e.errorSwitchClient=!0,e.errorSwitchOwner="WSP Internal"!==e.selected[t.UltimateClientType]),(s.stringIsNullUndefinedOrEmpty(e.selected[t.Level1])||e.selected[t.Level1].toUpperCase().includes("FEDV"))&&(e.errorSwitchBusinessLineDivision=!0)),void 0!==l.ApprovalItemDetail.find(function(e){return"Project's P&L in Federal Region"===e.ApprovalItemName.EN})&&(e.errorSwitchClient=!1,e.errorSwitchOwner=!1,"Public - Federal"===e.selected[t.ClientType]||0==e.selected[e.autoProp.ClientType].length&&s.stringIsNullUndefinedOrEmpty(e.selected[e.prop.ClientType])&&""!=e.selected[e.autoProp.Client]||"Public - Federal"===e.selected[t.UltimateClientType]||0==e.selected[e.autoProp.UltimateClientType].length&&s.stringIsNullUndefinedOrEmpty(e.selected[e.prop.UltimateClientType])&&""!=e.selected[e.autoProp.UltimateClient]||!s.stringIsNullUndefinedOrEmpty(e.selected[t.Level1])&&!e.selected[t.Level1].toUpperCase().includes("FEDV")||(e.errorSwitchClient=!0,e.errorSwitchOwner="WSP Internal"!==e.selected[t.UltimateClientType]),!s.stringIsNullUndefinedOrEmpty(e.selected[t.Level1])&&e.selected[t.Level1].toUpperCase().includes("FEDV")||(e.errorSwitchBusinessLineDivision=!0)),void 0!==l.ApprovalItemDetail.find(function(e){return e.ApprovalItemName.EN.includes("Same Essential Risk Profile")})?e.errorSwitchBusinessLine=!1:(((s.stringIsNullUndefinedOrEmpty(e.selected[t.Level3])||(e.selected[t.Level3].toUpperCase().includes("ENV")&&!e.selected[t.Level3].toUpperCase().includes("FED")||e.selected[t.Level3].toUpperCase().includes(" EE")))&&void 0===l.ApprovalItemDetail.find(function(e){return"Earth & Environment"===e.ApprovalItemName.EN})||void 0!==l.ApprovalItemDetail.find(function(e){return"Earth & Environment"===e.ApprovalItemName.EN})&&(s.stringIsNullUndefinedOrEmpty(e.selected[t.Level3])||!e.selected[t.Level3].toUpperCase().includes("ENV")&&e.selected[t.Level3].toUpperCase().includes("FED")&&!e.selected[t.Level3].toUpperCase().includes(" EE")))&&(e.errorSwitchBusinessLine=!0),((s.stringIsNullUndefinedOrEmpty(e.selected[t.Level3])||e.selected[t.Level3].toUpperCase().includes("CRS"))&&void 0===l.ApprovalItemDetail.find(function(e){return"Climate Resilience & Sustainability (CRS)"===e.ApprovalItemName.EN})||void 0!==l.ApprovalItemDetail.find(function(e){return"Climate Resilience & Sustainability (CRS)"===e.ApprovalItemName.EN})&&(s.stringIsNullUndefinedOrEmpty(e.selected[t.Level3])||!e.selected[t.Level3].toUpperCase().includes("CRS")))&&(e.errorSwitchBusinessLine=!0),((s.stringIsNullUndefinedOrEmpty(e.selected[t.Level3])||e.selected[t.Level3].toUpperCase().includes("ADVISORY"))&&void 0===l.ApprovalItemDetail.find(function(e){return"Advisory Services"===e.ApprovalItemName.EN})||void 0!==l.ApprovalItemDetail.find(function(e){return"Advisory Services"===e.ApprovalItemName.EN})&&(s.stringIsNullUndefinedOrEmpty(e.selected[t.Level3])||!e.selected[t.Level3].toUpperCase().includes("ADVISORY")))&&(e.errorSwitchBusinessLine=!0)),(e.errorSwitchOwner&&(0!=e.selected[e.autoProp.UltimateClientType].length||!s.stringIsNullUndefinedOrEmpty(e.selected[e.prop.UltimateClientType])||""==e.selected[e.autoProp.UltimateClient])||e.errorSwitchDeliveryMethod||e.errorSwitchClient&&(0!=e.selected[e.autoProp.ClientType].length||!s.stringIsNullUndefinedOrEmpty(e.selected[e.prop.ClientType])||""==e.selected[e.autoProp.Client])||e.errorSwitchBusinessLine||e.errorSwitchBusinessLineDivision)&&(n.isFormValid=!1,d(e))}function i(e,t,n){void 0===t.ApprovalItemDetail.find(function(e){return"Project's P&L in Federal Region"===e.ApprovalItemName.EN})&&void 0!==t.ApprovalItemDetail.find(function(e){return"Direct Client = Federal"===e.ApprovalItemName.EN})&&"Public - Federal"!==e&&(n.errorSwitchClient=!0),void 0!==t.ApprovalItemDetail.find(function(e){return"Direct Client = Private"===e.ApprovalItemName.EN})&&"Private"!==e&&"Regulated"!==e&&(n.errorSwitchClient=!0),void 0!==t.ApprovalItemDetail.find(function(e){return"Direct Client = Public (Non-Federal)"===e.ApprovalItemName.EN})&&"Public - Regional/MPO"!==e&&"Public - State/Province"!==e&&"Public - Local/County"!==e&&(n.errorSwitchClient=!0)}function u(e,t,n){"WSP Internal"!==e?(void 0===t.ApprovalItemDetail.find(function(e){return"Project's P&L in Federal Region"===e.ApprovalItemName.EN})&&void 0!==t.ApprovalItemDetail.find(function(e){return"Owner = Federal"===e.ApprovalItemName.EN})&&"Public - Federal"!==e&&(n.errorSwitchOwner=!0),void 0!==t.ApprovalItemDetail.find(function(e){return"Owner = Private"===e.ApprovalItemName.EN})&&"Private"!==e&&"Regulated"!==e&&(n.errorSwitchOwner=!0),void 0!==t.ApprovalItemDetail.find(function(e){return"Owner = Public (Non-Federal)"===e.ApprovalItemName.EN})&&"Public - Regional/MPO"!==e&&"Public - State/Province"!==e&&"Public - Local/County"!==e&&(n.errorSwitchOwner=!0)):n.errorSwitchOwner=!1}function c(e){return void 0!==e.ApprovalItemSteps.find(function(e){return"US Risk Committee Review (RCR) Coordinator"===e.CostPointRoleName||"Federal Risk Committee Review (FRCR) Chair"===e.CostPointRoleName})?"YES":"NO"}function d(e){n.alertWarningCustom("Warning",'<div align="left"><span>The following data does not match with the approval item selected:</span><ul>'+(e.errorSwitchClient?"<li>":"")+(e.errorSwitchClient?"<b>Client Type</b>":"")+(e.errorSwitchClient?"</li>":"")+(e.errorSwitchOwner?"<li>":"")+(e.errorSwitchOwner?"<b>Owner Type</b>":"")+(e.errorSwitchOwner?"</li>":"")+(e.errorSwitchDeliveryMethod?"<li>":"")+(e.errorSwitchDeliveryMethod?"<b>Delivery Method</b>":"")+(e.errorSwitchDeliveryMethod?"</li>":"")+(e.errorSwitchBusinessLine?"<li>":"")+(e.errorSwitchBusinessLine?"<b>Business Line</b>":"")+(e.errorSwitchBusinessLine?"</li>":"")+(e.errorSwitchBusinessLineDivision?"<li>":"")+(e.errorSwitchBusinessLineDivision?"<b>Federal Region</b>":"")+(e.errorSwitchBusinessLineDivision?"</li>":"")+'</ul><br /><span>To move forward, either:</span><ul><li>back out of this request and select the appropriate approval item for your request</li><li>update data in the applicable source of record</li></ul><br /><span>Guidance for updating data in the source system:</span><ul><li>If the necessary data is tied to an Opportunity, either update the Opportunity in CRM or contact your Regional CRM Data Coordinator.</li><li>If the necessary data is tied to an Agreement or Project, either update the data in the ERP or contact your Project Accountant.</li><li>For all other data, please contact <a href="mailto: IAS-Admin@wsp.com">IAS-Admin@wsp.com</a>.</li></ul></div>',"none")}function p(e,t,n){e.selected[t.OpportunityStatus]=n.value[t.OpportunityStatus],e.selected[t.OpportunityName]=n.value[t.OpportunityName],e.selected[t.Client]=n.value[t.Client],e.selected[t.UltimateClient]=n.value[t.UltimateClient],e.selected[t.WspRole]=n.value[t.WspRole],e.selected[t.ClientType]=n.value[t.ClientType],e.selected[t.UltimateClientType]=n.value[t.UltimateClientType],e.selected[t.Level1]=n.value[t.Level1],e.selected[t.Level2]=n.value[t.Level2],e.selected[t.Level3]=n.value[t.Level3],e.selected[t.Level4]=n.value[t.Level4],e.selected[t.CompanyNumber]=n.value[t.CompanyNumber],e.selected[t.CompanyName]=n.value[t.CompanyName],e.selected[t.EstGrossEcvRaw]=n.value[t.EstGrossEcvRaw],e.selected[t.EstNetEcvRaw]=n.value[t.EstNetEcvRaw],e.selected[t.EstSubEcvRaw]=n.value[t.EstSubEcvRaw],e.selected[t.Ppp]=n.value[t.Ppp],e.selected[t.Wp]=n.value[t.Wp],e.selected[t.DeliveryMethod]=n.value[t.DeliveryMethod],e.selected[t.City]=n.value[t.City],e.selected[t.ProjState]=n.value[t.ProjState],e.selected[t.Country]=n.value[t.Country],e.selected[t.ProjectDescription]=n.value[t.ProjectDescription],e.selected[t.Pa]=n.value[t.Pa],e.selected[t.PaEmail]=n.value[t.PaEmail],e.selected[t.PaEdited]=n.value[t.PaEdited],e.selected[t.ProjectManager]=n.value[t.ProjectManager],e.selected[t.ProjectManagerEmail]=n.value[t.ProjectManagerEmail],e.selected[t.ProjectManagerEdited]=n.value[t.ProjectManagerEdited],e.selected[t.PursuitManager]=n.value[t.PursuitManager],e.selected[t.PursuitManagerEmail]=n.value[t.PursuitManagerEmail],e.selected[t.PursuitManagerEdited]=n.value[t.PursuitManagerEdited],e.selected[t.JvEcvRaw]=n.value[t.JvEcvRaw],e.selected[t.EstDirectExpensesRaw]=n.value[t.EstDirectExpensesRaw],e.selected[t.FinancialTerm]=n.value[t.FinancialTerm],e.selected[t.CurrentFy]=n.value[t.CurrentFy],e.selected[t.SubsequentFy]=n.value[t.SubsequentFy],e.selected[t.NextFy]=n.value[t.NextFy],e.selected[t.SoleSource]="Y"===n.value[t.SoleSource]||"YES"===n.value[t.SoleSource]?"YES":"N"===n.value[t.SoleSource]||"NO"===n.value[t.SoleSource]?"NO":null,e.selected[t.MarketArea]=n.value[t.MarketArea],e.selected[t.PrimaryServiceType]=n.value[t.PrimaryServiceType],e.selected[t.MarketSector]=n.value[t.MarketSector],e.selected[t.ServiceType]=n.value[t.ServiceType],e.selected[t.Segment]=n.value[t.Segment],e.selected[t.TaskOrderPanel]=n.value[t.TaskOrderPanel],e.selected[t.DevBank]=n.value[t.DevBank],e.selected[t.TaskNetEcvRaw]=n.value[t.TaskNetEcvRaw],e.selected[t.TaskGrossEcvRaw]=n.value[t.TaskGrossEcvRaw],e.selected[t.ProjectDuration]=n.value[t.ProjectDuration]}function m(e){e.list.district=null!==e.object.division?g("DIVISION_ID",e.object.division,e.list.division,!0):null,e.list.area=null!==e.object.district?g("DISTRICT_ID",e.object.district,e.list.district,!0):null,e.list.costCenter=null!==e.object.area?g("AREA_ID",e.object.area,e.list.area,!0):null,e.list.marketArea=null!==e.object.segment?g("SEGMENT",e.object.segment,e.list.segment,!1):null,e.list.marketSector=null!==e.object.marketArea?g("AREA",e.object.marketArea,e.list.marketArea,!1):null,e.list.serviceType=null!==e.object.segment?g("SEGMENT",e.object.segment,e.list.coreServiceType,!1):null}function f(e,t,n){var l=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});t.selected[n.EstGrossEcv]=s.stringIsNullUndefinedOrEmpty(e.value[n.EstGrossEcvRaw])?null:l.format(e.value[n.EstGrossEcvRaw]),t.selected[n.EstNetEcv]=s.stringIsNullUndefinedOrEmpty(e.value[n.EstNetEcvRaw])?null:l.format(e.value[n.EstNetEcvRaw]),t.selected[n.EstSubEcv]=s.stringIsNullUndefinedOrEmpty(e.value[n.EstSubEcvRaw])?null:l.format(e.value[n.EstSubEcvRaw]),t.selected[n.EstDirectExpenses]=s.stringIsNullUndefinedOrEmpty(e.value[n.EstDirectExpensesRaw])?null:l.format(e.value[n.EstDirectExpensesRaw]),t.selected[n.JvEcv]=s.stringIsNullUndefinedOrEmpty(e.value[n.JvEcvRaw])?null:l.format(e.value[n.JvEcvRaw]),t.selected[n.TaskNetEcv]=s.stringIsNullUndefinedOrEmpty(e.value[n.TaskNetEcvRaw])?null:l.format(e.value[n.TaskNetEcvRaw]),t.selected[n.TaskGrossEcv]=s.stringIsNullUndefinedOrEmpty(e.value[n.TaskGrossEcvRaw])?null:l.format(e.value[n.TaskGrossEcvRaw])}function g(t,n,e,l){return e.filter(function(e){return null!=n&&""!==n&&(l?parseInt(e[t])===parseInt(n[t]):e[t]===n[t])})}function v(e,t,n){var l={RoleId:r.projectSetupEmployeeForLblRoleId,Parameters:{LOOKUP_VALUE:e}};return o.Search(l).then(function(e){"sdl"===n||"gbsPASupport"===n?null!==e[0]&&(t.list[n]=t.list[n].filter(function(e){e.value}),t.list[n].push({clearSwitch:"Y",value:e[0],prop:n})):(t.object[n]=e[0],t.clearSwitch[n]="Y")})}this.ShowDOAError=function(e,t){"NO"!==c(t)||s.stringIsNullUndefinedOrEmpty(e)||"YES"!==e.toUpperCase()||n.alertWarningCustom("Request Warning",'<div align="left"><span>You have noted that Risk Committee Review (RCR) is required, yet the approval item selected does not include the RCR Coordinator.</span><br/><br/><span>Please back out of this approval item and submit your request in connection with an appropriate approval item.</span><br/><br/><span>RCR is automatically triggered via IAS in all of the following scenarios:</span><ul><li>High Risk Countries</li><li>High Risk, as per DoA</li><li>New Line of Business</li><li>Higher value ECV thresholds</li><ul></div>',"none")},this.FillUpAutoPopulatedFields=function(e,t,n,l,o,r,i){e.selected[n.OpportunityNumber]=t.value[n.OpportunityNumber],e.selected[n.PmLevel]=t.value[n.PmLevel],e.selected[n.Type]=t.value[n.Type],s.stringIsNullUndefinedOrEmpty(i)||(s.stringIsNullUndefinedOrEmpty(i.value[n.PaEdited])?v(t.value[n.PaEmail],e,"pa"):(e.object.pa=JSON.parse(i.value[n.PaEdited]),e.clearSwitch.pa=e.switchField.pa?"N":"Y"),s.stringIsNullUndefinedOrEmpty(i.value[n.ProjectManagerEdited])?v(t.value[n.ProjectManagerEmail],e,"projectManager"):(e.object.projectManager=JSON.parse(i.value[n.ProjectManagerEdited]),e.clearSwitch.projectManager=e.switchField.projectManager?"N":"Y"),s.stringIsNullUndefinedOrEmpty(i.value[n.PursuitManagerEdited])?v(t.value[n.PursuitManagerEmail],e,"pursuitManager"):(e.object.pursuitManager=JSON.parse(i.value[n.PursuitManagerEdited]),e.clearSwitch.pursuitManager=e.switchField.pursuitManager?"N":"Y"));p(e,n,t),function(e,t,n){var l=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});t.selected[n.Company]=s.stringIsNullUndefinedOrEmpty(e.value[n.CompanyNumber])||s.stringIsNullUndefinedOrEmpty(e.value[n.CompanyName])?null:e.value[n.CompanyNumber]+" - "+e.value[n.CompanyName],t.selected[n.EstGrossEcv]=s.stringIsNullUndefinedOrEmpty(e.value[n.EstGrossEcvRaw])?null:l.format(e.value[n.EstGrossEcvRaw]),t.selected[n.EstNetEcv]=s.stringIsNullUndefinedOrEmpty(e.value[n.EstNetEcvRaw])?null:l.format(e.value[n.EstNetEcvRaw]),t.selected[n.EstSubEcv]=s.stringIsNullUndefinedOrEmpty(e.value[n.EstSubEcvRaw])?null:l.format(e.value[n.EstSubEcvRaw]),t.selected[n.EstDirectExpenses]=s.stringIsNullUndefinedOrEmpty(e.value[n.EstDirectExpensesRaw])?null:l.format(e.value[n.EstDirectExpensesRaw]),t.selected[n.JvEcv]=s.stringIsNullUndefinedOrEmpty(e.value[n.JvEcvRaw])?null:l.format(e.value[n.JvEcvRaw]),t.selected[n.TaskNetEcv]=s.stringIsNullUndefinedOrEmpty(e.value[n.TaskNetEcvRaw])?null:l.format(e.value[n.TaskNetEcvRaw]),t.selected[n.TaskGrossEcv]=s.stringIsNullUndefinedOrEmpty(e.value[n.TaskGrossEcvRaw])?null:l.format(e.value[n.TaskGrossEcvRaw]),t.selected[n.AnticipatedDecisionDate]=s.stringIsNullUndefinedOrEmpty(e.value[n.AnticipatedDecisionDate])?null:s.formatDate(new Date(e.value[n.AnticipatedDecisionDate]),"yyyy-MMM-dd"),t.selected[n.AnticipatedStartDate]=s.stringIsNullUndefinedOrEmpty(e.value[n.AnticipatedStartDate])?null:s.formatDate(new Date(e.value[n.AnticipatedStartDate]),"yyyy-MMM-dd"),t.selected[n.RfpIssueDate]=s.stringIsNullUndefinedOrEmpty(e.value[n.RfpIssueDate])?null:s.formatDate(new Date(e.value[n.RfpIssueDate]),"yyyy-MMM-dd"),t.selected[n.RfpSubmittalDate]=s.stringIsNullUndefinedOrEmpty(e.value[n.RfpSubmittalDate])?null:s.formatDate(new Date(e.value[n.RfpSubmittalDate]),"yyyy-MMM-dd"),t.selected[n.InterviewDueDate]=s.stringIsNullUndefinedOrEmpty(e.value[n.InterviewDueDate])?null:s.formatDate(new Date(e.value[n.InterviewDueDate]),"yyyy-MMM-dd")}(t,e,n),l&&a(e,n,o,r);return JSON.stringify(e.selected)},this.FillUpTwoWayBindFields=function(e,t,n,l,o){var r=s.guid();p(e,t,n),e.selected[t.Company]=n.value[t.Company],e.selected[t.RfpIssueDate]=n.value[t.RfpIssueDate],e.selected[t.RfpSubmittalDate]=n.value[t.RfpSubmittalDate],e.selected[t.AnticipatedDecisionDate]=n.value[t.AnticipatedDecisionDate],e.selected[t.AnticipatedStartDate]=n.value[t.AnticipatedStartDate],e.selected[t.Doa]=n.value[t.Doa],e.selected[t.DescribeOpp]=n.value[t.DescribeOpp],e.selected[t.RequiredDoa]=n.value[t.RequiredDoa],e.selected[t.KnowledgeReq]=n.value[t.KnowledgeReq],e.selected[t.PursuitProjectMgrWin]=n.value[t.PursuitProjectMgrWin],e.selected[t.ExecStrategy]=n.value[t.ExecStrategy],e.selected[t.WSPValue]=n.value[t.WSPValue],e.selected[t.TopFive]=n.value[t.TopFive],e.selected[t.StrengthOfClientRelationship]=n.value[t.StrengthOfClientRelationship],e.selected[t.CrmPlan]=n.value[t.CrmPlan],e.selected[t.Abilities]=n.value[t.Abilities],e.selected[t.Tracking]=n.value[t.Tracking],e.selected[t.SimilarServices]=n.value[t.SimilarServices],e.selected[t.Positioning]=n.value[t.Positioning],e.selected[t.ClientIssues]=n.value[t.ClientIssues],e.selected[t.Endorse]=n.value[t.Endorse],e.selected[t.Differentiated]=n.value[t.Differentiated],e.selected[t.Precluded]=n.value[t.Precluded],e.selected[t.KnownByTheClient]=n.value[t.KnownByTheClient],e.selected[t.Perception]=n.value[t.Perception],e.selected[t.Qualifications]=n.value[t.Qualifications],e.selected[t.Teaming]=n.value[t.Teaming],e.selected[t.StrengthOfQualifications]=n.value[t.StrengthOfQualifications],e.selected[t.SimilarProj]=n.value[t.SimilarProj],e.selected[t.Adequate]=n.value[t.Adequate],e.selected[t.Objectives]=n.value[t.Objectives],e.selected[t.Potential]=n.value[t.Potential],e.selected[t.Extent]=n.value[t.Extent],e.selected[t.Impact]=n.value[t.Impact],e.selected[t.Ps2Link]=n.value[t.Ps2Link],e.selected[t.Pndl]=n.value[t.Pndl],e.selected[t.Pstfl]=n.value[t.Pstfl],e.selected[t.IsPs2Link]=n.value[t.IsPs2Link],e.selected[t.IsPndl]=n.value[t.IsPndl],e.selected[t.IsPstfl]=n.value[t.IsPstfl],e.selected[t.IsPstfl]=n.value[t.IsPstfl],e.selected[t.NblMarkets]=n.value[t.NblMarkets],e.selected[t.NblMarketLead]=n.value[t.NblMarketLead],e.selected[t.ClientTypeExpected]=n.value[t.ClientTypeExpected],e.selected[t.UltimateClientTypeExpected]=n.value[t.UltimateClientTypeExpected],e.selected.WizardOwner=n.value.WizardOwner,e.selected.WizardClient=n.value.WizardClient,e.object.division=s.stringIsNullUndefinedOrEmpty(n.value[t.Level1])?null:e.list.division.find(function(e){return e.COST_CENTER_ID==JSON.parse(n.value[t.Level1]).COST_CENTER_ID}),e.object.district=s.stringIsNullUndefinedOrEmpty(n.value[t.Level2])?null:e.list.division.find(function(e){return e.COST_CENTER_ID==JSON.parse(n.value[t.Level2]).COST_CENTER_ID}),e.object.area=s.stringIsNullUndefinedOrEmpty(n.value[t.Level3])?null:e.list.division.find(function(e){return e.COST_CENTER_ID==JSON.parse(n.value[t.Level3]).COST_CENTER_ID}),e.object.costCenter=s.stringIsNullUndefinedOrEmpty(n.value[t.Level4])?null:e.list.division.find(function(e){return e.COST_CENTER_ID==JSON.parse(n.value[t.Level4]).COST_CENTER_ID}),e.list.state=s.stringIsNullUndefinedOrEmpty(n.value[t.Country])?null:e.list.country.find(function(e){return e.name==n.value[t.Country]}),null!==e.list.state&&e.list.state.states.push({id:0,name:"NATIONWIDE",state_code:"N/A",cities:[]});if(e.list.nblMarketLead=s.stringIsNullUndefinedOrEmpty(n.value[t.NblMarketLead])?[{value:null,email:null,id:r}]:JSON.parse(n.value[t.NblMarketLead]),o){for(var i=s.stringIsNullUndefinedOrEmpty(n.value[t.NblMarkets])?[{value:null,id:r}]:JSON.parse(n.value[t.NblMarkets]),a=0;a<i.length;a++)null!==i[a].value&&(i[a].value=s.stringIsNullUndefinedOrEmpty(i[a].value)?null:e.list.nblMarkets.find(function(e){return e.LocalBusinessLine.toUpperCase()===i[a].value.LocalBusinessLine.toUpperCase()&&e.DerivedRoleName.toUpperCase()===i[a].value.DerivedRoleName.toUpperCase()}));e.list.nblMarketSelected=i}else e.list.nblMarketSelected=s.stringIsNullUndefinedOrEmpty(n.value[t.NblMarkets])?[{value:null,id:r}]:JSON.parse(n.value[t.NblMarkets]);e.list.city=s.stringIsNullUndefinedOrEmpty(n.value[t.ProjState])?null:e.list.state.states.find(function(e){return e.name==n.value[t.ProjState]}),e.object.segment=s.stringIsNullUndefinedOrEmpty(n.value[t.Segment])?null:e.list.segment.find(function(e){return e.LIST_ID==JSON.parse(n.value[t.Segment]).LIST_ID}),e.object.marketArea=s.stringIsNullUndefinedOrEmpty(n.value[t.MarketArea])?null:e.list.segment.find(function(e){return e.LIST_ID==JSON.parse(n.value[t.MarketArea]).LIST_ID}),e.object.marketSector=s.stringIsNullUndefinedOrEmpty(n.value[t.MarketSector])?null:e.list.segment.find(function(e){return e.LIST_ID==JSON.parse(n.value[t.MarketSector]).LIST_ID}),e.object.serviceType=s.stringIsNullUndefinedOrEmpty(n.value[t.ServiceType])?null:e.list.coreServiceType.find(function(e){return e.LIST_ID==JSON.parse(n.value[t.ServiceType]).LIST_ID}),l||(e.object.projectManager=s.stringIsNullUndefinedOrEmpty(n.value[t.ProjectManager])?null:JSON.parse(n.value[t.ProjectManager]),e.object.pursuitManager=s.stringIsNullUndefinedOrEmpty(n.value[t.PursuitManager])?null:JSON.parse(n.value[t.PursuitManager]),e.object.pa=s.stringIsNullUndefinedOrEmpty(n.value[t.Pa])?null:JSON.parse(n.value[t.Pa]));return e.object.client=s.stringIsNullUndefinedOrEmpty(n.value[t.Client])?null:JSON.parse(n.value[t.Client]),e.object.ultimateClient=s.stringIsNullUndefinedOrEmpty(n.value[t.UltimateClient])?null:JSON.parse(n.value[t.UltimateClient]),m(e),f(n,e,t),JSON.stringify(e.selected)},this.GetNblml=function(e){var t={RoleId:-88888886,Parameters:{DATA:"NBLMLCONDITIONALCOMPREHENSIVE",NBLROLEID:"2007",COSTCENTERID:e}};return l.GetData(t).then(function(e){return e})},this.StringifyCRMObjects=function(e,t){e.selected[t.Level1]=s.stringIsNullUndefinedOrEmpty(e.object.division)?null:JSON.stringify(e.object.division),e.selected[t.Level2]=s.stringIsNullUndefinedOrEmpty(e.object.district)?null:JSON.stringify(e.object.district),e.selected[t.Level3]=s.stringIsNullUndefinedOrEmpty(e.object.area)?null:JSON.stringify(e.object.area),e.selected[t.Level4]=s.stringIsNullUndefinedOrEmpty(e.object.costCenter)?null:JSON.stringify(e.object.costCenter),e.selected[t.ProjectManager]=s.stringIsNullUndefinedOrEmpty(e.object.projectManager)?null:JSON.stringify(e.object.projectManager),e.selected[t.PursuitManager]=s.stringIsNullUndefinedOrEmpty(e.object.pursuitManager)?null:JSON.stringify(e.object.pursuitManager),e.selected[t.Pa]=s.stringIsNullUndefinedOrEmpty(e.object.pa)?null:JSON.stringify(e.object.pa),e.selected[t.Client]=s.stringIsNullUndefinedOrEmpty(e.object.client)?null:JSON.stringify(e.object.client),e.selected[t.UltimateClient]=s.stringIsNullUndefinedOrEmpty(e.object.ultimateClient)?null:JSON.stringify(e.object.ultimateClient),e.selected[t.MarketArea]=s.stringIsNullUndefinedOrEmpty(e.object.marketArea)?null:JSON.stringify(e.object.marketArea),e.selected[t.ServiceType]=s.stringIsNullUndefinedOrEmpty(e.object.serviceType)?null:JSON.stringify(e.object.serviceType),e.selected[t.MarketSector]=s.stringIsNullUndefinedOrEmpty(e.object.marketSector)?null:JSON.stringify(e.object.marketSector),e.selected[t.Segment]=s.stringIsNullUndefinedOrEmpty(e.object.segment)?null:JSON.stringify(e.object.segment)},this.GetDeliveryMethodList=function(){return o.Search({RoleId:-99999965,Parameters:{Id:null,Data:"DELIVERYMETHOD"}}).then(function(e){return e})},this.GetSegmentAreaSectorList=function(){return o.Search({RoleId:-99999965,Parameters:{Id:null,Data:"SEGMENTAREASECTOR"}}).then(function(e){return e})},this.GetSegmentServiceTypeList=function(){return o.Search({RoleId:-99999965,Parameters:{Id:null,Data:"SEGMENTSERVICETYPE"}}).then(function(e){return e})},this.GetAllOracleHierarchyList=function(e){var t={RoleId:-99999965,Parameters:{Id:null,Data:e?"ORACLEHIERARCHYNOFILTER":"ORACLEHIERARCHY"}};return o.Search(t).then(function(e){return e})},this.GetDistrictList=function(e,t){e.object.district=null,e.object.area=null,e.list.area=[],e.object.costCenter=null,e.list.costCenter=[],e.selected[t.Company]=null,e.list.lbl=[],e.object.lbl=null,e.list.district=g("DIVISION_ID",e.object.division,e.list.division,!0)},this.GetAreaList=function(e,t){e.object.area=null,e.object.costCenter=null,e.list.costCenter=[],e.selected[t.Company]=null,e.list.lbl=[],e.object.lbl=null,e.list.area=g("DISTRICT_ID",e.object.district,e.list.district,!0)},this.GetCostCenterList=function(e,t){e.object.costcenter=null,e.selected[t.Company]=null,e.list.costCenter=g("AREA_ID",e.object.area,e.list.area,!0)},this.GetCascadingToSegmentList=function(e){e.object.marketArea=null,e.object.marketSector=null,e.object.serviceType=null,e.list.marketArea=g("SEGMENT",e.object.segment,e.list.segment,!1),e.list.serviceType=g("SEGMENT",e.object.segment,e.list.coreServiceType,!1)},this.GetMarketSectorList=function(e){e.object.marketSector=null,e.list.marketSector=g("AREA",e.object.marketArea,e.list.marketArea,!1)},this.GetCountryStateCity=function(){return e.GetList().then(function(e){if(void 0===e)return null;var t=e.filter(function(e){return"USA"!==e.iso3});return t.unshift(e.find(function(e){return"USA"===e.iso3})),t})},this.GetCompany=function(e,t){e.selected[t.Company]=s.stringIsNullUndefinedOrEmpty(e.object.costCenter)?null:e.object.costCenter.COMPANY_NUMBER+" - "+e.object.costCenter.COMPANY_NAME},this.ShowValidationError=d,this.FillUpRequestNewCrmFields=function(){return p(_model,_prop,_item),_model.selected[_prop.TaskOrderPanel]=_item.value[_prop.TaskOrderPanel],_model.selected[_prop.RCRRequired]=_item.value[_prop.RCRRequired],_model.selected[_prop.ConfidentialProject]=_item.value[_prop.ConfidentialProject],_model.selected[_prop.SolicitationNumber]=_item.value[_prop.SolicitationNumber],_model.selected[_prop.ContractClassification]=_item.value[_prop.ContractClassification],_model.selected[_prop.MasterContractAgreement]=_item.value[_prop.MasterContractAgreement],_model.selected[_prop.IsFederalClient]=_item.value[_prop.IsFederalClient],_model.selected[_prop.PackageType]=_item.value[_prop.PackageType],_model.selected[_prop.Complexity]=_item.value[_prop.Complexity],_model.selected[_prop.Priority]=_item.value[_prop.Priority],_model.selected[_prop.SoleSource]=_item.value[_prop.SoleSource],_model.selected[_prop.DevBank]=_item.value[_prop.DevBank],_model.selected[_prop.RfpIssueDate]=_item.value[_prop.RfpIssueDate],_model.selected[_prop.ProjectDuration]=_item.value[_prop.ProjectDuration],_model.selected[_prop.RfpSubmittalDate]=_item.value[_prop.RfpSubmittalDate],_model.selected[_prop.AnticipatedDecisionDate]=_item.value[_prop.AnticipatedDecisionDate],_model.selected[_prop.AnticipatedStartDate]=_item.value[_prop.AnticipatedStartDate],_model.selected[_prop.CurrentFy]=_item.value[_prop.CurrentFy],_model.selected[_prop.SubsequentFy]=_item.value[_prop.SubsequentFy],_model.selected[_prop.NextFy]=_item.value[_prop.NextFy],_model.selected[_prop.Impact]=_item.value[_prop.Impact],_model.selected[_prop.City]=_item.value[_prop.City],_model.selected[_prop.Country]=_item.value[_prop.Country],_model.selected[_prop.ProjState]=_item.value[_prop.ProjState],_model.selected[_prop.Company]=_item.value[_prop.Company],_model.selected[_prop.Company]=_item.value[_prop.Company],_model.selected[_prop.Company]=_item.value[_prop.Company],_model.object.division=s.stringIsNullUndefinedOrEmpty(_item.value[_prop.Level1])?null:_model.list.division.find(function(e){return e.COST_CENTER_ID==JSON.parse(_item.value[_prop.Level1]).COST_CENTER_ID}),_model.object.district=s.stringIsNullUndefinedOrEmpty(_item.value[_prop.Level2])?null:_model.list.division.find(function(e){return e.COST_CENTER_ID==JSON.parse(_item.value[_prop.Level2]).COST_CENTER_ID}),_model.object.area=s.stringIsNullUndefinedOrEmpty(_item.value[_prop.Level3])?null:_model.list.division.find(function(e){return e.COST_CENTER_ID==JSON.parse(_item.value[_prop.Level3]).COST_CENTER_ID}),_model.object.costCenter=s.stringIsNullUndefinedOrEmpty(_item.value[_prop.Level4])?null:_model.list.division.find(function(e){return e.COST_CENTER_ID==JSON.parse(_item.value[_prop.Level4]).COST_CENTER_ID}),_model.list.state=s.stringIsNullUndefinedOrEmpty(_item.value[_prop.Country])?null:_model.list.country.find(function(e){return e.name==_item.value[_prop.Country]}),_model.list.city=s.stringIsNullUndefinedOrEmpty(_item.value[_prop.ProjState])?null:_model.list.state.states.find(function(e){return e.name==_item.value[_prop.ProjState]}),_model.object.projectManager=s.stringIsNullUndefinedOrEmpty(_item.value[_prop.ProjectManager])?null:JSON.parse(_item.value[_prop.ProjectManager]),_model.object.pursuitManager=s.stringIsNullUndefinedOrEmpty(_item.value[_prop.PursuitManager])?null:JSON.parse(_item.value[_prop.PursuitManager]),_model.object.pa=s.stringIsNullUndefinedOrEmpty(_item.value[_prop.Pa])?null:JSON.parse(_item.value[_prop.Pa]),_model.object.client=s.stringIsNullUndefinedOrEmpty(_item.value[_prop.Client])?null:JSON.parse(_item.value[_prop.Client]),_model.object.ultimateClient=s.stringIsNullUndefinedOrEmpty(_item.value[_prop.UltimateClient])?null:JSON.parse(_item.value[_prop.UltimateClient]),_model.selected[_prop.EstDirectExpensesRaw]=_item.value[_prop.EstDirectExpensesRaw],_model.selected[_prop.JvEcvRaw]=_item.value[_prop.JvEcvRaw],m(_model),f(_item,_model,_prop),JSON.stringify(_model.selected)},this.ClearEcvValuesNotTaskPipeLine=function(e,t,n,l){l?(e.selected[t.TaskGrossEcvRaw]=null,e.selected[t.TaskNetEcvRaw]=null):(e.selected[t.TaskGrossEcvRaw]=n?0:null,e.selected[t.TaskNetEcvRaw]=n?0:null,n||(e.selected[t.EstGrossEcvRaw]=null,e.selected[t.EstGrossEcv]=null,e.selected[t.EstNetEcvRaw]=null,e.selected[t.EstSubEcvRaw]=null,e.selected[t.EstDirectExpensesRaw]=null,e.selected[t.JvEcvRaw]=null))},this.ClearEcvValuesTaskPipeLine=function(e,t,n,l){l?(e.selected[t.EstGrossEcvRaw]=null,e.selected[t.EstGrossEcv]=null,e.selected[t.EstNetEcvRaw]=null,e.selected[t.EstSubEcvRaw]=null,e.selected[t.EstDirectExpensesRaw]=null,e.selected[t.JvEcvRaw]=null):(e.selected[t.EstGrossEcvRaw]=n?null:0,e.selected[t.EstGrossEcv]=n?null:0,e.selected[t.EstNetEcvRaw]=n?null:0,e.selected[t.EstSubEcvRaw]=n?null:0,e.selected[t.EstDirectExpensesRaw]=n?null:0,e.selected[t.JvEcvRaw]=n?null:0,n||(e.selected[t.TaskGrossEcvRaw]=null,e.selected[t.TaskNetEcvRaw]=null))},this.ValidateOpportunityVsApprovaltem=a,this.FillUpRequestNewFields=function(e,t,n){e.selected[t.TaskOrderPanel]=n.value[t.TaskOrderPanel],e.selected[t.RCRRequired]=n.value[t.RCRRequired],e.selected[t.DevBank]=n.value[t.DevBank],e.selected[t.OpportunityStatus]=n.value[t.OpportunityStatus],e.selected[t.OpportunityName]=n.value[t.OpportunityName],e.selected[t.Client]=n.value[t.Client],e.selected[t.UltimateClient]=n.value[t.UltimateClient],e.selected[t.ClientType]=n.value[t.ClientType],e.selected[t.UltimateClientType]=n.value[t.UltimateClientType],e.selected[t.WspRole]=n.value[t.WspRole],e.selected[t.AnticipatedDecisionDate]=n.value[t.AnticipatedDecisionDate],e.selected[t.AnticipatedStartDate]=n.value[t.AnticipatedStartDate],e.selected[t.RfpIssueDate]=n.value[t.RfpIssueDate],e.selected[t.ProjectDuration]=n.value[t.ProjectDuration],e.selected[t.RfpSubmittalDate]=n.value[t.RfpSubmittalDate],e.selected[t.ConfidentialProject]=n.value[t.ConfidentialProject],e.selected[t.SolicitationNumber]=n.value[t.SolicitationNumber],e.selected[t.ContractClassification]=n.value[t.ContractClassification],e.selected[t.MasterContractAgreement]=n.value[t.MasterContractAgreement],e.selected[t.IsFederalClient]=n.value[t.IsFederalClient],e.selected[t.PackageType]=n.value[t.PackageType],e.selected[t.Complexity]=n.value[t.Complexity],e.selected[t.Priority]=n.value[t.Priority],e.selected[t.SoleSource]=n.value[t.SoleSource],e.selected[t.Level1]=n.value[t.Level1],e.selected[t.Level2]=n.value[t.Level2],e.selected[t.Level3]=n.value[t.Level3],e.selected[t.Level4]=n.value[t.Level4],e.selected[t.Company]=n.value[t.Company],e.selected[t.EstGrossEcvRaw]=n.value[t.EstGrossEcvRaw],e.selected[t.EstNetEcvRaw]=n.value[t.EstNetEcvRaw],e.selected[t.EstSubEcvRaw]=n.value[t.EstSubEcvRaw],e.selected[t.EstDirectExpensesRaw]=n.value[t.EstDirectExpensesRaw],e.selected[t.TaskNetEcvRaw]=n.value[t.TaskNetEcvRaw],e.selected[t.TaskGrossEcvRaw]=n.value[t.TaskGrossEcvRaw],e.selected[t.JvEcvRaw]=n.value[t.JvEcvRaw],e.selected[t.Ppp]=n.value[t.Ppp],e.selected[t.Wp]=n.value[t.Wp],e.selected[t.GoGetPercent]=n.value[t.GoGetPercent],e.selected[t.ETCVRaw]=n.value[t.ETCVRaw],e.selected[t.ENCVRaw]=n.value[t.ENCVRaw],e.selected[t.ContractUpsetLimitValuesRaw]=n.value[t.ContractUpsetLimitValuesRaw],e.selected[t.ContractUpsetLimit]=n.value[t.ContractUpsetLimit],e.selected[t.DeliveryMethod]=n.value[t.DeliveryMethod],e.selected[t.City]=n.value[t.City],e.selected[t.ProjState]=n.value[t.ProjState],e.selected[t.Country]=n.value[t.Country],e.selected[t.MarketArea]=n.value[t.MarketArea],e.selected[t.PrimaryServiceType]=n.value[t.PrimaryServiceType],e.selected[t.ServiceType]=n.value[t.ServiceType],e.selected[t.MarketSector]=n.value[t.MarketSector],e.selected[t.Segment]=n.value[t.Segment],e.selected[t.ProjectDescription]=n.value[t.ProjectDescription],e.selected[t.CurrentFy]=n.value[t.CurrentFy],e.selected[t.SubsequentFy]=n.value[t.SubsequentFy],e.selected[t.NextFy]=n.value[t.NextFy],e.selected[t.Pa]=n.value[t.Pa],e.selected[t.PaAuto]=n.value[t.PaAuto],e.selected[t.ProjectManager]=n.value[t.ProjectManager],e.selected[t.PursuitManager]=n.value[t.PursuitManager],e.selected[t.Pic]=n.value[t.Pic],e.selected[t.PmLevel]=n.value[t.PmLevel],e.selected[t.ProposalManager]=n.value[t.ProposalManager],e.selected[t.MarketingCoordinator]=n.value[t.MarketingCoordinator],e.selected[t.OtherStaff]=n.value[t.OtherStaff],e.selected[t.TeamingPartners]=n.value[t.TeamingPartners],e.selected[t.Competitors]=n.value[t.Competitors],e.selected[t.Collaboration]=n.value[t.Collaboration],e.selected[t.PreSubmittalLaborHours]=n.value[t.PreSubmittalLaborHours],e.selected[t.PreSubmittalLaborDollar]=n.value[t.PreSubmittalLaborDollar],e.selected[t.PreSubmittalTotalCosts]=n.value[t.PreSubmittalTotalCosts],e.selected[t.PreSubmittalTotalPercent]=n.value[t.PreSubmittalTotalPercent],e.selected[t.PreSubmittalExpense]=n.value[t.PreSubmittalExpense],e.selected[t.QualificationsLaborHours]=n.value[t.QualificationsLaborHours],e.selected[t.QualificationsLaborDollar]=n.value[t.QualificationsLaborDollar],e.selected[t.QualificationsTotalCosts]=n.value[t.QualificationsTotalCosts],e.selected[t.QualificationsTotalPercent]=n.value[t.QualificationsTotalPercent],e.selected[t.QualificationsExpense]=n.value[t.QualificationsExpense],e.selected[t.TechProposalLaborHours]=n.value[t.TechProposalLaborHours],e.selected[t.TechProposalLaborDollar]=n.value[t.TechProposalLaborDollar],e.selected[t.TechProposalTotalCosts]=n.value[t.TechProposalTotalCosts],e.selected[t.TechProposalTotalPercent]=n.value[t.TechProposalTotalPercent],e.selected[t.TechProposalExpense]=n.value[t.TechProposalExpense],e.selected[t.CostProposalLaborHours]=n.value[t.CostProposalLaborHours],e.selected[t.CostProposalLaborDollar]=n.value[t.CostProposalLaborDollar],e.selected[t.CostProposalTotalCosts]=n.value[t.CostProposalTotalCosts],e.selected[t.CostProposalTotalPercent]=n.value[t.CostProposalTotalPercent],e.selected[t.CostProposalExpense]=n.value[t.CostProposalExpense],e.selected[t.InterviewLaborHours]=n.value[t.InterviewLaborHours],e.selected[t.InterviewLaborDollar]=n.value[t.InterviewLaborDollar],e.selected[t.InterviewTotalCosts]=n.value[t.InterviewTotalCosts],e.selected[t.InterviewTotalPercent]=n.value[t.InterviewTotalPercent],e.selected[t.InterviewExpense]=n.value[t.InterviewExpense],e.selected[t.ContractNegotiationsLaborHours]=n.value[t.ContractNegotiationsLaborHours],e.selected[t.ContractNegotiationsLaborDollar]=n.value[t.ContractNegotiationsLaborDollar],e.selected[t.ContractNegotiationsTotalCosts]=n.value[t.ContractNegotiationsTotalCosts],e.selected[t.ContractNegotiationsTotalPercent]=n.value[t.ContractNegotiationsTotalPercent],e.selected[t.ContractNegotiationsExpense]=n.value[t.ContractNegotiationsExpense],e.selected[t.PusuitBudgetTotalLaborHours]=n.value[t.PusuitBudgetTotalLaborHours],e.selected[t.PusuitBudgetTotalLaborDollar]=n.value[t.PusuitBudgetTotalLaborDollar],e.selected[t.PusuitBudgetTotalExpense]=n.value[t.PusuitBudgetTotalExpense],e.selected[t.PusuitBudgetTotalCost]=n.value[t.PusuitBudgetTotalCost],e.selected[t.PercentOfGrossEcv]=n.value[t.PercentOfGrossEcv],e.selected[t.QuTpCpTotalPercent]=n.value[t.QuTpCpTotalPercent],e.selected[t.IsBudgetFilledUp]=n.value[t.IsBudgetFilledUp],e.selected[t.Ps]=n.value[t.Ps],e.selected[t.Qu]=n.value[t.Qu],e.selected[t.Tp]=n.value[t.Tp],e.selected[t.Cp]=n.value[t.Cp],e.selected[t.Intvw]=n.value[t.Intvw],e.selected[t.Cn]=n.value[t.Cn],e.checkBoxes.ps=n.value[t.Ps],e.checkBoxes.qu=n.value[t.Qu],e.checkBoxes.tp=n.value[t.Tp],e.checkBoxes.cp=n.value[t.Cp],e.checkBoxes.intvw=n.value[t.Intvw],e.checkBoxes.cn=n.value[t.Cn],e.totalCost.ps=s.stringIsNullUndefinedOrEmpty(n.value[t.PreSubmittalTotalCosts])?null:n.value[t.PreSubmittalTotalCosts].replace("$","").replace(",",""),e.totalCost.qu=s.stringIsNullUndefinedOrEmpty(n.value[t.QualificationsTotalCosts])?null:n.value[t.QualificationsTotalCosts].replace("$","").replace(",",""),e.totalCost.tp=s.stringIsNullUndefinedOrEmpty(n.value[t.TechProposalTotalCosts])?null:n.value[t.TechProposalTotalCosts].replace("$","").replace(",",""),e.totalCost.cp=s.stringIsNullUndefinedOrEmpty(n.value[t.CostProposalTotalCosts])?null:n.value[t.CostProposalTotalCosts].replace("$","").replace(",",""),e.totalCost.intvw=s.stringIsNullUndefinedOrEmpty(n.value[t.InterviewTotalCosts])?null:n.value[t.InterviewTotalCosts].replace("$","").replace(",",""),e.totalCost.cn=s.stringIsNullUndefinedOrEmpty(n.value[t.ContractNegotiationsTotalCosts])?null:n.value[t.ContractNegotiationsTotalCosts].replace("$","").replace(",",""),e.totalLabor.ps=s.stringIsNullUndefinedOrEmpty(n.value[t.PreSubmittalLaborDollar])?null:n.value[t.PreSubmittalLaborDollar].replace("$","").replace(",",""),e.totalLabor.qu=s.stringIsNullUndefinedOrEmpty(n.value[t.QualificationsLaborDollar])?null:n.value[t.QualificationsLaborDollar].replace("$","").replace(",",""),e.totalLabor.tp=s.stringIsNullUndefinedOrEmpty(n.value[t.TechProposalLaborDollar])?null:n.value[t.TechProposalLaborDollar].replace("$","").replace(",",""),e.totalLabor.cp=s.stringIsNullUndefinedOrEmpty(n.value[t.CostProposalLaborDollar])?null:n.value[t.CostProposalLaborDollar].replace("$","").replace(",",""),e.totalLabor.intvw=s.stringIsNullUndefinedOrEmpty(n.value[t.InterviewLaborDollar])?null:n.value[t.InterviewLaborDollar].replace("$","").replace(",",""),e.totalLabor.cn=s.stringIsNullUndefinedOrEmpty(n.value[t.ContractNegotiationsLaborDollar])?null:n.value[t.ContractNegotiationsLaborDollar].replace("$","").replace(",",""),e.grandTotalCost=s.stringIsNullUndefinedOrEmpty(n.value[t.PusuitBudgetTotalCost])?null:n.value[t.PusuitBudgetTotalCost].replace("$","").replace(",",""),e.object.division=s.stringIsNullUndefinedOrEmpty(n.value[t.Level1])?null:e.list.division.find(function(e){return e.COST_CENTER_ID==JSON.parse(n.value[t.Level1]).COST_CENTER_ID}),e.object.district=s.stringIsNullUndefinedOrEmpty(n.value[t.Level2])?null:e.list.division.find(function(e){return e.COST_CENTER_ID==JSON.parse(n.value[t.Level2]).COST_CENTER_ID}),e.object.area=s.stringIsNullUndefinedOrEmpty(n.value[t.Level3])?null:e.list.division.find(function(e){return e.COST_CENTER_ID==JSON.parse(n.value[t.Level3]).COST_CENTER_ID}),e.object.costCenter=s.stringIsNullUndefinedOrEmpty(n.value[t.Level4])?null:e.list.division.find(function(e){return e.COST_CENTER_ID==JSON.parse(n.value[t.Level4]).COST_CENTER_ID}),e.list.state=s.stringIsNullUndefinedOrEmpty(n.value[t.Country])?null:e.list.country.find(function(e){return e.name==n.value[t.Country]}),null!==e.list.state&&(e.list.state.states.push({id:0,name:"NATIONWIDE",state_code:"N/A",cities:[]}),e.list.city=s.stringIsNullUndefinedOrEmpty(n.value[t.ProjState])?null:e.list.state.states.find(function(e){return e.name==n.value[t.ProjState]}));return e.object.segment=s.stringIsNullUndefinedOrEmpty(n.value[t.Segment])?null:e.list.segment.find(function(e){return e.LIST_ID==JSON.parse(n.value[t.Segment]).LIST_ID}),e.object.marketArea=s.stringIsNullUndefinedOrEmpty(n.value[t.MarketArea])?null:e.list.segment.find(function(e){return e.LIST_ID==JSON.parse(n.value[t.MarketArea]).LIST_ID}),e.object.marketSector=s.stringIsNullUndefinedOrEmpty(n.value[t.MarketSector])?null:e.list.segment.find(function(e){return e.LIST_ID==JSON.parse(n.value[t.MarketSector]).LIST_ID}),e.object.serviceType=s.stringIsNullUndefinedOrEmpty(n.value[t.ServiceType])?null:e.list.coreServiceType.find(function(e){return e.LIST_ID==JSON.parse(n.value[t.ServiceType]).LIST_ID}),e.object.projectManager=s.stringIsNullUndefinedOrEmpty(n.value[t.ProjectManager])?null:JSON.parse(n.value[t.ProjectManager]),e.object.pursuitManager=s.stringIsNullUndefinedOrEmpty(n.value[t.PursuitManager])?null:JSON.parse(n.value[t.PursuitManager]),e.object.proposalManager=s.stringIsNullUndefinedOrEmpty(n.value[t.ProposalManager])?null:JSON.parse(n.value[t.ProposalManager]),e.object.marketingCoordinator=s.stringIsNullUndefinedOrEmpty(n.value[t.MarketingCoordinator])?null:JSON.parse(n.value[t.MarketingCoordinator]),e.object.pa=s.stringIsNullUndefinedOrEmpty(n.value[t.Pa])?null:JSON.parse(n.value[t.Pa]),e.object.pic=s.stringIsNullUndefinedOrEmpty(n.value[t.Pic])?null:JSON.parse(n.value[t.Pic]),e.object.client=s.stringIsNullUndefinedOrEmpty(n.value[t.Client])?null:JSON.parse(n.value[t.Client]),e.object.ultimateClient=s.stringIsNullUndefinedOrEmpty(n.value[t.UltimateClient])?null:JSON.parse(n.value[t.UltimateClient]),e.object.masterContractAgreement=s.stringIsNullUndefinedOrEmpty(n.value[t.MasterContractAgreement])?null:JSON.parse(n.value[t.MasterContractAgreement]),e.list.otherStaff=s.stringIsNullUndefinedOrEmpty(n.value[t.OtherStaff])?[]:JSON.parse(n.value[t.OtherStaff]),e.list.teamingPartners=s.stringIsNullUndefinedOrEmpty(n.value[t.TeamingPartners])?[]:JSON.parse(n.value[t.TeamingPartners]),e.list.competitors=s.stringIsNullUndefinedOrEmpty(n.value[t.Competitors])?[]:JSON.parse(n.value[t.Competitors]),e.selected[t.PmLevel]=n.value[t.PmLevel],e.list.collaboration=s.stringIsNullUndefinedOrEmpty(n.value[t.Collaboration])?e.list.collaboration:JSON.parse(n.value[t.Collaboration]),m(e),function(e,t,n){var l=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});t.selected[n.EstGrossEcv]=s.stringIsNullUndefinedOrEmpty(e.value[n.EstGrossEcvRaw])?null:l.format(e.value[n.EstGrossEcvRaw]),t.selected[n.EstNetEcv]=s.stringIsNullUndefinedOrEmpty(e.value[n.EstNetEcvRaw])?null:l.format(e.value[n.EstNetEcvRaw]),t.selected[n.EstSubEcv]=s.stringIsNullUndefinedOrEmpty(e.value[n.EstSubEcvRaw])?null:l.format(e.value[n.EstSubEcvRaw]),t.selected[n.EstDirectExpenses]=s.stringIsNullUndefinedOrEmpty(e.value[n.EstDirectExpensesRaw])?null:l.format(e.value[n.EstDirectExpensesRaw]),t.selected[n.JvEcv]=s.stringIsNullUndefinedOrEmpty(e.value[n.JvEcvRaw])?null:l.format(e.value[n.JvEcvRaw]),t.selected[n.TaskNetEcv]=s.stringIsNullUndefinedOrEmpty(e.value[n.TaskNetEcvRaw])?null:l.format(e.value[n.TaskNetEcvRaw]),t.selected[n.TaskGrossEcv]=s.stringIsNullUndefinedOrEmpty(e.value[n.TaskGrossEcvRaw])?null:l.format(e.value[n.TaskGrossEcvRaw]),t.selected[n.ETCV]=s.stringIsNullUndefinedOrEmpty(e.value[n.ETCVRaw])?null:l.format(e.value[n.ETCVRaw]),t.selected[n.ENCV]=s.stringIsNullUndefinedOrEmpty(e.value[n.ENCVRaw])?null:l.format(e.value[n.ENCVRaw]),t.selected[n.PreSubmittalExpenseFormat]=s.stringIsNullUndefinedOrEmpty(e.value[n.PreSubmittalExpense])?null:l.format(e.value[n.PreSubmittalExpense]),t.selected[n.QualificationsExpenseFormat]=s.stringIsNullUndefinedOrEmpty(e.value[n.QualificationsExpense])?null:l.format(e.value[n.QualificationsExpense]),t.selected[n.TechProposalExpenseFormat]=s.stringIsNullUndefinedOrEmpty(e.value[n.TechProposalExpense])?null:l.format(e.value[n.TechProposalExpense]),t.selected[n.CostProposalExpenseFormat]=s.stringIsNullUndefinedOrEmpty(e.value[n.CostProposalExpense])?null:l.format(e.value[n.CostProposalExpense]),t.selected[n.InterviewExpenseFormat]=s.stringIsNullUndefinedOrEmpty(e.value[n.InterviewExpense])?null:l.format(e.value[n.InterviewExpense]),t.selected[n.ContractNegotiationsExpenseFormat]=s.stringIsNullUndefinedOrEmpty(e.value[n.ContractNegotiationsExpense])?null:l.format(e.value[n.ContractNegotiationsExpense]),t.selected[n.ContractUpsetLimitValues]=s.stringIsNullUndefinedOrEmpty(e.value[n.ContractUpsetLimitValuesRaw])?null:l.format(e.value[n.ContractUpsetLimitValuesRaw])}(n,e,t),e.switchForm=!0,JSON.stringify(e.selected)},this.ShowValidationRequestEdits=function(){n.alertWarningCustom("Warning",'<div align="left"><span>In order to submit request, data from the source system must match any requested edits.<br /><br /><span>To move forward, either:</span><ul><li>click "<b>Save & Finish Later</b>"</li><li>click "<b>Assign to Others</b>" to engage someone who has access to CRM, that they might update applicable data on your behalf</li></ul><br /></div>',"none")},this.IsRcrCoordinatorInWorkflow=c}angular.module("myApp").service("GngFormBusiness",e),e.$inject=["astigUtilityService","sweetDialogAlertService","LookupService","LookupRoleIds","CountryStateCityService","$timeout","GenericDataService"]}(),function(){"use strict";function e(s,o,r,e,n){this.GetFormDetails=function(e,t){var n=null;n="eanpSansOpportunity"===t||"eanpSansOpportunitywf"===t||"eanpSansOpportunitywar"===t?{RoleId:o.projectSetupAgreementRoleId,Parameters:{LOOKUP_VALUE:angular.copy(e),LOOKUP_REFERENCE:"eanp"===t||"eanpwar"===t||"eanpwf"===t?"OPPORTUNITY":"AGREEMENT"}}:{RoleId:o.projectSetupOpportunityRoleId,Parameters:{LOOKUP_VALUE:angular.copy(e)}};return r.Search(n).then(function(e){return e[0]})},this.FillupAutopopulatedFields=function(t,n,l,e,o){t.selected=angular.copy(l.value),t.selected[n.AnticipatedGrossRevenueEdit]=s.stringIsNullUndefinedOrEmpty(l.value[n.AnticipatedGrossRevenueEdit])?angular.copy(l.value[n.AnticipatedGrossRevenue]):angular.copy(l.value[n.AnticipatedGrossRevenueEdit]),t.selected[n.AnticipatedNetRevenueEdit]=s.stringIsNullUndefinedOrEmpty(l.value[n.AnticipatedNetRevenueEdit])?angular.copy(l.value[n.AnticipatedNetRevenue]):angular.copy(l.value[n.AnticipatedNetRevenueEdit]),t.selected[n.AnticipatedMarginEdit]=s.stringIsNullUndefinedOrEmpty(l.value[n.AnticipatedMarginEdit])?angular.copy(l.value[n.AnticipatedMargin]):angular.copy(l.value[n.AnticipatedMarginEdit]),t.selected[n.EngageGBS]=s.stringIsNullUndefinedOrEmpty(l.value[n.EngageGBS])?"YES":angular.copy(l.value[n.EngageGBS]),t.selected[n.ProjectName]="eanp"!==e&&"eanpwar"!==e&&"eanpwf"!==e&&"eanpSansOpportunity"!==e&&"eanpSansOpportunitywar"!==e&&"eanpSansOpportunitywf"!==e&&s.stringIsNullUndefinedOrEmpty(l.value[n.ProjectName])?l.value[n.OpportunityName]:l.value[n.ProjectName];t.selected[n.ContractClassification]="eanp"===e||"eanpwar"===e||"eanpwf"===e||"eanpSansOpportunity"===e||"eanpSansOpportunitywar"===e||"eanpSansOpportunitywf"===e?"Task Order":l.value[n.ContractClassification],t.clearSwitch.pa=s.stringIsNullUndefinedOrEmpty(l.value[n.PAEdited])?"N":"Y",t.clearSwitch.projectManager=s.stringIsNullUndefinedOrEmpty(l.value[n.ProjectManagerEdited])?"N":"Y",t.clearSwitch.projectDirector=s.stringIsNullUndefinedOrEmpty(l.value[n.ProjectDirector])?"N":"Y",t.clearSwitch.td=s.stringIsNullUndefinedOrEmpty(l.value[n.Td])?"N":"Y",t.object.projectDirector=s.stringIsNullUndefinedOrEmpty(l.value[n.ProjectDirector])?null:JSON.parse(l.value[n.ProjectDirector]),t.list.sdl=s.stringIsNullUndefinedOrEmpty(l.value[n.Sdl])?[{clearSwitch:"N",value:null}]:JSON.parse(l.value[n.Sdl]),t.list.gbsPASupport=s.stringIsNullUndefinedOrEmpty(l.value[n.GBSPASupport])?[{clearSwitch:"N",value:null,name:null}]:JSON.parse(l.value[n.GBSPASupport]);for(var r=0;r<t.list.gbsPASupport.length;r++)null!==t.list.gbsPASupport[r].value&&(t.list.gbsPASupport[r].clearSwitch="Y",t.list.gbsPASupport[r].name=angular.copy(s.stringIsNullUndefinedOrEmpty(t.list.gbsPASupport[r].value.LAST_FIRST_NAME)?t.list.gbsPASupport[r].value.FULL_NAME:t.list.gbsPASupport[r].value.LAST_FIRST_NAME));t.object.td=s.stringIsNullUndefinedOrEmpty(l.value[n.Td])?null:JSON.parse(l.value[n.Td]),t.object.engageGBS=!!s.stringIsNullUndefinedOrEmpty(l.value[n.EngageGBS])||"YES"===l.value[n.EngageGBS],t.object.sb=s.stringIsNullUndefinedOrEmpty(l.value[n.SbRef])?null:JSON.parse(l.value[n.SbRef]),t.list.vendorFinancialExposure=s.stringIsNullUndefinedOrEmpty(l.value[n.VendorFinancialExposure])?[]:JSON.parse(l.value[n.VendorFinancialExposure]),"eanpwf"===e||"eanp"===e||"eanpwar"===e?(t.object.pb=s.stringIsNullUndefinedOrEmpty(t.object.pbRef)?s.stringIsNullUndefinedOrEmpty(l.value[n.Pb])?null:JSON.parse(l.value[n.Pb]):t.object.pbRef,t.clearSwitch.pb=s.stringIsNullUndefinedOrEmpty(t.object.pbRef)&&s.stringIsNullUndefinedOrEmpty(l.value[n.Pb])?"N":"Y"):(t.object.pb=s.stringIsNullUndefinedOrEmpty(l.value[n.Pb])?null:JSON.parse(l.value[n.Pb]),t.clearSwitch.pb=s.stringIsNullUndefinedOrEmpty(l.value[n.Pb])?"N":"Y");s.stringIsNullUndefinedOrEmpty(l.value[n.PAEdited])?d(l.value[n.PAId],t,"pa"):t.object.pa=JSON.parse(l.value[n.PAEdited]);t.isLblInWorkFlow||!t.asForm?t.object.lbl=s.stringIsNullUndefinedOrEmpty(l.value[n.Lbl])?null:JSON.parse(l.value[n.Lbl]):t.object.lbl=s.stringIsNullUndefinedOrEmpty(l.value[n.Lbl])?null:t.list.lbl.find(function(e){return e.TableDataRoleId===JSON.parse(l.value[n.Lbl]).TableDataRoleId});if("eanpSansOpportunitywf"===e||"eanpSansOpportunity"===e||"eanpSansOpportunitywar"===e)t.selected[n.ClientTypeEdited]=s.stringIsNullUndefinedOrEmpty(l.value[n.ClientTypeEdited])?l.value[n.ClientType]:l.value[n.ClientTypeEdited],t.selected[n.UltimateClientTypeEdited]=s.stringIsNullUndefinedOrEmpty(l.value[n.UltimateClientTypeEdited])?l.value[n.UltimateClientType]:l.value[n.ClientTypeEdited],t.selected[n.DeliveryMethodEdited]=s.stringIsNullUndefinedOrEmpty(l.value[n.DeliveryMethodEdited])?l.value[n.DeliveryMethod]:l.value[n.DeliveryMethodEdited],t.selected[n.PrimaryServiceTypeEdited]=s.stringIsNullUndefinedOrEmpty(l.value[n.PrimaryServiceTypeEdited])?l.value[n.PrimaryServiceType]:l.value[n.PrimaryServiceTypeEdited],t.selected[n.CityEdited]=s.stringIsNullUndefinedOrEmpty(l.value[n.CityEdited])?l.value[n.City]:l.value[n.CityEdited],t.list.state=s.stringIsNullUndefinedOrEmpty(l.value[n.CountryEdited])?s.stringIsNullUndefinedOrEmpty(l.value[n.Country])?null:t.list.country.find(function(e){return e.name.toUpperCase()==l.value[n.Country].toUpperCase()}):t.list.country.find(function(e){return e.name.toUpperCase()==l.value[n.CountryEdited].toUpperCase()}),null!==t.list.state&&t.list.state.states.push({id:0,name:"NATIONWIDE",state_code:"N/A",cities:[]}),t.object.client=s.stringIsNullUndefinedOrEmpty(l.value[n.ClientEdited])?s.stringIsNullUndefinedOrEmpty(l.value[n.Client])?null:p(l.value[n.Client],t,"client"):JSON.parse(l.value[n.ClientEdited]),t.object.ultimateClient=s.stringIsNullUndefinedOrEmpty(l.value[n.UltimateClientEdited])?s.stringIsNullUndefinedOrEmpty(l.value[n.UltimateClient])?null:p(l.value[n.UltimateClient],t,"ultimateClient"):JSON.parse(l.value[n.UltimateClientEdited]),t.clearSwitch.client=s.stringIsNullUndefinedOrEmpty(l.value[n.ClientEdited])&&s.stringIsNullUndefinedOrEmpty(l.value[n.Client])?"N":"Y",t.clearSwitch.ultimateClient=s.stringIsNullUndefinedOrEmpty(l.value[n.UltimateClientEdited])&&s.stringIsNullUndefinedOrEmpty(l.value[n.UltimateClient])?"N":"Y",t.list.city=s.stringIsNullUndefinedOrEmpty(l.value[n.StateEdited])?s.stringIsNullUndefinedOrEmpty(l.value[n.State])?null:t.list.state.states.find(function(e){return e.name.toUpperCase()==l.value[n.State].toUpperCase()}):t.list.state.states.find(function(e){return e.name.toUpperCase()==l.value[n.StateEdited].toUpperCase()}),t.object.segment=s.stringIsNullUndefinedOrEmpty(l.value[n.SegmentsEdited])?s.stringIsNullUndefinedOrEmpty(l.value[n.Segments])?null:t.list.segment.find(function(e){return e.SEGMENT.toUpperCase()==l.value[n.Segments].toUpperCase()}):t.list.segment.find(function(e){return e.LIST_ID==JSON.parse(l.value[n.SegmentsEdited]).LIST_ID}),t.list.marketArea=null!==t.object.segment?f("SEGMENT",t.object.segment,t.list.segment,!1):null,t.object.marketArea=s.stringIsNullUndefinedOrEmpty(l.value[n.MarketAreaEdited])?s.stringIsNullUndefinedOrEmpty(l.value[n.MarketArea])?null:t.list.marketArea.find(function(e){return e.AREA.toUpperCase()==l.value[n.MarketArea].toUpperCase()}):t.list.segment.find(function(e){return e.LIST_ID==JSON.parse(l.value[n.MarketAreaEdited]).LIST_ID}),t.list.marketSector=null!==t.object.marketArea?f("AREA",t.object.marketArea,t.list.marketArea,!1):null,t.object.marketSector=s.stringIsNullUndefinedOrEmpty(l.value[n.MarketSectorEdited])?s.stringIsNullUndefinedOrEmpty(l.value[n.MarketSector])?null:t.list.marketSector.find(function(e){return e.SECTOR.toUpperCase()==l.value[n.MarketSector].toUpperCase()}):t.list.segment.find(function(e){return e.LIST_ID==JSON.parse(l.value[n.MarketSectorEdited]).LIST_ID}),t.list.serviceType=null!==t.object.segment?f("SEGMENT",t.object.segment,t.list.coreServiceType,!1):null,t.object.serviceType=s.stringIsNullUndefinedOrEmpty(l.value[n.ServiceTypeEdited])?s.stringIsNullUndefinedOrEmpty(l.value[n.ServiceType])?null:t.list.coreServiceType.find(function(e){return e.SERVICE_TYPE.toUpperCase()==l.value[n.ServiceType].toUpperCase()}):t.list.coreServiceType.find(function(e){return e.LIST_ID==JSON.parse(l.value[n.ServiceTypeEdited]).LIST_ID}),s.stringIsNullUndefinedOrEmpty(l.value[n.ProjectManagerEdited])?d(l.value[n.ProjectManagerId],t,"projectManager").then(function(e){m(l.value[n.Funding],t,o)}):(t.object.projectManager=JSON.parse(l.value[n.ProjectManagerEdited]),m(l.value[n.Funding],t,o));else if("pu"===e){if(s.stringIsNullUndefinedOrEmpty(l.value[n.ProjectManagerEdited])?d(l.value[n.ProjectManagerId],t,"projectManager").then(function(e){m(l.value[n.Funding],t,o)}):(t.object.projectManager=JSON.parse(l.value[n.ProjectManagerEdited]),m(l.value[n.Funding],t,o)),!s.stringIsNullUndefinedOrEmpty(o)&&3<o.length){var i="Remove Work at-Risk (WAR) & Establish Funding"===o[3].ApprovalItemName.EN?"Establish Funding / Contract Executed":o[3].ApprovalItemName.EN;t.selected[n.Action]=i}}else if("eanpwf"===e||"nanpwf"===e)s.stringIsNullUndefinedOrEmpty(l.value[n.ProjectManagerEdited])?d(l.value[n.ProjectManagerId],t,"projectManager").then(function(e){m(l.value[n.Funding],t,o)}):(t.object.projectManager=JSON.parse(l.value[n.ProjectManagerEdited]),m(l.value[n.Funding],t,o));else{var a=s.stringIsNullUndefinedOrEmpty(l.value[n.Funding])?null:JSON.parse(l.value[n.Funding]);s.stringIsNullUndefinedOrEmpty(l.value[n.ProjectManagerEdited])?d(l.value[n.ProjectManagerId],t,"projectManager").then(function(e){c(a,t,o)}):(t.object.projectManager=JSON.parse(l.value[n.ProjectManagerEdited]),c(a,t,o))}return JSON.stringify(t.selected)},this.setClearSwitch=function(e,t){for(var n=0;n<e[t].length;n++)null!==e[t][n].value&&(e[t][n].clearSwitch="Y")},this.FillUpTwoWayBindFields=function(e,t,n,l,o){e.selected=angular.copy(n.value),e.selected[t.ContractClassification]="eanpSansOpportunity"===l||"eanpSansOpportunitywf"===l||"eanpSansOpportunitywar"===l?"MSA":n.value[t.ContractClassification],e.selected[t.EngageGBS]=s.stringIsNullUndefinedOrEmpty(n.value[t.EngageGBS])?"YES":angular.copy(n.value[t.EngageGBS]),e.list.vendorFinancialExposure=s.stringIsNullUndefinedOrEmpty(n.value[t.VendorFinancialExposure])?[]:JSON.parse(n.value[t.VendorFinancialExposure]),e.list.state=s.stringIsNullUndefinedOrEmpty(n.value[t.Country])?e.list.country.find(function(e){return"USA"===e.iso3}):e.list.country.find(function(e){return e.name==n.value[t.Country]}),null!==e.list.state&&(e.list.state.states.push({id:0,name:"NATIONWIDE",state_code:"N/A",cities:[]}),e.list.city=s.stringIsNullUndefinedOrEmpty(n.value[t.State])?null:e.list.state.states.find(function(e){return e.name==n.value[t.State]}));e.object.segment=s.stringIsNullUndefinedOrEmpty(n.value[t.Segments])?null:e.list.segment.find(function(e){return e.LIST_ID==JSON.parse(n.value[t.Segments]).LIST_ID}),e.object.marketArea=s.stringIsNullUndefinedOrEmpty(n.value[t.MarketArea])?null:e.list.segment.find(function(e){return e.LIST_ID==JSON.parse(n.value[t.MarketArea]).LIST_ID}),e.object.marketSector=s.stringIsNullUndefinedOrEmpty(n.value[t.MarketSector])?null:e.list.segment.find(function(e){return e.LIST_ID==JSON.parse(n.value[t.MarketSector]).LIST_ID}),e.object.serviceType=s.stringIsNullUndefinedOrEmpty(n.value[t.ServiceType])?null:e.list.coreServiceType.find(function(e){return e.LIST_ID==JSON.parse(n.value[t.ServiceType]).LIST_ID}),e.object.client=s.stringIsNullUndefinedOrEmpty(n.value[t.Client])?null:JSON.parse(n.value[t.Client]),e.object.ultimateClient=s.stringIsNullUndefinedOrEmpty(n.value[t.UltimateClient])?null:JSON.parse(n.value[t.UltimateClient]),e.clearSwitch.client=s.stringIsNullUndefinedOrEmpty(n.value[t.Client])?"N":"Y",e.clearSwitch.ultimateClient=s.stringIsNullUndefinedOrEmpty(n.value[t.UltimateClient])?"N":"Y",e.object.projectManager=s.stringIsNullUndefinedOrEmpty(n.value[t.ProjectManager])?null:JSON.parse(n.value[t.ProjectManager]),e.object.pa=s.stringIsNullUndefinedOrEmpty(n.value[t.PA])?null:JSON.parse(n.value[t.PA]),"nanpSansOpportunitywf"!==l&&(e.object.lbl=s.stringIsNullUndefinedOrEmpty(n.value[t.Lbl])?null:e.list.lbl.find(function(e){return e.TableDataRoleId===JSON.parse(n.value[t.Lbl]).TableDataRoleId}));e.clearSwitch.projectManager=s.stringIsNullUndefinedOrEmpty(n.value[t.ProjectManager])?"N":"Y",e.clearSwitch.pa=s.stringIsNullUndefinedOrEmpty(n.value[t.PA])?"N":"Y",e.clearSwitch.projectDirector=s.stringIsNullUndefinedOrEmpty(n.value[t.ProjectDirector])?"N":"Y",e.clearSwitch.td=s.stringIsNullUndefinedOrEmpty(n.value[t.Td])?"N":"Y",e.object.projectDirector=s.stringIsNullUndefinedOrEmpty(n.value[t.ProjectDirector])?null:JSON.parse(n.value[t.ProjectDirector]),e.list.sdl=s.stringIsNullUndefinedOrEmpty(n.value[t.Sdl])?[{clearSwitch:"N",value:null}]:JSON.parse(n.value[t.Sdl]),e.list.gbsPASupport=s.stringIsNullUndefinedOrEmpty(n.value[t.GBSPASupport])?[{clearSwitch:"N",value:null,name:null}]:JSON.parse(n.value[t.GBSPASupport]);for(var r=0;r<e.list.gbsPASupport.length;r++)null!==e.list.gbsPASupport[r].value&&(e.list.gbsPASupport[r].clearSwitch="Y",e.list.gbsPASupport[r].name=angular.copy(e.list.gbsPASupport[r].value.LAST_FIRST_NAME),e.list.gbsPASupport[r].id=s.guid());"eanpwf"===l||"eanp"===l||"eanpwar"===l?(e.object.pb=s.stringIsNullUndefinedOrEmpty(e.object.pbRef)?s.stringIsNullUndefinedOrEmpty(n.value[t.Pb])?null:JSON.parse(n.value[t.Pb]):e.object.pbRef,e.clearSwitch.pb=s.stringIsNullUndefinedOrEmpty(e.object.pbRef)&&s.stringIsNullUndefinedOrEmpty(n.value[t.Pb])?"N":"Y"):(e.object.pb=s.stringIsNullUndefinedOrEmpty(n.value[t.Pb])?null:JSON.parse(n.value[t.Pb]),e.clearSwitch.pb=s.stringIsNullUndefinedOrEmpty(n.value[t.Pb])?"N":"Y");return e.object.td=s.stringIsNullUndefinedOrEmpty(n.value[t.Td])?null:JSON.parse(n.value[t.Td]),e.object.engageGBS=!!s.stringIsNullUndefinedOrEmpty(n.value[t.EngageGBS])||"YES"===n.value[t.EngageGBS],e.list.marketArea=null!==e.object.segment?f("SEGMENT",e.object.segment,e.list.segment,!1):null,e.list.marketSector=null!==e.object.marketArea?f("AREA",e.object.marketArea,e.list.marketArea,!1):null,e.list.serviceType=null!==e.object.segment?f("SEGMENT",e.object.segment,e.list.coreServiceType,!1):null,m(n.value[t.Funding],e,o),JSON.stringify(e.selected)},this.GetLocalBusinessLine=i,this.GetLocalBusinessLineForLead=function(e,t){var n={RoleId:1358,Parameters:{COST_CENTER_ID:s.stringIsNullUndefinedOrEmpty(e)?0:parseInt(e)}};return r.Search(n).then(function(e){return e})},this.GetApproverForLbl=l,this.GetApprover=d,this.GetApproverByEmail=function(e,t,n){var l={RoleId:o.projectSetupEmployeeForLblRoleId,Parameters:{LOOKUP_VALUE:e}};return r.Search(l).then(function(e){s.stringIsNullUndefinedOrEmpty(e)||("sdl"===n?null!==e[0]&&t.list[n].push({clearSwitch:"Y",value:e[0],prop:n}):"gbsPASupport"===n?t.list[n].push({clearSwitch:"Y",value:e[0],prop:n,name:e[0].LAST_FIRST_NAME,id:s.guid()}):(t.object[n]=e[0],t.clearSwitch[n]="Y"))})},this.GetApproverByEmailSetSelected=function(e){var t={RoleId:o.projectSetupEmployeeForLblRoleId,Parameters:{LOOKUP_VALUE:e}};return r.Search(t).then(function(e){return e[0]})},this.AddToList=a,this.DeleteItem=function(e,t,n){e[t].list.splice(n,1)},this.GetDistrictList=function(e,t,n,l){e.Level2.selected=null,e.Level3.selected=null,e.Level3.list=[],e.Level4.selected=null,e.Level4.list=[],e.Lbl.list=[],e.Lbl.selected=null,e.Level2.list=f("DIVISION_ID",e.Level1.selected,e.Level1.list,!0)},this.GetAreaList=function(e){e.Level3.selected=null,e.Level4.selected=null,e.Level4.list=[],e.Lbl.list=[],e.Lbl.selected=null,e.Level3.list=f("DISTRICT_ID",e.Level2.selected,e.Level2.list,!0)},this.GetCostCenterList=function(e){e.Level4.selected=null,e.Lbl.list=[],e.Lbl.selected=null,e.Level4.list=f("AREA_ID",e.Level3.selected,e.Level3.list,!0)},this.GetCompany=function(e,t){t.CompanyName=s.stringIsNullUndefinedOrEmpty(t.Level4)?null:t.Level4.COMPANY_NUMBER+" - "+t.Level4.COMPANY_NAME},this.CalculateNetFunding=function(e){var t=s.stringIsNullUndefinedOrEmpty(e.TotalFunding)?0:parseFloat(e.TotalFunding.toString().replace("$","").replace(",","").replace(",","").replace(",","")),n=s.stringIsNullUndefinedOrEmpty(e.Subcontractor)?0:parseFloat(e.Subcontractor.toString().replace("$","").replace(",","").replace(",","").replace(",","")),l=s.stringIsNullUndefinedOrEmpty(e.DirectExpense)?0:parseFloat(e.DirectExpense.toString().replace("$","").replace(",","").replace(",","").replace(",","")),o=s.stringIsNullUndefinedOrEmpty(e.NonReimbursableCost)?0:parseFloat(e.NonReimbursableCost.toString().replace("$","").replace(",","").replace(",","").replace(",",""));s.stringIsNullUndefinedOrEmpty(e.TotalFunding)&&s.stringIsNullUndefinedOrEmpty(e.Subcontractor)&&s.stringIsNullUndefinedOrEmpty(e.DirectExpense)&&s.stringIsNullUndefinedOrEmpty(e.NonReimbursableCost)?e.NetFunding=null:(e.NetFunding=t-n-l-o,e.NetFunding=u.format(e.NetFunding))},this.CalculateTargetMargin=function(e){var t=s.stringIsNullUndefinedOrEmpty(e.TotalFunding)?0:parseFloat(e.TotalFunding.toString().replace("$","").replace(",","").replace(",","").replace(",","")),n=s.stringIsNullUndefinedOrEmpty(e.Subcontractor)?0:parseFloat(e.Subcontractor.toString().replace("$","").replace(",","").replace(",","").replace(",","")),l=s.stringIsNullUndefinedOrEmpty(e.DirectExpense)?0:parseFloat(e.DirectExpense.toString().replace("$","").replace(",","").replace(",","").replace(",","")),o=s.stringIsNullUndefinedOrEmpty(e.Labor)?0:parseFloat(e.Labor.toString().replace("$","").replace(",","").replace(",","").replace(",","")),r=s.stringIsNullUndefinedOrEmpty(e.Oh)?0:parseFloat(e.Oh.toString().replace("$","").replace(",","").replace(",","").replace(",","")),i=s.stringIsNullUndefinedOrEmpty(e.NonReimbursableCost)?0:parseFloat(e.NonReimbursableCost.toString().replace("$","").replace(",","").replace(",","").replace(",",""));s.stringIsNullUndefinedOrEmpty(e.TotalFunding)&&s.stringIsNullUndefinedOrEmpty(e.Subcontractor)&&s.stringIsNullUndefinedOrEmpty(e.DirectExpense)&&s.stringIsNullUndefinedOrEmpty(e.Labor)&&s.stringIsNullUndefinedOrEmpty(e.Oh)&&s.stringIsNullUndefinedOrEmpty(e.NonReimbursableCost)&&s.stringIsNullUndefinedOrEmpty(_mr)?e.TargetMarginDollar=null:(e.TargetMarginDollar=t-o-r-n-l-i,e.TargetMarginDollar=u.format(e.TargetMarginDollar))},this.CalculateMRTargetMarginDollar=function(e){var t=s.stringIsNullUndefinedOrEmpty(e.list[1].TargetMarginDollar)?0:parseFloat(e.list[1].TargetMarginDollar.toString().replace("$","").replace(",","").replace(",","").replace(",","")),n=s.stringIsNullUndefinedOrEmpty(e.list[0].TargetMarginDollar)?0:parseFloat(e.list[0].TargetMarginDollar.toString().replace("$","").replace(",","").replace(",","").replace(",",""));e.total.TargetMarginDollar=n+t,e.total.TargetMarginDollar=u.format(e.total.TargetMarginDollar)},this.CalculateTargetMultiplier=function(e){var t=s.stringIsNullUndefinedOrEmpty(e.NetFunding)?0:parseFloat(e.NetFunding.toString().replace("$","").replace(",","").replace(",","").replace(",","")),n=s.stringIsNullUndefinedOrEmpty(e.Labor)?0:parseFloat(e.Labor.toString().replace("$","").replace(",","").replace(",","").replace(",",""));0!==n?(e.TargetMarginMultiplier=t/n,e.TargetMarginMultiplier=e.TargetMarginMultiplier.toString().includes(".")?e.TargetMarginMultiplier.toFixed(2):e.TargetMarginMultiplier):e.TargetMarginMultiplier=null},this.CalculateTargetMarginPercentOfTotal=function(e){var t=s.stringIsNullUndefinedOrEmpty(e.TargetMarginDollar)?0:parseFloat(e.TargetMarginDollar.toString().replace("$","").replace(",","").replace(",","").replace(",","")),n=s.stringIsNullUndefinedOrEmpty(e.TotalFunding)?0:parseFloat(e.TotalFunding.toString().replace("$","").replace(",","").replace(",","").replace(",",""));0!==n?(e.TargetMarginPercentOfTotal=t/n*100,e.TargetMarginPercentOfTotal=e.TargetMarginPercentOfTotal.toString().includes(".")?e.TargetMarginPercentOfTotal.toFixed(2):e.TargetMarginPercentOfTotal):e.TargetMarginPercentOfTotal=null},this.CalculateTargetMarginPercentOfNetFunding=function(e){var t=s.stringIsNullUndefinedOrEmpty(e.TargetMarginDollar)?0:parseFloat(e.TargetMarginDollar.toString().replace("$","").replace(",","").replace(",","").replace(",","")),n=s.stringIsNullUndefinedOrEmpty(e.NetFunding)?0:parseFloat(e.NetFunding.toString().replace("$","").replace(",","").replace(",","").replace(",",""));0!==n?(e.TargetMarginPercentOfNet=t/n*100,e.TargetMarginPercentOfNet=e.TargetMarginPercentOfNet.toString().includes(".")?e.TargetMarginPercentOfNet.toFixed(2):e.TargetMarginPercentOfNet):e.TargetMarginPercentOfNet=null},this.CalculateTotal=function(e,t){for(var n=0,l=!1,o=0;o<e.list.length;o++){l||(l=!s.stringIsNullUndefinedOrEmpty(e.list[o][t]));var r=s.stringIsNullUndefinedOrEmpty(e.list[o][t])?0:parseFloat(e.list[o][t].toString().replace("$","").replace(",","").replace(",","").replace(",",""));n+=r}e.total[t]=l?u.format(n):null},this.CalculateAnticipatedGrossRevenueVariance=v,this.CalculateAnticipatedNetRevenueVariance=I,this.CalculateAnticipatedMarginVariance=E,this.CalculateAnticipatedMarginPercentGross=S,this.CalculateAnticipatedMarginPercentGrossVariance=N,this.CalculateAnticipatedMarginPercentNet=A,this.CalculateAnticipatedMarginPercentNetVariance=y,this.CalculateTotalAgreementFunding=R,this.CalculateTotalValues=function(e,t){switch(t){case e.prop.AnticipatedGrossRevenueVariance:v(e);break;case e.prop.AnticipatedNetRevenueVariance:I(e);break;case e.prop.AnticipatedMarginVariance:E(e);break;case e.prop.AnticipatedMarginPercentOfGross:S(e);break;case e.prop.AnticipatedMarginPercentOfGrossVariance:N(e);break;case e.prop.AnticipatedMarginPercentOfNet:A(e);break;case e.prop.AnticipatedMarginPercentOfNetVariance:y(e);break;case e.prop.TotalAgreementFunding:R(e)}},this.StringiFyFundingObject=function(e){var t=angular.copy(e.objectList.funding);t.total=JSON.stringify(t.total),e.selected[e.prop.Labor]=angular.copy(e.objectList.funding.total.Labor),e.selected[e.prop.Oh]=angular.copy(e.objectList.funding.total.Oh),e.selected[e.prop.Subcontractor]=angular.copy(e.objectList.funding.total.Subcontractor),e.selected[e.prop.DirectExpense]=angular.copy(e.objectList.funding.total.DirectExpense),e.selected[e.prop.NonReimbursableCost]=angular.copy(e.objectList.funding.total.NonReimbursableCost),e.selected[e.prop.TargetMarginMultiplier]=angular.copy(e.objectList.funding.total.TargetMarginMultiplier),e.selected[e.prop.TotalFunding]=angular.copy(e.objectList.funding.total.TotalFunding),e.selected[e.prop.NetFunding]=angular.copy(e.objectList.funding.total.NetFunding),e.selected[e.prop.TargetMarginDollar]=angular.copy(e.objectList.funding.total.TargetMarginDollar),e.selected[e.prop.ManagementReserve]=angular.copy(e.objectList.funding.total.ManagementReserve),e.selected[e.prop.TargetMarginPercentOfTotal]=angular.copy(e.objectList.funding.total.TargetMarginPercentOfTotal),e.selected[e.prop.TargetMarginPercentOfNet]=angular.copy(e.objectList.funding.total.TargetMarginPercentOfNet);for(var n=0;n<t.list.length;n++)t.list[n].Level1.list=null,t.list[n].Level1.selected=s.stringIsNullUndefinedOrEmpty(t.list[n].Level1.selected)?null:JSON.stringify(t.list[n].Level1.selected),t.list[n].Level2.list=null,t.list[n].Level2.selected=s.stringIsNullUndefinedOrEmpty(t.list[n].Level2.selected)?null:JSON.stringify(t.list[n].Level2.selected),t.list[n].Level3.list=null,t.list[n].Level3.selected=s.stringIsNullUndefinedOrEmpty(t.list[n].Level3.selected)?null:JSON.stringify(t.list[n].Level3.selected),t.list[n].Level4.list=null,t.list[n].Level4.selected=s.stringIsNullUndefinedOrEmpty(t.list[n].Level4.selected)?null:JSON.stringify(t.list[n].Level4.selected),t.list[n].Lbl.list=null,t.list[n].Lbl.selected=s.stringIsNullUndefinedOrEmpty(t.list[n].Lbl.selected)?null:JSON.stringify(t.list[n].Lbl.selected),t.list[n].FundingSource.list=null;t.list=JSON.stringify(t.list),e.selected[e.prop.Funding]=s.stringIsNullUndefinedOrEmpty(t)?null:JSON.stringify(t)},this.SetDefaultPMinFunding=function(e){for(var t=0;t<e.objectList.funding.list.length;t++)e.objectList.funding.list[t].PM=e.object.projectManager,e.objectList.funding.list[t].PMLevel=s.stringIsNullUndefinedOrEmpty(e.object.projectManager)?null:e.object.projectManager.PM_LEVEL,e.objectList.funding.list[t].ClearSwitch.PM=s.stringIsNullUndefinedOrEmpty(e.object.projectManager)?"N":"Y"},this.SetDefaultLblInFunding=function(l,e){for(var t=0;t<l.objectList.funding.list.length;t++)l.objectList.funding.list[t].Lbl.list=s.stringIsNullUndefinedOrEmpty(l.list.workflowLbl)?angular.copy(l.list.lbl):angular.copy(l.list.workflowLbl),s.stringIsNullUndefinedOrEmpty(l.objectList.funding.list[t].Level4.selected)||e.COST_CENTER_ID===l.objectList.funding.list[t].Level4.selected.COST_CENTER_ID&&(l.objectList.funding.list[t].Lbl.selected=s.stringIsNullUndefinedOrEmpty(l.object.lbl)?null:l.objectList.funding.list[t].Lbl.list.find(function(e){var t=JSON.parse(e.DerivedParentTableDataRoleIds),n=JSON.parse(l.object.lbl.DerivedParentTableDataRoleIds);return t.some(function(t){return n.some(function(e){return t==e})})}))},this.SetDefaultPA=function(e,t){if(!s.stringIsNullUndefinedOrEmpty(e.PA)&&e.PA.includes("{")){var n=JSON.parse(e.PA);null!==t.object.pa?n.EMPLOYEE_NUMBER!==t.object.pa.EMPLOYEE_NUMBER&&l(n.EMPLOYEE_NUMBER).then(function(e){t.object.pa=e,t.clearSwitch.pa="Y"}):s.stringIsNullUndefinedOrEmpty(n.EMPLOYEE_NUMBER)||l(n.EMPLOYEE_NUMBER).then(function(e){t.object.pa=e,t.clearSwitch.pa="Y"})}},this.AssignLBL=function(e,t,n){return i(e,n).then(function(e){t.list=e})},this.SetDefaultOracleHierarchy=function(l,o,e){if(!s.stringIsNullUndefinedOrEmpty(l.COST_CENTER_ID))for(var t=0;t<o.objectList.funding.list.length;t++)s.stringIsNullUndefinedOrEmpty(o.objectList.funding.list[t].Level1.selected)&&(o.objectList.funding.list[t].Lbl.list=s.stringIsNullUndefinedOrEmpty(o.list.workflowLbl)?s.stringIsNullUndefinedOrEmpty(o.list.lbl)?[]:angular.copy(o.list.lbl):angular.copy(o.list.workflowLbl),o.objectList.funding.list[t].Level1.list=angular.copy(o.list.division),o.objectList.funding.list[t].Level1.selected=o.objectList.funding.list[t].Level1.list.find(function(e){return e.DIVISION_ID==o.selected[o.prop.Level1Id]}),o.objectList.funding.list[t].Level2.list=null!==o.objectList.funding.list[t].Level1.selected?f("DIVISION_ID",o.objectList.funding.list[t].Level1.selected,o.objectList.funding.list[t].Level1.list,!0):null,o.objectList.funding.list[t].Level2.selected=o.objectList.funding.list[t].Level2.list.find(function(e){return e.DISTRICT_ID==o.selected[o.prop.Level2Id]}),o.objectList.funding.list[t].Level3.list=null!==o.objectList.funding.list[t].Level2.selected?f("DISTRICT_ID",o.objectList.funding.list[t].Level2.selected,o.objectList.funding.list[t].Level2.list,!0):null,o.objectList.funding.list[t].Level3.selected=o.objectList.funding.list[t].Level3.list.find(function(e){return e.AREA_ID==o.selected[o.prop.Level3Id]}),o.objectList.funding.list[t].Level4.list=null!==o.objectList.funding.list[t].Level3.selected?f("AREA_ID",o.objectList.funding.list[t].Level3.selected,o.objectList.funding.list[t].Level3.list,!0):null,o.objectList.funding.list[t].Level4.selected=o.objectList.funding.list[t].Level4.list.find(function(e){return e.COST_CENTER_ID==o.selected[o.prop.CostCenterId]})),s.stringIsNullUndefinedOrEmpty(o.objectList.funding.list[t].Level4.selected)||l.COST_CENTER_ID===o.objectList.funding.list[t].Level4.selected.COST_CENTER_ID&&s.stringIsNullUndefinedOrEmpty(o.objectList.funding.list[t].Lbl.selected)&&(e?s.stringIsNullUndefinedOrEmpty(o.objectList.funding.list[t].Lbl.list)||(o.objectList.funding.list[t].Lbl.selected=s.stringIsNullUndefinedOrEmpty(l.LOCAL_BUSINESS_LINE)?null:o.objectList.funding.list[t].Lbl.list.find(function(e){var t=JSON.parse(e.DerivedParentTableDataRoleIds),n=JSON.parse(l.LOCAL_BUSINESS_LINE.DerivedParentTableDataRoleIds);return t.some(function(t){return n.some(function(e){return t==e})})})):o.objectList.funding.list[t].Lbl.selected=s.stringIsNullUndefinedOrEmpty(o.object.lbl)?null:o.objectList.funding.list[t].Lbl.list.find(function(e){var t=JSON.parse(e.DerivedParentTableDataRoleIds),n=JSON.parse(o.object.lbl.DerivedParentTableDataRoleIds);return t.some(function(t){return n.some(function(e){return t==e})})}))},this.CalculateAnticipatedMarginPercentNetForPricing=function(e){var t=s.stringIsNullUndefinedOrEmpty(e.selected[e.prop.AnticipatedNetRevenue])?0:parseFloat(e.selected[e.prop.AnticipatedNetRevenue].toString().replace("$","").replace(",","").replace(",","").replace(",","")),n=s.stringIsNullUndefinedOrEmpty(e.selected[e.prop.AnticipatedMargin])?0:parseFloat(e.selected[e.prop.AnticipatedMargin].toString().replace("$","").replace(",","").replace(",","").replace(",",""));0!==t?(e.selected[e.prop.AnticipatedMarginPercentOfNet]=n/t*100,e.selected[e.prop.AnticipatedMarginPercentOfNet]=e.selected[e.prop.AnticipatedMarginPercentOfNet].toString().includes(".")?e.selected[e.prop.AnticipatedMarginPercentOfNet].toFixed(2):e.selected[e.prop.AnticipatedMarginPercentOfNet]):e.selected[e.prop.AnticipatedMarginPercentOfNet]=null},this.CalculateAnticipatedMarginPercentGrossForPricing=function(e){var t=s.stringIsNullUndefinedOrEmpty(e.selected[e.prop.AnticipatedMargin])?0:parseFloat(e.selected[e.prop.AnticipatedMargin].toString().replace("$","").replace(",","").replace(",","").replace(",","")),n=s.stringIsNullUndefinedOrEmpty(e.selected[e.prop.AnticipatedGrossRevenue])?0:parseFloat(e.selected[e.prop.AnticipatedGrossRevenue].toString().replace("$","").replace(",","").replace(",","").replace(",",""));0!==n?(e.selected[e.prop.AnticipatedMarginPercentOfGross]=t/n*100,e.selected[e.prop.AnticipatedMarginPercentOfGross]=e.selected[e.prop.AnticipatedMarginPercentOfGross].toString().includes(".")?e.selected[e.prop.AnticipatedMarginPercentOfGross].toFixed(2):e.selected[e.prop.AnticipatedMarginPercentOfGross]):e.selected[e.prop.AnticipatedMarginPercentOfGross]=null},this.ClearOracleHierarchy=function(e){for(var t=0;t<e.objectList.funding.list.length;t++)e.objectList.funding.list[t].Lbl.list=[],e.objectList.funding.list[t].Level1.list=angular.copy(e.list.division),e.objectList.funding.list[t].Level1.selected=null,e.objectList.funding.list[t].Level2.list=[],e.objectList.funding.list[t].Level2.selected=null,e.objectList.funding.list[t].Level3.list=[],e.objectList.funding.list[t].Level3.selected=null,e.objectList.funding.list[t].Level4.list=[],e.objectList.funding.list[t].Level4.selected=null,e.objectList.funding.list[t].Lbl.selected=null},this.SetDefaultPAinFunding=function(e){for(var t=0;t<e.objectList.funding.list.length;t++)e.objectList.funding.list[t].PA=s.stringIsNullUndefinedOrEmpty(e.object.pa)?null:e.object.pa,e.objectList.funding.list[t].ClearSwitch.PA=s.stringIsNullUndefinedOrEmpty(e.object.pa)?"N":"Y"},this.GetKeyRoles=function(e){var t={RoleId:-88888886,Parameters:{DATA:"ROLEMEMBERSBYROLELIST",ROLE_LIST:e.ROLE_LIST,COST_CENTER_ID:e.COST_CENTER_ID,OBJECT_ID:e.OBJECT_ID,LOOKUP:e.LOOKUP,TABLEDATAROLEID:e.TABLEDATAROLEID}};return n.GetData(t).then(function(e){return e})},this.AddManagementReserve=g,this.CalculateMRTargetMargin=function(e){var t=s.stringIsNullUndefinedOrEmpty(e.list[0].TotalFunding)?0:parseFloat(e.list[0].TotalFunding.toString().replace("$","").replace(",","").replace(",","").replace(",","")),n=s.stringIsNullUndefinedOrEmpty(e.list[0].Subcontractor)?0:parseFloat(e.list[0].Subcontractor.toString().replace("$","").replace(",","").replace(",","").replace(",","")),l=s.stringIsNullUndefinedOrEmpty(e.list[0].DirectExpense)?0:parseFloat(e.list[0].DirectExpense.toString().replace("$","").replace(",","").replace(",","").replace(",","")),o=s.stringIsNullUndefinedOrEmpty(e.list[0].Labor)?0:parseFloat(e.list[0].Labor.toString().replace("$","").replace(",","").replace(",","").replace(",","")),r=s.stringIsNullUndefinedOrEmpty(e.list[0].Oh)?0:parseFloat(e.list[0].Oh.toString().replace("$","").replace(",","").replace(",","").replace(",","")),i=s.stringIsNullUndefinedOrEmpty(e.list[0].NonReimbursableCost)?0:parseFloat(e.list[0].NonReimbursableCost.toString().replace("$","").replace(",","").replace(",","").replace(",","")),a=s.stringIsNullUndefinedOrEmpty(e.list[1].ManagementReserve)?0:parseFloat(e.list[1].ManagementReserve.toString().replace("$","").replace(",","").replace(",","").replace(",",""));s.stringIsNullUndefinedOrEmpty(e.list[0].TotalFunding)&&s.stringIsNullUndefinedOrEmpty(e.list[0].Subcontractor)&&s.stringIsNullUndefinedOrEmpty(e.list[0].DirectExpense)&&s.stringIsNullUndefinedOrEmpty(e.list[0].Labor)&&s.stringIsNullUndefinedOrEmpty(e.list[0].Oh)&&s.stringIsNullUndefinedOrEmpty(e.list[0].NonReimbursableCost)&&s.stringIsNullUndefinedOrEmpty(e.list[1].ManagementReserve)?e.list[0].TargetMarginDollar=null:(e.list[0].TargetMarginDollar=t-o-r-n-l-i-a,e.list[0].TargetMarginDollar=u.format(e.list[0].TargetMarginDollar))};var u=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});function c(l,e,t){var n=C(t);if(s.stringIsNullUndefinedOrEmpty(l))e.objectList.funding={total:{Labor:null,Oh:null,Subcontractor:null,DirectExpense:null,NonReimbursableCost:null,TotalFunding:null,NetFunding:null,ManagementReserve:null,TargetMarginDollar:null,TargetMarginPercentOfTotal:null,TargetMarginPercentOfNet:null,TargetMarginMultiplier:null},list:[]},a(e,"funding",t),e.withManagementReserve&&g(e,"funding",t);else{l.total=JSON.parse(l.total),l.list=JSON.parse(l.list);for(var o=0;o<l.list.length;o++)l.list[o].Lbl.selected=s.stringIsNullUndefinedOrEmpty(l.list[o].Lbl.selected)?null:l.list[o].Lbl.list.find(function(e){var t=JSON.parse(e.DerivedParentTableDataRoleIds),n=JSON.parse(JSON.parse(l.list[o].Lbl.selected).DerivedParentTableDataRoleIds);return t.some(function(t){return n.some(function(e){return t==e})})}),l.list[o].Level1.list=angular.copy(e.list.division),l.list[o].Level1.selected=s.stringIsNullUndefinedOrEmpty(l.list[o].Level1.selected)?null:l.list[o].Level1.list.find(function(e){return e.COST_CENTER_ID==JSON.parse(l.list[o].Level1.selected).COST_CENTER_ID}),l.list[o].Level2.selected=s.stringIsNullUndefinedOrEmpty(l.list[o].Level2.selected)?null:l.list[o].Level1.list.find(function(e){return e.COST_CENTER_ID==JSON.parse(l.list[o].Level2.selected).COST_CENTER_ID}),l.list[o].Level2.list=null!==l.list[o].Level1.selected?f("DIVISION_ID",l.list[o].Level1.selected,l.list[o].Level1.list,!0):null,l.list[o].Level3.selected=s.stringIsNullUndefinedOrEmpty(l.list[o].Level3.selected)?null:l.list[o].Level1.list.find(function(e){return e.COST_CENTER_ID==JSON.parse(l.list[o].Level3.selected).COST_CENTER_ID}),l.list[o].Level3.list=null!==l.list[o].Level2.selected?f("DISTRICT_ID",l.list[o].Level2.selected,l.list[o].Level2.list,!0):null,l.list[o].Level4.selected=s.stringIsNullUndefinedOrEmpty(l.list[o].Level4.selected)?null:l.list[o].Level1.list.find(function(e){return e.COST_CENTER_ID==JSON.parse(l.list[o].Level4.selected).COST_CENTER_ID}),l.list[o].Level4.list=null!==l.list[o].Level3.selected?f("AREA_ID",l.list[o].Level3.selected,l.list[o].Level3.list,!0):null,l.list[o].FundingSource.list=null!==n?[n]:["Collections","Notice to Proceed","Original Contract","Purchase Order"],l.list[o].ProjectType.list=["BR + Exp","BUILDING","CPFF","CPM","CR","FIXED PRICE","FIXED UNIT","FP + Exp","FP PHYSICAL","MISC-OTHER","MISC-Sublet","R&D","T&M BR","T&M LM","TIME MATERIALS"];e.objectList.funding=angular.copy(l)}}function d(e,t,n){var l={RoleId:o.projectSetupEmployeeRoleId,Parameters:{LOOKUP_VALUE:s.stringIsNullUndefinedOrEmpty(e)?0:parseInt(e)}};return r.Search(l).then(function(e){return t.object[n]=e[0],t.clearSwitch[n]="Y",e[0]})}function p(e,t,n){var l={RoleId:o.projectSetupUltimateClientRoleId,Parameters:{LOOKUP_VALUE:e}};return r.Search(l).then(function(e){t.object[n]=e[0],t.clearSwitch[n]="Y"})}function l(e){var t={RoleId:o.projectSetupEmployeeForLblRoleId,Parameters:{LOOKUP_VALUE:e}};return r.Search(t).then(function(e){return e[0]})}function m(l,e,t){var n=C(t);if(s.stringIsNullUndefinedOrEmpty(l))e.objectList.funding={total:{Labor:null,Oh:null,Subcontractor:null,DirectExpense:null,NonReimbursableCost:null,TotalFunding:null,NetFunding:null,ManagementReserve:null,TargetMarginDollar:null,TargetMarginPercentOfTotal:null,TargetMarginPercentOfNet:null,TargetMarginMultiplier:null},list:[]},a(e,"funding",t),e.withManagementReserve&&g(e,"funding",t);else{l.total=JSON.parse(l.total);for(var o=0;o<l.list.length;o++)l.list[o].Lbl.selected=s.stringIsNullUndefinedOrEmpty(l.list[o].Lbl.selected)?null:l.list[o].Lbl.list.find(function(e){var t=JSON.parse(e.DerivedParentTableDataRoleIds),n=JSON.parse(JSON.parse(l.list[o].Lbl.selected).DerivedParentTableDataRoleIds);return t.some(function(t){return n.some(function(e){return t==e})})}),l.list[o].Level1.list=angular.copy(e.list.division),l.list[o].Level1.selected=s.stringIsNullUndefinedOrEmpty(l.list[o].Level1.selected)?null:l.list[o].Level1.list.find(function(e){return e.COST_CENTER_ID==JSON.parse(l.list[o].Level1.selected).COST_CENTER_ID}),l.list[o].Level2.selected=s.stringIsNullUndefinedOrEmpty(l.list[o].Level2.selected)?null:l.list[o].Level1.list.find(function(e){return e.COST_CENTER_ID==JSON.parse(l.list[o].Level2.selected).COST_CENTER_ID}),l.list[o].Level2.list=null!==l.list[o].Level1.selected?f("DIVISION_ID",l.list[o].Level1.selected,l.list[o].Level1.list,!0):null,l.list[o].Level3.selected=s.stringIsNullUndefinedOrEmpty(l.list[o].Level3.selected)?null:l.list[o].Level1.list.find(function(e){return e.COST_CENTER_ID==JSON.parse(l.list[o].Level3.selected).COST_CENTER_ID}),l.list[o].Level3.list=null!==l.list[o].Level2.selected?f("DISTRICT_ID",l.list[o].Level2.selected,l.list[o].Level2.list,!0):null,l.list[o].Level4.selected=s.stringIsNullUndefinedOrEmpty(l.list[o].Level4.selected)?null:l.list[o].Level1.list.find(function(e){return e.COST_CENTER_ID==JSON.parse(l.list[o].Level4.selected).COST_CENTER_ID}),l.list[o].ClearSwitch.PA=s.stringIsNullUndefinedOrEmpty(l.list[o].PA)?"N":"Y",l.list[o].ClearSwitch.PM=s.stringIsNullUndefinedOrEmpty(l.list[o].PM)?"N":"Y",l.list[o].Level4.list=null!==l.list[o].Level3.selected?f("AREA_ID",l.list[o].Level3.selected,l.list[o].Level3.list,!0):null,l.list[o].FundingSource.list=null!==n?[n]:["Collections","Notice to Proceed","Original Contract","Purchase Order"],l.list[o].ProjectType.list=["BR + Exp","BUILDING","CPFF","CPM","CR","FIXED PRICE","FIXED UNIT","FP + Exp","FP PHYSICAL","MISC-OTHER","MISC-Sublet","R&D","T&M BR","T&M LM","TIME MATERIALS"];e.objectList.funding=angular.copy(l)}}function f(t,n,e,l){return e.filter(function(e){return null!=n&&""!==n&&(l?parseInt(e[t])===parseInt(n[t]):e[t]===n[t])})}function i(e,t){var n={RoleId:1358,Parameters:{COST_CENTER_ID:s.stringIsNullUndefinedOrEmpty(e)?0:parseInt(e)}};return r.Search(n).then(function(e){return e})}function a(e,t,n){var l=angular.copy(e.list.division),o=C(n),r=s.isInArray(e.selected.PROJECT_TYPE,["BR + Exp","BUILDING","CPFF","CPM","CR","FIXED PRICE","FIXED UNIT","FP + Exp","FP PHYSICAL","MISC-OTHER","MISC-Sublet","R&D","T&M BR","T&M LM","TIME MATERIALS"])?e.selected.PROJECT_TYPE:null,i=s.stringIsNullUndefinedOrEmpty(e.list.workflowLbl)?s.stringIsNullUndefinedOrEmpty(e.list.lbl)?[]:angular.copy(e.list.lbl):angular.copy(e.list.workflowLbl),a={ProjectNumber:null,Level1:{selected:null,list:angular.copy(l)},Level2:{selected:null,list:[]},Level3:{selected:null,list:[]},Level4:{selected:null,list:[]},Lbl:{selected:[],list:angular.copy(i)},PM:s.stringIsNullUndefinedOrEmpty(e.object.projectManager)?null:e.object.projectManager,PMLevel:s.stringIsNullUndefinedOrEmpty(e.object.projectManager)?null:e.object.projectManager.PM_LEVEL,PA:s.stringIsNullUndefinedOrEmpty(e.object.pa)?null:e.object.pa,ClearSwitch:{PM:s.stringIsNullUndefinedOrEmpty(e.object.projectManager)?"N":"Y",PA:s.stringIsNullUndefinedOrEmpty(e.object.pa)?"N":"Y"},FundingClassification:O(n),FundingSource:{selected:o,list:null!==o?[o]:["Collections","Notice to Proceed","Original Contract","Purchase Order"]},ProjectType:{selected:r,list:["BR + Exp","BUILDING","CPFF","CPM","CR","FIXED PRICE","FIXED UNIT","FP + Exp","FP PHYSICAL","MISC-OTHER","MISC-Sublet","R&D","T&M BR","T&M LM","TIME MATERIALS"]},Labor:null,Oh:null,Subcontractor:null,DirectExpense:null,NonReimbursableCost:null,TotalFunding:null,NetFunding:null,ManagementReserve:null,TargetMarginDollar:null,TargetMarginPercentOfTotal:null,TargetMarginPercentOfNet:null,TargetMarginMultiplier:null};e.objectList[t].list.push(a)}function g(e,t,n){var l={ProjectNumber:"MR",Level1:{selected:null,list:null},Level2:{selected:null,list:[]},Level3:{selected:null,list:[]},Level4:{selected:null,list:[]},Lbl:{selected:null,list:[]},PM:s.stringIsNullUndefinedOrEmpty(e.object.pic)?null:e.object.pic.FULL_NAME,PMLevel:null,PA:s.stringIsNullUndefinedOrEmpty(e.object.pa)?null:e.object.pa,ClearSwitch:{PM:s.stringIsNullUndefinedOrEmpty(e.object.projectManager)?"N":"Y",PA:"N"},FundingClassification:O(n),FundingSource:{selected:null,list:null},ProjectType:{selected:null,list:null},Labor:null,Oh:null,Subcontractor:null,DirectExpense:null,NonReimbursableCost:null,TotalFunding:null,NetFunding:null,ManagementReserve:null,TargetMarginDollar:null,TargetMarginPercentOfTotal:null,TargetMarginPercentOfNet:null};e.objectList[t].list.push(l)}function f(t,n,e,l){return e.filter(function(e){return null!=n&&""!==n&&(l?parseInt(e[t])===parseInt(n[t]):e[t]===n[t])})}function v(e){var t=s.stringIsNullUndefinedOrEmpty(e.selected[e.prop.AnticipatedGrossRevenueEdit])?0:parseFloat(e.selected[e.prop.AnticipatedGrossRevenueEdit].toString().replace("$","").replace(",","").replace(",","").replace(",","")),n=s.stringIsNullUndefinedOrEmpty(e.objectList.funding.total.TotalFunding)?0:parseFloat(e.objectList.funding.total.TotalFunding.toString().replace("$","").replace(",","").replace(",","").replace(",",""));s.stringIsNullUndefinedOrEmpty(e.selected[e.prop.AnticipatedGrossRevenueEdit])&&s.stringIsNullUndefinedOrEmpty(e.objectList.funding.total.TotalFunding)?e.selected[e.prop.AnticipatedGrossRevenueVariance]=null:(e.selected[e.prop.AnticipatedGrossRevenueVariance]=n-t,e.selected[e.prop.AnticipatedGrossRevenueVariance]=u.format(e.selected[e.prop.AnticipatedGrossRevenueVariance]))}function I(e){var t=s.stringIsNullUndefinedOrEmpty(e.selected[e.prop.AnticipatedNetRevenueEdit])?0:parseFloat(e.selected[e.prop.AnticipatedNetRevenueEdit].toString().replace("$","").replace(",","").replace(",","").replace(",","")),n=s.stringIsNullUndefinedOrEmpty(e.objectList.funding.total.NetFunding)?0:parseFloat(e.objectList.funding.total.NetFunding.toString().replace("$","").replace(",","").replace(",","").replace(",",""));s.stringIsNullUndefinedOrEmpty(e.selected[e.prop.AnticipatedNetRevenueEdit])&&s.stringIsNullUndefinedOrEmpty(e.objectList.funding.total.NetFunding)?e.selected[e.prop.AnticipatedNetRevenueVariance]=null:(e.selected[e.prop.AnticipatedNetRevenueVariance]=n-t,e.selected[e.prop.AnticipatedNetRevenueVariance]=u.format(e.selected[e.prop.AnticipatedNetRevenueVariance]))}function E(e){var t=s.stringIsNullUndefinedOrEmpty(e.selected[e.prop.AnticipatedMarginEdit])?0:parseFloat(e.selected[e.prop.AnticipatedMarginEdit].toString().replace("$","").replace(",","").replace(",","").replace(",","")),n=s.stringIsNullUndefinedOrEmpty(e.objectList.funding.total.TargetMarginDollar)?0:parseFloat(e.objectList.funding.total.TargetMarginDollar.toString().replace("$","").replace(",","").replace(",","").replace(",",""));s.stringIsNullUndefinedOrEmpty(e.selected[e.prop.AnticipatedMarginEdit])&&s.stringIsNullUndefinedOrEmpty(e.objectList.funding.total.TargetMarginDollar)?e.selected[e.prop.AnticipatedMarginVariance]=null:(e.selected[e.prop.AnticipatedMarginVariance]=n-t,e.selected[e.prop.AnticipatedMarginVariance]=u.format(e.selected[e.prop.AnticipatedMarginVariance]))}function S(e){var t=s.stringIsNullUndefinedOrEmpty(e.selected[e.prop.AnticipatedMarginEdit])?0:parseFloat(e.selected[e.prop.AnticipatedMarginEdit].toString().replace("$","").replace(",","").replace(",","").replace(",","")),n=s.stringIsNullUndefinedOrEmpty(e.selected[e.prop.AnticipatedGrossRevenueEdit])?0:parseFloat(e.selected[e.prop.AnticipatedGrossRevenueEdit].toString().replace("$","").replace(",","").replace(",","").replace(",",""));0!==n?(e.selected[e.prop.AnticipatedMarginPercentOfGross]=t/n*100,e.selected[e.prop.AnticipatedMarginPercentOfGross]=e.selected[e.prop.AnticipatedMarginPercentOfGross].toString().includes(".")?e.selected[e.prop.AnticipatedMarginPercentOfGross].toFixed(2):e.selected[e.prop.AnticipatedMarginPercentOfGross]):e.selected[e.prop.AnticipatedMarginPercentOfGross]=null}function N(e){var t=s.stringIsNullUndefinedOrEmpty(e.selected[e.prop.AnticipatedMarginPercentOfGross])?0:parseFloat(e.selected[e.prop.AnticipatedMarginPercentOfGross].toString().replace("$","").replace(",","").replace(",","").replace(",","")),n=s.stringIsNullUndefinedOrEmpty(e.objectList.funding.total.TargetMarginPercentOfTotal)?0:parseFloat(e.objectList.funding.total.TargetMarginPercentOfTotal.toString().replace("$","").replace(",","").replace(",","").replace(",",""));s.stringIsNullUndefinedOrEmpty(e.selected[e.prop.AnticipatedMarginPercentOfGross])&&s.stringIsNullUndefinedOrEmpty(e.objectList.funding.total.TargetMarginPercentOfTotal)?e.selected[e.prop.AnticipatedMarginPercentOfGrossVariance]=null:(e.selected[e.prop.AnticipatedMarginPercentOfGrossVariance]=n-t,e.selected[e.prop.AnticipatedMarginPercentOfGrossVariance]=e.selected[e.prop.AnticipatedMarginPercentOfGrossVariance].toString().includes(".")?e.selected[e.prop.AnticipatedMarginPercentOfGrossVariance].toFixed(2):e.selected[e.prop.AnticipatedMarginPercentOfGrossVariance])}function A(e){var t=s.stringIsNullUndefinedOrEmpty(e.selected[e.prop.AnticipatedNetRevenueEdit])?0:parseFloat(e.selected[e.prop.AnticipatedNetRevenueEdit].toString().replace("$","").replace(",","").replace(",","").replace(",","")),n=s.stringIsNullUndefinedOrEmpty(e.selected[e.prop.AnticipatedMarginEdit])?0:parseFloat(e.selected[e.prop.AnticipatedMarginEdit].toString().replace("$","").replace(",","").replace(",","").replace(",",""));0!==t?(e.selected[e.prop.AnticipatedMarginPercentOfNet]=n/t*100,e.selected[e.prop.AnticipatedMarginPercentOfNet]=e.selected[e.prop.AnticipatedMarginPercentOfNet].toString().includes(".")?e.selected[e.prop.AnticipatedMarginPercentOfNet].toFixed(2):e.selected[e.prop.AnticipatedMarginPercentOfNet]):e.selected[e.prop.AnticipatedMarginPercentOfNet]=null}function y(e){var t=s.stringIsNullUndefinedOrEmpty(e.selected[e.prop.AnticipatedMarginPercentOfNet])?0:parseFloat(e.selected[e.prop.AnticipatedMarginPercentOfNet].toString().replace("$","").replace(",","").replace(",","").replace(",","")),n=s.stringIsNullUndefinedOrEmpty(e.objectList.funding.total.TargetMarginPercentOfNet)?0:parseFloat(e.objectList.funding.total.TargetMarginPercentOfNet.toString().replace("$","").replace(",","").replace(",","").replace(",",""));s.stringIsNullUndefinedOrEmpty(e.selected[e.prop.AnticipatedMarginPercentOfNet])&&s.stringIsNullUndefinedOrEmpty(e.objectList.funding.total.TargetMarginPercentOfNet)?e.selected[e.prop.AnticipatedMarginPercentOfNetVariance]=null:(e.selected[e.prop.AnticipatedMarginPercentOfNetVariance]=n-t,e.selected[e.prop.AnticipatedMarginPercentOfNetVariance]=e.selected[e.prop.AnticipatedMarginPercentOfNetVariance].toString().includes(".")?e.selected[e.prop.AnticipatedMarginPercentOfNetVariance].toFixed(2):e.selected[e.prop.AnticipatedMarginPercentOfNetVariance])}function R(e){var t=s.stringIsNullUndefinedOrEmpty(e.selected[e.prop.AgreementFundingInOracle])?0:parseFloat(e.selected[e.prop.AgreementFundingInOracle].toString().replace("$","").replace(",","").replace(",","").replace(",","")),n=s.stringIsNullUndefinedOrEmpty(e.objectList.funding.total.TotalFunding)?0:parseFloat(e.objectList.funding.total.TotalFunding.toString().replace("$","").replace(",","").replace(",","").replace(",",""));s.stringIsNullUndefinedOrEmpty(e.selected[e.prop.AgreementFundingInOracle])&&s.stringIsNullUndefinedOrEmpty(e.objectList.funding.total.TotalFunding)?e.selected[e.prop.TotalAgreementFunding]=null:(e.selected[e.prop.TotalAgreementFunding]=t+n,e.selected[e.prop.TotalAgreementFunding]=u.format(e.selected[e.prop.TotalAgreementFunding]))}function O(e){return s.stringIsNullUndefinedOrEmpty(e)?"Original":3<e.length?"Change Order Executed"===e[3].ApprovalItemName.EN?"Additional":"Change Order Pending - Mod Not Yet Executed"===e[3].ApprovalItemName.EN?"Additional":"Correction"===e[3].ApprovalItemName.EN?"Correction":"Transfer"===e[3].ApprovalItemName.EN?"Transfer":"Original":"Original"}function C(e){return s.stringIsNullUndefinedOrEmpty(e)?null:3<e.length?"Change Order Executed"===e[3].ApprovalItemName.EN?"MOD/SUPPLEMENT":"Change Order Pending - Mod Not Yet Executed"===e[3].ApprovalItemName.EN?"Pending/Unsigned Modification":"Correction"===e[3].ApprovalItemName.EN?"ERROR CORRECTION":"Transfer"===e[3].ApprovalItemName.EN?"Transfer of Funds":null:null}}angular.module("myApp").service("ProjectSetupFormBusiness",e),e.$inject=["astigUtilityService","LookupRoleIds","LookupService","$q","GenericDataService"]}();
//# sourceMappingURL=js.7db9eb99c05f-43a0-a7b5-2f40190708ed.min.js.map